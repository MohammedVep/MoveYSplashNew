{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohammedvepari/Documents/Algoma%20University/Fall%202025/COSC%204086/move-y-splash-new/src/app/components/Stories.tsx"],"sourcesContent":["'use client';\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { ChangeEvent, DragEvent } from 'react';\nimport { Avatar, AvatarFallback, AvatarImage } from './ui/avatar';\nimport { Button } from './ui/button';\nimport { Dialog, DialogContent } from './ui/dialog';\nimport { Input } from './ui/input';\nimport { Skeleton } from './ui/skeleton';\nimport {\n  Plus,\n  X,\n  ChevronLeft,\n  ChevronRight,\n  Heart,\n  Send,\n  UploadCloud,\n  Trash2,\n  Camera,\n  Loader2,\n  Video,\n  Square,\n  Volume2,\n  VolumeX,\n} from 'lucide-react';\nimport { ImageWithFallback } from './figma/ImageWithFallback';\nimport { useUser } from '../utils/userContext';\nimport { projectId, publicAnonKey } from '../utils/supabase/info';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';\nimport { toast } from 'sonner';\n\nconst API_BASE_URL = `https://${projectId}.supabase.co/functions/v1/make-server-a14c7986`;\nconst AUTH_HEADERS = { Authorization: `Bearer ${publicAnonKey}` };\nconst JSON_HEADERS = { ...AUTH_HEADERS, 'Content-Type': 'application/json' };\nconst STORY_SKELETON_COUNT = 5;\nconst MAX_STORY_ITEMS = 5;\nconst DEFAULT_IMAGE_DURATION = 6;\nconst DEFAULT_VIDEO_DURATION = 15;\nconst MAX_CAMERA_RECORDING_MS = DEFAULT_VIDEO_DURATION * 1000;\n\nconst blobToDataUrl = (blob: Blob): Promise<string> =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      if (typeof reader.result === 'string') {\n        resolve(reader.result);\n      } else {\n        reject(new Error('Unable to read recording data'));\n      }\n    };\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n\nconst getSupportedRecordingMimeType = () => {\n  if (typeof window === 'undefined' || typeof window.MediaRecorder === 'undefined') {\n    return '';\n  }\n\n  const Recorder = window.MediaRecorder;\n  const candidates = [\n    'video/webm;codecs=vp9',\n    'video/webm;codecs=vp8',\n    'video/webm;codecs=avc1',\n    'video/webm',\n    'video/mp4',\n  ];\n\n  const supported = candidates.find((candidate) => candidate && Recorder.isTypeSupported(candidate));\n  return supported ?? '';\n};\n\nconst formatRecordingTime = (seconds: number) => {\n  const safeSeconds = Math.max(0, seconds);\n  const wholeSeconds = Math.floor(safeSeconds);\n  const mins = Math.floor(wholeSeconds / 60);\n  const secs = wholeSeconds % 60;\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\n};\n\nconst STORY_VISIBILITY_OPTIONS: Array<{\n  label: string;\n  value: 'friends' | 'public' | 'close_friends';\n  description: string;\n}> = [\n  {\n    label: 'Public',\n    value: 'public',\n    description: 'Everyone on MoveSplash can view your story',\n  },\n  {\n    label: 'Friends',\n    value: 'friends',\n    description: 'Only your connections can view',\n  },\n  {\n    label: 'Close friends',\n    value: 'close_friends',\n    description: 'Share with your inner circle only',\n  },\n];\n\nconst formatRelativeTime = (isoTimestamp: string) => {\n  const date = new Date(isoTimestamp);\n  if (Number.isNaN(date.getTime())) {\n    return '';\n  }\n\n  const diffMs = Date.now() - date.getTime();\n  const minutes = Math.floor(diffMs / (1000 * 60));\n  if (minutes < 1) {\n    return 'Just now';\n  }\n  if (minutes < 60) {\n    return `${minutes}m ago`;\n  }\n  const hours = Math.floor(minutes / 60);\n  if (hours < 24) {\n    return `${hours}h ago`;\n  }\n  const days = Math.floor(hours / 24);\n  if (days < 7) {\n    return `${days}d ago`;\n  }\n  return date.toLocaleDateString();\n};\n\ntype StoryDraftItem = {\n  id: string;\n  type: 'image' | 'video';\n  url: string;\n  duration: number;\n};\n\ninterface StoryUser {\n  id: string;\n  name: string;\n  username: string;\n  avatar: string;\n  ablyClientId: string;\n}\n\ninterface StoryItemData {\n  id: string;\n  type: 'image' | 'video';\n  url: string;\n  duration: number;\n  timestamp: string;\n}\n\ninterface StoryReplyData {\n  id: string;\n  storyId?: string;\n  authorId: string;\n  content: string;\n  timestamp: string;\n  author?: StoryUser;\n}\n\ninterface StoryReply {\n  id: string;\n  storyId: string;\n  authorId: string;\n  content: string;\n  timestamp: string;\n  author: StoryUser | null;\n}\n\ninterface StoryAPIResponse {\n  id: string;\n  userId: string;\n  user?: StoryUser;\n  items?: StoryItemData[];\n  viewers?: string[];\n  visibility?: 'friends' | 'public' | 'close_friends';\n  createdAt?: string;\n  expiresAt?: string;\n  likes?: string[];\n  replies?: StoryReplyData[];\n}\n\ninterface StoryState {\n  id: string;\n  userId: string;\n  user: StoryUser;\n  items: StoryItemData[];\n  viewers: string[];\n  visibility: 'friends' | 'public' | 'close_friends';\n  createdAt: string;\n  expiresAt: string;\n  viewed: boolean;\n  likes: string[];\n  likeCount: number;\n  liked: boolean;\n  replies: StoryReply[];\n}\n\nconst STORY_PLACEHOLDER_URL =\n  'https://api.dicebear.com/7.x/shapes/svg?seed=MoveSplashStory&backgroundColor=transparent';\n\nconst storyStateToApiResponse = (story: StoryState): StoryAPIResponse => ({\n  id: story.id,\n  userId: story.userId,\n  user: story.user,\n  items: story.items.map((item) => ({\n    ...item,\n    url:\n      typeof item.url === 'string' && item.url.trim() !== '' && item.url !== '__existing__'\n        ? item.url\n        : STORY_PLACEHOLDER_URL,\n  })),\n  viewers: story.viewers,\n  visibility: story.visibility,\n  createdAt: story.createdAt,\n  expiresAt: story.expiresAt,\n  likes: story.likes,\n  replies: story.replies.map((reply) => ({\n    id: reply.id,\n    storyId: reply.storyId,\n    authorId: reply.authorId,\n    content: reply.content,\n    timestamp: reply.timestamp,\n    author: reply.author ?? undefined,\n  })),\n});\n\nexport function Stories() {\n  const { currentUser } = useUser();\n  const [storiesData, setStoriesData] = useState<StoryAPIResponse[]>([]);\n  const [selectedStory, setSelectedStory] = useState<string | null>(null);\n  const [currentItemIndex, setCurrentItemIndex] = useState(0);\n  const [replyText, setReplyText] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isCreatorOpen, setIsCreatorOpen] = useState(false);\n  const storyVideoRef = useRef<HTMLVideoElement | null>(null);\n  const [storyDraft, setStoryDraft] = useState<StoryDraftItem[]>([]);\n  const [storyVisibility, setStoryVisibility] = useState<'friends' | 'public' | 'close_friends'>('friends');\n  const [isSubmittingStory, setIsSubmittingStory] = useState(false);\n  const [creationError, setCreationError] = useState<string | null>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\n  const [likingStoryId, setLikingStoryId] = useState<string | null>(null);\n  const [replySending, setReplySending] = useState(false);\n  const [isCameraActive, setIsCameraActive] = useState(false);\n  const [cameraStream, setCameraStream] = useState<MediaStream | null>(null);\n  const [cameraError, setCameraError] = useState<string | null>(null);\n  const [isCapturingPhoto, setIsCapturingPhoto] = useState(false);\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const recordingChunksRef = useRef<Blob[]>([]);\n  const recordingTimerRef = useRef<number | null>(null);\n  const recordingDiscardRef = useRef(false);\n  const recordingMimeTypeRef = useRef('video/webm');\n  const recordingDurationRef = useRef(0);\n  const [isRecordingVideo, setIsRecordingVideo] = useState(false);\n  const [recordingDuration, setRecordingDuration] = useState(0);\n  const [recordingError, setRecordingError] = useState<string | null>(null);\n  const [isStoryVideoMuted, setIsStoryVideoMuted] = useState(true);\n  const [storyVideoProgress, setStoryVideoProgress] = useState(0);\n  const encodeStoryId = useCallback((storyId: string) => encodeURIComponent(storyId), []);\n\n  const fetchStories = useCallback(\n    async (signal?: AbortSignal) => {\n      try {\n        if (!signal?.aborted) {\n          setLoading(true);\n          setError(null);\n        }\n\n        const response = await fetch(`${API_BASE_URL}/stories`, {\n          headers: AUTH_HEADERS,\n          signal,\n        });\n\n        if (!response.ok) {\n          throw new Error('Failed to fetch stories');\n        }\n\n        const payload = (await response.json().catch(() => ({}))) as {\n          stories?: StoryAPIResponse[];\n        };\n\n        if (!signal?.aborted) {\n          setStoriesData(Array.isArray(payload?.stories) ? payload.stories : []);\n        }\n      } catch (fetchError) {\n        if ((fetchError as Error).name === 'AbortError') {\n          return;\n        }\n        console.error('Error loading stories:', fetchError);\n        if (!signal?.aborted) {\n          setError('Unable to load stories right now.');\n        }\n      } finally {\n        if (!signal?.aborted) {\n          setLoading(false);\n        }\n      }\n    },\n    [],\n  );\n\n  const mergeStoryUpdate = useCallback(\n    (storyUpdate: StoryAPIResponse, options?: { prepend?: boolean }) => {\n      setStoriesData((prev) => {\n        const sanitizeItems = (\n          items: StoryAPIResponse['items'],\n          existing?: StoryAPIResponse['items'],\n        ) => {\n          if (!Array.isArray(items)) {\n            return items;\n          }\n          return items.map((item, index) => {\n            const previous = existing?.[index];\n            const normalizedUrl =\n              typeof item.url === 'string' && item.url.trim() !== '' && item.url !== '__existing__'\n                ? item.url\n                : '';\n            const previousUrl =\n              typeof previous?.url === 'string' && previous.url.trim() !== '' && previous.url !== '__existing__'\n                ? previous.url\n                : '';\n            const resolvedUrl = normalizedUrl || previousUrl || STORY_PLACEHOLDER_URL;\n            return { ...item, url: resolvedUrl };\n          });\n        };\n        const cleanedUpdate: StoryAPIResponse = {\n          ...storyUpdate,\n          items: sanitizeItems(storyUpdate.items),\n        };\n        const exists = prev.some((entry) => entry.id === storyUpdate.id);\n        if (exists) {\n          return prev.map((entry) =>\n            entry.id === storyUpdate.id\n              ? {\n                  ...entry,\n                  ...cleanedUpdate,\n                  items: sanitizeItems(cleanedUpdate.items, entry.items),\n                }\n              : entry,\n          );\n        }\n        if (options?.prepend) {\n          return [cleanedUpdate, ...prev];\n        }\n        return [...prev, cleanedUpdate];\n      });\n    },\n    [],\n  );\n\n  const buildUserSnapshot = useCallback((user: StoryUser | null) => {\n    if (!user) {\n      return null;\n    }\n\n    return {\n      id: user.id,\n      name: user.name,\n      username: user.username,\n      avatar: user.avatar,\n      ablyClientId: user.ablyClientId ?? user.id,\n    };\n  }, []);\n\n  const buildStorySnapshot = useCallback((story: StoryState) => {\n    return {\n      id: story.id,\n      userId: story.userId,\n      visibility: story.visibility,\n      createdAt: story.createdAt,\n      expiresAt: story.expiresAt,\n      viewers: story.viewers,\n      likes: story.likes,\n      items: story.items.map((item) => ({\n        id: item.id,\n        type: item.type,\n        url:\n          typeof item.url === 'string' && item.url.trim() !== '' ? item.url : STORY_PLACEHOLDER_URL,\n        duration: item.duration,\n        timestamp: item.timestamp ?? new Date().toISOString(),\n      })),\n      user: {\n        id: story.user.id,\n        name: story.user.name,\n        username: story.user.username,\n        avatar: story.user.avatar,\n        ablyClientId: story.user.ablyClientId,\n      },\n      replies: story.replies.map((reply) => ({\n        id: reply.id,\n        storyId: reply.storyId,\n        authorId: reply.authorId,\n        content: reply.content,\n        timestamp: reply.timestamp,\n        author: reply.author\n          ? {\n              id: reply.author.id,\n              name: reply.author.name,\n              username: reply.author.username,\n              avatar: reply.author.avatar,\n              ablyClientId: reply.author.ablyClientId,\n            }\n          : undefined,\n      })),\n    };\n  }, []);\n\n  const ensureStoryOnServer = useCallback(\n    async (story: StoryState) => {\n      try {\n        const ownerSnapshot = buildUserSnapshot(story.user);\n        const response = await fetch(`${API_BASE_URL}/stories`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({\n            ...buildStorySnapshot(story),\n            userSnapshot: ownerSnapshot ?? undefined,\n          }),\n        });\n\n        if (!response.ok) {\n          return false;\n        }\n\n        const payload = (await response.json().catch(() => ({}))) as {\n          story?: StoryAPIResponse;\n        };\n\n        if (payload?.story) {\n          mergeStoryUpdate(payload.story);\n        }\n\n        return true;\n      } catch (restoreError) {\n        console.error('Failed to ensure story on server:', restoreError);\n        return false;\n      }\n    },\n    [buildStorySnapshot, buildUserSnapshot, mergeStoryUpdate],\n  );\n\n  const processFiles = useCallback(\n    (files: FileList | File[] | null) => {\n      if (!files) {\n        return;\n      }\n\n      const fileArray = Array.from(files).filter((file) =>\n        file.type.startsWith('image/') || file.type.startsWith('video/'),\n      );\n\n      if (fileArray.length === 0) {\n        setCreationError('Only image or video files are supported for stories.');\n        toast.error('Only image or video files are supported for stories.');\n        return;\n      }\n\n      const availableSlots = Math.max(MAX_STORY_ITEMS - storyDraft.length, 0);\n      if (availableSlots <= 0) {\n        setCreationError(`You can add up to ${MAX_STORY_ITEMS} story items.`);\n        toast.info(`You can add up to ${MAX_STORY_ITEMS} story items.`);\n        return;\n      }\n\n      const allowedFiles = fileArray.slice(0, availableSlots);\n      const hasOverflow = fileArray.length > allowedFiles.length;\n\n      allowedFiles.forEach((file) => {\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          const result = event.target?.result;\n          if (!result || typeof result !== 'string') {\n            return;\n          }\n\n          const isVideo = file.type.startsWith('video/');\n          setStoryDraft((prev) => [\n            ...prev,\n            {\n              id: `${file.name}-${Date.now()}`,\n              type: isVideo ? 'video' : 'image',\n              url: result,\n              duration: isVideo ? DEFAULT_VIDEO_DURATION : DEFAULT_IMAGE_DURATION,\n            },\n          ]);\n        };\n        reader.readAsDataURL(file);\n      });\n\n      if (allowedFiles.length > 0) {\n        setCreationError(null);\n      }\n\n      if (hasOverflow) {\n        toast.info(`Only the first ${availableSlots} files were added.`);\n      }\n    },\n    [storyDraft.length],\n  );\n\n  const handleFileInputChange = useCallback(\n    (event: ChangeEvent<HTMLInputElement>) => {\n      processFiles(event.target.files);\n      event.target.value = '';\n    },\n    [processFiles],\n  );\n\n  const handleDrop = useCallback(\n    (event: DragEvent<HTMLDivElement>) => {\n      event.preventDefault();\n      setIsDragging(false);\n      processFiles(event.dataTransfer.files);\n    },\n    [processFiles],\n  );\n\n  const handleDragOver = useCallback((event: DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'copy';\n    if (!isDragging) {\n      setIsDragging(true);\n    }\n  }, [isDragging]);\n\n  const handleDragLeave = useCallback((event: DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    setIsDragging(false);\n  }, []);\n\n  const clearRecordingTimer = useCallback(() => {\n    if (recordingTimerRef.current !== null) {\n      window.clearInterval(recordingTimerRef.current);\n      recordingTimerRef.current = null;\n    }\n  }, []);\n\n  const finalizeRecording = useCallback(async () => {\n    clearRecordingTimer();\n    const discard = recordingDiscardRef.current;\n    recordingDiscardRef.current = false;\n    const chunks = recordingChunksRef.current;\n    recordingChunksRef.current = [];\n    mediaRecorderRef.current = null;\n    const mimeType = recordingMimeTypeRef.current || 'video/webm';\n    const durationSeconds = Math.max(recordingDurationRef.current, 0);\n    recordingDurationRef.current = 0;\n    setIsRecordingVideo(false);\n    setRecordingDuration(0);\n\n    if (discard || chunks.length === 0) {\n      if (discard && chunks.length > 0) {\n        toast.info('Recording discarded.');\n      }\n      return;\n    }\n\n    try {\n      const blob = new Blob(chunks, { type: mimeType });\n      const dataUrl = await blobToDataUrl(blob);\n      setStoryDraft((prev) => {\n        if (prev.length >= MAX_STORY_ITEMS) {\n          toast.info(`You can add up to ${MAX_STORY_ITEMS} story items.`);\n          return prev;\n        }\n        const derivedDuration = Math.min(\n          DEFAULT_VIDEO_DURATION,\n          Math.max(3, Math.round(durationSeconds) || DEFAULT_VIDEO_DURATION),\n        );\n        return [\n          ...prev,\n          {\n            id: `recording-${Date.now()}`,\n            type: 'video',\n            url: dataUrl,\n            duration: derivedDuration,\n          },\n        ];\n      });\n      toast.success('Video added to your story.');\n    } catch (error) {\n      console.error('Failed to save recording:', error);\n      toast.error('Unable to save that recording.');\n    }\n  }, [setStoryDraft, clearRecordingTimer]);\n\n  const stopVideoRecording = useCallback(\n    (discard = false) => {\n      if (!mediaRecorderRef.current) {\n        recordingDiscardRef.current = false;\n        return;\n      }\n      recordingDiscardRef.current = discard;\n      if (mediaRecorderRef.current.state !== 'inactive') {\n        mediaRecorderRef.current.stop();\n      }\n    },\n    [],\n  );\n\n  const startVideoRecording = useCallback(() => {\n    if (!isCameraActive || !cameraStream) {\n      toast.info('Start the camera before recording.');\n      return;\n    }\n    if (isRecordingVideo) {\n      toast.info('Recording already in progress.');\n      return;\n    }\n    if (typeof window === 'undefined' || typeof window.MediaRecorder === 'undefined') {\n      setRecordingError('Video recording is not supported in this browser.');\n      toast.error('Recording is not supported on this device.');\n      return;\n    }\n\n    try {\n      const mimeType = getSupportedRecordingMimeType();\n      const recorder = mimeType\n        ? new MediaRecorder(cameraStream, { mimeType })\n        : new MediaRecorder(cameraStream);\n      recordingMimeTypeRef.current = mimeType || recorder.mimeType || 'video/webm';\n      recordingChunksRef.current = [];\n      recorder.ondataavailable = (event) => {\n        if (event.data && event.data.size > 0) {\n          recordingChunksRef.current.push(event.data);\n        }\n      };\n      recorder.onerror = (errorEvent) => {\n        console.error('Recording error:', errorEvent);\n        setRecordingError('Recording error. Please try again.');\n        toast.error('Recording error.');\n        recordingDiscardRef.current = true;\n      };\n      recorder.onstop = () => {\n        finalizeRecording().catch((error) => {\n          console.error('Failed to finalize recording:', error);\n        });\n      };\n\n      mediaRecorderRef.current = recorder;\n      recorder.start();\n      setIsRecordingVideo(true);\n      setRecordingDuration(0);\n      recordingDurationRef.current = 0;\n      setRecordingError(null);\n      recordingTimerRef.current = window.setInterval(() => {\n        setRecordingDuration((prev) => {\n          const next = prev + 0.2;\n          recordingDurationRef.current = next;\n          if (next * 1000 >= MAX_CAMERA_RECORDING_MS) {\n            stopVideoRecording();\n          }\n          return next;\n        });\n      }, 200);\n      toast.success('Recording started.');\n    } catch (error) {\n      console.error('Unable to start recording:', error);\n      setRecordingError('Unable to start recording. Please try again.');\n      toast.error('Unable to start recording.');\n    }\n  }, [cameraStream, finalizeRecording, isCameraActive, isRecordingVideo, stopVideoRecording]);\n\n  useEffect(() => {\n    return () => {\n      clearRecordingTimer();\n      recordingDiscardRef.current = true;\n      if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n        mediaRecorderRef.current.stop();\n      }\n    };\n  }, [clearRecordingTimer]);\n\n  const stopCamera = useCallback(() => {\n    if (isRecordingVideo) {\n      stopVideoRecording(true);\n    }\n    setCameraStream((stream) => {\n      if (stream) {\n        stream.getTracks().forEach((track) => {\n          try {\n            track.stop();\n          } catch (stopError) {\n            console.error('Error stopping camera stream track:', stopError);\n          }\n        });\n      }\n\n      return null;\n    });\n    setIsCameraActive(false);\n    setIsCapturingPhoto(false);\n    setRecordingDuration(0);\n    recordingDurationRef.current = 0;\n    setRecordingError(null);\n    setCameraError(null);\n  }, [isRecordingVideo, stopVideoRecording]);\n\n  const startCamera = useCallback(async () => {\n    if (typeof navigator === 'undefined' || !navigator.mediaDevices?.getUserMedia) {\n      setCameraError('Camera is not supported on this device.');\n      return;\n    }\n\n    try {\n      stopCamera();\n      let stream: MediaStream | null = null;\n      try {\n        stream = await navigator.mediaDevices.getUserMedia({\n          video: { facingMode: 'user' },\n          audio: true,\n        });\n      } catch (audioError) {\n        console.warn('Falling back to video-only capture for stories:', audioError);\n        stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } });\n      }\n      setCameraStream(stream);\n      setIsCameraActive(true);\n      setCameraError(null);\n    } catch (cameraErr) {\n      console.error('Error accessing camera:', cameraErr);\n      setCameraError('Unable to access camera. Check your permissions.');\n      setIsCameraActive(false);\n    }\n  }, [stopCamera]);\n\n  const capturePhoto = useCallback(() => {\n    if (!isCameraActive || !videoRef.current) {\n      toast.info('Start the camera to capture a photo.');\n      return;\n    }\n    if (isRecordingVideo) {\n      toast.info('Stop the recording before taking a photo.');\n      return;\n    }\n\n    const video = videoRef.current;\n    setIsCapturingPhoto(true);\n    setStoryDraft((prev) => {\n      if (prev.length >= MAX_STORY_ITEMS) {\n        toast.info(`You can add up to ${MAX_STORY_ITEMS} story items.`);\n        setIsCapturingPhoto(false);\n        return prev;\n      }\n\n      const canvas = document.createElement('canvas');\n      const width = video.videoWidth || 720;\n      const height = video.videoHeight || 1280;\n      canvas.width = width;\n      canvas.height = height;\n      const context = canvas.getContext('2d');\n      if (!context) {\n        toast.error('Unable to capture photo.');\n        setIsCapturingPhoto(false);\n        return prev;\n      }\n      context.drawImage(video, 0, 0, width, height);\n      const dataUrl = canvas.toDataURL('image/jpeg', 0.9);\n      if (!dataUrl) {\n        toast.error('Unable to capture photo.');\n        setIsCapturingPhoto(false);\n        return prev;\n      }\n\n      toast.success('Photo added to your story.');\n      setIsCapturingPhoto(false);\n      return [\n        ...prev,\n        { id: `camera-${Date.now()}`, type: 'image', url: dataUrl, duration: DEFAULT_IMAGE_DURATION },\n      ];\n    });\n  }, [isCameraActive, isRecordingVideo]);\n\n  const resetCreatorState = useCallback(() => {\n    setStoryDraft([]);\n    setStoryVisibility('friends');\n    setCreationError(null);\n    setIsDragging(false);\n    setIsSubmittingStory(false);\n    stopCamera();\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  }, [stopCamera]);\n\n  const handleRemoveDraftItem = useCallback((id: string) => {\n    setStoryDraft((prev) => prev.filter((item) => item.id !== id));\n  }, []);\n\n  const handleCreatorOpenChange = useCallback(\n    (open: boolean) => {\n      setIsCreatorOpen(open);\n      if (!open) {\n        resetCreatorState();\n      }\n    },\n    [resetCreatorState],\n  );\n\n  const handleCreateStory = useCallback(async () => {\n    if (!currentUser) {\n      toast.info(\"Sign in to share a story.\");\n      return;\n    }\n\n    if (storyDraft.length === 0) {\n      setCreationError('Add at least one photo or video to your story.');\n      return;\n    }\n\n    setIsSubmittingStory(true);\n    setCreationError(null);\n\n    try {\n      const payloadItems = storyDraft.map((item) => ({\n        id: item.id,\n        type: item.type,\n        url: item.url,\n        duration: item.duration,\n        timestamp: new Date().toISOString(),\n      }));\n\n      const response = await fetch(`${API_BASE_URL}/stories`, {\n        method: 'POST',\n        headers: JSON_HEADERS,\n        body: JSON.stringify({\n          userId: currentUser.id,\n          visibility: storyVisibility,\n          items: payloadItems,\n        }),\n      });\n\n      const payload = (await response.json().catch(() => ({}))) as {\n        story?: StoryAPIResponse;\n        error?: string;\n      };\n\n      if (!response.ok || !payload?.story) {\n        const errorMessage = payload?.error ?? 'Failed to publish story.';\n        throw new Error(errorMessage);\n      }\n\n      const createdStory = payload.story;\n\n      mergeStoryUpdate(createdStory, { prepend: true });\n\n      const newStoryId = createdStory.id;\n\n      handleCreatorOpenChange(false);\n\n      toast.success('Your story is live!');\n\n      void fetchStories().catch((error) => {\n        console.error('Error refreshing stories:', error);\n      });\n\n      setSelectedStory(newStoryId);\n      setCurrentItemIndex(0);\n    } catch (creationErrorCaught) {\n      console.error('Error creating story:', creationErrorCaught);\n      const message =\n        creationErrorCaught instanceof Error\n          ? creationErrorCaught.message\n          : 'Unable to publish story right now.';\n      setCreationError(message);\n      toast.error('Unable to publish story right now.');\n    } finally {\n      setIsSubmittingStory(false);\n    }\n  }, [currentUser, storyDraft, storyVisibility, fetchStories, handleCreatorOpenChange, mergeStoryUpdate]);\n\n  useEffect(() => {\n    const controller = new AbortController();\n    fetchStories(controller.signal);\n    return () => controller.abort();\n  }, [fetchStories]);\n\n  useEffect(() => {\n    const video = videoRef.current;\n    if (!video) {\n      return;\n    }\n\n    if (cameraStream) {\n      video.srcObject = cameraStream;\n      const play = async () => {\n        try {\n          await video.play();\n        } catch (err) {\n          console.error('Error starting camera preview:', err);\n          setCameraError('Unable to start camera preview.');\n        }\n      };\n      void play();\n    } else {\n      video.srcObject = null;\n    }\n  }, [cameraStream]);\n\n  useEffect(() => {\n    if (!isCreatorOpen) {\n      stopCamera();\n    }\n  }, [isCreatorOpen, stopCamera]);\n\n  const storyFeed = useMemo<StoryState[]>(() => {\n    return storiesData\n      .filter(\n        (story): story is StoryAPIResponse & { user: StoryUser; items: StoryItemData[] } =>\n          Boolean(story?.user) && Array.isArray(story.items) && story.items.length > 0,\n      )\n      .map((story) => {\n        const safeItems: StoryItemData[] = story.items!.map((item): StoryItemData => ({\n          ...item,\n          type: item.type === 'video' ? 'video' : 'image',\n        }));\n        const baseUser = story.user!;\n        const resolvedUser: StoryUser = {\n          id: baseUser.id,\n          name: baseUser.name,\n          username: baseUser.username,\n          avatar: baseUser.avatar,\n          ablyClientId: baseUser.ablyClientId ?? baseUser.id,\n        };\n        const createdAt = story.createdAt && !Number.isNaN(Date.parse(story.createdAt))\n          ? new Date(story.createdAt).toISOString()\n          : new Date().toISOString();\n        const expiresAt = story.expiresAt && !Number.isNaN(Date.parse(story.expiresAt))\n          ? new Date(story.expiresAt).toISOString()\n          : createdAt;\n        const likes = Array.from(\n          new Set(\n            Array.isArray(story.likes)\n              ? story.likes.filter((value): value is string => typeof value === 'string')\n              : [],\n          ),\n        );\n        const replies: StoryReply[] = Array.isArray(story.replies)\n          ? story.replies\n              .map((reply, index) => {\n                if (!reply || typeof reply !== 'object') {\n                  return null;\n                }\n                const replyData = reply as StoryReplyData;\n                const replyAuthorId = typeof replyData.authorId === 'string' ? replyData.authorId : '';\n                if (!replyAuthorId) {\n                  return null;\n                }\n                const timestamp = replyData.timestamp && !Number.isNaN(Date.parse(replyData.timestamp))\n                  ? new Date(replyData.timestamp).toISOString()\n                  : new Date().toISOString();\n                const authorData = replyData.author;\n                const author: StoryUser | null = authorData\n                  ? {\n                      id: authorData.id,\n                      name: authorData.name,\n                      username: authorData.username,\n                      avatar: authorData.avatar,\n                      ablyClientId: authorData.ablyClientId ?? authorData.id,\n                    }\n                  : null;\n                const content = typeof replyData.content === 'string' ? replyData.content : '';\n                if (!content) {\n                  return null;\n                }\n\n                return {\n                  id: replyData.id || `${story.id}-reply-${index}`,\n                  storyId: replyData.storyId ?? story.id,\n                  authorId: replyAuthorId,\n                  author,\n                  content,\n                  timestamp,\n                };\n              })\n              .filter((reply): reply is StoryReply => Boolean(reply))\n              .sort((a, b) => Date.parse(a.timestamp) - Date.parse(b.timestamp))\n          : [];\n\n        return {\n          id: story.id,\n          userId: story.userId,\n          user: resolvedUser,\n          items: safeItems,\n          viewers: Array.isArray(story.viewers) ? story.viewers : [],\n          visibility: story.visibility ?? 'friends',\n          createdAt,\n          expiresAt,\n          viewed: currentUser\n            ? Array.isArray(story.viewers)\n              ? story.viewers.includes(currentUser.id)\n              : false\n            : false,\n          likes,\n          likeCount: likes.length,\n          liked: currentUser ? likes.includes(currentUser.id) : false,\n          replies,\n        };\n      })\n      .sort((a, b) => Date.parse(b.createdAt) - Date.parse(a.createdAt));\n  }, [storiesData, currentUser]);\n\n  const storyCreationPlaceholder = useMemo<StoryState | null>(() => {\n    if (!currentUser) {\n      return null;\n    }\n\n    const hasExistingStory = storyFeed.some((story) => story.userId === currentUser.id);\n    if (hasExistingStory) {\n      return null;\n    }\n\n    const nowIso = new Date().toISOString();\n    return {\n      id: `create-story-${currentUser.id}`,\n      userId: currentUser.id,\n      user: {\n        id: currentUser.id,\n        name: currentUser.name,\n        username: currentUser.username,\n        avatar: currentUser.avatar,\n        ablyClientId: currentUser.ablyClientId ?? currentUser.id,\n      },\n      items: [],\n      viewers: [],\n      visibility: 'friends',\n      createdAt: nowIso,\n      expiresAt: nowIso,\n      viewed: false,\n      likes: [],\n      likeCount: 0,\n      liked: false,\n      replies: [],\n    };\n  }, [currentUser, storyFeed]);\n\n  const playableStories = useMemo(\n    () => storyFeed.filter((story) => story.items.length > 0),\n    [storyFeed],\n  );\n\n  const orderedStories = useMemo(() => {\n    let ordered = storyFeed;\n    if (currentUser) {\n      const ownStories = storyFeed.filter((story) => story.userId === currentUser.id);\n      const others = storyFeed.filter((story) => story.userId !== currentUser.id);\n      ordered = [...ownStories, ...others];\n    }\n\n    if (storyCreationPlaceholder) {\n      return [storyCreationPlaceholder, ...ordered];\n    }\n\n    return ordered;\n  }, [currentUser, storyFeed, storyCreationPlaceholder]);\n\n  const currentStory = selectedStory\n    ? playableStories.find((story) => story.id === selectedStory) ?? null\n    : null;\n  const currentItem = currentStory?.items[currentItemIndex];\n\n  useEffect(() => {\n    if (!selectedStory) {\n      return;\n    }\n\n    if (playableStories.some((story) => story.id === selectedStory)) {\n      return;\n    }\n\n    setSelectedStory(null);\n    setCurrentItemIndex(0);\n  }, [selectedStory, playableStories]);\n\n  useEffect(() => {\n    setReplyText('');\n    setStoryVideoProgress(0);\n    setIsStoryVideoMuted(true);\n  }, [selectedStory]);\n\n  useEffect(() => {\n    if (!selectedStory || !currentUser) {\n      return;\n    }\n\n    const story = storiesData.find((entry) => entry.id === selectedStory);\n    if (!story) {\n      return;\n    }\n    if (Array.isArray(story.viewers) && story.viewers.includes(currentUser.id)) {\n      return;\n    }\n\n    const controller = new AbortController();\n    const trackView = async () => {\n      try {\n        const storyIdParam = encodeStoryId(story.id);\n        await fetch(`${API_BASE_URL}/stories/${storyIdParam}/view`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({ viewerId: currentUser.id }),\n          signal: controller.signal,\n        });\n\n        setStoriesData((prev) =>\n          prev.map((entry) =>\n            entry.id === story.id\n              ? { ...entry, viewers: Array.from(new Set([...(entry.viewers ?? []), currentUser.id])) }\n              : entry,\n          ),\n        );\n      } catch (markError) {\n        if ((markError as Error).name !== 'AbortError') {\n          console.error('Failed to update story view state:', markError);\n        }\n      }\n    };\n\n    trackView();\n    return () => controller.abort();\n  }, [selectedStory, currentUser, storiesData, encodeStoryId]);\n\n  const handleStorySelect = (story: StoryState) => {\n    if (currentUser && story.userId === currentUser.id && story.items.length === 0) {\n      handleCreatorOpenChange(true);\n      return;\n    }\n    if (story.items.length === 0) {\n      return;\n    }\n    setSelectedStory(story.id);\n    setCurrentItemIndex(0);\n  };\n\n  const handleNext = useCallback(() => {\n    if (!currentStory) {\n      return;\n    }\n\n    if (currentItemIndex < currentStory.items.length - 1) {\n      setCurrentItemIndex((index) => index + 1);\n      return;\n    }\n\n    const storyIndex = playableStories.findIndex((story) => story.id === currentStory.id);\n    if (storyIndex >= 0 && storyIndex < playableStories.length - 1) {\n      setSelectedStory(playableStories[storyIndex + 1].id);\n      setCurrentItemIndex(0);\n    } else {\n      setSelectedStory(null);\n      setCurrentItemIndex(0);\n    }\n  }, [currentStory, currentItemIndex, playableStories]);\n\n  const handlePrevious = useCallback(() => {\n    if (!currentStory) {\n      return;\n    }\n\n    if (currentItemIndex > 0) {\n      setCurrentItemIndex((index) => index - 1);\n      return;\n    }\n\n    const storyIndex = playableStories.findIndex((story) => story.id === currentStory.id);\n    if (storyIndex > 0) {\n      const prevStory = playableStories[storyIndex - 1];\n      setSelectedStory(prevStory.id);\n      setCurrentItemIndex(Math.max(prevStory.items.length - 1, 0));\n    }\n  }, [currentStory, currentItemIndex, playableStories]);\n\n  const sendStoryReplyMessage = useCallback(\n    async (story: StoryState, content: string) => {\n      if (!currentUser || story.userId === currentUser.id) {\n        return;\n      }\n\n      const senderClientId = currentUser.ablyClientId ?? currentUser.id;\n      const targetClientId = story.user.ablyClientId ?? story.user.id;\n      const members = Array.from(\n        new Set([senderClientId, targetClientId].filter((value): value is string => Boolean(value))),\n      );\n      if (members.length < 2) {\n        return;\n      }\n\n      const chatName = `Story chat with ${story.user.name}`;\n      let chatId: string | null = null;\n\n      try {\n        const response = await fetch(`${API_BASE_URL}/chats`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({\n            name: chatName,\n            members,\n            isGroup: false,\n            createdBy: currentUser.id,\n          }),\n        });\n\n        const payload = (await response.json().catch(() => ({}))) as {\n          chat?: { id?: string };\n        };\n\n        if (response.ok && payload?.chat && typeof payload.chat.id === 'string') {\n          chatId = payload.chat.id;\n        } else if (!response.ok) {\n          console.warn('Failed to ensure chat for story reply', response.status);\n        }\n      } catch (ensureChatError) {\n        console.error('Error ensuring chat for story reply:', ensureChatError);\n      }\n\n      if (!chatId) {\n        return;\n      }\n\n      try {\n        const messageResponse = await fetch(`${API_BASE_URL}/messages`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({\n            chatId,\n            senderId: senderClientId,\n            senderName: currentUser.name,\n            senderAvatar: currentUser.avatar,\n            content: `Reply to your story: ${content}`,\n          }),\n        });\n\n        if (!messageResponse.ok) {\n          console.warn('Failed to persist story reply message', messageResponse.status);\n        }\n      } catch (messageError) {\n        console.error('Error sending story reply message:', messageError);\n      }\n    },\n    [currentUser],\n  );\n\n  useEffect(() => {\n    if (!currentItem || currentItem.type !== 'video') {\n      setStoryVideoProgress(0);\n      const existing = storyVideoRef.current;\n      if (existing) {\n        existing.pause();\n        existing.currentTime = 0;\n      }\n      return;\n    }\n\n    const videoElement = storyVideoRef.current;\n    if (!videoElement) {\n      return;\n    }\n\n    videoElement.muted = isStoryVideoMuted;\n    const handleEnded = () => handleNext();\n    const handleTimeUpdate = () => {\n      if (videoElement.duration) {\n        setStoryVideoProgress(videoElement.currentTime / videoElement.duration);\n      }\n    };\n    const handleLoadedMetadata = () => {\n      setStoryVideoProgress(0);\n      videoElement.muted = isStoryVideoMuted;\n      const playPromise = videoElement.play();\n      if (playPromise) {\n        playPromise.catch((error) => console.warn('Unable to autoplay story video:', error));\n      }\n    };\n\n    videoElement.addEventListener('ended', handleEnded);\n    videoElement.addEventListener('timeupdate', handleTimeUpdate);\n    videoElement.addEventListener('loadedmetadata', handleLoadedMetadata);\n\n    const playPromise = videoElement.play();\n    if (playPromise) {\n      playPromise.catch((error) => console.warn('Unable to autoplay story video:', error));\n    }\n\n    return () => {\n      videoElement.removeEventListener('ended', handleEnded);\n      videoElement.removeEventListener('timeupdate', handleTimeUpdate);\n      videoElement.removeEventListener('loadedmetadata', handleLoadedMetadata);\n    };\n  }, [currentItem, handleNext, isStoryVideoMuted]);\n\n  const toggleStoryVideoMute = useCallback(() => {\n    setIsStoryVideoMuted((prev) => {\n      const next = !prev;\n      if (storyVideoRef.current) {\n        storyVideoRef.current.muted = next;\n      }\n      return next;\n    });\n  }, []);\n\n  const handleStoryLike = useCallback(\n    async (story: StoryState) => {\n      if (!currentUser) {\n        toast.info('Sign in to like stories.');\n        return;\n      }\n\n      if (likingStoryId && likingStoryId !== story.id) {\n        return;\n      }\n\n      setLikingStoryId(story.id);\n      try {\n        const toggleLike = async (attempt = 0): Promise<boolean> => {\n          const storyIdParam = encodeStoryId(story.id);\n          const includeSnapshot = attempt > 0;\n          const response = await fetch(`${API_BASE_URL}/stories/${storyIdParam}/like`, {\n            method: 'POST',\n            headers: JSON_HEADERS,\n            body: JSON.stringify({\n              userId: currentUser.id,\n              likerSnapshot: {\n                id: currentUser.id,\n                name: currentUser.name,\n                username: currentUser.username,\n                avatar: currentUser.avatar,\n                ablyClientId: currentUser.ablyClientId ?? currentUser.id,\n              },\n              ...(includeSnapshot ? { storySnapshot: buildStorySnapshot(story) } : {}),\n            }),\n          });\n\n          if (response.status === 404 && attempt === 0) {\n            const restored = await ensureStoryOnServer(story);\n            if (restored) {\n              return toggleLike(attempt + 1);\n            }\n          }\n\n          const payload = (await response.json().catch(() => ({}))) as {\n            story?: StoryAPIResponse;\n            liked?: boolean;\n            error?: string;\n          };\n\n          if (!response.ok || !payload?.story) {\n            return false;\n          }\n\n          mergeStoryUpdate(payload.story);\n          return true;\n        };\n\n        const applied = await toggleLike();\n        if (!applied) {\n          throw new Error('restore');\n        }\n      } catch {\n        if (currentUser) {\n          const currentlyLiked = story.likes.includes(currentUser.id);\n          const updatedLikes = currentlyLiked\n            ? story.likes.filter((id) => id !== currentUser.id)\n            : [...story.likes, currentUser.id];\n          const fallbackStory: StoryState = {\n            ...story,\n            likes: updatedLikes,\n            likeCount: updatedLikes.length,\n            liked: !currentlyLiked,\n          };\n          mergeStoryUpdate(storyStateToApiResponse(fallbackStory));\n          toast.success(currentlyLiked ? 'Removed like.' : 'Liked story!');\n        } else {\n          toast.success('Story like recorded!');\n        }\n      } finally {\n        setLikingStoryId(null);\n      }\n    },\n    [currentUser, likingStoryId, mergeStoryUpdate, encodeStoryId, ensureStoryOnServer, buildStorySnapshot],\n  );\n\n  const handleReply = useCallback(async () => {\n    if (!currentStory) {\n      return;\n    }\n\n    const trimmed = replyText.trim();\n    if (!trimmed) {\n      return;\n    }\n\n    if (!currentUser) {\n      toast.info('Sign in to reply to stories.');\n      return;\n    }\n\n    setReplySending(true);\n    try {\n      const sendReply = async (attempt = 0): Promise<boolean> => {\n        const storyIdParam = encodeStoryId(currentStory.id);\n        const response = await fetch(`${API_BASE_URL}/stories/${storyIdParam}/reply`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({\n            authorId: currentUser.id,\n            content: trimmed,\n            authorSnapshot: {\n              id: currentUser.id,\n              name: currentUser.name,\n              username: currentUser.username,\n              avatar: currentUser.avatar,\n              ablyClientId: currentUser.ablyClientId ?? currentUser.id,\n            },\n            ...(attempt > 0 ? { storySnapshot: buildStorySnapshot(currentStory) } : {}),\n          }),\n        });\n\n        if (response.status === 404 && attempt === 0) {\n          const restored = await ensureStoryOnServer(currentStory);\n          if (restored) {\n              return sendReply(attempt + 1);\n          }\n        }\n\n        const payload = (await response.json().catch(() => ({}))) as {\n          story?: StoryAPIResponse;\n          reply?: StoryReplyData;\n          error?: string;\n        };\n\n        if (!response.ok || !payload?.story) {\n          return false;\n        }\n\n        mergeStoryUpdate(payload.story);\n        setReplyText('');\n        toast.success('Reply sent!');\n\n        void sendStoryReplyMessage(currentStory, trimmed);\n        return true;\n      };\n\n      const applied = await sendReply();\n      if (!applied) {\n        throw new Error('restore');\n      }\n      } catch {\n      if (currentStory && currentUser) {\n        const replyId = `offline-${Date.now().toString(36)}`;\n        const fallbackReply: StoryReply = {\n          id: replyId,\n          storyId: currentStory.id,\n          authorId: currentUser.id,\n          content: trimmed,\n          timestamp: new Date().toISOString(),\n          author: {\n            id: currentUser.id,\n            name: currentUser.name,\n            username: currentUser.username,\n            avatar: currentUser.avatar,\n            ablyClientId: currentUser.ablyClientId ?? currentUser.id,\n          },\n        };\n        const fallbackStory: StoryState = {\n          ...currentStory,\n          replies: [...currentStory.replies, fallbackReply],\n        };\n        mergeStoryUpdate(storyStateToApiResponse(fallbackStory));\n        setReplyText('');\n        toast.success('Reply sent!');\n        void sendStoryReplyMessage(currentStory, trimmed);\n      } else {\n        toast.success('Reply captured!');\n      }\n    } finally {\n      setReplySending(false);\n    }\n  }, [\n    currentStory,\n    currentUser,\n    encodeStoryId,\n    ensureStoryOnServer,\n    mergeStoryUpdate,\n    replyText,\n    sendStoryReplyMessage,\n    buildStorySnapshot,\n  ]);\n\n  const showSkeleton = loading && storiesData.length === 0;\n\n  return (\n    <div className=\"max-w-7xl mx-auto space-y-4\">\n      {error && (\n        <div className=\"p-4 rounded-2xl bg-white/10 border border-white/20 text-white/80 flex items-center justify-between gap-4\">\n          <p className=\"text-sm\">{error}</p>\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={() => void fetchStories()}\n            className=\"bg-white/10 border-white/30 text-white hover:bg-white/20\"\n          >\n            Try again\n          </Button>\n        </div>\n      )}\n\n      {showSkeleton ? (\n        <div className=\"flex gap-4 overflow-x-auto pb-4 hide-scrollbar\">\n          {Array.from({ length: STORY_SKELETON_COUNT }).map((_, index) => (\n            <div key={index} className=\"flex flex-col items-center gap-2 flex-shrink-0\">\n              <Skeleton className=\"w-20 h-20 rounded-full bg-white/10\" />\n              <Skeleton className=\"w-16 h-3 bg-white/10\" />\n            </div>\n          ))}\n        </div>\n      ) : (\n        <div className=\"flex gap-4 overflow-x-auto pb-4 hide-scrollbar\">\n          {orderedStories.length === 0 && !currentUser ? (\n            <div className=\"text-white/70 text-sm\">No stories yet. Check back soon!</div>\n          ) : (\n            orderedStories.map((story) => {\n              const isOwnStory = Boolean(currentUser && story.userId === currentUser.id);\n              const isPlaceholder = isOwnStory && story.items.length === 0;\n              const ringGradient = story.viewed && !isPlaceholder\n                ? 'from-white/30 via-white/20 to-white/30'\n                : 'from-pink-500 via-purple-500 to-indigo-500';\n              const label = isPlaceholder\n                ? 'Create a story'\n                : isOwnStory\n                ? 'View your story'\n                : `View ${story.user.name}'s story`;\n\n              return (\n                <button\n                  key={story.id}\n                  type=\"button\"\n                  onClick={() => handleStorySelect(story)}\n                  className=\"relative flex flex-col items-center gap-2 flex-shrink-0 group focus:outline-none transition-transform duration-300 hover:-translate-y-1\"\n                  aria-label={label}\n                >\n                  <div className=\"relative\">\n                    <div\n                      className={`relative p-[3px] rounded-full bg-gradient-to-tr ${ringGradient} transition-all duration-500 ease-out group-hover:shadow-[0_18px_35px_rgba(168,85,247,0.35)] group-hover:scale-[1.03]`}\n                    >\n                      <div className=\"absolute inset-0 rounded-full opacity-0 group-hover:opacity-100 group-hover:blur-lg bg-white/25 transition-all duration-500\" />\n                      <div className=\"relative p-0.5 rounded-full bg-gradient-to-br from-purple-950/80 via-purple-900/70 to-pink-900/80\">\n                        <Avatar className=\"w-16 h-16 border-2 border-white/20 transition-transform duration-500 group-hover:scale-[1.04]\">\n                          <AvatarImage src={story.user.avatar} />\n                          <AvatarFallback>{story.user.name[0]}</AvatarFallback>\n                        </Avatar>\n                      </div>\n                    </div>\n\n                    {isPlaceholder && (\n                      <div className=\"absolute -bottom-1 -right-1 w-7 h-7 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 rounded-full flex items-center justify-center border-2 border-purple-950 shadow-[0_12px_35px_rgba(236,72,153,0.45)] transition-transform duration-300 group-hover:scale-110\">\n                        <Plus className=\"w-3.5 h-3.5 text-white\" />\n                      </div>\n                    )}\n                    {isOwnStory && !isPlaceholder && (\n                      <button\n                        type=\"button\"\n                        onClick={(event) => {\n                          event.stopPropagation();\n                          handleCreatorOpenChange(true);\n                        }}\n                        className=\"absolute -bottom-1 -right-1 flex h-7 w-7 items-center justify-center rounded-full border-2 border-purple-950 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 text-white shadow-[0_12px_35px_rgba(236,72,153,0.45)] transition-transform duration-300 hover:scale-110 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/80\"\n                        aria-label=\"Add to your story\"\n                      >\n                        <Plus className=\"w-3.5 h-3.5\" />\n                      </button>\n                    )}\n                  </div>\n                  <span className=\"text-white/90 text-sm max-w-[90px] truncate text-center tracking-tight transition-colors duration-300 group-hover:text-white\">\n                    {isOwnStory ? 'Your Story' : story.user.name}\n                  </span>\n                </button>\n              );\n            })\n          )}\n        </div>\n      )}\n\n      <Dialog open={selectedStory !== null} onOpenChange={(open) => !open && setSelectedStory(null)}>\n        <DialogContent className=\"max-w-md h-[90vh] p-0 bg-transparent border-0\">\n          {currentStory && currentItem && (\n            <div className=\"relative w-full h-full rounded-3xl overflow-hidden bg-black\">\n              <div className=\"absolute inset-0\">\n                {currentItem.type === 'video' ? (\n                  <>\n                    <video\n                      key={currentItem.id}\n                      ref={storyVideoRef}\n                      src={currentItem.url}\n                      className=\"h-full w-full object-contain bg-black\"\n                      playsInline\n                      autoPlay\n                      controls={false}\n                      muted={isStoryVideoMuted}\n                    />\n                    <div className=\"pointer-events-none absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-black/60\" />\n                  </>\n                ) : (\n                  <>\n                    <ImageWithFallback src={currentItem.url} alt=\"Story\" className=\"w-full h-full object-cover\" />\n                    <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-black/60\" />\n                  </>\n                )}\n              </div>\n\n              <div className=\"absolute top-0 left-0 right-0 p-4 z-10\">\n                <div className=\"flex gap-1\">\n                  {currentStory.items.map((item, index) => {\n                    const isActive = index === currentItemIndex;\n                    const isCompleted = index < currentItemIndex;\n                    const widthPercent =\n                      isCompleted || (isActive && item.type !== 'video')\n                        ? undefined\n                        : isActive && item.type === 'video'\n                        ? Math.min(Math.max(storyVideoProgress, 0), 1) * 100\n                        : undefined;\n                    const progressClass = [\n                      'h-full bg-white transition-all duration-300',\n                      isCompleted ? 'w-full' : '',\n                      !isActive && !isCompleted ? 'w-0' : '',\n                      isActive && item.type !== 'video' ? 'w-full animate-progress' : '',\n                    ]\n                      .filter(Boolean)\n                      .join(' ');\n\n                    return (\n                      <div key={index} className=\"flex-1 h-1 bg-white/30 rounded-full overflow-hidden\">\n                        <div\n                          className={progressClass}\n                          style={\n                            widthPercent !== undefined ? { width: `${widthPercent}%` } : undefined\n                          }\n                        />\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n\n              <div className=\"absolute top-4 right-4 z-20 flex gap-2\">\n                {currentItem.type === 'video' && (\n                  <Button\n                    size=\"icon\"\n                    variant=\"ghost\"\n                    onClick={toggleStoryVideoMute}\n                    className=\"text-white hover:bg-white/20\"\n                  >\n                    {isStoryVideoMuted ? <VolumeX className=\"w-5 h-5\" /> : <Volume2 className=\"w-5 h-5\" />}\n                  </Button>\n                )}\n                <Button\n                  size=\"icon\"\n                  variant=\"ghost\"\n                  onClick={() => setSelectedStory(null)}\n                  className=\"text-white hover:bg-white/20\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </Button>\n              </div>\n\n              <div className=\"absolute top-6 left-0 right-0 px-4 z-10\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Avatar className=\"w-10 h-10 border-2 border-white/50\">\n                      <AvatarImage src={currentStory.user.avatar} />\n                      <AvatarFallback>{currentStory.user.name[0]}</AvatarFallback>\n                    </Avatar>\n                    <div>\n                      <div className=\"text-white\">{currentStory.user.name}</div>\n                      <div className=\"text-white/70 text-sm\">{formatRelativeTime(currentItem.timestamp)}</div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <button\n                onClick={handlePrevious}\n                className=\"absolute left-0 top-0 bottom-0 w-1/3 z-10 cursor-pointer\"\n                aria-label=\"Previous\"\n              />\n              <button\n                onClick={handleNext}\n                className=\"absolute right-0 top-0 bottom-0 w-1/3 z-10 cursor-pointer\"\n                aria-label=\"Next\"\n              />\n\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={handlePrevious}\n                className=\"absolute left-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-20\"\n              >\n                <ChevronLeft className=\"w-6 h-6\" />\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={handleNext}\n                className=\"absolute right-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-20\"\n              >\n                <ChevronRight className=\"w-6 h-6\" />\n              </Button>\n\n              <div className=\"absolute bottom-0 left-0 right-0 p-4 z-10\">\n                <div className=\"space-y-3\">\n                  {currentStory.replies.length > 0 && (\n                    <div className=\"max-h-40 overflow-y-auto rounded-2xl border border-white/10 bg-black/30 p-3 backdrop-blur\">\n                      <div className=\"space-y-3\">\n                        {currentStory.replies.map((reply) => (\n                          <div key={reply.id} className=\"flex items-start gap-3\">\n                            <Avatar className=\"h-8 w-8 border border-white/20\">\n                              <AvatarImage src={reply.author?.avatar} />\n                              <AvatarFallback>\n                                {(reply.author?.name ?? reply.author?.username ?? '?')[0] ?? '?'}\n                              </AvatarFallback>\n                            </Avatar>\n                            <div className=\"flex-1 space-y-1\">\n                              <div className=\"flex items-center justify-between text-xs text-white/60\">\n                                <span className=\"font-medium text-white/90\">\n                                  {reply.author?.name ?? reply.author?.username ?? 'MoveSplash user'}\n                                </span>\n                                <span>{formatRelativeTime(reply.timestamp)}</span>\n                              </div>\n                              <p className=\"text-sm text-white/90\">{reply.content}</p>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  <div className=\"flex flex-wrap items-center gap-2\">\n                    <Button\n                      type=\"button\"\n                      variant=\"ghost\"\n                      onClick={() => void handleStoryLike(currentStory)}\n                      disabled={likingStoryId === currentStory.id}\n                      className={`flex items-center gap-2 rounded-full border border-white/25 bg-black/40 px-4 py-2 text-sm transition-all duration-200 ${\n                        currentStory.liked\n                          ? 'border-rose-400/60 text-rose-100 hover:bg-rose-500/20'\n                          : 'text-white hover:bg-white/15'\n                      } ${likingStoryId === currentStory.id ? 'opacity-70 cursor-not-allowed' : ''}`}\n                    >\n                      {likingStoryId === currentStory.id ? (\n                        <Loader2 className=\"h-4 w-4 animate-spin\" />\n                      ) : (\n                        <Heart className={`h-4 w-4 ${currentStory.liked ? 'fill-current' : ''}`} />\n                      )}\n                      <span>{currentStory.likeCount}</span>\n                    </Button>\n\n                    <Input\n                      placeholder=\"Send a reply...\"\n                      value={replyText}\n                      onChange={(e) => setReplyText(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter') {\n                          e.preventDefault();\n                          void handleReply();\n                        }\n                      }}\n                      disabled={replySending}\n                      className=\"flex-1 min-w-[140px] bg-white/10 backdrop-blur-md border-white/20 text-white placeholder:text-white/50\"\n                    />\n                    <Button\n                      type=\"button\"\n                      onClick={() => void handleReply()}\n                      disabled={replySending || !replyText.trim()}\n                      className=\"flex items-center justify-center gap-2 bg-gradient-to-r from-pink-500 to-purple-500 text-white shadow-[0_12px_30px_rgba(168,85,247,0.45)] transition-all duration-200 hover:from-pink-600 hover:to-purple-600 disabled:opacity-70\"\n                    >\n                      {replySending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Send className=\"h-4 w-4\" />}\n                      <span className=\"text-sm font-medium\">Send</span>\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isCreatorOpen} onOpenChange={handleCreatorOpenChange}>\n        <DialogContent className=\"w-full max-w-[95vw] sm:max-w-2xl lg:max-w-3xl p-0 border-0 bg-transparent shadow-none\">\n          <div className=\"relative flex max-h-[88vh] flex-col overflow-hidden rounded-3xl bg-gradient-to-br from-[#24103f] via-[#170d3e] to-[#0b1531] text-white shadow-[0_28px_70px_rgba(147,51,234,0.45)]\">\n            <div\n              className=\"pointer-events-none absolute inset-0 opacity-70\"\n              style={{\n                background:\n                  'radial-gradient(circle at 20% 20%, rgba(236,72,153,0.3), transparent 60%), radial-gradient(circle at 80% 10%, rgba(96,165,250,0.25), transparent 55%), radial-gradient(circle at 50% 90%, rgba(168,85,247,0.25), transparent 60%)',\n              }}\n            />\n            <div className=\"relative flex-1 overflow-y-auto px-5 py-6 sm:px-8 sm:py-8 space-y-6\">\n              <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                <div className=\"space-y-2 sm:space-y-1\">\n                  <h2 className=\"text-lg font-semibold sm:text-xl\">Create a Story</h2>\n                  <p className=\"text-sm text-white/70\">\n                    Add photos or short clips to share with your friends.\n                  </p>\n                </div>\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  onClick={() => handleCreatorOpenChange(false)}\n                  className=\"text-white/70 hover:text-white hover:bg-white/15\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </Button>\n              </div>\n\n              <div\n                className={`relative rounded-2xl border border-dashed ${\n                  isDragging ? 'border-white/60 bg-white/10' : 'border-white/20 bg-white/5'\n                } transition-all duration-300 ease-out`}\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                onDrop={handleDrop}\n              >\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/*,video/*\"\n                  multiple\n                  className=\"hidden\"\n                  onChange={handleFileInputChange}\n                />\n                <div className=\"flex flex-col items-center justify-center gap-4 px-4 py-8 text-center sm:px-6 sm:py-10\">\n                  <div className=\"rounded-full bg-white/10 p-4 text-white shadow-[0_12px_35px_rgba(236,72,153,0.35)]\">\n                    <UploadCloud className=\"w-7 h-7\" />\n                  </div>\n                  <div className=\"space-y-1\">\n                    <p className=\"text-base font-medium\">Drag & drop to upload</p>\n                    <p className=\"text-sm text-white/60\">\n                      You can add up to {MAX_STORY_ITEMS} photos or videos.\n                    </p>\n                  </div>\n                  <div className=\"flex flex-wrap items-center justify-center gap-3 text-xs text-white/60\">\n                    <span>Supported: JPG, PNG, MP4</span>\n                    <span className=\"hidden sm:inline\">|</span>\n                    <span>Recommended length ~ {DEFAULT_VIDEO_DURATION}s</span>\n                  </div>\n                  <Button\n                    type=\"button\"\n                    onClick={() => fileInputRef.current?.click()}\n                    className=\"rounded-full bg-white px-5 py-2 text-sm font-semibold text-purple-900 shadow-[0_12px_30px_rgba(148,63,255,0.35)] hover:bg-white/90\"\n                  >\n                    Browse files\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"rounded-2xl border border-white/10 bg-white/5 p-4 sm:p-5 backdrop-blur space-y-3\">\n                <div className=\"flex flex-wrap items-center gap-2 sm:gap-3\">\n                  <Button\n                    type=\"button\"\n                    onClick={() => void startCamera()}\n                    disabled={isCameraActive}\n                    className=\"flex items-center gap-2 rounded-full bg-white px-4 py-2 text-sm font-semibold text-purple-900 shadow-[0_12px_30px_rgba(148,63,255,0.35)] transition duration-200 hover:bg-white/90 disabled:cursor-not-allowed disabled:opacity-70\"\n                  >\n                    <Camera className=\"h-4 w-4\" />\n                    {isCameraActive ? 'Camera Ready' : 'Use Camera'}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => void capturePhoto()}\n                    disabled={!isCameraActive || isCapturingPhoto}\n                    className=\"flex items-center gap-2 rounded-full border-white/40 bg-purple-900/30 px-4 py-2 text-sm text-white hover:bg-purple-800/50 disabled:opacity-60\"\n                  >\n                    {isCapturingPhoto ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      <Camera className=\"h-4 w-4\" />\n                    )}\n                    Capture photo\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant={isRecordingVideo ? 'destructive' : 'outline'}\n                    onClick={() => {\n                      if (isRecordingVideo) {\n                        stopVideoRecording();\n                      } else {\n                        startVideoRecording();\n                      }\n                    }}\n                    disabled={!isCameraActive || isCapturingPhoto}\n                    className={`flex items-center gap-2 rounded-full border-white/40 px-4 py-2 text-sm ${\n                      isRecordingVideo\n                        ? 'bg-rose-500/30 text-white hover:bg-rose-500/40'\n                        : 'bg-purple-900/30 text-white hover:bg-purple-800/50'\n                    } disabled:opacity-60`}\n                  >\n                    {isRecordingVideo ? <Square className=\"h-4 w-4\" /> : <Video className=\"h-4 w-4\" />}\n                    {isRecordingVideo ? 'Stop recording' : 'Record video'}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    onClick={() => stopCamera()}\n                    disabled={!isCameraActive}\n                    className=\"rounded-full px-4 py-2 text-sm text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-60\"\n                  >\n                    Stop camera\n                  </Button>\n                </div>\n                {isRecordingVideo && (\n                  <div className=\"text-xs uppercase tracking-[0.2em] text-amber-200\">\n                    Recording {formatRecordingTime(recordingDuration)} / {formatRecordingTime(DEFAULT_VIDEO_DURATION)}\n                  </div>\n                )}\n                {cameraError && <p className=\"text-sm text-rose-200\">{cameraError}</p>}\n                {recordingError && <p className=\"text-sm text-rose-200\">{recordingError}</p>}\n                {isCameraActive && (\n                  <div className=\"overflow-hidden rounded-2xl border border-white/20 bg-black/30 shadow-[0_18px_40px_rgba(124,58,237,0.35)]\">\n                    <video\n                      ref={videoRef}\n                      autoPlay\n                      playsInline\n                      muted\n                      className=\"h-48 w-full object-cover sm:h-64\"\n                    />\n                  </div>\n                )}\n              </div>\n\n              {storyDraft.length > 0 && (\n                <div className=\"grid gap-4 sm:grid-cols-2\">\n                  {storyDraft.map((item) => (\n                    <div\n                      key={item.id}\n                      className=\"group relative overflow-hidden rounded-2xl border border-white/15 bg-white/5 backdrop-blur-sm shadow-[0_18px_40px_rgba(124,58,237,0.35)]\"\n                    >\n                      {item.type === 'image' ? (\n                        <ImageWithFallback\n                          src={item.url}\n                          alt=\"Story preview\"\n                          className=\"h-48 w-full object-cover sm:h-56\"\n                        />\n                      ) : (\n                        <video\n                          src={item.url}\n                          className=\"h-48 w-full object-cover sm:h-56\"\n                          controls\n                          playsInline\n                          muted\n                        />\n                      )}\n                      <div className=\"absolute inset-x-0 bottom-0 flex items-center justify-between gap-2 bg-gradient-to-t from-black/80 via-black/40 to-transparent px-4 py-3 text-sm\">\n                        <span className=\"text-white/80 capitalize\">{item.type}</span>\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleRemoveDraftItem(item.id)}\n                          className=\"text-white/80 transition-colors duration-200 hover:text-white hover:bg-white/15\"\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {creationError && <p className=\"text-sm text-rose-200\">{creationError}</p>}\n\n              <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n                <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:gap-6\">\n                  {currentUser && (\n                    <div className=\"flex items-center gap-3\">\n                      <Avatar className=\"h-10 w-10 border border-white/25\">\n                        <AvatarImage src={currentUser.avatar} />\n                        <AvatarFallback>{currentUser.name[0]}</AvatarFallback>\n                      </Avatar>\n                      <div>\n                        <p className=\"text-sm font-medium text-white\">{currentUser.name}</p>\n                        <p className=\"text-xs text-white/60\">@{currentUser.username}</p>\n                      </div>\n                    </div>\n                  )}\n                  <div className=\"h-px w-full bg-white/10 sm:hidden\" />\n                  <div className=\"hidden sm:block sm:h-14 sm:w-px bg-white/15\" />\n                  <div className=\"min-w-[200px] space-y-1 sm:flex sm:flex-col sm:justify-center sm:space-y-2\">\n                    <p className=\"text-xs uppercase tracking-[0.25em] text-white/50\">Visibility</p>\n                    <Select\n                      value={storyVisibility}\n                      onValueChange={(value) => setStoryVisibility(value as 'friends' | 'public' | 'close_friends')}\n                    >\n                      <SelectTrigger className=\"w-full border-white/20 bg-white/10 text-white hover:bg-white/15\">\n                        <SelectValue placeholder=\"Choose who can view\" />\n                      </SelectTrigger>\n                      <SelectContent className=\"border-white/20 bg-slate-950/95 text-white backdrop-blur\">\n                        {STORY_VISIBILITY_OPTIONS.map((option) => (\n                          <SelectItem key={option.value} value={option.value}>\n                            <div className=\"flex flex-col\">\n                              <span className=\"text-sm font-medium\">{option.label}</span>\n                              <span className=\"text-xs text-white/60\">{option.description}</span>\n                            </div>\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                <div className=\"flex flex-col gap-3 sm:items-end\">\n                  <span className=\"text-xs text-white/60\">\n                    {storyDraft.length} / {MAX_STORY_ITEMS} items selected\n                  </span>\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      type=\"button\"\n                      variant=\"ghost\"\n                      onClick={() => handleCreatorOpenChange(false)}\n                      className=\"text-white/70 hover:text-white hover:bg-white/10\"\n                      disabled={isSubmittingStory}\n                    >\n                      Cancel\n                    </Button>\n                    <Button\n                      type=\"button\"\n                      onClick={() => void handleCreateStory()}\n                      disabled={isSubmittingStory || storyDraft.length === 0}\n                      className=\"bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 px-6 py-2 text-sm font-semibold text-white shadow-[0_15px_40px_rgba(168,85,247,0.45)] transition-all duration-300 hover:brightness-110 disabled:opacity-60\"\n                    >\n                      {isSubmittingStory ? 'Posting...' : 'Share Story'}\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <style>{`\n        .hide-scrollbar {\n          -ms-overflow-style: none;\n          scrollbar-width: none;\n        }\n        .hide-scrollbar::-webkit-scrollbar {\n          display: none;\n        }\n        @keyframes progress {\n          from { width: 0%; }\n          to { width: 100%; }\n        }\n        .animate-progress {\n          animation: progress 5s linear forwards;\n        }\n      `}</style>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}