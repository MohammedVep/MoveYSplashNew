{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohammedvepari/Documents/Algoma%20University/Fall%202025/COSC%204086/move-y-splash-new/src/app/components/Stories.tsx"],"sourcesContent":["'use client';\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { ChangeEvent, DragEvent } from 'react';\nimport { Avatar, AvatarFallback, AvatarImage } from './ui/avatar';\nimport { Button } from './ui/button';\nimport { Dialog, DialogContent } from './ui/dialog';\nimport { Input } from './ui/input';\nimport { Skeleton } from './ui/skeleton';\nimport {\n  Plus,\n  X,\n  ChevronLeft,\n  ChevronRight,\n  Heart,\n  Send,\n  UploadCloud,\n  Trash2,\n  Camera,\n  Loader2,\n  Video,\n  Square,\n  Volume2,\n  VolumeX,\n} from 'lucide-react';\nimport { ImageWithFallback } from './figma/ImageWithFallback';\nimport { useUser } from '../utils/userContext';\nimport { projectId, publicAnonKey } from '../utils/supabase/info';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';\nimport { toast } from 'sonner';\n\nconst API_BASE_URL = `https://${projectId}.supabase.co/functions/v1/make-server-a14c7986`;\nconst AUTH_HEADERS = { Authorization: `Bearer ${publicAnonKey}` };\nconst JSON_HEADERS = { ...AUTH_HEADERS, 'Content-Type': 'application/json' };\nconst STORY_SKELETON_COUNT = 5;\nconst MAX_STORY_ITEMS = 5;\nconst DEFAULT_IMAGE_DURATION = 6;\nconst DEFAULT_VIDEO_DURATION = 15;\nconst MAX_CAMERA_RECORDING_MS = DEFAULT_VIDEO_DURATION * 1000;\n\nconst blobToDataUrl = (blob: Blob): Promise<string> =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      if (typeof reader.result === 'string') {\n        resolve(reader.result);\n      } else {\n        reject(new Error('Unable to read recording data'));\n      }\n    };\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n\nconst getSupportedRecordingMimeType = () => {\n  if (typeof window === 'undefined' || typeof window.MediaRecorder === 'undefined') {\n    return '';\n  }\n\n  const Recorder = window.MediaRecorder;\n  const candidates = [\n    'video/webm;codecs=vp9',\n    'video/webm;codecs=vp8',\n    'video/webm;codecs=avc1',\n    'video/webm',\n    'video/mp4',\n  ];\n\n  const supported = candidates.find((candidate) => candidate && Recorder.isTypeSupported(candidate));\n  return supported ?? '';\n};\n\nconst formatRecordingTime = (seconds: number) => {\n  const safeSeconds = Math.max(0, seconds);\n  const wholeSeconds = Math.floor(safeSeconds);\n  const mins = Math.floor(wholeSeconds / 60);\n  const secs = wholeSeconds % 60;\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\n};\n\nconst STORY_VISIBILITY_OPTIONS: Array<{\n  label: string;\n  value: 'friends' | 'public' | 'close_friends';\n  description: string;\n}> = [\n  {\n    label: 'Public',\n    value: 'public',\n    description: 'Everyone on MoveSplash can view your story',\n  },\n  {\n    label: 'Friends',\n    value: 'friends',\n    description: 'Only your connections can view',\n  },\n  {\n    label: 'Close friends',\n    value: 'close_friends',\n    description: 'Share with your inner circle only',\n  },\n];\n\nconst formatRelativeTime = (isoTimestamp: string) => {\n  const date = new Date(isoTimestamp);\n  if (Number.isNaN(date.getTime())) {\n    return '';\n  }\n\n  const diffMs = Date.now() - date.getTime();\n  const minutes = Math.floor(diffMs / (1000 * 60));\n  if (minutes < 1) {\n    return 'Just now';\n  }\n  if (minutes < 60) {\n    return `${minutes}m ago`;\n  }\n  const hours = Math.floor(minutes / 60);\n  if (hours < 24) {\n    return `${hours}h ago`;\n  }\n  const days = Math.floor(hours / 24);\n  if (days < 7) {\n    return `${days}d ago`;\n  }\n  return date.toLocaleDateString();\n};\n\ntype StoryDraftItem = {\n  id: string;\n  type: 'image' | 'video';\n  url: string;\n  duration: number;\n};\n\ninterface StoryUser {\n  id: string;\n  name: string;\n  username: string;\n  avatar: string;\n  ablyClientId: string;\n}\n\ninterface StoryItemData {\n  id: string;\n  type: 'image' | 'video';\n  url: string;\n  duration: number;\n  timestamp: string;\n}\n\ninterface StoryReplyData {\n  id: string;\n  storyId?: string;\n  authorId: string;\n  content: string;\n  timestamp: string;\n  author?: StoryUser;\n}\n\ninterface StoryReply {\n  id: string;\n  storyId: string;\n  authorId: string;\n  content: string;\n  timestamp: string;\n  author: StoryUser | null;\n}\n\ninterface StoryAPIResponse {\n  id: string;\n  userId: string;\n  user?: StoryUser;\n  items?: StoryItemData[];\n  viewers?: string[];\n  visibility?: 'friends' | 'public' | 'close_friends';\n  createdAt?: string;\n  expiresAt?: string;\n  likes?: string[];\n  replies?: StoryReplyData[];\n}\n\ninterface StoryState {\n  id: string;\n  userId: string;\n  user: StoryUser;\n  items: StoryItemData[];\n  viewers: string[];\n  visibility: 'friends' | 'public' | 'close_friends';\n  createdAt: string;\n  expiresAt: string;\n  viewed: boolean;\n  likes: string[];\n  likeCount: number;\n  liked: boolean;\n  replies: StoryReply[];\n}\n\nconst STORY_PLACEHOLDER_URL =\n  'https://api.dicebear.com/7.x/shapes/svg?seed=MoveSplashStory&backgroundColor=transparent';\n\nconst storyStateToApiResponse = (story: StoryState): StoryAPIResponse => ({\n  id: story.id,\n  userId: story.userId,\n  user: story.user,\n  items: story.items.map((item) => ({\n    ...item,\n    url:\n      typeof item.url === 'string' && item.url.trim() !== '' && item.url !== '__existing__'\n        ? item.url\n        : STORY_PLACEHOLDER_URL,\n  })),\n  viewers: story.viewers,\n  visibility: story.visibility,\n  createdAt: story.createdAt,\n  expiresAt: story.expiresAt,\n  likes: story.likes,\n  replies: story.replies.map((reply) => ({\n    id: reply.id,\n    storyId: reply.storyId,\n    authorId: reply.authorId,\n    content: reply.content,\n    timestamp: reply.timestamp,\n    author: reply.author ?? undefined,\n  })),\n});\n\nexport function Stories() {\n  const { currentUser } = useUser();\n  const [storiesData, setStoriesData] = useState<StoryAPIResponse[]>([]);\n  const [selectedStory, setSelectedStory] = useState<string | null>(null);\n  const [currentItemIndex, setCurrentItemIndex] = useState(0);\n  const [replyText, setReplyText] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isCreatorOpen, setIsCreatorOpen] = useState(false);\n  const storyVideoRef = useRef<HTMLVideoElement | null>(null);\n  const [storyDraft, setStoryDraft] = useState<StoryDraftItem[]>([]);\n  const [storyVisibility, setStoryVisibility] = useState<'friends' | 'public' | 'close_friends'>('friends');\n  const [isSubmittingStory, setIsSubmittingStory] = useState(false);\n  const [creationError, setCreationError] = useState<string | null>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\n  const [likingStoryId, setLikingStoryId] = useState<string | null>(null);\n  const [replySending, setReplySending] = useState(false);\n  const [isCameraActive, setIsCameraActive] = useState(false);\n  const [cameraStream, setCameraStream] = useState<MediaStream | null>(null);\n  const [cameraError, setCameraError] = useState<string | null>(null);\n  const [isCapturingPhoto, setIsCapturingPhoto] = useState(false);\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const recordingChunksRef = useRef<Blob[]>([]);\n  const recordingTimerRef = useRef<number | null>(null);\n  const recordingDiscardRef = useRef(false);\n  const recordingMimeTypeRef = useRef('video/webm');\n  const recordingDurationRef = useRef(0);\n  const [isRecordingVideo, setIsRecordingVideo] = useState(false);\n  const [recordingDuration, setRecordingDuration] = useState(0);\n  const [recordingError, setRecordingError] = useState<string | null>(null);\n  const [isStoryVideoMuted, setIsStoryVideoMuted] = useState(true);\n  const [storyVideoProgress, setStoryVideoProgress] = useState(0);\n  const encodeStoryId = useCallback((storyId: string) => encodeURIComponent(storyId), []);\n\n  const fetchStories = useCallback(\n    async (signal?: AbortSignal) => {\n      try {\n        if (!signal?.aborted) {\n          setLoading(true);\n          setError(null);\n        }\n\n        const response = await fetch(`${API_BASE_URL}/stories`, {\n          headers: AUTH_HEADERS,\n          signal,\n        });\n\n        if (!response.ok) {\n          throw new Error('Failed to fetch stories');\n        }\n\n        const payload = (await response.json().catch(() => ({}))) as {\n          stories?: StoryAPIResponse[];\n        };\n\n        if (!signal?.aborted) {\n          setStoriesData(Array.isArray(payload?.stories) ? payload.stories : []);\n        }\n      } catch (fetchError) {\n        if ((fetchError as Error).name === 'AbortError') {\n          return;\n        }\n        console.error('Error loading stories:', fetchError);\n        if (!signal?.aborted) {\n          setError('Unable to load stories right now.');\n        }\n      } finally {\n        if (!signal?.aborted) {\n          setLoading(false);\n        }\n      }\n    },\n    [],\n  );\n\n  const mergeStoryUpdate = useCallback(\n    (storyUpdate: StoryAPIResponse, options?: { prepend?: boolean }) => {\n      setStoriesData((prev) => {\n        const sanitizeItems = (\n          items: StoryAPIResponse['items'],\n          existing?: StoryAPIResponse['items'],\n        ) => {\n          if (!Array.isArray(items)) {\n            return items;\n          }\n          return items.map((item, index) => {\n            const previous = existing?.[index];\n            const normalizedUrl =\n              typeof item.url === 'string' && item.url.trim() !== '' && item.url !== '__existing__'\n                ? item.url\n                : '';\n            const previousUrl =\n              typeof previous?.url === 'string' && previous.url.trim() !== '' && previous.url !== '__existing__'\n                ? previous.url\n                : '';\n            const resolvedUrl = normalizedUrl || previousUrl || STORY_PLACEHOLDER_URL;\n            return { ...item, url: resolvedUrl };\n          });\n        };\n        const cleanedUpdate: StoryAPIResponse = {\n          ...storyUpdate,\n          items: sanitizeItems(storyUpdate.items),\n        };\n        const exists = prev.some((entry) => entry.id === storyUpdate.id);\n        if (exists) {\n          return prev.map((entry) =>\n            entry.id === storyUpdate.id\n              ? {\n                  ...entry,\n                  ...cleanedUpdate,\n                  items: sanitizeItems(cleanedUpdate.items, entry.items),\n                }\n              : entry,\n          );\n        }\n        if (options?.prepend) {\n          return [cleanedUpdate, ...prev];\n        }\n        return [...prev, cleanedUpdate];\n      });\n    },\n    [],\n  );\n\n  const buildUserSnapshot = useCallback((user: StoryUser | null) => {\n    if (!user) {\n      return null;\n    }\n\n    return {\n      id: user.id,\n      name: user.name,\n      username: user.username,\n      avatar: user.avatar,\n      ablyClientId: user.ablyClientId ?? user.id,\n    };\n  }, []);\n\n  const buildStorySnapshot = useCallback((story: StoryState) => {\n    return {\n      id: story.id,\n      userId: story.userId,\n      visibility: story.visibility,\n      createdAt: story.createdAt,\n      expiresAt: story.expiresAt,\n      viewers: story.viewers,\n      likes: story.likes,\n      items: story.items.map((item) => ({\n        id: item.id,\n        type: item.type,\n        url:\n          typeof item.url === 'string' && item.url.trim() !== '' ? item.url : STORY_PLACEHOLDER_URL,\n        duration: item.duration,\n        timestamp: item.timestamp ?? new Date().toISOString(),\n      })),\n      user: {\n        id: story.user.id,\n        name: story.user.name,\n        username: story.user.username,\n        avatar: story.user.avatar,\n        ablyClientId: story.user.ablyClientId,\n      },\n      replies: story.replies.map((reply) => ({\n        id: reply.id,\n        storyId: reply.storyId,\n        authorId: reply.authorId,\n        content: reply.content,\n        timestamp: reply.timestamp,\n        author: reply.author\n          ? {\n              id: reply.author.id,\n              name: reply.author.name,\n              username: reply.author.username,\n              avatar: reply.author.avatar,\n              ablyClientId: reply.author.ablyClientId,\n            }\n          : undefined,\n      })),\n    };\n  }, []);\n\n  const ensureStoryOnServer = useCallback(\n    async (story: StoryState) => {\n      try {\n        const ownerSnapshot = buildUserSnapshot(story.user);\n        const response = await fetch(`${API_BASE_URL}/stories`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({\n            ...buildStorySnapshot(story),\n            userSnapshot: ownerSnapshot ?? undefined,\n          }),\n        });\n\n        if (!response.ok) {\n          return false;\n        }\n\n        const payload = (await response.json().catch(() => ({}))) as {\n          story?: StoryAPIResponse;\n        };\n\n        if (payload?.story) {\n          mergeStoryUpdate(payload.story);\n        }\n\n        return true;\n      } catch (restoreError) {\n        console.error('Failed to ensure story on server:', restoreError);\n        return false;\n      }\n    },\n    [buildStorySnapshot, buildUserSnapshot, mergeStoryUpdate],\n  );\n\n  const processFiles = useCallback(\n    (files: FileList | File[] | null) => {\n      if (!files) {\n        return;\n      }\n\n      const fileArray = Array.from(files).filter((file) =>\n        file.type.startsWith('image/') || file.type.startsWith('video/'),\n      );\n\n      if (fileArray.length === 0) {\n        setCreationError('Only image or video files are supported for stories.');\n        toast.error('Only image or video files are supported for stories.');\n        return;\n      }\n\n      const availableSlots = Math.max(MAX_STORY_ITEMS - storyDraft.length, 0);\n      if (availableSlots <= 0) {\n        setCreationError(`You can add up to ${MAX_STORY_ITEMS} story items.`);\n        toast.info(`You can add up to ${MAX_STORY_ITEMS} story items.`);\n        return;\n      }\n\n      const allowedFiles = fileArray.slice(0, availableSlots);\n      const hasOverflow = fileArray.length > allowedFiles.length;\n\n      allowedFiles.forEach((file) => {\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          const result = event.target?.result;\n          if (!result || typeof result !== 'string') {\n            return;\n          }\n\n          const isVideo = file.type.startsWith('video/');\n          setStoryDraft((prev) => [\n            ...prev,\n            {\n              id: `${file.name}-${Date.now()}`,\n              type: isVideo ? 'video' : 'image',\n              url: result,\n              duration: isVideo ? DEFAULT_VIDEO_DURATION : DEFAULT_IMAGE_DURATION,\n            },\n          ]);\n        };\n        reader.readAsDataURL(file);\n      });\n\n      if (allowedFiles.length > 0) {\n        setCreationError(null);\n      }\n\n      if (hasOverflow) {\n        toast.info(`Only the first ${availableSlots} files were added.`);\n      }\n    },\n    [storyDraft.length],\n  );\n\n  const handleFileInputChange = useCallback(\n    (event: ChangeEvent<HTMLInputElement>) => {\n      processFiles(event.target.files);\n      event.target.value = '';\n    },\n    [processFiles],\n  );\n\n  const handleDrop = useCallback(\n    (event: DragEvent<HTMLDivElement>) => {\n      event.preventDefault();\n      setIsDragging(false);\n      processFiles(event.dataTransfer.files);\n    },\n    [processFiles],\n  );\n\n  const handleDragOver = useCallback((event: DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'copy';\n    if (!isDragging) {\n      setIsDragging(true);\n    }\n  }, [isDragging]);\n\n  const handleDragLeave = useCallback((event: DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    setIsDragging(false);\n  }, []);\n\n  const clearRecordingTimer = useCallback(() => {\n    if (recordingTimerRef.current !== null) {\n      window.clearInterval(recordingTimerRef.current);\n      recordingTimerRef.current = null;\n    }\n  }, []);\n\n  const finalizeRecording = useCallback(async () => {\n    clearRecordingTimer();\n    const discard = recordingDiscardRef.current;\n    recordingDiscardRef.current = false;\n    const chunks = recordingChunksRef.current;\n    recordingChunksRef.current = [];\n    mediaRecorderRef.current = null;\n    const mimeType = recordingMimeTypeRef.current || 'video/webm';\n    const durationSeconds = Math.max(recordingDurationRef.current, 0);\n    recordingDurationRef.current = 0;\n    setIsRecordingVideo(false);\n    setRecordingDuration(0);\n\n    if (discard || chunks.length === 0) {\n      if (discard && chunks.length > 0) {\n        toast.info('Recording discarded.');\n      }\n      return;\n    }\n\n    try {\n      const blob = new Blob(chunks, { type: mimeType });\n      const dataUrl = await blobToDataUrl(blob);\n      setStoryDraft((prev) => {\n        if (prev.length >= MAX_STORY_ITEMS) {\n          toast.info(`You can add up to ${MAX_STORY_ITEMS} story items.`);\n          return prev;\n        }\n        const derivedDuration = Math.min(\n          DEFAULT_VIDEO_DURATION,\n          Math.max(3, Math.round(durationSeconds) || DEFAULT_VIDEO_DURATION),\n        );\n        return [\n          ...prev,\n          {\n            id: `recording-${Date.now()}`,\n            type: 'video',\n            url: dataUrl,\n            duration: derivedDuration,\n          },\n        ];\n      });\n      toast.success('Video added to your story.');\n    } catch (error) {\n      console.error('Failed to save recording:', error);\n      toast.error('Unable to save that recording.');\n    }\n  }, [setStoryDraft, clearRecordingTimer]);\n\n  const stopVideoRecording = useCallback(\n    (discard = false) => {\n      if (!mediaRecorderRef.current) {\n        recordingDiscardRef.current = false;\n        return;\n      }\n      recordingDiscardRef.current = discard;\n      if (mediaRecorderRef.current.state !== 'inactive') {\n        mediaRecorderRef.current.stop();\n      }\n    },\n    [],\n  );\n\n  const startVideoRecording = useCallback(() => {\n    if (!isCameraActive || !cameraStream) {\n      toast.info('Start the camera before recording.');\n      return;\n    }\n    if (isRecordingVideo) {\n      toast.info('Recording already in progress.');\n      return;\n    }\n    if (typeof window === 'undefined' || typeof window.MediaRecorder === 'undefined') {\n      setRecordingError('Video recording is not supported in this browser.');\n      toast.error('Recording is not supported on this device.');\n      return;\n    }\n\n    try {\n      const mimeType = getSupportedRecordingMimeType();\n      const recorder = mimeType\n        ? new MediaRecorder(cameraStream, { mimeType })\n        : new MediaRecorder(cameraStream);\n      recordingMimeTypeRef.current = mimeType || recorder.mimeType || 'video/webm';\n      recordingChunksRef.current = [];\n      recorder.ondataavailable = (event) => {\n        if (event.data && event.data.size > 0) {\n          recordingChunksRef.current.push(event.data);\n        }\n      };\n      recorder.onerror = (errorEvent) => {\n        console.error('Recording error:', errorEvent);\n        setRecordingError('Recording error. Please try again.');\n        toast.error('Recording error.');\n        recordingDiscardRef.current = true;\n      };\n      recorder.onstop = () => {\n        finalizeRecording().catch((error) => {\n          console.error('Failed to finalize recording:', error);\n        });\n      };\n\n      mediaRecorderRef.current = recorder;\n      recorder.start();\n      setIsRecordingVideo(true);\n      setRecordingDuration(0);\n      recordingDurationRef.current = 0;\n      setRecordingError(null);\n      recordingTimerRef.current = window.setInterval(() => {\n        setRecordingDuration((prev) => {\n          const next = prev + 0.2;\n          recordingDurationRef.current = next;\n          if (next * 1000 >= MAX_CAMERA_RECORDING_MS) {\n            stopVideoRecording();\n          }\n          return next;\n        });\n      }, 200);\n      toast.success('Recording started.');\n    } catch (error) {\n      console.error('Unable to start recording:', error);\n      setRecordingError('Unable to start recording. Please try again.');\n      toast.error('Unable to start recording.');\n    }\n  }, [cameraStream, finalizeRecording, isCameraActive, isRecordingVideo, stopVideoRecording]);\n\n  useEffect(() => {\n    return () => {\n      clearRecordingTimer();\n      recordingDiscardRef.current = true;\n      if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n        mediaRecorderRef.current.stop();\n      }\n    };\n  }, [clearRecordingTimer]);\n\n  const stopCamera = useCallback(() => {\n    if (isRecordingVideo) {\n      stopVideoRecording(true);\n    }\n    setCameraStream((stream) => {\n      if (stream) {\n        stream.getTracks().forEach((track) => {\n          try {\n            track.stop();\n          } catch (stopError) {\n            console.error('Error stopping camera stream track:', stopError);\n          }\n        });\n      }\n\n      return null;\n    });\n    setIsCameraActive(false);\n    setIsCapturingPhoto(false);\n    setRecordingDuration(0);\n    recordingDurationRef.current = 0;\n    setRecordingError(null);\n    setCameraError(null);\n  }, [isRecordingVideo, stopVideoRecording]);\n\n  const startCamera = useCallback(async () => {\n    if (typeof navigator === 'undefined' || !navigator.mediaDevices?.getUserMedia) {\n      setCameraError('Camera is not supported on this device.');\n      return;\n    }\n\n    try {\n      stopCamera();\n      let stream: MediaStream | null = null;\n      try {\n        stream = await navigator.mediaDevices.getUserMedia({\n          video: { facingMode: 'user' },\n          audio: true,\n        });\n      } catch (audioError) {\n        console.warn('Falling back to video-only capture for stories:', audioError);\n        stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } });\n      }\n      setCameraStream(stream);\n      setIsCameraActive(true);\n      setCameraError(null);\n    } catch (cameraErr) {\n      console.error('Error accessing camera:', cameraErr);\n      setCameraError('Unable to access camera. Check your permissions.');\n      setIsCameraActive(false);\n    }\n  }, [stopCamera]);\n\n  const capturePhoto = useCallback(() => {\n    if (!isCameraActive || !videoRef.current) {\n      toast.info('Start the camera to capture a photo.');\n      return;\n    }\n    if (isRecordingVideo) {\n      toast.info('Stop the recording before taking a photo.');\n      return;\n    }\n\n    const video = videoRef.current;\n    setIsCapturingPhoto(true);\n    setStoryDraft((prev) => {\n      if (prev.length >= MAX_STORY_ITEMS) {\n        toast.info(`You can add up to ${MAX_STORY_ITEMS} story items.`);\n        setIsCapturingPhoto(false);\n        return prev;\n      }\n\n      const canvas = document.createElement('canvas');\n      const width = video.videoWidth || 720;\n      const height = video.videoHeight || 1280;\n      canvas.width = width;\n      canvas.height = height;\n      const context = canvas.getContext('2d');\n      if (!context) {\n        toast.error('Unable to capture photo.');\n        setIsCapturingPhoto(false);\n        return prev;\n      }\n      context.drawImage(video, 0, 0, width, height);\n      const dataUrl = canvas.toDataURL('image/jpeg', 0.9);\n      if (!dataUrl) {\n        toast.error('Unable to capture photo.');\n        setIsCapturingPhoto(false);\n        return prev;\n      }\n\n      toast.success('Photo added to your story.');\n      setIsCapturingPhoto(false);\n      return [\n        ...prev,\n        { id: `camera-${Date.now()}`, type: 'image', url: dataUrl, duration: DEFAULT_IMAGE_DURATION },\n      ];\n    });\n  }, [isCameraActive, isRecordingVideo]);\n\n  const resetCreatorState = useCallback(() => {\n    setStoryDraft([]);\n    setStoryVisibility('friends');\n    setCreationError(null);\n    setIsDragging(false);\n    setIsSubmittingStory(false);\n    stopCamera();\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  }, [stopCamera]);\n\n  const handleRemoveDraftItem = useCallback((id: string) => {\n    setStoryDraft((prev) => prev.filter((item) => item.id !== id));\n  }, []);\n\n  const handleCreatorOpenChange = useCallback(\n    (open: boolean) => {\n      setIsCreatorOpen(open);\n      if (!open) {\n        resetCreatorState();\n      }\n    },\n    [resetCreatorState],\n  );\n\n  const handleCreateStory = useCallback(async () => {\n    if (!currentUser) {\n      toast.info(\"Sign in to share a story.\");\n      return;\n    }\n\n    if (storyDraft.length === 0) {\n      setCreationError('Add at least one photo or video to your story.');\n      return;\n    }\n\n    setIsSubmittingStory(true);\n    setCreationError(null);\n\n    try {\n      const payloadItems = storyDraft.map((item) => ({\n        id: item.id,\n        type: item.type,\n        url: item.url,\n        duration: item.duration,\n        timestamp: new Date().toISOString(),\n      }));\n\n      const response = await fetch(`${API_BASE_URL}/stories`, {\n        method: 'POST',\n        headers: JSON_HEADERS,\n        body: JSON.stringify({\n          userId: currentUser.id,\n          visibility: storyVisibility,\n          items: payloadItems,\n        }),\n      });\n\n      const payload = (await response.json().catch(() => ({}))) as {\n        story?: StoryAPIResponse;\n        error?: string;\n      };\n\n      if (!response.ok || !payload?.story) {\n        const errorMessage = payload?.error ?? 'Failed to publish story.';\n        throw new Error(errorMessage);\n      }\n\n      const createdStory = payload.story;\n\n      mergeStoryUpdate(createdStory, { prepend: true });\n\n      const newStoryId = createdStory.id;\n\n      handleCreatorOpenChange(false);\n\n      toast.success('Your story is live!');\n\n      void fetchStories().catch((error) => {\n        console.error('Error refreshing stories:', error);\n      });\n\n      setSelectedStory(newStoryId);\n      setCurrentItemIndex(0);\n    } catch (creationErrorCaught) {\n      console.error('Error creating story:', creationErrorCaught);\n      const message =\n        creationErrorCaught instanceof Error\n          ? creationErrorCaught.message\n          : 'Unable to publish story right now.';\n      setCreationError(message);\n      toast.error('Unable to publish story right now.');\n    } finally {\n      setIsSubmittingStory(false);\n    }\n  }, [currentUser, storyDraft, storyVisibility, fetchStories, handleCreatorOpenChange, mergeStoryUpdate]);\n\n  useEffect(() => {\n    const controller = new AbortController();\n    fetchStories(controller.signal);\n    return () => controller.abort();\n  }, [fetchStories]);\n\n  useEffect(() => {\n    const video = videoRef.current;\n    if (!video) {\n      return;\n    }\n\n    if (cameraStream) {\n      video.srcObject = cameraStream;\n      const play = async () => {\n        try {\n          await video.play();\n        } catch (err) {\n          console.error('Error starting camera preview:', err);\n          setCameraError('Unable to start camera preview.');\n        }\n      };\n      void play();\n    } else {\n      video.srcObject = null;\n    }\n  }, [cameraStream]);\n\n  useEffect(() => {\n    if (!isCreatorOpen) {\n      stopCamera();\n    }\n  }, [isCreatorOpen, stopCamera]);\n\n  const storyFeed = useMemo<StoryState[]>(() => {\n    return storiesData\n      .filter(\n        (story): story is StoryAPIResponse & { user: StoryUser; items: StoryItemData[] } =>\n          Boolean(story?.user) && Array.isArray(story.items) && story.items.length > 0,\n      )\n      .map((story) => {\n        const safeItems: StoryItemData[] = story.items!.map((item): StoryItemData => ({\n          ...item,\n          type: item.type === 'video' ? 'video' : 'image',\n        }));\n        const baseUser = story.user!;\n        const resolvedUser: StoryUser = {\n          id: baseUser.id,\n          name: baseUser.name,\n          username: baseUser.username,\n          avatar: baseUser.avatar,\n          ablyClientId: baseUser.ablyClientId ?? baseUser.id,\n        };\n        const createdAt = story.createdAt && !Number.isNaN(Date.parse(story.createdAt))\n          ? new Date(story.createdAt).toISOString()\n          : new Date().toISOString();\n        const expiresAt = story.expiresAt && !Number.isNaN(Date.parse(story.expiresAt))\n          ? new Date(story.expiresAt).toISOString()\n          : createdAt;\n        const likes = Array.from(\n          new Set(\n            Array.isArray(story.likes)\n              ? story.likes.filter((value): value is string => typeof value === 'string')\n              : [],\n          ),\n        );\n        const replies: StoryReply[] = Array.isArray(story.replies)\n          ? story.replies\n              .map((reply, index) => {\n                if (!reply || typeof reply !== 'object') {\n                  return null;\n                }\n                const replyData = reply as StoryReplyData;\n                const replyAuthorId = typeof replyData.authorId === 'string' ? replyData.authorId : '';\n                if (!replyAuthorId) {\n                  return null;\n                }\n                const timestamp = replyData.timestamp && !Number.isNaN(Date.parse(replyData.timestamp))\n                  ? new Date(replyData.timestamp).toISOString()\n                  : new Date().toISOString();\n                const authorData = replyData.author;\n                const author: StoryUser | null = authorData\n                  ? {\n                      id: authorData.id,\n                      name: authorData.name,\n                      username: authorData.username,\n                      avatar: authorData.avatar,\n                      ablyClientId: authorData.ablyClientId ?? authorData.id,\n                    }\n                  : null;\n                const content = typeof replyData.content === 'string' ? replyData.content : '';\n                if (!content) {\n                  return null;\n                }\n\n                return {\n                  id: replyData.id || `${story.id}-reply-${index}`,\n                  storyId: replyData.storyId ?? story.id,\n                  authorId: replyAuthorId,\n                  author,\n                  content,\n                  timestamp,\n                };\n              })\n              .filter((reply): reply is StoryReply => Boolean(reply))\n              .sort((a, b) => Date.parse(a.timestamp) - Date.parse(b.timestamp))\n          : [];\n\n        return {\n          id: story.id,\n          userId: story.userId,\n          user: resolvedUser,\n          items: safeItems,\n          viewers: Array.isArray(story.viewers) ? story.viewers : [],\n          visibility: story.visibility ?? 'friends',\n          createdAt,\n          expiresAt,\n          viewed: currentUser\n            ? Array.isArray(story.viewers)\n              ? story.viewers.includes(currentUser.id)\n              : false\n            : false,\n          likes,\n          likeCount: likes.length,\n          liked: currentUser ? likes.includes(currentUser.id) : false,\n          replies,\n        };\n      })\n      .sort((a, b) => Date.parse(b.createdAt) - Date.parse(a.createdAt));\n  }, [storiesData, currentUser]);\n\n  const storyCreationPlaceholder = useMemo<StoryState | null>(() => {\n    if (!currentUser) {\n      return null;\n    }\n\n    const hasExistingStory = storyFeed.some((story) => story.userId === currentUser.id);\n    if (hasExistingStory) {\n      return null;\n    }\n\n    const nowIso = new Date().toISOString();\n    return {\n      id: `create-story-${currentUser.id}`,\n      userId: currentUser.id,\n      user: {\n        id: currentUser.id,\n        name: currentUser.name,\n        username: currentUser.username,\n        avatar: currentUser.avatar,\n        ablyClientId: currentUser.ablyClientId ?? currentUser.id,\n      },\n      items: [],\n      viewers: [],\n      visibility: 'friends',\n      createdAt: nowIso,\n      expiresAt: nowIso,\n      viewed: false,\n      likes: [],\n      likeCount: 0,\n      liked: false,\n      replies: [],\n    };\n  }, [currentUser, storyFeed]);\n\n  const playableStories = useMemo(\n    () => storyFeed.filter((story) => story.items.length > 0),\n    [storyFeed],\n  );\n\n  const orderedStories = useMemo(() => {\n    let ordered = storyFeed;\n    if (currentUser) {\n      const ownStories = storyFeed.filter((story) => story.userId === currentUser.id);\n      const others = storyFeed.filter((story) => story.userId !== currentUser.id);\n      ordered = [...ownStories, ...others];\n    }\n\n    if (storyCreationPlaceholder) {\n      return [storyCreationPlaceholder, ...ordered];\n    }\n\n    return ordered;\n  }, [currentUser, storyFeed, storyCreationPlaceholder]);\n\n  const currentStory = selectedStory\n    ? playableStories.find((story) => story.id === selectedStory) ?? null\n    : null;\n  const currentItem = currentStory?.items[currentItemIndex];\n\n  useEffect(() => {\n    if (!selectedStory) {\n      return;\n    }\n\n    if (playableStories.some((story) => story.id === selectedStory)) {\n      return;\n    }\n\n    setSelectedStory(null);\n    setCurrentItemIndex(0);\n  }, [selectedStory, playableStories]);\n\n  useEffect(() => {\n    setReplyText('');\n    setStoryVideoProgress(0);\n    setIsStoryVideoMuted(true);\n  }, [selectedStory]);\n\n  useEffect(() => {\n    if (!selectedStory || !currentUser) {\n      return;\n    }\n\n    const story = storiesData.find((entry) => entry.id === selectedStory);\n    if (!story) {\n      return;\n    }\n    if (Array.isArray(story.viewers) && story.viewers.includes(currentUser.id)) {\n      return;\n    }\n\n    const controller = new AbortController();\n    const trackView = async () => {\n      try {\n        const storyIdParam = encodeStoryId(story.id);\n        await fetch(`${API_BASE_URL}/stories/${storyIdParam}/view`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({ viewerId: currentUser.id }),\n          signal: controller.signal,\n        });\n\n        setStoriesData((prev) =>\n          prev.map((entry) =>\n            entry.id === story.id\n              ? { ...entry, viewers: Array.from(new Set([...(entry.viewers ?? []), currentUser.id])) }\n              : entry,\n          ),\n        );\n      } catch (markError) {\n        if ((markError as Error).name !== 'AbortError') {\n          console.error('Failed to update story view state:', markError);\n        }\n      }\n    };\n\n    trackView();\n    return () => controller.abort();\n  }, [selectedStory, currentUser, storiesData, encodeStoryId]);\n\n  const handleStorySelect = (story: StoryState) => {\n    if (currentUser && story.userId === currentUser.id && story.items.length === 0) {\n      handleCreatorOpenChange(true);\n      return;\n    }\n    if (story.items.length === 0) {\n      return;\n    }\n    setSelectedStory(story.id);\n    setCurrentItemIndex(0);\n  };\n\n  const handleNext = useCallback(() => {\n    if (!currentStory) {\n      return;\n    }\n\n    if (currentItemIndex < currentStory.items.length - 1) {\n      setCurrentItemIndex((index) => index + 1);\n      return;\n    }\n\n    const storyIndex = playableStories.findIndex((story) => story.id === currentStory.id);\n    if (storyIndex >= 0 && storyIndex < playableStories.length - 1) {\n      setSelectedStory(playableStories[storyIndex + 1].id);\n      setCurrentItemIndex(0);\n    } else {\n      setSelectedStory(null);\n      setCurrentItemIndex(0);\n    }\n  }, [currentStory, currentItemIndex, playableStories]);\n\n  const handlePrevious = useCallback(() => {\n    if (!currentStory) {\n      return;\n    }\n\n    if (currentItemIndex > 0) {\n      setCurrentItemIndex((index) => index - 1);\n      return;\n    }\n\n    const storyIndex = playableStories.findIndex((story) => story.id === currentStory.id);\n    if (storyIndex > 0) {\n      const prevStory = playableStories[storyIndex - 1];\n      setSelectedStory(prevStory.id);\n      setCurrentItemIndex(Math.max(prevStory.items.length - 1, 0));\n    }\n  }, [currentStory, currentItemIndex, playableStories]);\n\n  const sendStoryReplyMessage = useCallback(\n    async (story: StoryState, content: string) => {\n      if (!currentUser || story.userId === currentUser.id) {\n        return;\n      }\n\n      const senderClientId = currentUser.ablyClientId ?? currentUser.id;\n      const targetClientId = story.user.ablyClientId ?? story.user.id;\n      const members = Array.from(\n        new Set([senderClientId, targetClientId].filter((value): value is string => Boolean(value))),\n      );\n      if (members.length < 2) {\n        return;\n      }\n\n      const chatName = `Story chat with ${story.user.name}`;\n      let chatId: string | null = null;\n\n      try {\n        const response = await fetch(`${API_BASE_URL}/chats`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({\n            name: chatName,\n            members,\n            isGroup: false,\n            createdBy: currentUser.id,\n          }),\n        });\n\n        const payload = (await response.json().catch(() => ({}))) as {\n          chat?: { id?: string };\n        };\n\n        if (response.ok && payload?.chat && typeof payload.chat.id === 'string') {\n          chatId = payload.chat.id;\n        } else if (!response.ok) {\n          console.warn('Failed to ensure chat for story reply', response.status);\n        }\n      } catch (ensureChatError) {\n        console.error('Error ensuring chat for story reply:', ensureChatError);\n      }\n\n      if (!chatId) {\n        return;\n      }\n\n      try {\n        const messageResponse = await fetch(`${API_BASE_URL}/messages`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({\n            chatId,\n            senderId: senderClientId,\n            senderName: currentUser.name,\n            senderAvatar: currentUser.avatar,\n            content: `Reply to your story: ${content}`,\n          }),\n        });\n\n        if (!messageResponse.ok) {\n          console.warn('Failed to persist story reply message', messageResponse.status);\n        }\n      } catch (messageError) {\n        console.error('Error sending story reply message:', messageError);\n      }\n    },\n    [currentUser],\n  );\n\n  useEffect(() => {\n    if (!currentItem || currentItem.type !== 'video') {\n      setStoryVideoProgress(0);\n      const existing = storyVideoRef.current;\n      if (existing) {\n        existing.pause();\n        existing.currentTime = 0;\n      }\n      return;\n    }\n\n    const videoElement = storyVideoRef.current;\n    if (!videoElement) {\n      return;\n    }\n\n    videoElement.muted = isStoryVideoMuted;\n    const handleEnded = () => handleNext();\n    const handleTimeUpdate = () => {\n      if (videoElement.duration) {\n        setStoryVideoProgress(videoElement.currentTime / videoElement.duration);\n      }\n    };\n    const handleLoadedMetadata = () => {\n      setStoryVideoProgress(0);\n      videoElement.muted = isStoryVideoMuted;\n      const playPromise = videoElement.play();\n      if (playPromise) {\n        playPromise.catch((error) => console.warn('Unable to autoplay story video:', error));\n      }\n    };\n\n    videoElement.addEventListener('ended', handleEnded);\n    videoElement.addEventListener('timeupdate', handleTimeUpdate);\n    videoElement.addEventListener('loadedmetadata', handleLoadedMetadata);\n\n    const playPromise = videoElement.play();\n    if (playPromise) {\n      playPromise.catch((error) => console.warn('Unable to autoplay story video:', error));\n    }\n\n    return () => {\n      videoElement.removeEventListener('ended', handleEnded);\n      videoElement.removeEventListener('timeupdate', handleTimeUpdate);\n      videoElement.removeEventListener('loadedmetadata', handleLoadedMetadata);\n    };\n  }, [currentItem, handleNext, isStoryVideoMuted]);\n\n  const toggleStoryVideoMute = useCallback(() => {\n    setIsStoryVideoMuted((prev) => {\n      const next = !prev;\n      if (storyVideoRef.current) {\n        storyVideoRef.current.muted = next;\n      }\n      return next;\n    });\n  }, []);\n\n  const handleStoryLike = useCallback(\n    async (story: StoryState) => {\n      if (!currentUser) {\n        toast.info('Sign in to like stories.');\n        return;\n      }\n\n      if (likingStoryId && likingStoryId !== story.id) {\n        return;\n      }\n\n      setLikingStoryId(story.id);\n      try {\n        const toggleLike = async (attempt = 0): Promise<boolean> => {\n          const storyIdParam = encodeStoryId(story.id);\n          const includeSnapshot = attempt > 0;\n          const response = await fetch(`${API_BASE_URL}/stories/${storyIdParam}/like`, {\n            method: 'POST',\n            headers: JSON_HEADERS,\n            body: JSON.stringify({\n              userId: currentUser.id,\n              likerSnapshot: {\n                id: currentUser.id,\n                name: currentUser.name,\n                username: currentUser.username,\n                avatar: currentUser.avatar,\n                ablyClientId: currentUser.ablyClientId ?? currentUser.id,\n              },\n              ...(includeSnapshot ? { storySnapshot: buildStorySnapshot(story) } : {}),\n            }),\n          });\n\n          if (response.status === 404 && attempt === 0) {\n            const restored = await ensureStoryOnServer(story);\n            if (restored) {\n              return toggleLike(attempt + 1);\n            }\n          }\n\n          const payload = (await response.json().catch(() => ({}))) as {\n            story?: StoryAPIResponse;\n            liked?: boolean;\n            error?: string;\n          };\n\n          if (!response.ok || !payload?.story) {\n            return false;\n          }\n\n          mergeStoryUpdate(payload.story);\n          return true;\n        };\n\n        const applied = await toggleLike();\n        if (!applied) {\n          throw new Error('restore');\n        }\n      } catch {\n        if (currentUser) {\n          const currentlyLiked = story.likes.includes(currentUser.id);\n          const updatedLikes = currentlyLiked\n            ? story.likes.filter((id) => id !== currentUser.id)\n            : [...story.likes, currentUser.id];\n          const fallbackStory: StoryState = {\n            ...story,\n            likes: updatedLikes,\n            likeCount: updatedLikes.length,\n            liked: !currentlyLiked,\n          };\n          mergeStoryUpdate(storyStateToApiResponse(fallbackStory));\n          toast.success(currentlyLiked ? 'Removed like.' : 'Liked story!');\n        } else {\n          toast.success('Story like recorded!');\n        }\n      } finally {\n        setLikingStoryId(null);\n      }\n    },\n    [currentUser, likingStoryId, mergeStoryUpdate, encodeStoryId, ensureStoryOnServer, buildStorySnapshot],\n  );\n\n  const handleReply = useCallback(async () => {\n    if (!currentStory) {\n      return;\n    }\n\n    const trimmed = replyText.trim();\n    if (!trimmed) {\n      return;\n    }\n\n    if (!currentUser) {\n      toast.info('Sign in to reply to stories.');\n      return;\n    }\n\n    setReplySending(true);\n    try {\n      const sendReply = async (attempt = 0): Promise<boolean> => {\n        const storyIdParam = encodeStoryId(currentStory.id);\n        const response = await fetch(`${API_BASE_URL}/stories/${storyIdParam}/reply`, {\n          method: 'POST',\n          headers: JSON_HEADERS,\n          body: JSON.stringify({\n            authorId: currentUser.id,\n            content: trimmed,\n            authorSnapshot: {\n              id: currentUser.id,\n              name: currentUser.name,\n              username: currentUser.username,\n              avatar: currentUser.avatar,\n              ablyClientId: currentUser.ablyClientId ?? currentUser.id,\n            },\n            ...(attempt > 0 ? { storySnapshot: buildStorySnapshot(currentStory) } : {}),\n          }),\n        });\n\n        if (response.status === 404 && attempt === 0) {\n          const restored = await ensureStoryOnServer(currentStory);\n          if (restored) {\n              return sendReply(attempt + 1);\n          }\n        }\n\n        const payload = (await response.json().catch(() => ({}))) as {\n          story?: StoryAPIResponse;\n          reply?: StoryReplyData;\n          error?: string;\n        };\n\n        if (!response.ok || !payload?.story) {\n          return false;\n        }\n\n        mergeStoryUpdate(payload.story);\n        setReplyText('');\n        toast.success('Reply sent!');\n\n        void sendStoryReplyMessage(currentStory, trimmed);\n        return true;\n      };\n\n      const applied = await sendReply();\n      if (!applied) {\n        throw new Error('restore');\n      }\n      } catch {\n      if (currentStory && currentUser) {\n        const replyId = `offline-${Date.now().toString(36)}`;\n        const fallbackReply: StoryReply = {\n          id: replyId,\n          storyId: currentStory.id,\n          authorId: currentUser.id,\n          content: trimmed,\n          timestamp: new Date().toISOString(),\n          author: {\n            id: currentUser.id,\n            name: currentUser.name,\n            username: currentUser.username,\n            avatar: currentUser.avatar,\n            ablyClientId: currentUser.ablyClientId ?? currentUser.id,\n          },\n        };\n        const fallbackStory: StoryState = {\n          ...currentStory,\n          replies: [...currentStory.replies, fallbackReply],\n        };\n        mergeStoryUpdate(storyStateToApiResponse(fallbackStory));\n        setReplyText('');\n        toast.success('Reply sent!');\n        void sendStoryReplyMessage(currentStory, trimmed);\n      } else {\n        toast.success('Reply captured!');\n      }\n    } finally {\n      setReplySending(false);\n    }\n  }, [\n    currentStory,\n    currentUser,\n    encodeStoryId,\n    ensureStoryOnServer,\n    mergeStoryUpdate,\n    replyText,\n    sendStoryReplyMessage,\n    buildStorySnapshot,\n  ]);\n\n  const showSkeleton = loading && storiesData.length === 0;\n\n  return (\n    <div className=\"max-w-7xl mx-auto space-y-4\">\n      {error && (\n        <div className=\"p-4 rounded-2xl bg-white/10 border border-white/20 text-white/80 flex items-center justify-between gap-4\">\n          <p className=\"text-sm\">{error}</p>\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={() => void fetchStories()}\n            className=\"bg-white/10 border-white/30 text-white hover:bg-white/20\"\n          >\n            Try again\n          </Button>\n        </div>\n      )}\n\n      {showSkeleton ? (\n        <div className=\"flex gap-4 overflow-x-auto pb-4 hide-scrollbar\">\n          {Array.from({ length: STORY_SKELETON_COUNT }).map((_, index) => (\n            <div key={index} className=\"flex flex-col items-center gap-2 flex-shrink-0\">\n              <Skeleton className=\"w-20 h-20 rounded-full bg-white/10\" />\n              <Skeleton className=\"w-16 h-3 bg-white/10\" />\n            </div>\n          ))}\n        </div>\n      ) : (\n        <div className=\"flex gap-4 overflow-x-auto pb-4 hide-scrollbar\">\n          {orderedStories.length === 0 && !currentUser ? (\n            <div className=\"text-white/70 text-sm\">No stories yet. Check back soon!</div>\n          ) : (\n            orderedStories.map((story) => {\n              const isOwnStory = Boolean(currentUser && story.userId === currentUser.id);\n              const isPlaceholder = isOwnStory && story.items.length === 0;\n              const ringGradient = story.viewed && !isPlaceholder\n                ? 'from-white/30 via-white/20 to-white/30'\n                : 'from-pink-500 via-purple-500 to-indigo-500';\n              const label = isPlaceholder\n                ? 'Create a story'\n                : isOwnStory\n                ? 'View your story'\n                : `View ${story.user.name}'s story`;\n\n              return (\n                <button\n                  key={story.id}\n                  type=\"button\"\n                  onClick={() => handleStorySelect(story)}\n                  className=\"relative flex flex-col items-center gap-2 flex-shrink-0 group focus:outline-none transition-transform duration-300 hover:-translate-y-1\"\n                  aria-label={label}\n                >\n                  <div className=\"relative\">\n                    <div\n                      className={`relative p-[3px] rounded-full bg-gradient-to-tr ${ringGradient} transition-all duration-500 ease-out group-hover:shadow-[0_18px_35px_rgba(168,85,247,0.35)] group-hover:scale-[1.03]`}\n                    >\n                      <div className=\"absolute inset-0 rounded-full opacity-0 group-hover:opacity-100 group-hover:blur-lg bg-white/25 transition-all duration-500\" />\n                      <div className=\"relative p-0.5 rounded-full bg-gradient-to-br from-purple-950/80 via-purple-900/70 to-pink-900/80\">\n                        <Avatar className=\"w-16 h-16 border-2 border-white/20 transition-transform duration-500 group-hover:scale-[1.04]\">\n                          <AvatarImage src={story.user.avatar} />\n                          <AvatarFallback>{story.user.name[0]}</AvatarFallback>\n                        </Avatar>\n                      </div>\n                    </div>\n\n                    {isPlaceholder && (\n                      <div className=\"absolute -bottom-1 -right-1 w-7 h-7 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 rounded-full flex items-center justify-center border-2 border-purple-950 shadow-[0_12px_35px_rgba(236,72,153,0.45)] transition-transform duration-300 group-hover:scale-110\">\n                        <Plus className=\"w-3.5 h-3.5 text-white\" />\n                      </div>\n                    )}\n                    {isOwnStory && !isPlaceholder && (\n                      <button\n                        type=\"button\"\n                        onClick={(event) => {\n                          event.stopPropagation();\n                          handleCreatorOpenChange(true);\n                        }}\n                        className=\"absolute -bottom-1 -right-1 flex h-7 w-7 items-center justify-center rounded-full border-2 border-purple-950 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 text-white shadow-[0_12px_35px_rgba(236,72,153,0.45)] transition-transform duration-300 hover:scale-110 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/80\"\n                        aria-label=\"Add to your story\"\n                      >\n                        <Plus className=\"w-3.5 h-3.5\" />\n                      </button>\n                    )}\n                  </div>\n                  <span className=\"text-white/90 text-sm max-w-[90px] truncate text-center tracking-tight transition-colors duration-300 group-hover:text-white\">\n                    {isOwnStory ? 'Your Story' : story.user.name}\n                  </span>\n                </button>\n              );\n            })\n          )}\n        </div>\n      )}\n\n      <Dialog open={selectedStory !== null} onOpenChange={(open) => !open && setSelectedStory(null)}>\n        <DialogContent className=\"max-w-md h-[90vh] p-0 bg-transparent border-0\">\n          {currentStory && currentItem && (\n            <div className=\"relative w-full h-full rounded-3xl overflow-hidden bg-black\">\n              <div className=\"absolute inset-0\">\n                {currentItem.type === 'video' ? (\n                  <>\n                    <video\n                      key={currentItem.id}\n                      ref={storyVideoRef}\n                      src={currentItem.url}\n                      className=\"h-full w-full object-contain bg-black\"\n                      playsInline\n                      autoPlay\n                      controls={false}\n                      muted={isStoryVideoMuted}\n                    />\n                    <div className=\"pointer-events-none absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-black/60\" />\n                  </>\n                ) : (\n                  <>\n                    <ImageWithFallback src={currentItem.url} alt=\"Story\" className=\"w-full h-full object-cover\" />\n                    <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-black/60\" />\n                  </>\n                )}\n              </div>\n\n              <div className=\"absolute top-0 left-0 right-0 p-4 z-10\">\n                <div className=\"flex gap-1\">\n                  {currentStory.items.map((item, index) => {\n                    const isActive = index === currentItemIndex;\n                    const isCompleted = index < currentItemIndex;\n                    const widthPercent =\n                      isCompleted || (isActive && item.type !== 'video')\n                        ? undefined\n                        : isActive && item.type === 'video'\n                        ? Math.min(Math.max(storyVideoProgress, 0), 1) * 100\n                        : undefined;\n                    const progressClass = [\n                      'h-full bg-white transition-all duration-300',\n                      isCompleted ? 'w-full' : '',\n                      !isActive && !isCompleted ? 'w-0' : '',\n                      isActive && item.type !== 'video' ? 'w-full animate-progress' : '',\n                    ]\n                      .filter(Boolean)\n                      .join(' ');\n\n                    return (\n                      <div key={index} className=\"flex-1 h-1 bg-white/30 rounded-full overflow-hidden\">\n                        <div\n                          className={progressClass}\n                          style={\n                            widthPercent !== undefined ? { width: `${widthPercent}%` } : undefined\n                          }\n                        />\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n\n              <div className=\"absolute top-4 right-4 z-20 flex gap-2\">\n                {currentItem.type === 'video' && (\n                  <Button\n                    size=\"icon\"\n                    variant=\"ghost\"\n                    onClick={toggleStoryVideoMute}\n                    className=\"text-white hover:bg-white/20\"\n                  >\n                    {isStoryVideoMuted ? <VolumeX className=\"w-5 h-5\" /> : <Volume2 className=\"w-5 h-5\" />}\n                  </Button>\n                )}\n                <Button\n                  size=\"icon\"\n                  variant=\"ghost\"\n                  onClick={() => setSelectedStory(null)}\n                  className=\"text-white hover:bg-white/20\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </Button>\n              </div>\n\n              <div className=\"absolute top-6 left-0 right-0 px-4 z-10\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Avatar className=\"w-10 h-10 border-2 border-white/50\">\n                      <AvatarImage src={currentStory.user.avatar} />\n                      <AvatarFallback>{currentStory.user.name[0]}</AvatarFallback>\n                    </Avatar>\n                    <div>\n                      <div className=\"text-white\">{currentStory.user.name}</div>\n                      <div className=\"text-white/70 text-sm\">{formatRelativeTime(currentItem.timestamp)}</div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <button\n                onClick={handlePrevious}\n                className=\"absolute left-0 top-0 bottom-0 w-1/3 z-10 cursor-pointer\"\n                aria-label=\"Previous\"\n              />\n              <button\n                onClick={handleNext}\n                className=\"absolute right-0 top-0 bottom-0 w-1/3 z-10 cursor-pointer\"\n                aria-label=\"Next\"\n              />\n\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={handlePrevious}\n                className=\"absolute left-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-20\"\n              >\n                <ChevronLeft className=\"w-6 h-6\" />\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={handleNext}\n                className=\"absolute right-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-20\"\n              >\n                <ChevronRight className=\"w-6 h-6\" />\n              </Button>\n\n              <div className=\"absolute bottom-0 left-0 right-0 p-4 z-10\">\n                <div className=\"space-y-3\">\n                  {currentStory.replies.length > 0 && (\n                    <div className=\"max-h-40 overflow-y-auto rounded-2xl border border-white/10 bg-black/30 p-3 backdrop-blur\">\n                      <div className=\"space-y-3\">\n                        {currentStory.replies.map((reply) => (\n                          <div key={reply.id} className=\"flex items-start gap-3\">\n                            <Avatar className=\"h-8 w-8 border border-white/20\">\n                              <AvatarImage src={reply.author?.avatar} />\n                              <AvatarFallback>\n                                {(reply.author?.name ?? reply.author?.username ?? '?')[0] ?? '?'}\n                              </AvatarFallback>\n                            </Avatar>\n                            <div className=\"flex-1 space-y-1\">\n                              <div className=\"flex items-center justify-between text-xs text-white/60\">\n                                <span className=\"font-medium text-white/90\">\n                                  {reply.author?.name ?? reply.author?.username ?? 'MoveSplash user'}\n                                </span>\n                                <span>{formatRelativeTime(reply.timestamp)}</span>\n                              </div>\n                              <p className=\"text-sm text-white/90\">{reply.content}</p>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  <div className=\"flex flex-wrap items-center gap-2\">\n                    <Button\n                      type=\"button\"\n                      variant=\"ghost\"\n                      onClick={() => void handleStoryLike(currentStory)}\n                      disabled={likingStoryId === currentStory.id}\n                      className={`flex items-center gap-2 rounded-full border border-white/25 bg-black/40 px-4 py-2 text-sm transition-all duration-200 ${\n                        currentStory.liked\n                          ? 'border-rose-400/60 text-rose-100 hover:bg-rose-500/20'\n                          : 'text-white hover:bg-white/15'\n                      } ${likingStoryId === currentStory.id ? 'opacity-70 cursor-not-allowed' : ''}`}\n                    >\n                      {likingStoryId === currentStory.id ? (\n                        <Loader2 className=\"h-4 w-4 animate-spin\" />\n                      ) : (\n                        <Heart className={`h-4 w-4 ${currentStory.liked ? 'fill-current' : ''}`} />\n                      )}\n                      <span>{currentStory.likeCount}</span>\n                    </Button>\n\n                    <Input\n                      placeholder=\"Send a reply...\"\n                      value={replyText}\n                      onChange={(e) => setReplyText(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter') {\n                          e.preventDefault();\n                          void handleReply();\n                        }\n                      }}\n                      disabled={replySending}\n                      className=\"flex-1 min-w-[140px] bg-white/10 backdrop-blur-md border-white/20 text-white placeholder:text-white/50\"\n                    />\n                    <Button\n                      type=\"button\"\n                      onClick={() => void handleReply()}\n                      disabled={replySending || !replyText.trim()}\n                      className=\"flex items-center justify-center gap-2 bg-gradient-to-r from-pink-500 to-purple-500 text-white shadow-[0_12px_30px_rgba(168,85,247,0.45)] transition-all duration-200 hover:from-pink-600 hover:to-purple-600 disabled:opacity-70\"\n                    >\n                      {replySending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Send className=\"h-4 w-4\" />}\n                      <span className=\"text-sm font-medium\">Send</span>\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isCreatorOpen} onOpenChange={handleCreatorOpenChange}>\n        <DialogContent className=\"w-full max-w-[95vw] sm:max-w-2xl lg:max-w-3xl p-0 border-0 bg-transparent shadow-none\">\n          <div className=\"relative flex max-h-[88vh] flex-col overflow-hidden rounded-3xl bg-gradient-to-br from-[#24103f] via-[#170d3e] to-[#0b1531] text-white shadow-[0_28px_70px_rgba(147,51,234,0.45)]\">\n            <div\n              className=\"pointer-events-none absolute inset-0 opacity-70\"\n              style={{\n                background:\n                  'radial-gradient(circle at 20% 20%, rgba(236,72,153,0.3), transparent 60%), radial-gradient(circle at 80% 10%, rgba(96,165,250,0.25), transparent 55%), radial-gradient(circle at 50% 90%, rgba(168,85,247,0.25), transparent 60%)',\n              }}\n            />\n            <div className=\"relative flex-1 overflow-y-auto px-5 py-6 sm:px-8 sm:py-8 space-y-6\">\n              <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                <div className=\"space-y-2 sm:space-y-1\">\n                  <h2 className=\"text-lg font-semibold sm:text-xl\">Create a Story</h2>\n                  <p className=\"text-sm text-white/70\">\n                    Add photos or short clips to share with your friends.\n                  </p>\n                </div>\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  onClick={() => handleCreatorOpenChange(false)}\n                  className=\"text-white/70 hover:text-white hover:bg-white/15\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </Button>\n              </div>\n\n              <div\n                className={`relative rounded-2xl border border-dashed ${\n                  isDragging ? 'border-white/60 bg-white/10' : 'border-white/20 bg-white/5'\n                } transition-all duration-300 ease-out`}\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                onDrop={handleDrop}\n              >\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/*,video/*\"\n                  multiple\n                  className=\"hidden\"\n                  onChange={handleFileInputChange}\n                />\n                <div className=\"flex flex-col items-center justify-center gap-4 px-4 py-8 text-center sm:px-6 sm:py-10\">\n                  <div className=\"rounded-full bg-white/10 p-4 text-white shadow-[0_12px_35px_rgba(236,72,153,0.35)]\">\n                    <UploadCloud className=\"w-7 h-7\" />\n                  </div>\n                  <div className=\"space-y-1\">\n                    <p className=\"text-base font-medium\">Drag & drop to upload</p>\n                    <p className=\"text-sm text-white/60\">\n                      You can add up to {MAX_STORY_ITEMS} photos or videos.\n                    </p>\n                  </div>\n                  <div className=\"flex flex-wrap items-center justify-center gap-3 text-xs text-white/60\">\n                    <span>Supported: JPG, PNG, MP4</span>\n                    <span className=\"hidden sm:inline\">|</span>\n                    <span>Recommended length ~ {DEFAULT_VIDEO_DURATION}s</span>\n                  </div>\n                  <Button\n                    type=\"button\"\n                    onClick={() => fileInputRef.current?.click()}\n                    className=\"rounded-full bg-white px-5 py-2 text-sm font-semibold text-purple-900 shadow-[0_12px_30px_rgba(148,63,255,0.35)] hover:bg-white/90\"\n                  >\n                    Browse files\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"rounded-2xl border border-white/10 bg-white/5 p-4 sm:p-5 backdrop-blur space-y-3\">\n                <div className=\"flex flex-wrap items-center gap-2 sm:gap-3\">\n                  <Button\n                    type=\"button\"\n                    onClick={() => void startCamera()}\n                    disabled={isCameraActive}\n                    className=\"flex items-center gap-2 rounded-full bg-white px-4 py-2 text-sm font-semibold text-purple-900 shadow-[0_12px_30px_rgba(148,63,255,0.35)] transition duration-200 hover:bg-white/90 disabled:cursor-not-allowed disabled:opacity-70\"\n                  >\n                    <Camera className=\"h-4 w-4\" />\n                    {isCameraActive ? 'Camera Ready' : 'Use Camera'}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => void capturePhoto()}\n                    disabled={!isCameraActive || isCapturingPhoto}\n                    className=\"flex items-center gap-2 rounded-full border-white/40 bg-purple-900/30 px-4 py-2 text-sm text-white hover:bg-purple-800/50 disabled:opacity-60\"\n                  >\n                    {isCapturingPhoto ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      <Camera className=\"h-4 w-4\" />\n                    )}\n                    Capture photo\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant={isRecordingVideo ? 'destructive' : 'outline'}\n                    onClick={() => {\n                      if (isRecordingVideo) {\n                        stopVideoRecording();\n                      } else {\n                        startVideoRecording();\n                      }\n                    }}\n                    disabled={!isCameraActive || isCapturingPhoto}\n                    className={`flex items-center gap-2 rounded-full border-white/40 px-4 py-2 text-sm ${\n                      isRecordingVideo\n                        ? 'bg-rose-500/30 text-white hover:bg-rose-500/40'\n                        : 'bg-purple-900/30 text-white hover:bg-purple-800/50'\n                    } disabled:opacity-60`}\n                  >\n                    {isRecordingVideo ? <Square className=\"h-4 w-4\" /> : <Video className=\"h-4 w-4\" />}\n                    {isRecordingVideo ? 'Stop recording' : 'Record video'}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    onClick={() => stopCamera()}\n                    disabled={!isCameraActive}\n                    className=\"rounded-full px-4 py-2 text-sm text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-60\"\n                  >\n                    Stop camera\n                  </Button>\n                </div>\n                {isRecordingVideo && (\n                  <div className=\"text-xs uppercase tracking-[0.2em] text-amber-200\">\n                    Recording {formatRecordingTime(recordingDuration)} / {formatRecordingTime(DEFAULT_VIDEO_DURATION)}\n                  </div>\n                )}\n                {cameraError && <p className=\"text-sm text-rose-200\">{cameraError}</p>}\n                {recordingError && <p className=\"text-sm text-rose-200\">{recordingError}</p>}\n                {isCameraActive && (\n                  <div className=\"overflow-hidden rounded-2xl border border-white/20 bg-black/30 shadow-[0_18px_40px_rgba(124,58,237,0.35)]\">\n                    <video\n                      ref={videoRef}\n                      autoPlay\n                      playsInline\n                      muted\n                      className=\"h-48 w-full object-cover sm:h-64\"\n                    />\n                  </div>\n                )}\n              </div>\n\n              {storyDraft.length > 0 && (\n                <div className=\"grid gap-4 sm:grid-cols-2\">\n                  {storyDraft.map((item) => (\n                    <div\n                      key={item.id}\n                      className=\"group relative overflow-hidden rounded-2xl border border-white/15 bg-white/5 backdrop-blur-sm shadow-[0_18px_40px_rgba(124,58,237,0.35)]\"\n                    >\n                      {item.type === 'image' ? (\n                        <ImageWithFallback\n                          src={item.url}\n                          alt=\"Story preview\"\n                          className=\"h-48 w-full object-cover sm:h-56\"\n                        />\n                      ) : (\n                        <video\n                          src={item.url}\n                          className=\"h-48 w-full object-cover sm:h-56\"\n                          controls\n                          playsInline\n                          muted\n                        />\n                      )}\n                      <div className=\"absolute inset-x-0 bottom-0 flex items-center justify-between gap-2 bg-gradient-to-t from-black/80 via-black/40 to-transparent px-4 py-3 text-sm\">\n                        <span className=\"text-white/80 capitalize\">{item.type}</span>\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleRemoveDraftItem(item.id)}\n                          className=\"text-white/80 transition-colors duration-200 hover:text-white hover:bg-white/15\"\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {creationError && <p className=\"text-sm text-rose-200\">{creationError}</p>}\n\n              <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n                <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:gap-6\">\n                  {currentUser && (\n                    <div className=\"flex items-center gap-3\">\n                      <Avatar className=\"h-10 w-10 border border-white/25\">\n                        <AvatarImage src={currentUser.avatar} />\n                        <AvatarFallback>{currentUser.name[0]}</AvatarFallback>\n                      </Avatar>\n                      <div>\n                        <p className=\"text-sm font-medium text-white\">{currentUser.name}</p>\n                        <p className=\"text-xs text-white/60\">@{currentUser.username}</p>\n                      </div>\n                    </div>\n                  )}\n                  <div className=\"h-px w-full bg-white/10 sm:hidden\" />\n                  <div className=\"hidden sm:block sm:h-14 sm:w-px bg-white/15\" />\n                  <div className=\"min-w-[200px] space-y-1 sm:flex sm:flex-col sm:justify-center sm:space-y-2\">\n                    <p className=\"text-xs uppercase tracking-[0.25em] text-white/50\">Visibility</p>\n                    <Select\n                      value={storyVisibility}\n                      onValueChange={(value) => setStoryVisibility(value as 'friends' | 'public' | 'close_friends')}\n                    >\n                      <SelectTrigger className=\"w-full border-white/20 bg-white/10 text-white hover:bg-white/15\">\n                        <SelectValue placeholder=\"Choose who can view\" />\n                      </SelectTrigger>\n                      <SelectContent className=\"border-white/20 bg-slate-950/95 text-white backdrop-blur\">\n                        {STORY_VISIBILITY_OPTIONS.map((option) => (\n                          <SelectItem key={option.value} value={option.value}>\n                            <div className=\"flex flex-col\">\n                              <span className=\"text-sm font-medium\">{option.label}</span>\n                              <span className=\"text-xs text-white/60\">{option.description}</span>\n                            </div>\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                <div className=\"flex flex-col gap-3 sm:items-end\">\n                  <span className=\"text-xs text-white/60\">\n                    {storyDraft.length} / {MAX_STORY_ITEMS} items selected\n                  </span>\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      type=\"button\"\n                      variant=\"ghost\"\n                      onClick={() => handleCreatorOpenChange(false)}\n                      className=\"text-white/70 hover:text-white hover:bg-white/10\"\n                      disabled={isSubmittingStory}\n                    >\n                      Cancel\n                    </Button>\n                    <Button\n                      type=\"button\"\n                      onClick={() => void handleCreateStory()}\n                      disabled={isSubmittingStory || storyDraft.length === 0}\n                      className=\"bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 px-6 py-2 text-sm font-semibold text-white shadow-[0_15px_40px_rgba(168,85,247,0.45)] transition-all duration-300 hover:brightness-110 disabled:opacity-60\"\n                    >\n                      {isSubmittingStory ? 'Posting...' : 'Share Story'}\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <style>{`\n        .hide-scrollbar {\n          -ms-overflow-style: none;\n          scrollbar-width: none;\n        }\n        .hide-scrollbar::-webkit-scrollbar {\n          display: none;\n        }\n        @keyframes progress {\n          from { width: 0%; }\n          to { width: 100%; }\n        }\n        .animate-progress {\n          animation: progress 5s linear forwards;\n        }\n      `}</style>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}