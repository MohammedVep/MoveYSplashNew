{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohammedvepari/Documents/Algoma%20University/Fall%202025/COSC%204086/move-y-splash-new/src/app/utils/supabase/info.tsx"],"sourcesContent":["/* AUTOGENERATED FILE - DO NOT EDIT CONTENTS */\n\nexport const projectId = \"opmvuhlheenygwbqwljk\"\nexport const publicAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9wbXZ1aGxoZWVueWd3YnF3bGprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2OTkxMjMsImV4cCI6MjA3NjI3NTEyM30.teI8M7lSDyunxTtcltbw8duAGnjJ8P8hgZXbRlDFYb4\""],"names":[],"mappings":"AAAA,6CAA6C;;;;;;AAEtC,MAAM,YAAY;AAClB,MAAM,gBAAgB"}},
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohammedvepari/Documents/Algoma%20University/Fall%202025/COSC%204086/move-y-splash-new/src/app/utils/userContext.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useState, ReactNode, useEffect, useCallback } from 'react';\nimport { useTheme } from 'next-themes';\nimport { projectId, publicAnonKey } from './supabase/info';\nimport { normalizeThemePreference, resolveThemePreference } from '../components/settings-theme';\n\nconst API_BASE_URL = `https://${projectId}.supabase.co/functions/v1/make-server-a14c7986`;\n\nexport interface UserPost {\n  id: string;\n  userId: string;\n  text?: string;\n  media?: Array<{type: 'image' | 'video', url: string}>;\n  likes: number;\n  comments: number;\n  shares: number;\n  timestamp: Date;\n  liked?: boolean;\n  likedBy: string[];\n}\n\nexport interface PostComment {\n  id: string;\n  postId: string;\n  postOwnerId: string;\n  authorId: string;\n  authorName: string;\n  authorAvatar: string;\n  content: string;\n  createdAt: Date;\n}\n\nexport interface Achievement {\n  id: string;\n  name: string;\n  description: string;\n  earnedAt: Date;\n  icon: string;\n  color: string;\n}\n\nexport interface UserSettings {\n  // Privacy\n  profileVisibility: string;\n  whoCanMessage: string;\n  whoCanCall: string;\n  showOnlineStatus: boolean;\n  showReadReceipts: boolean;\n  allowTagging: boolean;\n  \n  // Notifications\n  pushNotifications: boolean;\n  emailNotifications: boolean;\n  smsNotifications: boolean;\n  notifyLikes: boolean;\n  notifyComments: boolean;\n  notifyMessages: boolean;\n  notifyFriendRequests: boolean;\n  notifyStories: boolean;\n  soundEnabled: boolean;\n  soundVolume: number;\n  \n  // Appearance\n  theme: string;\n  language: string;\n  fontSize: string;\n  autoPlayVideos: boolean;\n  reduceAnimations: boolean;\n  \n  // Account\n  phoneNumber: string;\n}\n\nexport interface UserData {\n  id: string;\n  name: string;\n  username: string;\n  email: string;\n  avatar: string;\n  ablyClientId: string;\n  bio: string;\n  location: string;\n  website: string;\n  joinedAt: Date;\n  friendIds: string[];\n  blockedIds: string[];\n  savedPostIds: string[];\n  posts: UserPost[];\n  achievements: Achievement[];\n  settings: UserSettings;\n}\n\nexport interface UserContextType {\n  currentUser: UserData | null;\n  profileUser: UserData | null;\n  profileUserId: string | null;\n  allUsers: Map<string, UserData>;\n  updateUser: (userData: Partial<UserData>) => Promise<boolean>;\n  updateSettings: (settings: Partial<UserSettings>) => Promise<void>;\n  changePassword: (oldPassword: string, newPassword: string) => Promise<{ success: boolean; error?: string }>;\n  addPost: (post: Omit<UserPost, 'id' | 'userId' | 'timestamp' | 'likes' | 'comments' | 'shares' | 'likedBy'>) => Promise<void>;\n  deletePost: (postId: string) => Promise<void>;\n  likePost: (postId: string, userId: string) => Promise<void>;\n  sharePost: (\n    postOwnerId: string,\n    postId: string,\n    options: {\n      platform: string;\n      sharerUserId?: string;\n      message?: string;\n    }\n  ) => Promise<number | null>;\n  toggleSavePost: (postOwnerId: string, postId: string) => Promise<boolean>;\n  fetchComments: (postOwnerId: string, postId: string) => Promise<PostComment[]>;\n  addComment: (\n    postOwnerId: string,\n    postId: string,\n    content: string\n  ) => Promise<{ comment: PostComment; totalComments: number } | null>;\n  addFriend: (friendId: string) => Promise<boolean>;\n  removeFriend: (friendId: string) => Promise<boolean>;\n  blockUser: (userId: string) => Promise<boolean>;\n  unblockUser: (userId: string) => Promise<boolean>;\n  refreshAllUsers: () => Promise<void>;\n  getUserStats: () => {\n    totalPosts: number;\n    totalFriends: number;\n    totalLikes: number;\n    rank: number;\n  };\n  getAchievements: () => Achievement[];\n  login: (email: string, password: string) => Promise<boolean>;\n  signup: (name: string, email: string, password: string, birthdate: string) => Promise<boolean>;\n  logout: () => void;\n  loadUserData: (userId: string) => Promise<boolean>;\n  loadProfileUser: (userId: string | null) => Promise<boolean>;\n}\n\nconst UserContext = createContext<UserContextType | undefined>(undefined);\n\nexport function useUser() {\n  const context = useContext(UserContext);\n  if (context === undefined) {\n    throw new Error('useUser must be used within a UserProvider');\n  }\n  return context;\n}\n\n// Default settings\nexport const defaultSettings: UserSettings = {\n  profileVisibility: 'public',\n  whoCanMessage: 'everyone',\n  whoCanCall: 'friends',\n  showOnlineStatus: true,\n  showReadReceipts: true,\n  allowTagging: true,\n  pushNotifications: true,\n  emailNotifications: true,\n  smsNotifications: false,\n  notifyLikes: true,\n  notifyComments: true,\n  notifyMessages: true,\n  notifyFriendRequests: true,\n  notifyStories: false,\n  soundEnabled: true,\n  soundVolume: 75,\n  theme: 'dark',\n  language: 'en',\n  fontSize: 'medium',\n  autoPlayVideos: true,\n  reduceAnimations: false,\n  phoneNumber: ''\n};\n\nconst FONT_SIZE_SCALE: Record<'small' | 'medium' | 'large', string> = {\n  small: '14px',\n  medium: '16px',\n  large: '18px'\n};\n\nexport const resolveFontSizePreference = (value?: string): 'small' | 'medium' | 'large' => {\n  if (value === 'small') {\n    return 'small';\n  }\n  if (value === 'medium') {\n    return 'medium';\n  }\n  return 'large';\n};\n\nconst sanitizeSettings = (settings: Partial<UserSettings>): Partial<UserSettings> => {\n  const sanitized: Partial<UserSettings> = { ...settings };\n\n  if (sanitized.theme) {\n    sanitized.theme = normalizeThemePreference(sanitized.theme);\n  }\n\n  if (sanitized.fontSize) {\n    sanitized.fontSize = resolveFontSizePreference(sanitized.fontSize);\n  }\n\n  if (sanitized.language) {\n    sanitized.language = 'en';\n  }\n\n  return sanitized;\n};\n\nconst mergeWithDefaultSettings = (settings?: Partial<UserSettings>): UserSettings => ({\n  ...defaultSettings,\n  ...sanitizeSettings(settings ?? {})\n});\n\ninterface ServerUser {\n  id: string;\n  ablyClientId?: string;\n  name: string;\n  username: string;\n  email: string;\n  avatar: string;\n  bio?: string;\n  location?: string;\n  website?: string;\n  joinedAt?: string;\n  friendIds?: string[];\n  blockedIds?: string[];\n  savedPostIds?: string[];\n}\n\nconst normalizeServerUser = (user: ServerUser): UserData => {\n  const joinedAt = user.joinedAt ? new Date(user.joinedAt) : new Date();\n\n  return {\n    id: user.id,\n    ablyClientId: user.ablyClientId ?? user.id,\n    name: user.name,\n    username: user.username,\n    email: user.email,\n    avatar: user.avatar,\n    bio: user.bio ?? '',\n    location: user.location ?? '',\n    website: user.website ?? '',\n    joinedAt,\n    friendIds: Array.isArray(user.friendIds) ? user.friendIds : [],\n    blockedIds: Array.isArray(user.blockedIds) ? user.blockedIds : [],\n    savedPostIds: Array.isArray(user.savedPostIds)\n      ? user.savedPostIds.filter((value): value is string => typeof value === 'string')\n      : [],\n    posts: [],\n    achievements: [],\n    settings: mergeWithDefaultSettings()\n  };\n};\n\nconst mergeServerUser = (server: ServerUser, fallback?: UserData | null): UserData => {\n  const normalized = normalizeServerUser(server);\n  return {\n    ...normalized,\n    posts: fallback?.posts ?? normalized.posts,\n    achievements: fallback?.achievements ?? normalized.achievements,\n    settings: fallback?.settings ?? normalized.settings,\n  };\n};\n\nconst normalizeComment = (value: unknown, fallbackPostOwnerId: string): PostComment | null => {\n  if (typeof value !== 'object' || value === null) {\n    return null;\n  }\n\n  const record = value as Record<string, unknown>;\n  const idValue = record['id'];\n  const postIdValue = record['postId'];\n  const postOwnerValue = record['postOwnerId'] ?? record['postOwner'] ?? fallbackPostOwnerId;\n  const authorIdValue = record['authorId'];\n\n  if (\n    typeof idValue !== 'string' ||\n    idValue.trim().length === 0 ||\n    typeof postIdValue !== 'string' ||\n    postIdValue.trim().length === 0 ||\n    typeof postOwnerValue !== 'string' ||\n    postOwnerValue.trim().length === 0 ||\n    typeof authorIdValue !== 'string' ||\n    authorIdValue.trim().length === 0\n  ) {\n    return null;\n  }\n\n  const createdAtRaw = record['createdAt'];\n  const createdAt =\n    typeof createdAtRaw === 'string' && createdAtRaw\n      ? new Date(createdAtRaw)\n      : new Date();\n\n  return {\n    id: idValue,\n    postId: postIdValue,\n    postOwnerId: postOwnerValue,\n    authorId: authorIdValue,\n    authorName:\n      typeof record['authorName'] === 'string' && record['authorName']\n        ? record['authorName']\n        : 'Unknown user',\n    authorAvatar:\n      typeof record['authorAvatar'] === 'string' ? record['authorAvatar'] ?? '' : '',\n    content: typeof record['content'] === 'string' ? record['content'] : '',\n    createdAt,\n  };\n};\n\nexport function UserProvider({ children }: { children: ReactNode }) {\n  const [currentUser, setCurrentUser] = useState<UserData | null>(null);\n  const [allUsers, setAllUsers] = useState<Map<string, UserData>>(new Map());\n  const [profileUserId, setProfileUserId] = useState<string | null>(null);\n  const [profileUser, setProfileUser] = useState<UserData | null>(null);\n  const { setTheme } = useTheme();\n\n  // Load user directory from Supabase so all profile data reflects persisted state\n  useEffect(() => {\n    const fetchUsers = async () => {\n      try {\n        const response = await fetch(`${API_BASE_URL}/users`, {\n          headers: {\n            'Authorization': `Bearer ${publicAnonKey}`\n          }\n        });\n\n        if (!response.ok) {\n          console.error('Failed to load users from Supabase');\n          return;\n        }\n\n        const { users: serverUsers } = await response.json() as { users: ServerUser[] };\n\n        setAllUsers(prev => {\n          const updated = new Map(prev);\n\n          serverUsers.forEach(serverUser => {\n            const normalized = normalizeServerUser(serverUser);\n            const existing = prev.get(serverUser.id) ?? (normalized.ablyClientId ? prev.get(normalized.ablyClientId) : undefined);\n            const mergedUser = existing\n              ? {\n                  ...normalized,\n                  posts: existing.posts,\n                  achievements: existing.achievements,\n                  settings: mergeWithDefaultSettings(existing.settings)\n                }\n              : normalized;\n\n            updated.set(mergedUser.id, mergedUser);\n            if (mergedUser.ablyClientId && mergedUser.ablyClientId !== mergedUser.id) {\n              updated.set(mergedUser.ablyClientId, mergedUser);\n            }\n          });\n\n          return updated;\n        });\n      } catch (error) {\n        console.error('Error loading users from Supabase:', error);\n      }\n    };\n\n    fetchUsers();\n  }, []);\n\n  useEffect(() => {\n    const preference = normalizeThemePreference(currentUser?.settings?.theme ?? defaultSettings.theme);\n    const applyTheme = () => {\n      setTheme(resolveThemePreference(preference));\n    };\n\n    applyTheme();\n\n    if (preference === 'dynamic') {\n      const interval = setInterval(applyTheme, 10 * 60 * 1000);\n      return () => clearInterval(interval);\n    }\n\n    return undefined;\n  }, [currentUser?.settings?.theme, setTheme]);\n\n  useEffect(() => {\n    const resolvedPreference = resolveFontSizePreference(currentUser?.settings?.fontSize ?? defaultSettings.fontSize);\n    const root = typeof document !== 'undefined' ? document.documentElement : null;\n\n    if (root) {\n      root.style.setProperty('--font-size', FONT_SIZE_SCALE[resolvedPreference]);\n    }\n  }, [currentUser?.settings?.fontSize]);\n\n  useEffect(() => {\n    if (!currentUser) {\n      setProfileUserId(null);\n      setProfileUser(null);\n      return;\n    }\n\n    if (!profileUserId || profileUserId === currentUser.id) {\n      setProfileUserId(currentUser.id);\n      setProfileUser(currentUser);\n    }\n  }, [currentUser, profileUserId]);\n\n  // Calculate achievements based on merit\n  const calculateAchievements = useCallback((user: UserData): Achievement[] => {\n    const achievements: Achievement[] = [];\n    const now = new Date();\n    const accountAge = now.getTime() - user.joinedAt.getTime();\n    const daysOld = accountAge / (1000 * 60 * 60 * 24);\n\n    // Early Adopter - joined within first 3 months\n    const firstUsers = Array.from(allUsers.values()).sort((a, b) => \n      a.joinedAt.getTime() - b.joinedAt.getTime()\n    ).slice(0, 100);\n    if (firstUsers.some(u => u.id === user.id)) {\n      achievements.push({\n        id: 'early-adopter',\n        name: 'Early Adopter',\n        description: 'One of the first 100 users on MoveSplash',\n        earnedAt: user.joinedAt,\n        icon: 'Award',\n        color: 'from-purple-500 to-pink-500'\n      });\n    }\n\n    // Top Contributor - 50+ posts\n    if (user.posts.length >= 50) {\n      achievements.push({\n        id: 'top-contributor',\n        name: 'Top Contributor',\n        description: 'Created over 50 posts',\n        earnedAt: user.posts[49]?.timestamp || now,\n        icon: 'TrendingUp',\n        color: 'from-orange-500 to-yellow-500'\n      });\n    }\n\n    // Story Master - 30+ posts with media\n    const postsWithMedia = user.posts.filter(p => p.media && p.media.length > 0);\n    if (postsWithMedia.length >= 30) {\n      achievements.push({\n        id: 'story-master',\n        name: 'Story Master',\n        description: 'Shared 30+ posts with photos or videos',\n        earnedAt: postsWithMedia[29]?.timestamp || now,\n        icon: 'Camera',\n        color: 'from-blue-500 to-cyan-500'\n      });\n    }\n\n    // Super Friend - 100+ friends\n    if (user.friendIds.length >= 100) {\n      achievements.push({\n        id: 'super-friend',\n        name: 'Super Friend',\n        description: 'Connected with over 100 friends',\n        earnedAt: now,\n        icon: 'Users',\n        color: 'from-green-500 to-emerald-500'\n      });\n    }\n\n    // Rising Star - 1000+ total likes\n    const totalLikes = user.posts.reduce((sum, post) => sum + post.likes, 0);\n    if (totalLikes >= 1000) {\n      achievements.push({\n        id: 'rising-star',\n        name: 'Rising Star',\n        description: 'Received over 1000 likes',\n        earnedAt: now,\n        icon: 'Star',\n        color: 'from-yellow-500 to-orange-500'\n      });\n    }\n\n    // Conversation Starter - 500+ total comments\n    const totalComments = user.posts.reduce((sum, post) => sum + post.comments, 0);\n    if (totalComments >= 500) {\n      achievements.push({\n        id: 'conversation-starter',\n        name: 'Conversation Starter',\n        description: 'Generated over 500 comments',\n        earnedAt: now,\n        icon: 'MessageCircle',\n        color: 'from-cyan-500 to-blue-500'\n      });\n    }\n\n    // Viral Creator - any post with 500+ likes\n    if (user.posts.some(p => p.likes >= 500)) {\n      achievements.push({\n        id: 'viral-creator',\n        name: 'Viral Creator',\n        description: 'Created a post with 500+ likes',\n        earnedAt: user.posts.find(p => p.likes >= 500)?.timestamp || now,\n        icon: 'Zap',\n        color: 'from-pink-500 to-purple-500'\n      });\n    }\n\n    // Consistent Creator - posted for 30+ days\n    if (daysOld >= 30 && user.posts.length >= 30) {\n      achievements.push({\n        id: 'consistent-creator',\n        name: 'Consistent Creator',\n        description: 'Posted consistently for 30+ days',\n        earnedAt: now,\n        icon: 'Calendar',\n        color: 'from-indigo-500 to-purple-500'\n      });\n    }\n\n    return achievements;\n  }, [allUsers]);\n\n  // Update achievements for current user\n  useEffect(() => {\n    if (!currentUser) {\n      return;\n    }\n\n    const achievements = calculateAchievements(currentUser);\n    const existing = currentUser.achievements;\n    const isSame =\n      existing.length === achievements.length &&\n      existing.every((achievement, index) => achievement.id === achievements[index]?.id);\n\n    if (isSame) {\n      return;\n    }\n\n    setCurrentUser(prev => (prev ? { ...prev, achievements } : null));\n    setAllUsers(prev => {\n      const newMap = new Map(prev);\n      const entry = newMap.get(currentUser.id);\n      if (entry) {\n        const updatedEntry = { ...entry, achievements };\n        newMap.set(currentUser.id, updatedEntry);\n        if (entry.ablyClientId && entry.ablyClientId !== entry.id) {\n          newMap.set(entry.ablyClientId, updatedEntry);\n        }\n      }\n      return newMap;\n    });\n  }, [currentUser, calculateAchievements]);\n\n  const updateUser = async (userData: Partial<UserData>) => {\n    if (!currentUser) {\n      return false;\n    }\n\n    const previousUser = currentUser;\n    const updated = { ...currentUser, ...userData };\n\n    setCurrentUser(updated);\n    setAllUsers(prev => {\n      const newMap = new Map(prev);\n      newMap.set(updated.id, updated);\n      if (updated.ablyClientId && updated.ablyClientId !== updated.id) {\n        newMap.set(updated.ablyClientId, updated);\n      }\n      return newMap;\n    });\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/users/${updated.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${publicAnonKey}`\n        },\n        body: JSON.stringify({\n          name: updated.name,\n          username: updated.username,\n          email: updated.email,\n          avatar: updated.avatar,\n          bio: updated.bio,\n          location: updated.location,\n          website: updated.website,\n          joinedAt: updated.joinedAt.toISOString(),\n          friendIds: updated.friendIds,\n          blockedIds: updated.blockedIds\n        })\n      });\n\n      const payload = await response.json().catch(() => null);\n\n      if (!response.ok || !payload?.user) {\n        console.error('Failed to sync user data to server');\n        setCurrentUser(previousUser);\n        setAllUsers(prev => {\n          const newMap = new Map(prev);\n          newMap.set(previousUser.id, previousUser);\n          if (previousUser.ablyClientId && previousUser.ablyClientId !== previousUser.id) {\n            newMap.set(previousUser.ablyClientId, previousUser);\n          }\n          return newMap;\n        });\n        return false;\n      }\n\n      const serverUser = payload.user as ServerUser & { joinedAt?: string };\n      const normalized = normalizeServerUser(serverUser);\n      const mergedUser: UserData = {\n        ...updated,\n        name: normalized.name,\n        username: normalized.username,\n        email: normalized.email,\n        avatar: normalized.avatar,\n        bio: normalized.bio,\n        location: normalized.location,\n        website: normalized.website,\n        joinedAt: normalized.joinedAt,\n        friendIds: normalized.friendIds,\n        blockedIds: normalized.blockedIds\n      };\n\n      setCurrentUser(mergedUser);\n      setAllUsers(prev => {\n        const newMap = new Map(prev);\n        newMap.set(mergedUser.id, mergedUser);\n        if (mergedUser.ablyClientId && mergedUser.ablyClientId !== mergedUser.id) {\n          newMap.set(mergedUser.ablyClientId, mergedUser);\n        }\n        return newMap;\n      });\n\n      return true;\n    } catch (error) {\n      console.error('Error syncing user data:', error);\n      setCurrentUser(previousUser);\n      setAllUsers(prev => {\n        const newMap = new Map(prev);\n        newMap.set(previousUser.id, previousUser);\n        if (previousUser.ablyClientId && previousUser.ablyClientId !== previousUser.id) {\n          newMap.set(previousUser.ablyClientId, previousUser);\n        }\n        return newMap;\n      });\n      return false;\n    }\n  };\n\n  const updateSettings = async (settings: Partial<UserSettings>) => {\n    if (currentUser) {\n      const sanitized = sanitizeSettings(settings);\n      const updatedSettings = { ...currentUser.settings, ...sanitized };\n      const updated = { ...currentUser, settings: updatedSettings };\n      setCurrentUser(updated);\n      setAllUsers(prev => {\n        const newMap = new Map(prev);\n        newMap.set(updated.id, updated);\n        return newMap;\n      });\n\n      // Sync to Supabase\n      try {\n        const response = await fetch(`${API_BASE_URL}/users/${currentUser.id}/settings`, {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${publicAnonKey}`\n          },\n          body: JSON.stringify(updatedSettings)\n        });\n\n        if (!response.ok) {\n          console.error('Failed to sync settings to server');\n        }\n      } catch (error) {\n        console.error('Error syncing settings:', error);\n      }\n    }\n  };\n\n  const changePassword = async (\n    oldPassword: string,\n    newPassword: string\n  ): Promise<{ success: boolean; error?: string }> => {\n    if (!currentUser) {\n      return { success: false, error: 'No user is signed in' };\n    }\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/auth/change-password`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${publicAnonKey}`\n        },\n        body: JSON.stringify({\n          userId: currentUser.id,\n          oldPassword,\n          newPassword\n        })\n      });\n\n      const payload = (await response.json().catch(() => ({}))) as { success?: boolean; error?: string };\n\n      if (!response.ok || payload?.success !== true) {\n        const errorMessage =\n          typeof payload?.error === 'string' && payload.error.trim().length > 0\n            ? payload.error\n            : 'Unable to change password right now';\n        return { success: false, error: errorMessage };\n      }\n\n      return { success: true };\n    } catch (error) {\n      console.error('Error changing password:', error);\n      return { success: false, error: 'Unexpected error while updating password' };\n    }\n  };\n\n  const addPost = async (post: Omit<UserPost, 'id' | 'userId' | 'timestamp' | 'likes' | 'comments' | 'shares' | 'likedBy'>) => {\n    if (currentUser) {\n      const newPost: UserPost = {\n        ...post,\n        id: `${currentUser.id}-post-${Date.now()}`,\n        userId: currentUser.id,\n        timestamp: new Date(),\n        likes: 0,\n        comments: 0,\n        shares: 0,\n        likedBy: []\n      };\n\n      const updatedUser = {\n        ...currentUser,\n        posts: [newPost, ...currentUser.posts]\n      };\n\n      setCurrentUser(updatedUser);\n      setAllUsers(prev => {\n        const newMap = new Map(prev);\n        newMap.set(updatedUser.id, updatedUser);\n        return newMap;\n      });\n\n      // Sync to Supabase\n      try {\n        await fetch(`${API_BASE_URL}/posts`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${publicAnonKey}`\n          },\n          body: JSON.stringify({\n            userId: currentUser.id,\n            text: post.text,\n            media: post.media\n          })\n        });\n      } catch (error) {\n        console.error('Error syncing post:', error);\n      }\n    }\n  };\n\n  const deletePost = async (postId: string) => {\n    if (currentUser) {\n      const updatedUser = {\n        ...currentUser,\n        posts: currentUser.posts.filter(p => p.id !== postId)\n      };\n\n      setCurrentUser(updatedUser);\n      setAllUsers(prev => {\n        const newMap = new Map(prev);\n        newMap.set(updatedUser.id, updatedUser);\n        return newMap;\n      });\n\n      // Sync to Supabase\n      try {\n        await fetch(`${API_BASE_URL}/posts/${currentUser.id}/${postId}`, {\n          method: 'DELETE',\n          headers: {\n            'Authorization': `Bearer ${publicAnonKey}`\n          }\n        });\n      } catch (error) {\n        console.error('Error deleting post:', error);\n      }\n    }\n  };\n\n  const likePost = async (postId: string, userId: string) => {\n    let nextProfileUser: UserData | null = null;\n\n    setAllUsers(prev => {\n      const newMap = new Map(prev);\n      newMap.forEach((user, id) => {\n        const postIndex = user.posts.findIndex(p => p.id === postId);\n        if (postIndex !== -1) {\n          const post = user.posts[postIndex];\n          const hasLiked = post.likedBy.includes(userId);\n          \n          const updatedPost = {\n            ...post,\n            likes: hasLiked ? post.likes - 1 : post.likes + 1,\n            likedBy: hasLiked \n              ? post.likedBy.filter(id => id !== userId)\n              : [...post.likedBy, userId]\n          };\n\n          const updatedPosts = [...user.posts];\n          updatedPosts[postIndex] = updatedPost;\n\n          const updatedUser = { ...user, posts: updatedPosts };\n          newMap.set(id, updatedUser);\n\n          if (currentUser && id === currentUser.id) {\n            setCurrentUser(updatedUser);\n          }\n\n          if (profileUserId && (id === profileUserId || user.ablyClientId === profileUserId)) {\n            nextProfileUser = updatedUser;\n          }\n\n          // Sync to Supabase\n          fetch(`${API_BASE_URL}/posts/${user.id}/${postId}/like`, {\n            method: 'PUT',\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${publicAnonKey}`\n            },\n            body: JSON.stringify({ likerUserId: userId })\n          }).catch(error => console.error('Error syncing like:', error));\n        }\n      });\n      return newMap;\n    });\n\n    if (nextProfileUser) {\n      setProfileUser(nextProfileUser);\n    }\n  };\n\n  const sharePost = async (\n    postOwnerId: string,\n    postId: string,\n    options: { platform: string; sharerUserId?: string; message?: string }\n  ): Promise<number | null> => {\n    const payloadBody = {\n      platform: options.platform,\n      sharerUserId: options.sharerUserId ?? currentUser?.id ?? '',\n      message: options.message ?? ''\n    };\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/posts/${postOwnerId}/${postId}/share`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${publicAnonKey}`\n        },\n        body: JSON.stringify(payloadBody)\n      });\n\n      let payload = await response.json().catch(() => null);\n\n      if (!response.ok || !payload?.post) {\n        if (response.status !== 404) {\n          const errorMessage = payload?.error ?? `status ${response.status}`;\n          console.error('Error recording share:', errorMessage);\n          return null;\n        }\n\n        // Fallback to legacy dynamic route\n        const fallbackResponse = await fetch(`${API_BASE_URL}/shares`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${publicAnonKey}`\n          },\n          body: JSON.stringify({\n            ...payloadBody,\n            postOwnerId,\n            postId\n          })\n        });\n\n        payload = await fallbackResponse.json().catch(() => null);\n\n        if (!fallbackResponse.ok || !payload?.post) {\n          const errorMessage = payload?.error ?? `status ${fallbackResponse.status}`;\n          console.error('Error recording share (fallback):', errorMessage);\n          return null;\n        }\n      }\n\n      const postRecord = payload.post as Record<string, unknown>;\n      const totalSharesValue = postRecord?.['shares'];\n      const totalShares =\n        typeof totalSharesValue === 'number' && Number.isFinite(totalSharesValue)\n          ? totalSharesValue\n          : null;\n\n      let resolvedShares = totalShares;\n      let updatedOwnerSnapshot: UserData | null = null;\n      let nextProfileUser: UserData | null = null;\n\n      setAllUsers(prev => {\n        const newMap = new Map(prev);\n        const owner = newMap.get(postOwnerId);\n        if (!owner) {\n          return prev;\n        }\n\n        const postIndex = owner.posts.findIndex(post => post.id === postId);\n        if (postIndex === -1) {\n          return prev;\n        }\n\n        const updatedPosts = [...owner.posts];\n        const existingPost = updatedPosts[postIndex];\n        const nextShares = totalShares ?? existingPost.shares + 1;\n        resolvedShares = nextShares;\n        updatedPosts[postIndex] = {\n          ...existingPost,\n          shares: nextShares\n        };\n\n        const updatedOwner = { ...owner, posts: updatedPosts };\n        updatedOwnerSnapshot = updatedOwner;\n\n        newMap.set(updatedOwner.id, updatedOwner);\n        if (updatedOwner.ablyClientId && updatedOwner.ablyClientId !== updatedOwner.id) {\n          newMap.set(updatedOwner.ablyClientId, updatedOwner);\n        }\n\n        if (\n          profileUserId &&\n          (updatedOwner.id === profileUserId || updatedOwner.ablyClientId === profileUserId)\n        ) {\n          nextProfileUser = updatedOwner;\n        }\n\n        return newMap;\n      });\n\n      const ownerSnapshot = updatedOwnerSnapshot as UserData | null;\n      const ownerId = ownerSnapshot ? ownerSnapshot.id : null;\n      if (ownerSnapshot && ownerId && currentUser && currentUser.id === ownerId) {\n        setCurrentUser(ownerSnapshot);\n      }\n\n      if (nextProfileUser) {\n        setProfileUser(nextProfileUser);\n      }\n\n      return resolvedShares ?? totalShares ?? null;\n    } catch (error) {\n      console.error('Error sharing post:', error);\n      return null;\n    }\n  };\n\n  const toggleSavePost = async (postOwnerId: string, postId: string): Promise<boolean> => {\n    if (!currentUser) {\n      console.warn('toggleSavePost requires a logged-in user');\n      throw new Error('User must be signed in to save posts');\n    }\n\n    const activeUser = currentUser;\n    const userId = activeUser.id;\n    const bookmarkKey = `${postOwnerId}:${postId}`;\n    const previousSaved = Array.isArray(activeUser.savedPostIds) ? activeUser.savedPostIds : [];\n    const hasSaved = previousSaved.includes(bookmarkKey);\n    const optimisticSaved = hasSaved\n      ? previousSaved.filter((value) => value !== bookmarkKey)\n      : [...previousSaved, bookmarkKey];\n\n    const applySavedPostIds = (savedPostIds: string[]) => {\n      setCurrentUser((prev) => (prev && prev.id === userId ? { ...prev, savedPostIds } : prev));\n\n      setAllUsers((prev) => {\n        const next = new Map(prev);\n        const base = next.get(userId) ?? (activeUser && activeUser.id === userId ? activeUser : null);\n        if (base) {\n          const updated = { ...base, savedPostIds };\n          next.set(base.id, updated);\n          if (base.ablyClientId && base.ablyClientId !== base.id) {\n            next.set(base.ablyClientId, updated);\n          }\n        }\n        return next;\n      });\n\n      setProfileUser((prev) => {\n        if (!prev) {\n          return prev;\n        }\n        if (prev.id === userId || prev.ablyClientId === userId) {\n          return { ...prev, savedPostIds };\n        }\n        return prev;\n      });\n    };\n\n    applySavedPostIds(optimisticSaved);\n\n    type BookmarkResponse = {\n      success?: boolean;\n      error?: string;\n      savedPostIds?: unknown;\n    };\n\n    const parseSavedIds = (value: unknown): string[] =>\n      Array.isArray(value)\n        ? value.filter((entry): entry is string => typeof entry === 'string')\n        : optimisticSaved;\n\n    const sendBookmarkRequest = async (\n      endpoint: string,\n      body: Record<string, unknown>,\n    ): Promise<string[]> => {\n      const response = await fetch(endpoint, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${publicAnonKey}`,\n        },\n        body: JSON.stringify(body),\n      });\n\n      const payload = (await response.json().catch(() => null)) as BookmarkResponse | null;\n      if (!response.ok || !payload?.success) {\n        const error = new Error(payload?.error ?? `status ${response.status}`) as Error & {\n          status?: number;\n        };\n        error.status = response.status;\n        throw error;\n      }\n\n      return parseSavedIds(payload.savedPostIds);\n    };\n\n    const persistSavedPostIds = async (savedPostIds: string[]): Promise<string[]> => {\n      const response = await fetch(`${API_BASE_URL}/users/${userId}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${publicAnonKey}`,\n        },\n        body: JSON.stringify({ savedPostIds }),\n      });\n\n      const payload = (await response.json().catch(() => null)) as\n        | { success?: boolean; error?: string; user?: { savedPostIds?: unknown } }\n        | null;\n\n      if (!response.ok || !payload?.user) {\n        const errorMessage = payload?.error ?? `status ${response.status}`;\n        const error = new Error(errorMessage) as Error & { status?: number };\n        error.status = response.status;\n        throw error;\n      }\n\n      return parseSavedIds(payload.user.savedPostIds);\n    };\n\n    try {\n      const savedIds = await sendBookmarkRequest(\n        `${API_BASE_URL}/posts/${postOwnerId}/${postId}/bookmark`,\n        { userId },\n      );\n      applySavedPostIds(savedIds);\n      return savedIds.includes(bookmarkKey);\n    } catch (primaryError) {\n      const withStatus = primaryError as Error & { status?: number };\n      if (withStatus.status === 404 || withStatus.status === 405) {\n        try {\n          const savedIds = await sendBookmarkRequest(`${API_BASE_URL}/bookmarks`, {\n            userId,\n            postOwnerId,\n            postId,\n          });\n          applySavedPostIds(savedIds);\n          return savedIds.includes(bookmarkKey);\n        } catch (fallbackError) {\n          const fallbackWithStatus = fallbackError as Error & { status?: number };\n          if (fallbackWithStatus.status === 404 || fallbackWithStatus.status === 405) {\n            try {\n              const savedIds = await persistSavedPostIds(optimisticSaved);\n              applySavedPostIds(savedIds);\n              return savedIds.includes(bookmarkKey);\n            } catch (persistError) {\n              applySavedPostIds(previousSaved);\n              console.error('Error persisting saved posts via user update:', persistError);\n              throw persistError instanceof Error ? persistError : new Error(String(persistError));\n            }\n          }\n\n          applySavedPostIds(previousSaved);\n          console.error('Error toggling saved post (fallback):', fallbackError);\n          throw fallbackError instanceof Error ? fallbackError : new Error(String(fallbackError));\n        }\n      }\n\n      applySavedPostIds(previousSaved);\n      console.error('Error toggling saved post:', primaryError);\n      throw primaryError instanceof Error ? primaryError : new Error(String(primaryError));\n    }\n  };\n\n  const fetchComments = async (postOwnerId: string, postId: string): Promise<PostComment[]> => {\n    const headers = {\n      'Authorization': `Bearer ${publicAnonKey}`\n    };\n\n    const parseResponse = async (response: Response): Promise<PostComment[]> => {\n      const payload = await response.json().catch(() => null);\n      if (!response.ok) {\n        const errorMessage = payload?.error ?? `status ${response.status}`;\n        throw new Error(errorMessage);\n      }\n\n      const rawComments = Array.isArray(payload?.comments) ? payload.comments : [];\n\n      return rawComments\n        .map((comment: unknown) => normalizeComment(comment, postOwnerId))\n        .filter(\n          (comment: PostComment | null): comment is PostComment => Boolean(comment)\n        )\n        .sort(\n          (a: PostComment, b: PostComment) =>\n            a.createdAt.getTime() - b.createdAt.getTime()\n        );\n    };\n\n    try {\n      const primaryQuery = new URLSearchParams({\n        ownerId: postOwnerId,\n        postId\n      });\n\n      const primaryResponse = await fetch(`${API_BASE_URL}/comments?${primaryQuery.toString()}`, {\n        headers\n      });\n\n      try {\n        return await parseResponse(primaryResponse);\n      } catch (primaryError) {\n        if (primaryResponse.status !== 404) {\n          throw primaryError instanceof Error ? primaryError : new Error(String(primaryError));\n        }\n        // Fallback to legacy dynamic route\n        const fallbackResponse = await fetch(`${API_BASE_URL}/posts/${postOwnerId}/${postId}/comments`, {\n          headers\n        });\n        return await parseResponse(fallbackResponse);\n      }\n    } catch (error) {\n      console.error('Error fetching comments:', error);\n      return [];\n    }\n  };\n\n  const addComment = async (\n    postOwnerId: string,\n    postId: string,\n    content: string\n  ): Promise<{ comment: PostComment; totalComments: number } | null> => {\n    if (!currentUser) {\n      console.warn('addComment requires a logged-in user');\n      return null;\n    }\n\n    const trimmed = content.trim();\n    if (!trimmed) {\n      return null;\n    }\n\n    try {\n      const primaryResponse = await fetch(`${API_BASE_URL}/comments`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${publicAnonKey}`\n        },\n        body: JSON.stringify({\n          postOwnerId,\n          postId,\n          authorId: currentUser.id,\n          content: trimmed\n        })\n      });\n\n      let payload = await primaryResponse.json().catch(() => null);\n\n      if (!primaryResponse.ok || !payload?.comment) {\n        if (primaryResponse.status !== 404) {\n          const errorMessage = payload?.error ?? `status ${primaryResponse.status}`;\n          console.error('Error creating comment:', errorMessage);\n          return null;\n        }\n\n        // Fallback to legacy dynamic route\n        const fallbackResponse = await fetch(`${API_BASE_URL}/posts/${postOwnerId}/${postId}/comments`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${publicAnonKey}`\n          },\n          body: JSON.stringify({\n            authorId: currentUser.id,\n            content: trimmed\n          })\n        });\n\n        payload = await fallbackResponse.json().catch(() => null);\n\n        if (!fallbackResponse.ok || !payload?.comment) {\n          const errorMessage = payload?.error ?? `status ${fallbackResponse.status}`;\n          console.error('Error creating comment (fallback):', errorMessage);\n          return null;\n        }\n      }\n\n      const normalizedComment = normalizeComment(payload.comment, postOwnerId);\n      if (!normalizedComment) {\n        return null;\n      }\n\n      const postRecord = payload.post as Record<string, unknown> | undefined;\n      const totalCommentsValue = postRecord?.['comments'];\n      const totalComments =\n        typeof totalCommentsValue === 'number' && Number.isFinite(totalCommentsValue)\n          ? totalCommentsValue\n          : null;\n\n      let resolvedComments = totalComments;\n      let updatedUserSnapshot: UserData | null = null;\n      let nextProfileUser: UserData | null = null;\n\n      setAllUsers(prev => {\n        const newMap = new Map(prev);\n        const owner = newMap.get(postOwnerId);\n        if (!owner) {\n          return prev;\n        }\n\n        const postIndex = owner.posts.findIndex(post => post.id === postId);\n        if (postIndex === -1) {\n          return prev;\n        }\n\n        const updatedPosts = [...owner.posts];\n        const existingPost = updatedPosts[postIndex];\n        const nextComments = totalComments ?? existingPost.comments + 1;\n        resolvedComments = nextComments;\n        updatedPosts[postIndex] = {\n          ...existingPost,\n          comments: nextComments\n        };\n\n        const updatedUser = { ...owner, posts: updatedPosts };\n        updatedUserSnapshot = updatedUser;\n\n        newMap.set(updatedUser.id, updatedUser);\n        if (updatedUser.ablyClientId && updatedUser.ablyClientId !== updatedUser.id) {\n          newMap.set(updatedUser.ablyClientId, updatedUser);\n        }\n\n        if (profileUserId && (updatedUser.id === profileUserId || updatedUser.ablyClientId === profileUserId)) {\n          nextProfileUser = updatedUser;\n        }\n\n        return newMap;\n      });\n\n      const nextSnapshot = updatedUserSnapshot as UserData | null;\n      const nextId = nextSnapshot ? nextSnapshot.id : null;\n      if (nextSnapshot && nextId && currentUser.id === nextId) {\n        setCurrentUser(nextSnapshot);\n      }\n\n      if (nextProfileUser) {\n        setProfileUser(nextProfileUser);\n      }\n\n      const finalCount =\n        resolvedComments !== null && resolvedComments !== undefined\n          ? resolvedComments\n          : (totalComments !== null && totalComments !== undefined ? totalComments : 1);\n\n      return {\n        comment: normalizedComment,\n        totalComments: finalCount\n      };\n    } catch (error) {\n      console.error('Error adding comment:', error);\n      return null;\n    }\n  };\n\n  const addFriend = async (friendId: string): Promise<boolean> => {\n    if (!currentUser || friendId === currentUser.id) {\n      console.warn('addFriend requires a different logged-in user');\n      return false;\n    }\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/friends/${currentUser.id}/${friendId}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${publicAnonKey}`\n        },\n        body: JSON.stringify({\n          actorName: currentUser.name,\n          actorAvatar: currentUser.avatar\n        })\n      });\n\n      const payload = await response.json().catch(() => null);\n\n      if (!response.ok || !payload?.currentUser) {\n        const errorMessage = payload?.error ?? `status ${response.status}`;\n        console.error('Error adding friend:', errorMessage);\n        return false;\n      }\n\n      const mergedCurrent = mergeServerUser(payload.currentUser as ServerUser, currentUser);\n      setCurrentUser(mergedCurrent);\n      setAllUsers(prev => {\n        const next = new Map(prev);\n        next.set(mergedCurrent.id, mergedCurrent);\n        const targetPayload = payload.targetUser as ServerUser | undefined;\n        if (targetPayload) {\n          const existingTarget = prev.get(targetPayload.id);\n          const mergedTarget = mergeServerUser(targetPayload, existingTarget);\n          next.set(mergedTarget.id, mergedTarget);\n        }\n        return next;\n      });\n\n      void refreshAllUsers();\n      return true;\n    } catch (error) {\n      console.error('Error adding friend:', error);\n      return false;\n    }\n  };\n\n  const removeFriend = async (friendId: string): Promise<boolean> => {\n    if (!currentUser || friendId === currentUser.id) {\n      return false;\n    }\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/friends/${currentUser.id}/${friendId}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${publicAnonKey}`\n        }\n      });\n\n      const payload = await response.json().catch(() => null);\n\n      if (!response.ok || !payload?.currentUser) {\n        const errorMessage = payload?.error ?? `status ${response.status}`;\n        console.error('Error removing friend:', errorMessage);\n        return false;\n      }\n\n      const mergedCurrent = mergeServerUser(payload.currentUser as ServerUser, currentUser);\n      setCurrentUser(mergedCurrent);\n      setAllUsers(prev => {\n        const next = new Map(prev);\n        next.set(mergedCurrent.id, mergedCurrent);\n        const targetPayload = payload.targetUser as ServerUser | undefined;\n        if (targetPayload) {\n          const existingTarget = prev.get(targetPayload.id);\n          const mergedTarget = mergeServerUser(targetPayload, existingTarget);\n          next.set(mergedTarget.id, mergedTarget);\n        }\n        return next;\n      });\n\n      void refreshAllUsers();\n      return true;\n    } catch (error) {\n      console.error('Error removing friend:', error);\n      return false;\n    }\n  };\n\n  const blockUser = async (userId: string): Promise<boolean> => {\n    if (!currentUser || userId === currentUser.id) {\n      return false;\n    }\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/blocks/${currentUser.id}/${userId}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${publicAnonKey}`\n        },\n        body: JSON.stringify({})\n      });\n\n      const payload = await response.json().catch(() => null);\n\n      if (!response.ok || !payload?.currentUser) {\n        const errorMessage = payload?.error ?? `status ${response.status}`;\n        console.error('Error blocking user:', errorMessage);\n        return false;\n      }\n\n      const mergedCurrent = mergeServerUser(payload.currentUser as ServerUser, currentUser);\n      setCurrentUser(mergedCurrent);\n      setAllUsers(prev => {\n        const next = new Map(prev);\n        next.set(mergedCurrent.id, mergedCurrent);\n        const targetPayload = payload.targetUser as ServerUser | undefined;\n        if (targetPayload) {\n          const existingTarget = prev.get(targetPayload.id);\n          const mergedTarget = mergeServerUser(targetPayload, existingTarget);\n          next.set(mergedTarget.id, mergedTarget);\n        }\n        return next;\n      });\n\n      void refreshAllUsers();\n      return true;\n    } catch (error) {\n      console.error('Error blocking user:', error);\n      return false;\n    }\n  };\n\n  const unblockUser = async (userId: string): Promise<boolean> => {\n    if (!currentUser || userId === currentUser.id) {\n      return false;\n    }\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/blocks/${currentUser.id}/${userId}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${publicAnonKey}`\n        }\n      });\n\n      const payload = await response.json().catch(() => null);\n\n      if (!response.ok || !payload?.currentUser) {\n        const errorMessage = payload?.error ?? `status ${response.status}`;\n        console.error('Error unblocking user:', errorMessage);\n        return false;\n      }\n\n      const mergedCurrent = mergeServerUser(payload.currentUser as ServerUser, currentUser);\n      setCurrentUser(mergedCurrent);\n      setAllUsers(prev => {\n        const next = new Map(prev);\n        next.set(mergedCurrent.id, mergedCurrent);\n        return next;\n      });\n\n      void refreshAllUsers();\n      return true;\n    } catch (error) {\n      console.error('Error unblocking user:', error);\n      return false;\n    }\n  };\n\n  const getUserStats = () => {\n    if (!currentUser) {\n      return { totalPosts: 0, totalFriends: 0, totalLikes: 0, rank: 0 };\n    }\n\n    const totalPosts = currentUser.posts.length;\n    const totalFriends = currentUser.friendIds.length;\n    const totalLikes = currentUser.posts.reduce((sum, post) => sum + post.likes, 0);\n\n    // Calculate rank based on total engagement\n    const allUsersArray = Array.from(allUsers.values());\n    const rankedUsers = allUsersArray\n      .map(user => ({\n        id: user.id,\n        score: user.posts.length * 10 + \n               user.posts.reduce((sum, post) => sum + post.likes, 0) +\n               user.friendIds.length * 5\n      }))\n      .sort((a, b) => b.score - a.score);\n\n    const rank = rankedUsers.findIndex(u => u.id === currentUser.id) + 1;\n\n    return { totalPosts, totalFriends, totalLikes, rank };\n  };\n\n  const getAchievements = () => {\n    if (!currentUser) return [];\n    return calculateAchievements(currentUser);\n  };\n\n  const fetchUserSnapshot = useCallback(async (userId: string): Promise<UserData | null> => {\n    try {\n      const userResponse = await fetch(`${API_BASE_URL}/users/${userId}`, {\n        headers: {\n          'Authorization': `Bearer ${publicAnonKey}`\n        }\n      });\n\n      if (!userResponse.ok) {\n        return null;\n      }\n\n      const { user: userData } = await userResponse.json() as { user: ServerUser };\n\n      const settingsResponse = await fetch(`${API_BASE_URL}/users/${userId}/settings`, {\n        headers: {\n          'Authorization': `Bearer ${publicAnonKey}`\n        }\n      });\n\n      let settings = mergeWithDefaultSettings();\n      if (settingsResponse.ok) {\n        const { settings: savedSettings } = await settingsResponse.json();\n        settings = mergeWithDefaultSettings(savedSettings);\n      }\n\n      const postsResponse = await fetch(`${API_BASE_URL}/users/${userId}/posts`, {\n        headers: {\n          'Authorization': `Bearer ${publicAnonKey}`\n        }\n      });\n\n      let posts: UserPost[] = [];\n      if (postsResponse.ok) {\n        const { posts: savedPosts } = await postsResponse.json() as {\n          posts: Array<Omit<UserPost, 'timestamp'> & { timestamp: string }>;\n        };\n        posts = savedPosts.map((savedPost) => ({\n          ...savedPost,\n          timestamp: new Date(savedPost.timestamp)\n        }));\n      }\n\n      return {\n        ...userData,\n        ablyClientId: userData.ablyClientId ?? userData.id,\n        bio: userData.bio ?? '',\n        location: userData.location ?? '',\n        website: userData.website ?? '',\n        joinedAt: new Date(userData.joinedAt ?? new Date().toISOString()),\n        friendIds: Array.isArray(userData.friendIds) ? userData.friendIds : [],\n        blockedIds: Array.isArray(userData.blockedIds) ? userData.blockedIds : [],\n        savedPostIds: Array.isArray(userData.savedPostIds)\n          ? userData.savedPostIds.filter((value): value is string => typeof value === 'string')\n          : [],\n        posts,\n        settings,\n        achievements: []\n      };\n    } catch (error) {\n      console.error('Error fetching user snapshot:', error);\n      return null;\n    }\n  }, []);\n\n  const loadUserData = async (userId: string) => {\n    try {\n      const user = await fetchUserSnapshot(userId);\n      if (!user) {\n        return false;\n      }\n\n      setCurrentUser(user);\n      setAllUsers(prev => {\n        const newMap = new Map(prev);\n        newMap.set(user.id, user);\n        if (user.ablyClientId && user.ablyClientId !== user.id) {\n          newMap.set(user.ablyClientId, user);\n        }\n        return newMap;\n      });\n\n      if (!profileUserId || profileUserId === user.id) {\n        setProfileUserId(user.id);\n        setProfileUser(user);\n      }\n\n      return true;\n    } catch (error) {\n      console.error('Error loading user data:', error);\n      return false;\n    }\n  };\n\n  const loadProfileUser = useCallback(async (userId: string | null): Promise<boolean> => {\n    if (!userId) {\n      if (currentUser) {\n        setProfileUserId(currentUser.id);\n        setProfileUser(currentUser);\n        return true;\n      }\n      setProfileUserId(null);\n      setProfileUser(null);\n      return false;\n    }\n\n    if (currentUser && userId === currentUser.id) {\n      setProfileUserId(currentUser.id);\n      setProfileUser(currentUser);\n      return true;\n    }\n\n    const snapshot = await fetchUserSnapshot(userId);\n    if (!snapshot) {\n      return false;\n    }\n\n    setProfileUserId(snapshot.id);\n    setProfileUser(snapshot);\n    setAllUsers(prev => {\n      const next = new Map(prev);\n      next.set(snapshot.id, snapshot);\n      if (snapshot.ablyClientId && snapshot.ablyClientId !== snapshot.id) {\n        next.set(snapshot.ablyClientId, snapshot);\n      }\n      return next;\n    });\n\n    return true;\n  }, [currentUser, fetchUserSnapshot]);\n\n  const refreshAllUsers = useCallback(async (): Promise<void> => {\n    try {\n      const response = await fetch(`${API_BASE_URL}/users`, {\n        headers: {\n          'Authorization': `Bearer ${publicAnonKey}`\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`status ${response.status}`);\n      }\n\n      const payload = await response.json().catch(() => null);\n      const rawUsers = Array.isArray(payload?.users) ? payload.users : [];\n\n      setAllUsers(prev => {\n        const next = new Map<string, UserData>();\n        rawUsers.forEach((rawUser: unknown) => {\n          if (typeof rawUser !== 'object' || rawUser === null) {\n            return;\n          }\n          const serverUser = rawUser as ServerUser;\n          const existing = prev.get(serverUser.id);\n          const merged = mergeServerUser(serverUser, existing);\n          next.set(merged.id, merged);\n          if (merged.ablyClientId && merged.ablyClientId !== merged.id) {\n            next.set(merged.ablyClientId, merged);\n          }\n        });\n        prev.forEach((value, key) => {\n          if (!next.has(key)) {\n            next.set(key, value);\n          }\n        });\n        return next;\n      });\n\n      setCurrentUser(prev => {\n        if (!prev) {\n          return prev;\n        }\n        const serverEntry = rawUsers.find((candidate: unknown) => {\n          return typeof candidate === 'object' && candidate !== null && (candidate as { id?: unknown }).id === prev.id;\n        }) as ServerUser | undefined;\n\n        if (!serverEntry) {\n          return prev;\n        }\n\n        const merged = mergeServerUser(serverEntry, prev);\n        const prevFriendsSorted = [...prev.friendIds].sort();\n        const mergedFriendsSorted = [...merged.friendIds].sort();\n        const sameFriends =\n          prevFriendsSorted.length === mergedFriendsSorted.length &&\n          prevFriendsSorted.every((value, index) => value === mergedFriendsSorted[index]);\n        const prevBlockedSorted = [...prev.blockedIds].sort();\n        const mergedBlockedSorted = [...merged.blockedIds].sort();\n        const sameBlocked =\n          prevBlockedSorted.length === mergedBlockedSorted.length &&\n          prevBlockedSorted.every((value, index) => value === mergedBlockedSorted[index]);\n\n        if (sameFriends && sameBlocked) {\n          return prev;\n        }\n\n        return merged;\n      });\n    } catch (error) {\n      console.error('Error refreshing users:', error);\n    }\n  }, []);\n\n  useEffect(() => {\n    void refreshAllUsers();\n  }, [refreshAllUsers]);\n\n  const login = async (email: string, password: string): Promise<boolean> => {\n    try {\n      console.log('[Login] Attempting login for:', email);\n\n      const response = await fetch(`${API_BASE_URL}/auth/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${publicAnonKey}`\n        },\n        body: JSON.stringify({ email, password })\n      });\n\n      const payload = await response.json().catch(() => null);\n      console.log('[Login] Server response status:', response.status);\n\n      if (!response.ok || !payload?.user) {\n        const errorMessage = payload?.error ?? `status ${response.status}`;\n        console.log('[Login]  Server login failed:', errorMessage);\n        return false;\n      }\n\n      const userData = payload.user as ServerUser;\n      console.log('[Login]  Server login successful for:', userData.name);\n\n      const loaded = await loadUserData(userData.id);\n      if (!loaded) {\n        console.warn('[Login]  Using normalized login payload while Supabase details load');\n        const fallbackUser = normalizeServerUser(userData);\n        setCurrentUser(fallbackUser);\n        setAllUsers(prev => {\n          const newMap = new Map(prev);\n          newMap.set(fallbackUser.id, fallbackUser);\n          if (fallbackUser.ablyClientId && fallbackUser.ablyClientId !== fallbackUser.id) {\n            newMap.set(fallbackUser.ablyClientId, fallbackUser);\n          }\n          return newMap;\n        });\n      }\n\n      return true;\n    } catch (error) {\n      console.error('[Login] Error during login:', error);\n      return false;\n    }\n  };\n\n  const signup = async (name: string, email: string, password: string, birthdate: string): Promise<boolean> => {\n    try {\n      const response = await fetch(`${API_BASE_URL}/auth/register`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${publicAnonKey}`\n        },\n        body: JSON.stringify({ name, email, password, birthdate })\n      });\n\n      const payload = await response.json().catch(() => null);\n\n      if (!response.ok || !payload?.user) {\n        const errorMessage = payload?.error ?? `status ${response.status}`;\n        console.error('Registration failed:', errorMessage);\n        return false;\n      }\n\n      const userData = payload.user as ServerUser;\n      const settingsFromResponse = payload.settings as Partial<UserSettings> | undefined;\n\n      const loaded = await loadUserData(userData.id);\n      if (!loaded) {\n        const fallbackUser = {\n          ...normalizeServerUser(userData),\n          settings: mergeWithDefaultSettings(settingsFromResponse)\n        };\n\n        setCurrentUser(fallbackUser);\n        setAllUsers(prev => {\n          const newMap = new Map(prev);\n          newMap.set(fallbackUser.id, fallbackUser);\n          if (fallbackUser.ablyClientId && fallbackUser.ablyClientId !== fallbackUser.id) {\n            newMap.set(fallbackUser.ablyClientId, fallbackUser);\n          }\n          return newMap;\n        });\n      }\n\n      console.log('User registered successfully:', userData.email);\n      return true;\n    } catch (error) {\n      console.error('Signup error:', error);\n      return false;\n    }\n  };\n\n  const logout = () => {\n    setCurrentUser(null);\n  };\n\n  return (\n    <UserContext.Provider\n      value={{\n        currentUser,\n        profileUser,\n        profileUserId,\n        allUsers,\n        updateUser,\n        updateSettings,\n        changePassword,\n        addPost,\n        deletePost,\n        likePost,\n        sharePost,\n        toggleSavePost,\n        fetchComments,\n        addComment,\n        addFriend,\n        removeFriend,\n        blockUser,\n        unblockUser,\n        refreshAllUsers,\n        getUserStats,\n        getAchievements,\n        login,\n        signup,\n        logout,\n        loadUserData,\n        loadProfileUser\n      }}\n    >\n      {children}\n    </UserContext.Provider>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1529, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohammedvepari/Documents/Algoma%20University/Fall%202025/COSC%204086/move-y-splash-new/src/app/utils/shareUtils.ts"],"sourcesContent":["'use client';\n\nexport type ShareOptionId =\n  | 'copy'\n  | 'facebook'\n  | 'twitter'\n  | 'whatsapp'\n  | 'telegram'\n  | 'email'\n  | 'web'\n  | 'movesplash';\n\nexport interface ShareablePost {\n  userpostId: string;\n  memberId: string;\n  authorName: string;\n  authorUsername?: string;\n  authorAvatar?: string;\n  text?: string;\n}\n\nexport interface ShareToMessagesPayload {\n  message: string;\n  postId: string;\n  postOwnerId: string;\n}\n\nconst FALLBACK_ORIGIN = 'https://movesplash.app';\n\nexport const buildPostShareUrl = (postOwnerId: string, postId: string): string => {\n  if (typeof window !== 'undefined' && window.location?.origin) {\n    return `${window.location.origin}/posts/${encodeURIComponent(postOwnerId)}/${encodeURIComponent(postId)}`;\n  }\n  return `${FALLBACK_ORIGIN}/posts/${encodeURIComponent(postOwnerId)}/${encodeURIComponent(postId)}`;\n};\n\nexport const buildShareText = (authorName: string, postText: string | undefined): string => {\n  const trimmed = postText?.trim();\n  if (trimmed && trimmed.length > 0) {\n    return trimmed.length > 280 ? `${trimmed.slice(0, 277)}` : trimmed;\n  }\n  return `Check out this MoveYSplash post from ${authorName}!`;\n};\n\nexport const buildShareMessage = (post: ShareablePost): string => {\n  const shareUrl = buildPostShareUrl(post.memberId, post.userpostId);\n  const base = buildShareText(post.authorName, post.text);\n  return `${post.authorName} on MoveYSplash:\\n${base}\\n\\n${shareUrl}`;\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;AA2BA,MAAM,kBAAkB;AAEjB,MAAM,oBAAoB,CAAC,aAAqB;IACrD,IAAI,kDAAkB,eAAe,OAAO,QAAQ,EAAE;;IAGtD,OAAO,GAAG,gBAAgB,OAAO,EAAE,mBAAmB,aAAa,CAAC,EAAE,mBAAmB,SAAS;AACpG;AAEO,MAAM,iBAAiB,CAAC,YAAoB;IACjD,MAAM,UAAU,UAAU;IAC1B,IAAI,WAAW,QAAQ,MAAM,GAAG,GAAG;QACjC,OAAO,QAAQ,MAAM,GAAG,MAAM,GAAG,QAAQ,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG;IAC9D;IACA,OAAO,CAAC,qCAAqC,EAAE,WAAW,CAAC,CAAC;AAC9D;AAEO,MAAM,oBAAoB,CAAC;IAChC,MAAM,WAAW,kBAAkB,KAAK,QAAQ,EAAE,KAAK,UAAU;IACjE,MAAM,OAAO,eAAe,KAAK,UAAU,EAAE,KAAK,IAAI;IACtD,OAAO,GAAG,KAAK,UAAU,CAAC,kBAAkB,EAAE,KAAK,IAAI,EAAE,UAAU;AACrE"}},
    {"offset": {"line": 1560, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohammedvepari/Documents/Algoma%20University/Fall%202025/COSC%204086/move-y-splash-new/src/app/utils/notifications.ts"],"sourcesContent":[" /**\n  * Mohammed Vepari\n  * ID: 5145543\n  * Friday November 14th 2025\n  */\n\n/**\n * Cross-browser notification utility\n * Works with Safari, Chrome, Firefox, and other modern browsers\n */\n\nexport interface NotificationOptions {\n  title: string;\n  body: string;\n  icon?: string;\n  tag?: string;\n  requireInteraction?: boolean;\n  onClick?: () => void;\n}\n\nclass NotificationManager {\n  private permission: NotificationPermission = 'default';\n  private supported: boolean = false;\n\n  constructor() {\n    const notificationAPI = this.getNotificationAPI();\n    this.supported = Boolean(notificationAPI);\n    if (notificationAPI) {\n      this.permission = notificationAPI.permission;\n    }\n  }\n\n  private getNotificationAPI(): typeof Notification | undefined {\n    if (typeof window === 'undefined') {\n      return undefined;\n    }\n\n    return window.Notification;\n  }\n\n  /**\n   * Check if notifications are supported\n   */\n  isSupported(): boolean {\n    return this.supported;\n  }\n\n  /**\n   * Get current permission status\n   */\n  getPermission(): NotificationPermission {\n    return this.permission;\n  }\n\n  /**\n   * Request notification permission\n   * MUST be called from a user interaction (click, tap, etc.) for Safari\n   */\n  async requestPermission(): Promise<NotificationPermission> {\n    if (!this.supported) {\n      console.warn('Notifications are not supported in this browser');\n      return 'denied';\n    }\n\n    const notificationAPI = this.getNotificationAPI();\n    if (!notificationAPI) {\n      console.warn('Notification API is not available');\n      return 'denied';\n    }\n\n    try {\n      // Safari requires the callback syntax in older versions\n      if (notificationAPI.permission === 'default') {\n        const permission = await new Promise<NotificationPermission>((resolve) => {\n          // Modern browsers (and newer Safari)\n          if (notificationAPI.requestPermission.length === 0) {\n            notificationAPI.requestPermission().then(resolve);\n          } else {\n            // Older Safari\n            notificationAPI.requestPermission(resolve);\n          }\n        });\n        this.permission = permission;\n        return permission;\n      }\n      \n      this.permission = notificationAPI.permission;\n      return notificationAPI.permission;\n    } catch (error) {\n      console.error('Error requesting notification permission:', error);\n      return 'denied';\n    }\n  }\n\n  /**\n   * Show a notification\n   * Will automatically request permission if needed (must be called from user interaction)\n   */\n  async show(options: NotificationOptions): Promise<Notification | null> {\n    if (!this.supported) {\n      console.warn('Notifications are not supported');\n      return null;\n    }\n\n    const notificationAPI = this.getNotificationAPI();\n    if (!notificationAPI) {\n      console.warn('Notification API is not available');\n      return null;\n    }\n\n    // Request permission if not granted\n    if (this.permission !== 'granted') {\n      const permission = await this.requestPermission();\n      if (permission !== 'granted') {\n        console.warn('Notification permission denied');\n        return null;\n      }\n    }\n\n    try {\n      const notification = new notificationAPI(options.title, {\n        body: options.body,\n        icon: options.icon || '/favicon.ico',\n        tag: options.tag,\n        requireInteraction: options.requireInteraction || false,\n        // Safari-specific: ensure badge and silent are set\n        badge: options.icon,\n        silent: false\n      });\n\n      if (options.onClick) {\n        notification.onclick = (event) => {\n          event.preventDefault();\n          options.onClick?.();\n          notification.close();\n        };\n      }\n\n      return notification;\n    } catch (error) {\n      console.error('Error showing notification:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Show a notification (simplified version)\n   */\n  async showSimple(title: string, body: string, onClick?: () => void): Promise<Notification | null> {\n    return this.show({ title, body, onClick });\n  }\n}\n\n// Export singleton instance\nexport const notificationManager = new NotificationManager();\n\n// Export convenience functions\nexport const requestNotificationPermission = () => notificationManager.requestPermission();\nexport const showNotification = (options: NotificationOptions) => notificationManager.show(options);\nexport const isNotificationSupported = () => notificationManager.isSupported();\nexport const getNotificationPermission = () => notificationManager.getPermission();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1704, "column": 0}, "map": {"version":3,"sources":["file:///Users/mohammedvepari/Documents/Algoma%20University/Fall%202025/COSC%204086/move-y-splash-new/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useTheme } from 'next-themes';\nimport { usePathname, useRouter } from 'next/navigation';\nimport { LandingPage } from './components/LandingPage';\nimport { LoginPage } from './components/LoginPage';\nimport { SignupPage } from './components/SignupPage';\nimport { Navigation } from './components/Navigation';\nimport { MainFeed } from './components/MainFeed';\nimport { ChatInterface } from './components/ChatInterface';\nimport { VideoChat } from './components/VideoChat';\nimport { FriendsList } from './components/FriendsList';\nimport { Stories } from './components/Stories';\nimport { Settings } from './components/Settings';\nimport { Profile } from './components/Profile';\nimport { HelpCenter } from './components/HelpCenter';\nimport { PrivacyPolicy } from './components/PrivacyPolicy';\nimport { TermsOfUse } from './components/TermsOfUse';\nimport { AboutUs } from './components/AboutUs';\nimport { CookiePolicy } from './components/CookiePolicy';\nimport { FeaturePages } from './components/FeaturePages';\nimport { Toaster } from './components/ui/sonner';\nimport { toast } from 'sonner';\nimport { UserProvider, useUser } from './utils/userContext';\nimport type { AppState, AppView, CallType, FeatureType } from './types/app';\nimport { cn } from './components/ui/utils';\nimport type { ShareToMessagesPayload } from './utils/shareUtils';\n\nconst LOGIN_BASE = '/login';\nconst DEFAULT_VIEW: AppView = 'feed';\n\nconst viewPathSegments: Record<AppView, string> = {\n  feed: 'feed',\n  messages: 'messages',\n  video: 'videochat',\n  friends: 'friendsList',\n  stories: 'stories',\n  settings: 'settings',\n  profile: 'profile',\n  help: 'help',\n  privacy: 'privacy',\n  terms: 'terms'\n};\n\nconst pathSegmentToView = Object.entries(viewPathSegments).reduce<Record<string, AppView>>(\n  (acc, [view, segment]) => {\n    acc[segment.toLowerCase()] = view as AppView;\n    return acc;\n  },\n  {}\n);\n\nconst featurePathSegments: Record<FeatureType, string> = {\n  'group-chats': 'messaging',\n  'video-calls': 'videochat',\n  'screen-share': 'screenshare',\n  stories: 'stories',\n  friends: 'friends',\n  'gen-z': 'genz'\n};\n\nconst pathSegmentToFeature = Object.entries(featurePathSegments).reduce<Record<string, FeatureType>>(\n  (acc, [feature, segment]) => {\n    acc[segment.toLowerCase()] = feature as FeatureType;\n    return acc;\n  },\n  {}\n);\n\nconst staticLandingRoutes: Record<string, AppState> = {\n  help: 'help',\n  privacy: 'privacy',\n  terms: 'terms',\n  about: 'about',\n  cookies: 'cookies',\n  signup: 'signup'\n};\n\nconst staticStatePaths: Partial<Record<AppState, string>> = {\n  landing: '/',\n  signup: '/signup',\n  help: '/help',\n  privacy: '/privacy',\n  terms: '/terms',\n  about: '/about',\n  cookies: '/cookies'\n};\n\ntype DerivedLocationState = {\n  state: AppState;\n  feature: FeatureType | null;\n  view: AppView;\n};\n\nfunction deriveStateFromPath(pathname: string): DerivedLocationState {\n  const segments = pathname.split('/').filter(Boolean);\n\n  if (segments.length === 0) {\n    return { state: 'landing', feature: null, view: DEFAULT_VIEW };\n  }\n\n  const [first, second] = segments.map((segment) => segment.toLowerCase());\n\n  if (first === 'login') {\n    if (!second) {\n      return { state: 'login', feature: null, view: DEFAULT_VIEW };\n    }\n    const matchedView = pathSegmentToView[second];\n    if (matchedView) {\n      return { state: 'app', feature: null, view: matchedView };\n    }\n    return { state: 'login', feature: null, view: DEFAULT_VIEW };\n  }\n\n  const staticState = staticLandingRoutes[first];\n  if (staticState) {\n    return { state: staticState, feature: null, view: DEFAULT_VIEW };\n  }\n\n  const matchedFeature = pathSegmentToFeature[first];\n  if (matchedFeature) {\n    return { state: 'feature', feature: matchedFeature, view: DEFAULT_VIEW };\n  }\n\n  return { state: 'landing', feature: null, view: DEFAULT_VIEW };\n}\n\nfunction pathForState(state: AppState, feature: FeatureType | null, view: AppView): string {\n  if (state === 'login') {\n    return LOGIN_BASE;\n  }\n\n  if (state === 'app') {\n    const segment = viewPathSegments[view] ?? viewPathSegments[DEFAULT_VIEW];\n    return `${LOGIN_BASE}/${segment}`;\n  }\n\n  if (state === 'feature' && feature) {\n    return `/${featurePathSegments[feature]}`;\n  }\n\n  return staticStatePaths[state] ?? '/';\n}\n\nfunction AppShell() {\n  const { login, signup, logout, currentUser, loadProfileUser } = useUser();\n  const router = useRouter();\n  const pathname = usePathname() || '/';\n  const derivedFromPath = deriveStateFromPath(pathname);\n  const [appState, setAppState] = useState<AppState>(derivedFromPath.state);\n  const [currentView, setCurrentView] = useState<AppView>(derivedFromPath.view);\n  const [activeCall, setActiveCall] = useState<CallType>(null);\n  const [currentFeature, setCurrentFeature] = useState<FeatureType | null>(derivedFromPath.feature);\n  const [pendingShareDraft, setPendingShareDraft] = useState<ShareToMessagesPayload | null>(null);\n  const [pendingMessageTarget, setPendingMessageTarget] = useState<string | null>(null);\n  const [selectedProfileId, setSelectedProfileId] = useState<string | null>(null);\n  const [isProfileLoading, setIsProfileLoading] = useState(false);\n  const { resolvedTheme } = useTheme();\n  const isLightTheme = resolvedTheme === 'light';\n\n  const appContainerClass = cn(\n    'min-h-screen relative overflow-hidden transition-colors duration-500',\n    isLightTheme\n      ? 'bg-gradient-to-br from-rose-100 via-purple-100 to-sky-100 text-slate-900'\n      : 'bg-gradient-to-br from-purple-900 via-pink-800 to-orange-700 text-white'\n  );\n\n  const backgroundBlobs = isLightTheme\n    ? [\n        'absolute -top-40 -left-40 w-96 h-96 bg-gradient-to-r from-pink-200 to-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob',\n        'absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-r from-amber-200 to-orange-200 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob animation-delay-2000',\n        'absolute -bottom-40 left-20 w-96 h-96 bg-gradient-to-r from-sky-200 to-cyan-200 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob animation-delay-4000'\n      ]\n    : [\n        'absolute -top-40 -left-40 w-96 h-96 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob',\n        'absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-2000',\n        'absolute -bottom-40 left-20 w-96 h-96 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-4000'\n      ];\n\n  useEffect(() => {\n    const derived = deriveStateFromPath(pathname);\n\n    if (derived.state === 'app') {\n      setAppState('app');\n      setCurrentView(derived.view);\n      setCurrentFeature(null);\n      return;\n    }\n\n    if (derived.state === 'feature') {\n      setAppState('feature');\n      setCurrentFeature(derived.feature);\n      return;\n    }\n\n    setAppState(derived.state);\n    setCurrentFeature(null);\n  }, [pathname]);\n\n  useEffect(() => {\n    const targetPath = pathForState(appState, currentFeature, currentView);\n    if (pathname !== targetPath) {\n      router.replace(targetPath, { scroll: false });\n    }\n  }, [appState, currentFeature, currentView, pathname, router]);\n\n  useEffect(() => {\n    if (!currentUser) {\n      setSelectedProfileId(null);\n      return;\n    }\n\n    setSelectedProfileId(prev => (prev ? prev : currentUser.id));\n  }, [currentUser]);\n\n  useEffect(() => {\n    let cancelled = false;\n\n    const run = async () => {\n      if (selectedProfileId === null) {\n        setIsProfileLoading(false);\n        await loadProfileUser(null);\n        return;\n      }\n\n      setIsProfileLoading(true);\n      const success = await loadProfileUser(selectedProfileId);\n      if (cancelled) {\n        return;\n      }\n\n      setIsProfileLoading(false);\n      if (!success) {\n        toast.error('Unable to load that profile right now.');\n      }\n    };\n\n    void run();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [selectedProfileId, loadProfileUser]);\n\n  const handleLogin = async (email: string, password: string) => {\n    const success = await login(email, password);\n    if (success) {\n      toast.success('Welcome back! ');\n      setSelectedProfileId(null);\n      setAppState('app');\n      setCurrentView('feed');\n    } else {\n      toast.error('Invalid email or password');\n    }\n  };\n\n  const handleSignup = async (name: string, email: string, password: string, birthdate: string) => {\n    const success = await signup(name, email, password, birthdate);\n    if (success) {\n      toast.success(`Welcome to MoveSplash, ${name}! `);\n      setSelectedProfileId(null);\n      setAppState('app');\n      setCurrentView('feed');\n    } else {\n      toast.error('Email already in use');\n    }\n  };\n\n  const handleLogout = () => {\n    logout();\n    toast.success('See you later! ');\n    setSelectedProfileId(null);\n    setPendingMessageTarget(null);\n    setIsProfileLoading(false);\n    setAppState('landing');\n  };\n\n  const handleNavigate = (view: AppView) => {\n    if (view === 'profile') {\n      setSelectedProfileId(currentUser ? currentUser.id : null);\n    }\n    setCurrentView(view);\n    setActiveCall(null); // Clear active call when navigating\n  };\n\n  const handleStartCall = (type: 'audio' | 'video') => {\n    setActiveCall(type);\n    setCurrentView('video');\n  };\n\n  const handleEndCall = () => {\n    setActiveCall(null);\n    setCurrentView('messages'); // Return to messages after call ends\n  };\n\n  const handleOpenSettings = () => {\n    setCurrentView('settings');\n    setActiveCall(null);\n  };\n\n  const handleOpenHelpCenterInApp = () => {\n    setActiveCall(null);\n    setCurrentView('help');\n  };\n\n  const handleOpenPrivacyPolicyInApp = () => {\n    setActiveCall(null);\n    setCurrentView('privacy');\n  };\n\n  const handleOpenTermsInApp = () => {\n    setActiveCall(null);\n    setCurrentView('terms');\n  };\n\n  const handleCloseSettings = () => {\n    setCurrentView('feed');\n  };\n\n  const handleShareToMessages = (payload: ShareToMessagesPayload) => {\n    setPendingShareDraft(payload);\n    setCurrentView('messages');\n  };\n\n  const handleOpenMessagesForUser = (userId: string) => {\n    setPendingMessageTarget(userId);\n    setCurrentView('messages');\n  };\n\n  const handleOpenProfile = (userId: string) => {\n    setSelectedProfileId(userId);\n    setCurrentView('profile');\n  };\n\n  const handleProfileBack = () => {\n    if (currentUser) {\n      setSelectedProfileId(currentUser.id);\n    }\n    setCurrentView('friends');\n  };\n\n  const handleOpenLoginFlow = () => {\n    setCurrentFeature(null);\n    setAppState('login');\n  };\n\n  const handleOpenFeature = (feature: FeatureType) => {\n    setCurrentFeature(feature);\n    setAppState('feature');\n  };\n\n  const handleCloseFeature = () => {\n    setCurrentFeature(null);\n    setAppState('landing');\n  };\n\n  // Render different states\n  if (appState === 'help') {\n    return (\n      <>\n        <HelpCenter onBack={() => setAppState('landing')} />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  if (appState === 'privacy') {\n    return (\n      <>\n        <PrivacyPolicy onBack={() => setAppState('landing')} />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  if (appState === 'terms') {\n    return (\n      <>\n        <TermsOfUse onBack={() => setAppState('landing')} />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  if (appState === 'about') {\n    return (\n      <>\n        <AboutUs onBack={() => setAppState('landing')} />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  if (appState === 'cookies') {\n    return (\n      <>\n        <CookiePolicy onBack={() => setAppState('landing')} />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  if (appState === 'feature' && currentFeature) {\n    return (\n      <>\n        <FeaturePages \n          feature={currentFeature} \n          onBack={handleCloseFeature}\n          onGetStarted={() => setAppState('signup')}\n        />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  if (appState === 'landing') {\n    return (\n      <>\n        <LandingPage\n          onGetStarted={() => setAppState('signup')}\n          onLogin={handleOpenLoginFlow}\n          onViewFeature={handleOpenFeature}\n          onViewHelp={() => setAppState('help')}\n          onViewPrivacy={() => setAppState('privacy')}\n          onViewTerms={() => setAppState('terms')}\n          onViewAbout={() => setAppState('about')}\n          onViewCookies={() => setAppState('cookies')}\n        />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  if (appState === 'login') {\n    return (\n      <>\n        <LoginPage\n          onLogin={handleLogin}\n          onBack={() => setAppState('landing')}\n          onSignup={() => setAppState('signup')}\n        />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  if (appState === 'signup') {\n    return (\n      <>\n        <SignupPage\n          onSignup={handleSignup}\n          onBack={() => setAppState('landing')}\n          onLogin={handleOpenLoginFlow}\n        />\n        <Toaster position=\"top-center\" />\n      </>\n    );\n  }\n\n  // Main App View\n  return (\n    <div className={appContainerClass}>\n      {/* Animated background blobs */}\n      <div className=\"fixed inset-0 overflow-hidden pointer-events-none\">\n        {backgroundBlobs.map((className, index) => (\n          <div key={index} className={className}></div>\n        ))}\n      </div>\n\n      {/* Navigation */}\n      <Navigation\n        currentView={currentView}\n        onNavigate={handleNavigate}\n        onLogout={handleLogout}\n        onOpenSettings={handleOpenSettings}\n      />\n\n      {/* Main Content */}\n      <main className=\"relative z-10 p-6\">\n        {currentView === 'feed' && (\n          <div className=\"space-y-6\">\n            <Stories />\n            <MainFeed onShareToMessages={handleShareToMessages} />\n          </div>\n        )}\n        {currentView === 'messages' && !activeCall && (\n          <ChatInterface\n            onStartCall={handleStartCall}\n            shareDraft={pendingShareDraft?.message ?? null}\n            onShareDraftConsumed={() => setPendingShareDraft(null)}\n            focusUserId={pendingMessageTarget}\n            onFocusUserConsumed={() => setPendingMessageTarget(null)}\n          />\n        )}\n        {(currentView === 'video' || activeCall) && (\n          <VideoChat \n            callType={activeCall || 'video'} \n            onEndCall={handleEndCall}\n          />\n        )}\n        {currentView === 'friends' && (\n          <FriendsList\n            onOpenProfile={handleOpenProfile}\n            onOpenMessage={handleOpenMessagesForUser}\n          />\n        )}\n        {currentView === 'stories' && <Stories />}\n        {currentView === 'settings' && (\n          <Settings\n            onClose={handleCloseSettings}\n            onLogout={handleLogout}\n            onOpenHelpCenter={handleOpenHelpCenterInApp}\n            onOpenPrivacyPolicy={handleOpenPrivacyPolicyInApp}\n            onOpenTermsOfService={handleOpenTermsInApp}\n          />\n        )}\n        {currentView === 'help' && (\n          <HelpCenter onBack={() => setCurrentView('settings')} />\n        )}\n        {currentView === 'privacy' && (\n          <PrivacyPolicy onBack={() => setCurrentView('settings')} />\n        )}\n        {currentView === 'terms' && (\n          <TermsOfUse onBack={() => setCurrentView('settings')} />\n        )}\n        {currentView === 'profile' && (\n          <Profile\n            onShareToMessages={handleShareToMessages}\n            profileUserId={selectedProfileId}\n            isLoading={isProfileLoading}\n            onBackToFriends={handleProfileBack}\n          />\n        )}\n      </main>\n\n      <Toaster position=\"top-center\" />\n\n      <style>{`\n        @keyframes blob {\n          0% { transform: translate(0px, 0px) scale(1); }\n          33% { transform: translate(30px, -50px) scale(1.1); }\n          66% { transform: translate(-20px, 20px) scale(0.9); }\n          100% { transform: translate(0px, 0px) scale(1); }\n        }\n        .animate-blob {\n          animation: blob 7s infinite;\n        }\n        .animation-delay-2000 {\n          animation-delay: 2s;\n        }\n        .animation-delay-4000 {\n          animation-delay: 4s;\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default function App() {\n  return (\n    <UserProvider>\n      <AppShell />\n    </UserProvider>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}