(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},54385,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}},43173,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(6085)),i=s(e.r(54385));r.default=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!=(t=e.shouldThrowOnError)&&t,this.signal=e.signal,this.isMaybeSingle=null!=(r=e.isMaybeSingle)&&r,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=n.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,s,n;let a=null,o=null,l=null,c=e.status,d=e.statusText;if(e.ok){if("HEAD"!==this.method){let r=await e.text();""===r||(o="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null==(t=this.headers.get("Accept"))?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}let n=null==(r=this.headers.get("Prefer"))?void 0:r.match(/count=(exact|planned|estimated)/),i=null==(s=e.headers.get("content-range"))?void 0:s.split("/");n&&i&&i.length>1&&(l=parseInt(i[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,d="Not Acceptable"):o=1===o.length?o[0]:null)}else{let t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(o=[],a=null,c=200,d="OK")}catch(r){404===e.status&&""===t?(c=204,d="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null==(n=null==a?void 0:a.details)?void 0:n.includes("0 rows"))&&(a=null,c=200,d="OK"),a&&this.shouldThrowOnError)throw new i.default(a)}return{error:a,data:o,count:l,status:c,statusText:d}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,s;return{error:{message:`${null!=(t=null==e?void 0:e.name)?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!=(r=null==e?void 0:e.stack)?r:""}`,hint:"",code:`${null!=(s=null==e?void 0:e.code)?s:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}}},82191,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(43173));class i extends n.default{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){let i=n?`${n}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let s=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){let n=void 0===s?"offset":`${s}.offset`,i=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var a;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!=(a=this.headers.get("Accept"))?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}}r.default=i},14633,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(82191));class i extends n.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let n="";"plain"===s?n="pl":"phrase"===s?n="ph":"websearch"===s&&(n="w");let i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}r.default=i},38290,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(14633));r.default=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}select(e,t){let{head:r=!1,count:s}=null!=t?t:{},i=!1,a=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new n.default({method:r?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!=(s=this.fetch)?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){var a;if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&this.url.searchParams.set("on_conflict",t),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!=(a=this.fetch)?a:fetch})}update(e,{count:t}={}){var r;return t&&this.headers.append("Prefer",`count=${t}`),new n.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!=(r=this.fetch)?r:fetch})}delete({count:e}={}){var t;return e&&this.headers.append("Prefer",`count=${e}`),new n.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!=(t=this.fetch)?t:fetch})}}},2259,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(38290)),i=s(e.r(14633));class a{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=s}from(e){let t=new URL(`${this.url}/${e}`);return new n.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new a(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:n}={}){var a;let o,l,c=new URL(`${this.url}/rpc/${e}`);r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{c.searchParams.append(e,t)})):(o="POST",l=t);let d=new Headers(this.headers);return n&&d.set("Prefer",`count=${n}`),new i.default({method:o,url:c,headers:d,schema:this.schemaName,body:l,fetch:null!=(a=this.fetch)?a:fetch})}}r.default=a},82215,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PostgrestError=r.PostgrestBuilder=r.PostgrestTransformBuilder=r.PostgrestFilterBuilder=r.PostgrestQueryBuilder=r.PostgrestClient=void 0;let n=s(e.r(2259));r.PostgrestClient=n.default;let i=s(e.r(38290));r.PostgrestQueryBuilder=i.default;let a=s(e.r(14633));r.PostgrestFilterBuilder=a.default;let o=s(e.r(82191));r.PostgrestTransformBuilder=o.default;let l=s(e.r(43173));r.PostgrestBuilder=l.default;let c=s(e.r(54385));r.PostgrestError=c.default,r.default={PostgrestClient:n.default,PostgrestQueryBuilder:i.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}},67034,(e,t,r)=>{var s={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],s=t[1];return(r+s)*3/4-s},t.toByteArray=function(e){var t,r,i=l(e),a=i[0],o=i[1],c=new n((a+o)*3/4-o),d=0,u=o>0?a-4:a;for(r=0;r<u;r+=4)t=s[e.charCodeAt(r)]<<18|s[e.charCodeAt(r+1)]<<12|s[e.charCodeAt(r+2)]<<6|s[e.charCodeAt(r+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===o&&(t=s[e.charCodeAt(r)]<<2|s[e.charCodeAt(r+1)]>>4,c[d++]=255&t),1===o&&(t=s[e.charCodeAt(r)]<<10|s[e.charCodeAt(r+1)]<<4|s[e.charCodeAt(r+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c},t.fromByteArray=function(e){for(var t,s=e.length,n=s%3,i=[],a=0,o=s-n;a<o;a+=16383)i.push(function(e,t,s){for(var n,i=[],a=t;a<s;a+=3)n=(e[a]<<16&0xff0000)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(r[n>>18&63]+r[n>>12&63]+r[n>>6&63]+r[63&n]);return i.join("")}(e,a,a+16383>o?o:a+16383));return 1===n?i.push(r[(t=e[s-1])>>2]+r[t<<4&63]+"=="):2===n&&i.push(r[(t=(e[s-2]<<8)+e[s-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),i.join("")};for(var r=[],s=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=i.length;a<o;++a)r[a]=i[a],s[i.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var s=r===t?0:4-r%4;return[r,s]}s[45]=62,s[95]=63},72:function(e,t,r){"use strict";var s=r(675),n=r(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return d(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e){var s=e,n=t;if(("string"!=typeof n||""===n)&&(n="utf8"),!o.isEncoding(n))throw TypeError("Unknown encoding: "+n);var i=0|p(s,n),l=a(i),c=l.write(s,n);return c!==i&&(l=l.slice(0,c)),l}if(ArrayBuffer.isView(e))return u(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(R(e,ArrayBuffer)||e&&R(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(R(e,SharedArrayBuffer)||e&&R(e.buffer,SharedArrayBuffer)))return function(e,t,r){var s;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(s=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),o.prototype),s}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var d=e.valueOf&&e.valueOf();if(null!=d&&d!==e)return o.from(d,t,r);var f=function(e){if(o.isBuffer(e)){var t=0|h(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?a(0):u(e):"Buffer"===e.type&&Array.isArray(e.data)?u(e.data):void 0}(e);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return c(e),a(e<0?0:0|h(e))}function u(e){for(var t=e.length<0?0:0|h(e.length),r=a(t),s=0;s<t;s+=1)r[s]=255&e[s];return r}t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=0x7fffffff,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return(c(e),e<=0)?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)},o.allocUnsafe=function(e){return d(e)},o.allocUnsafeSlow=function(e){return d(e)};function h(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||R(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,s=arguments.length>2&&!0===arguments[2];if(!s&&0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return S(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return C(e).length;default:if(n)return s?-1:S(e).length;t=(""+t).toLowerCase(),n=!0}}function f(e,t,r){var n,i,a,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var s=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>s)&&(r=s);for(var n="",i=t;i<r;++i)n+=A[e[i]];return n}(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return function(e,t,r){var s="";r=Math.min(e.length,r);for(var n=t;n<r;++n)s+=String.fromCharCode(127&e[n]);return s}(this,t,r);case"latin1":case"binary":return function(e,t,r){var s="";r=Math.min(e.length,r);for(var n=t;n<r;++n)s+=String.fromCharCode(e[n]);return s}(this,t,r);case"base64":return n=this,i=t,a=r,0===i&&a===n.length?s.fromByteArray(n):s.fromByteArray(n.slice(i,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var s=e.slice(t,r),n="",i=0;i<s.length;i+=2)n+=String.fromCharCode(s[i]+256*s[i+1]);return n}(this,t,r);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function m(e,t,r){var s=e[t];e[t]=e[r],e[r]=s}function g(e,t,r,s,n){var i;if(0===e.length)return -1;if("string"==typeof r?(s=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(i=r*=1)!=i&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length)if(n)return -1;else r=e.length-1;else if(r<0)if(!n)return -1;else r=0;if("string"==typeof t&&(t=o.from(t,s)),o.isBuffer(t))return 0===t.length?-1:b(e,t,r,s,n);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(n)return Uint8Array.prototype.indexOf.call(e,t,r);else return Uint8Array.prototype.lastIndexOf.call(e,t,r);return b(e,[t],r,s,n)}throw TypeError("val must be string, number or Buffer")}function b(e,t,r,s,n){var i,a=1,o=e.length,l=t.length;if(void 0!==s&&("ucs2"===(s=String(s).toLowerCase())||"ucs-2"===s||"utf16le"===s||"utf-16le"===s)){if(e.length<2||t.length<2)return -1;a=2,o/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(n){var d=-1;for(i=r;i<o;i++)if(c(e,i)===c(t,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===l)return d*a}else -1!==d&&(i-=i-d),d=-1}else for(r+l>o&&(r=o-l),i=r;i>=0;i--){for(var u=!0,h=0;h<l;h++)if(c(e,i+h)!==c(t,h)){u=!1;break}if(u)return i}return -1}o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(R(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),R(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,s=t.length,n=0,i=Math.min(r,s);n<i;++n)if(e[n]!==t[n]){r=e[n],s=t[n];break}return r<s?-1:+(s<r)},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,s=o.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var i=e[r];if(R(i,Uint8Array)&&(i=o.from(i)),!o.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(s,n),n+=i.length}return s},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?x(this,0,e):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},i&&(o.prototype[i]=o.prototype.inspect),o.prototype.compare=function(e,t,r,s,n){if(R(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===s&&(s=0),void 0===n&&(n=this.length),t<0||r>e.length||s<0||n>this.length)throw RangeError("out of range index");if(s>=n&&t>=r)return 0;if(s>=n)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,s>>>=0,n>>>=0,this===e)return 0;for(var i=n-s,a=r-t,l=Math.min(i,a),c=this.slice(s,n),d=e.slice(t,r),u=0;u<l;++u)if(c[u]!==d[u]){i=c[u],a=d[u];break}return i<a?-1:+(a<i)},o.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)};function x(e,t,r){r=Math.min(e.length,r);for(var s=[],n=t;n<r;){var i,a,o,l,c=e[n],d=null,u=c>239?4:c>223?3:c>191?2:1;if(n+u<=r)switch(u){case 1:c<128&&(d=c);break;case 2:(192&(i=e[n+1]))==128&&(l=(31&c)<<6|63&i)>127&&(d=l);break;case 3:i=e[n+1],a=e[n+2],(192&i)==128&&(192&a)==128&&(l=(15&c)<<12|(63&i)<<6|63&a)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:i=e[n+1],a=e[n+2],o=e[n+3],(192&i)==128&&(192&a)==128&&(192&o)==128&&(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&o)>65535&&l<1114112&&(d=l)}null===d?(d=65533,u=1):d>65535&&(d-=65536,s.push(d>>>10&1023|55296),d=56320|1023&d),s.push(d),n+=u}var h=s,p=h.length;if(p<=4096)return String.fromCharCode.apply(String,h);for(var f="",m=0;m<p;)f+=String.fromCharCode.apply(String,h.slice(m,m+=4096));return f}function y(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function w(e,t,r,s,n,i){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<i)throw RangeError('"value" argument is out of bounds');if(r+s>e.length)throw RangeError("Index out of range")}function v(e,t,r,s,n,i){if(r+s>e.length||r<0)throw RangeError("Index out of range")}function j(e,t,r,s,i){return t*=1,r>>>=0,i||v(e,t,r,4,34028234663852886e22,-34028234663852886e22),n.write(e,t,r,s,23,4),r+4}function k(e,t,r,s,i){return t*=1,r>>>=0,i||v(e,t,r,8,17976931348623157e292,-17976931348623157e292),n.write(e,t,r,s,52,8),r+8}o.prototype.write=function(e,t,r,s){if(void 0===t)s="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)s=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===s&&(s="utf8")):(s=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var n,i,a,o,l,c,d,u,h=this.length-t;if((void 0===r||r>h)&&(r=h),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");s||(s="utf8");for(var p=!1;;)switch(s){case"hex":return function(e,t,r,s){r=Number(r)||0;var n=e.length-r;s?(s=Number(s))>n&&(s=n):s=n;var i=t.length;s>i/2&&(s=i/2);for(var a=0;a<s;++a){var o,l=parseInt(t.substr(2*a,2),16);if((o=l)!=o)break;e[r+a]=l}return a}(this,e,t,r);case"utf8":case"utf-8":return n=t,i=r,E(S(e,this.length-n),this,n,i);case"ascii":return a=t,o=r,E(_(e),this,a,o);case"latin1":case"binary":return function(e,t,r,s){return E(_(t),e,r,s)}(this,e,t,r);case"base64":return l=t,c=r,E(C(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d=t,u=r,E(function(e,t){for(var r,s,n=[],i=0;i<e.length&&!((t-=2)<0);++i)s=(r=e.charCodeAt(i))>>8,n.push(r%256),n.push(s);return n}(e,this.length-d),this,d,u);default:if(p)throw TypeError("Unknown encoding: "+s);s=(""+s).toLowerCase(),p=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var s=this.subarray(e,t);return Object.setPrototypeOf(s,o.prototype),s},o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||y(e,t,this.length);for(var s=this[e],n=1,i=0;++i<t&&(n*=256);)s+=this[e+i]*n;return s},o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||y(e,t,this.length);for(var s=this[e+--t],n=1;t>0&&(n*=256);)s+=this[e+--t]*n;return s},o.prototype.readUInt8=function(e,t){return e>>>=0,t||y(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||y(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||y(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||y(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||y(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||y(e,t,this.length);for(var s=this[e],n=1,i=0;++i<t&&(n*=256);)s+=this[e+i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||y(e,t,this.length);for(var s=t,n=1,i=this[e+--s];s>0&&(n*=256);)i+=this[e+--s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},o.prototype.readInt8=function(e,t){return(e>>>=0,t||y(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||y(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||y(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||y(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||y(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||y(e,4,this.length),n.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||y(e,4,this.length),n.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||y(e,8,this.length),n.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||y(e,8,this.length),n.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,s){if(e*=1,t>>>=0,r>>>=0,!s){var n=Math.pow(2,8*r)-1;w(this,e,t,r,n,0)}var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,s){if(e*=1,t>>>=0,r>>>=0,!s){var n=Math.pow(2,8*r)-1;w(this,e,t,r,n,0)}var i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,r,s){if(e*=1,t>>>=0,!s){var n=Math.pow(2,8*r-1);w(this,e,t,r,n-1,-n)}var i=0,a=1,o=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/a|0)-o&255;return t+r},o.prototype.writeIntBE=function(e,t,r,s){if(e*=1,t>>>=0,!s){var n=Math.pow(2,8*r-1);w(this,e,t,r,n-1,-n)}var i=r-1,a=1,o=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/a|0)-o&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e*=1,t>>>=0,r||w(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return k(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return k(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,s){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),s||0===s||(s=this.length),t>=e.length&&(t=e.length),t||(t=0),s>0&&s<r&&(s=r),s===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(s<0)throw RangeError("sourceEnd out of bounds");s>this.length&&(s=this.length),e.length-t<s-r&&(s=e.length-t+r);var n=s-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,s);else if(this===e&&r<t&&t<s)for(var i=n-1;i>=0;--i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,s),t);return n},o.prototype.fill=function(e,t,r,s){if("string"==typeof e){if("string"==typeof t?(s=t,t=0,r=this.length):"string"==typeof r&&(s=r,r=this.length),void 0!==s&&"string"!=typeof s)throw TypeError("encoding must be a string");if("string"==typeof s&&!o.isEncoding(s))throw TypeError("Unknown encoding: "+s);if(1===e.length){var n,i=e.charCodeAt(0);("utf8"===s&&i<128||"latin1"===s)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{var a=o.isBuffer(e)?e:o.from(e,s),l=a.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=a[n%l]}return this};var N=/[^+/0-9A-Za-z-_]/g;function S(e,t){t=t||1/0;for(var r,s=e.length,n=null,i=[],a=0;a<s;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319||a+1===s){(t-=3)>-1&&i.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(t-=3)>-1&&i.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return i}function _(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function C(e){return s.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function E(e,t,r,s){for(var n=0;n<s&&!(n+r>=t.length)&&!(n>=e.length);++n)t[n+r]=e[n];return n}function R(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var A=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var s=16*r,n=0;n<16;++n)t[s+n]=e[r]+e[n];return t}()},783:function(e,t){t.read=function(e,t,r,s,n){var i,a,o=8*n-s-1,l=(1<<o)-1,c=l>>1,d=-7,u=r?n-1:0,h=r?-1:1,p=e[t+u];for(u+=h,i=p&(1<<-d)-1,p>>=-d,d+=o;d>0;i=256*i+e[t+u],u+=h,d-=8);for(a=i&(1<<-d)-1,i>>=-d,d+=s;d>0;a=256*a+e[t+u],u+=h,d-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,s),i-=c}return(p?-1:1)*a*Math.pow(2,i-s)},t.write=function(e,t,r,s,n,i){var a,o,l,c=8*i-n-1,d=(1<<c)-1,u=d>>1,h=5960464477539062e-23*(23===n),p=s?0:i-1,f=s?1:-1,m=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(o=+!!isNaN(t),a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+u>=1?t+=h/l:t+=h*Math.pow(2,1-u),t*l>=2&&(a++,l/=2),a+u>=d?(o=0,a=d):a+u>=1?(o=(t*l-1)*Math.pow(2,n),a+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,n),a=0));n>=8;e[r+p]=255&o,p+=f,o/=256,n-=8);for(a=a<<n|o,c+=n;c>0;e[r+p]=255&a,p+=f,a/=256,c-=8);e[r+p-f]|=128*m}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={exports:{}},a=!0;try{s[e](r,r.exports,i),a=!1}finally{a&&delete n[e]}return r.exports}i.ab="/ROOT/node_modules/next/dist/compiled/buffer/",t.exports=i(72)},55838,(e,t,r)=>{"use strict";var s=e.r(71645),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=s.useState,a=s.useEffect,o=s.useLayoutEffect,l=s.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),s=i({inst:{value:r,getSnapshot:t}}),n=s[0].inst,d=s[1];return o(function(){n.value=r,n.getSnapshot=t,c(n)&&d({inst:n})},[e,r,t]),a(function(){return c(n)&&d({inst:n}),e(function(){c(n)&&d({inst:n})})},[e]),l(r),r};r.useSyncExternalStore=void 0!==s.useSyncExternalStore?s.useSyncExternalStore:d},2239,(e,t,r)=>{"use strict";t.exports=e.r(55838)},5190,(e,t,r)=>{e.e,t.exports=(()=>{let t;"use strict";var r,s,n,i,a,o,l,c,d,u={},h={exports:u},p=Object.defineProperty,f=Object.defineProperties,m=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertyNames,x=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,v=(e,t,r)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,j=(e,t)=>{for(var r in t||(t={}))y.call(t,r)&&v(e,r,t[r]);if(x)for(var r of x(t))w.call(t,r)&&v(e,r,t[r]);return e},k=(e,t)=>{for(var r in t)p(e,r,{get:t[r],enumerable:!0})},N={};k(N,{ErrorInfo:()=>T,Realtime:()=>rU,Rest:()=>rc,default:()=>sg,makeProtocolMessageFromDeserialized:()=>t9,msgpack:()=>sp}),h.exports=((e,t,r,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of b(t))y.call(e,n)||n===r||p(e,n,{get:()=>t[n],enumerable:!(s=m(t,n))||s.enumerable});return e})(p({},"__esModule",{value:!0}),N);var S=class{},_=e.g;function C(e,t){return`${e}`.padStart(t?3:2,"0")}function E(e){return S.Config.logTimestamps?function(t){let r=new Date;e(C(r.getHours())+":"+C(r.getMinutes())+":"+C(r.getSeconds())+"."+C(r.getMilliseconds(),1)+" "+t)}:function(t){e(t)}}var R=class e{constructor(){this.deprecated=(e,t)=>{this.deprecationWarning(`${e} is deprecated and will be removed in a future version. ${t}`)},this.shouldLog=e=>e<=this.logLevel,this.setLog=(e,t)=>{void 0!==e&&(this.logLevel=e),void 0!==t&&(this.logHandler=this.logErrorHandler=t)},this.logLevel=e.defaultLogLevel,this.logHandler=e.defaultLogHandler,this.logErrorHandler=e.defaultLogErrorHandler}static initLogHandlers(){var t;let r,s,[n,i]=("function"==typeof(null==(t=null==_?void 0:_.console)?void 0:t.log)?(r=function(...e){console.log.apply(console,e)},s=console.warn?function(...e){console.warn.apply(console,e)}:r):r=s=function(){},[r,s].map(E));this.defaultLogHandler=n,this.defaultLogErrorHandler=i,this.defaultLogger=new e}static logActionNoStrip(e,t,r,s){e.logAction(t,r,s)}logAction(e,t,r){this.shouldLog(e)&&(1===e?this.logErrorHandler:this.logHandler)("Ably: "+t+": "+r,e)}renamedClientOption(e,t){this.deprecationWarning(`The \`${e}\` client option has been renamed to \`${t}\`. Please update your code to use \`${t}\` instead. \`${e}\` will be removed in a future version.`)}renamedMethod(e,t,r){this.deprecationWarning(`\`${e}\`\u2019s \`${t}\` method has been renamed to \`${r}\`. Please update your code to use \`${r}\` instead. \`${t}\` will be removed in a future version.`)}deprecationWarning(e){this.shouldLog(1)&&this.logErrorHandler(`Ably: Deprecation warning - ${e}`,1)}};R.defaultLogLevel=1,R.LOG_NONE=0,R.LOG_ERROR=1,R.LOG_MAJOR=2,R.LOG_MINOR=3,R.LOG_MICRO=4,R.logAction=(e,t,r,s)=>{R.logActionNoStrip(e,t,r,s)};var A={};function O(e){let t="["+e.constructor.name;return e.message&&(t+=": "+e.message),e.statusCode&&(t+="; statusCode="+e.statusCode),e.code&&(t+="; code="+e.code),e.cause&&(t+="; cause="+en(e.cause)),e.href&&!(e.message&&e.message.indexOf("help.ably.io")>-1)&&(t+="; see "+e.href+" "),t+="]"}k(A,{Format:()=>Z,allSame:()=>Q,allToLowerCase:()=>ep,allToUpperCase:()=>ef,arrChooseN:()=>ec,arrDeleteValue:()=>V,arrEquals:()=>ej,arrIntersect:()=>W,arrIntersectOb:()=>G,arrPopRandomElement:()=>ee,arrWithoutValue:()=>K,cheapRandStr:()=>eo,containsValue:()=>F,copy:()=>P,createMissingPluginError:()=>ek,dataSizeBytes:()=>ea,decodeBody:()=>eu,encodeBody:()=>eh,ensureArray:()=>D,forInOwnNonNullProperties:()=>X,getBackoffCoefficient:()=>em,getGlobalObject:()=>ex,getJitterCoefficient:()=>eg,getRetryTime:()=>eb,inherits:()=>q,inspectBody:()=>ei,inspectError:()=>en,intersect:()=>H,isEmpty:()=>$,isErrorInfoOrPartialErrorInfo:()=>es,isNil:()=>U,isObject:()=>L,keysArray:()=>J,matchDerivedChannel:()=>ew,mixin:()=>M,parseQueryString:()=>er,prototypicalClone:()=>z,randomString:()=>el,shallowClone:()=>B,shallowEquals:()=>ey,throwMissingPluginError:()=>eN,toBase64:()=>ev,toQueryString:()=>et,valuesArray:()=>Y,whenPromiseSettles:()=>ed,withTimeoutAsync:()=>eS});var T=class e extends Error{constructor(t,r,s,n){super(t),void 0!==Object.setPrototypeOf&&Object.setPrototypeOf(this,e.prototype),this.code=r,this.statusCode=s,this.cause=n}toString(){return O(this)}static fromValues(t){let{message:r,code:s,statusCode:n}=t;if("string"!=typeof r||"number"!=typeof s||"number"!=typeof n)throw Error("ErrorInfo.fromValues(): invalid values: "+S.Config.inspect(t));let i=Object.assign(new e(r,s,n),t);return i.code&&!i.href&&(i.href="https://help.ably.io/error/"+i.code),i}},I=class e extends Error{constructor(t,r,s,n){super(t),void 0!==Object.setPrototypeOf&&Object.setPrototypeOf(this,e.prototype),this.code=r,this.statusCode=s,this.cause=n}toString(){return O(this)}static fromValues(t){let{message:r,code:s,statusCode:n}=t;if("string"!=typeof r||!U(s)&&"number"!=typeof s||!U(n)&&"number"!=typeof n)throw Error("PartialErrorInfo.fromValues(): invalid values: "+S.Config.inspect(t));let i=Object.assign(new e(r,s,n),t);return i.code&&!i.href&&(i.href="https://help.ably.io/error/"+i.code),i}};function M(e,...t){for(let r=0;r<t.length;r++){let s=t[r];if(!s)break;for(let t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t])}return e}function P(e){return M({},e)}function D(e){return U(e)?[]:Array.isArray(e)?e:[e]}function L(e){return"[object Object]"==Object.prototype.toString.call(e)}function $(e){for(let t in e)return!1;return!0}function U(e){return null==e}function B(e){let t={};for(let r in e)t[r]=e[r];return t}function z(e,t){class r{}r.prototype=e;let s=new r;return t&&M(s,t),s}var q=function(e,t){S.Config.inherits?S.Config.inherits(e,t):(e.super_=t,e.prototype=z(t.prototype,{constructor:e}))};function F(e,t){for(let r in e)if(e[r]==t)return!0;return!1}function H(e,t){return Array.isArray(t)?W(e,t):G(e,t)}function W(e,t){let r=[];for(let s=0;s<e.length;s++){let n=e[s];-1!=t.indexOf(n)&&r.push(n)}return r}function G(e,t){let r=[];for(let s=0;s<e.length;s++){let n=e[s];n in t&&r.push(n)}return r}function V(e,t){let r=e.indexOf(t),s=-1!=r;return s&&e.splice(r,1),s}function K(e,t){let r=e.slice();return V(r,t),r}function J(e,t){let r=[];for(let s in e)(!t||Object.prototype.hasOwnProperty.call(e,s))&&r.push(s);return r}function Y(e,t){let r=[];for(let s in e)(!t||Object.prototype.hasOwnProperty.call(e,s))&&r.push(e[s]);return r}function X(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&e[r]&&t(r)}function Q(e,t){if(0===e.length)return!0;let r=e[0][t];return e.every(function(e){return e[t]===r})}var Z=((r=Z||{}).msgpack="msgpack",r.json="json",r);function ee(e){return e.splice(Math.floor(Math.random()*e.length),1)[0]}function et(e){let t=[];if(e)for(let r in e)t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.length?"?"+t.join("&"):""}function er(e){let t,r=/([^?&=]+)=?([^&]*)/g,s={};for(;t=r.exec(e);)s[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return s}function es(e){return"object"==typeof e&&null!==e&&(e instanceof T||e instanceof I)}function en(e){var t,r;return e instanceof Error||(null==(t=null==e?void 0:e.constructor)?void 0:t.name)==="ErrorInfo"||(null==(r=null==e?void 0:e.constructor)?void 0:r.name)==="PartialErrorInfo"?e.toString():S.Config.inspect(e)}function ei(e){return S.BufferUtils.isBuffer(e)?e.toString():"string"==typeof e?e:S.Config.inspect(e)}function ea(e){if(S.BufferUtils.isBuffer(e))return S.BufferUtils.byteLength(e);if("string"==typeof e)return S.Config.stringByteSize(e);if("number"==typeof e)return 8;if("boolean"==typeof e)return 1;throw Error(`Expected input of Utils.dataSizeBytes to be a string, a number, a boolean or a buffer, but was: ${typeof e}`)}function eo(){return String(Math.random()).substr(2)}var el=async e=>{let t=await S.Config.getRandomArrayBuffer(e);return S.BufferUtils.base64Encode(t)};function ec(e,t){let r=Math.min(t,e.length),s=e.slice(),n=[];for(let e=0;e<r;e++)n.push(ee(s));return n}function ed(e,t){e.then(e=>{null==t||t(null,e)}).catch(e=>{null==t||t(e)})}function eu(e,t,r){return"msgpack"==r?(t||eN("MsgPack"),t.decode(e)):JSON.parse(String(e))}function eh(e,t,r){return"msgpack"==r?(t||eN("MsgPack"),t.encode(e,!0)):JSON.stringify(e)}function ep(e){return e.map(function(e){return e&&e.toLowerCase()})}function ef(e){return e.map(function(e){return e&&e.toUpperCase()})}function em(e){return Math.min((e+2)/3,2)}function eg(){return 1-.2*Math.random()}function eb(e,t){return e*em(t)*eg()}function ex(){return e.g}function ey(e,t){return Object.keys(e).every(r=>e[r]===t[r])&&Object.keys(t).every(r=>t[r]===e[r])}function ew(e){let t=e.match(/^(\[([^?]*)(?:(.*))\])?(.+)$/);if(!t||!t.length||t.length<5)throw new T("regex match failed",400,40010);if(t[2])throw new T(`cannot use a derived option with a ${t[2]} channel`,400,40010);return{qualifierParam:t[3]||"",channelName:t[4]}}function ev(e){let t=S.BufferUtils,r=t.utf8Encode(e);return t.base64Encode(r)}function ej(e,t){return e.length===t.length&&e.every(function(e,r){return e===t[r]})}function ek(e){return new T(`${e} plugin not provided`,40019,400)}function eN(e){throw ek(e)}async function eS(e,t=5e3,r="Timeout expired"){let s=new T(r,5e4,500);return Promise.race([e,new Promise((e,r)=>setTimeout(()=>r(s),t))])}var e_="2.14.0",eC={ENDPOINT:"main",ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["main.a.fallback.ably-realtime.com","main.b.fallback.ably-realtime.com","main.c.fallback.ably-realtime.com","main.d.fallback.ably-realtime.com","main.e.fallback.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:1e4,httpMaxRetryDuration:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,webSocketConnectTimeout:1e4,webSocketSlowTimeout:4e3},httpMaxRetryCount:3,maxMessageSize:65536,version:e_,protocolVersion:4,agent:"ably-js/"+e_,getPort:function(e,t){return t||e.tls?e.tlsPort:e.port},getHttpScheme:function(e){return e.tls?"https://":"http://"},getPrimaryDomainFromEndpoint:eR,getEndpointFallbackHosts:eA,getFallbackHosts:eT,getHosts:function(e){return[e.primaryDomain].concat(eT(e))},checkHost:eI,objectifyOptions:function(e,t,r,s,n){let i;if(void 0===e){let e=t?`${r} must be initialized with either a client options object, an Ably API key, or an Ably Token`:`${r} must be initialized with a client options object`;throw R.logAction(s,R.LOG_ERROR,`${r}()`,e),Error(e)}if("string"==typeof e)if(-1==e.indexOf(":")){if(!t){let e=`${r} cannot be initialized with just an Ably Token; you must provide a client options object with a \`plugins\` property. (Set this Ably Token as the object\u2019s \`token\` property.)`;throw R.logAction(s,R.LOG_ERROR,`${r}()`,e),Error(e)}i={token:e}}else{if(!t){let e=`${r} cannot be initialized with just an Ably API key; you must provide a client options object with a \`plugins\` property. (Set this Ably API key as the object\u2019s \`key\` property.)`;throw R.logAction(s,R.LOG_ERROR,`${r}()`,e),Error(e)}i={key:e}}else i=e;return n&&(i=f(j({},i),g({plugins:j(j({},n),i.plugins)}))),i},normaliseOptions:function(e,t,r){let s=null!=r?r:R.defaultLogger;e.environment&&s.deprecated("The `environment` client option","Use the `endpoint` client option instead."),e.restHost&&s.deprecated("The `restHost` client option","Use the `endpoint` client option instead."),e.realtimeHost&&s.deprecated("The `realtimeHost` client option","Use the `endpoint` client option instead.");if(e.endpoint&&(e.environment||e.restHost||e.realtimeHost))throw new T("The `endpoint` option cannot be used in conjunction with the `environment`, `restHost`, or `realtimeHost` options.",40106,400);if(e.environment&&(e.restHost||e.realtimeHost))throw new T("The `environment` option cannot be used in conjunction with the `restHost`, or `realtimeHost` options.",40106,400);"function"==typeof e.recover&&!0===e.closeOnUnload&&(R.logAction(s,R.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),e.recover=void 0),"closeOnUnload"in e||(e.closeOnUnload=!e.recover),"queueMessages"in e||(e.queueMessages=!0);let n=e.endpoint||eC.ENDPOINT;e.fallbackHosts||e.restHost||e.realtimeHost||e.port||e.tlsPort||(e.fallbackHosts=eA(e.environment||n));let i=e.environment&&`${e.environment}.realtime.ably.net`,a=e.restHost||e.realtimeHost||i||eR(n);(e.fallbackHosts||[]).concat(a).forEach(eI),e.port=e.port||eC.PORT,e.tlsPort=e.tlsPort||eC.TLS_PORT,"tls"in e||(e.tls=!0);let o=function(e){let t={};for(let r in eC.TIMEOUTS)t[r]=e[r]||eC.TIMEOUTS[r];return t}(e);t?"useBinaryProtocol"in e?e.useBinaryProtocol=S.Config.supportsBinary&&e.useBinaryProtocol:e.useBinaryProtocol=S.Config.preferBinary:e.useBinaryProtocol=!1;let l={};e.clientId&&(l["X-Ably-ClientId"]=S.BufferUtils.base64Encode(S.BufferUtils.utf8Encode(e.clientId))),"idempotentRestPublishing"in e||(e.idempotentRestPublishing=!0);let c=null,d=e.connectivityCheckUrl;if(e.connectivityCheckUrl){let[t,r]=e.connectivityCheckUrl.split("?");c=r?er(r):{},-1===t.indexOf("://")&&(t="https://"+t),d=t}let u=e.wsConnectivityCheckUrl;return u&&-1===u.indexOf("://")&&(u="wss://"+u),f(j({},e),g({primaryDomain:a,maxMessageSize:e.maxMessageSize||eC.maxMessageSize,timeouts:o,connectivityCheckParams:c,connectivityCheckUrl:d,wsConnectivityCheckUrl:u,headers:l}))},defaultGetHeaders:function(e,{format:t=eL.format,protocolVersion:r=eL.protocolVersion}={}){return{accept:eD[t],"X-Ably-Version":r.toString(),"Ably-Agent":eM(e)}},defaultPostHeaders:function(e,{format:t=eL.format,protocolVersion:r=eL.protocolVersion}={}){let s;return{accept:s=eD[t],"content-type":s,"X-Ably-Version":r.toString(),"Ably-Agent":eM(e)}}};function eE(e){return e.includes(".")||e.includes("::")||"localhost"===e}function eR(e){if(eE(e))return e;if(e.startsWith("nonprod:")){let t=e.replace("nonprod:","");return`${t}.realtime.ably-nonprod.net`}return`${e}.realtime.ably.net`}function eA(e){return eE(e)?[]:e.startsWith("nonprod:")?eO(e.replace("nonprod:",""),"ably-realtime-nonprod.com"):eO(e,"ably-realtime.com")}function eO(e,t){return["a","b","c","d","e"].map(r=>`${e}.${r}.fallback.${t}`)}function eT(e){let t=e.fallbackHosts,r=void 0!==e.httpMaxRetryCount?e.httpMaxRetryCount:eC.httpMaxRetryCount;return t?ec(t,r):[]}function eI(e){if("string"!=typeof e)throw new T("host must be a string; was a "+typeof e,4e4,400);if(!e.length)throw new T("host must not be zero-length",4e4,400)}function eM(e){let t=eC.agent;if(e.agents)for(var r in e.agents)t+=" "+r+"/"+e.agents[r];return t}function eP(e,t,r){let s=r||{};if(s.cipher){e||eN("Crypto");let r=e.getCipher(s.cipher,t);s.cipher=r.cipherParams,s.channelCipher=r.cipher}else"cipher"in s&&(s.cipher=void 0,s.channelCipher=null);return s}var eD={json:"application/json",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack",text:"text/plain"},eL={format:"json",protocolVersion:eC.protocolVersion},e$=class e{constructor(e,t){this.logger=e,this.members=t||[]}call(e,t){for(let r of this.members)if(r)try{r(e,t)}catch(e){R.logAction(this.logger,R.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+e+"; stack = "+e.stack)}}push(...e){this.members.push(...e)}createPromise(){return new Promise((e,t)=>{this.push((r,s)=>{r?t(r):e(s)})})}resolveAll(e){this.call(null,e)}rejectAll(e){this.call(e)}static create(t,r){let s=new e(t,r);return Object.assign((e,t)=>s.call(e,t),{push:e=>s.push(e),createPromise:()=>s.createPromise(),resolveAll:e=>s.resolveAll(e),rejectAll:e=>s.rejectAll(e)})}},eU=((s=eU||{}).Get="get",s.Delete="delete",s.Post="post",s.Put="put",s.Patch="patch",s),eB=((n=eB||{})[n.Success=200]="Success",n[n.NoContent=204]="NoContent",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.Forbidden=403]="Forbidden",n[n.RequestTimeout=408]="RequestTimeout",n[n.InternalServerError=500]="InternalServerError",n);function ez(e){return es(e)?(e.code||(403===e.statusCode?e.code=40300:(e.code=40170,e.statusCode=401)),e):new T(en(e),e.code||40170,e.statusCode||401)}function eq(e){if(!e)return"";"string"==typeof e&&(e=JSON.parse(e));let t=Object.create(null),r=J(e,!0);r.sort();for(let s=0;s<r.length;s++)t[r[s]]=e[r[s]].sort();return JSON.stringify(t)}function eF(e,t){if(e.authCallback)R.logAction(t,R.LOG_MINOR,"Auth()","using token auth with authCallback");else if(e.authUrl)R.logAction(t,R.LOG_MINOR,"Auth()","using token auth with authUrl");else if(e.key)R.logAction(t,R.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(e.tokenDetails)R.logAction(t,R.LOG_MINOR,"Auth()","using token auth with supplied token only");else{let e="authOptions must include valid authentication parameters";throw R.logAction(t,R.LOG_ERROR,"Auth()",e),Error(e)}}function eH(e){return e.useTokenAuth||!("useTokenAuth"in e&&!e.useTokenAuth)&&(e.authCallback||e.authUrl||e.token||e.tokenDetails)}var eW=0,eG=class{constructor(e,t){if(this.authOptions={},this.client=e,this.tokenParams=t.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,eH(t))(function(e){return!e.key&&!e.authCallback&&!e.authUrl})(t)&&R.logAction(this.logger,R.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(t.defaultTokenParams,t),eF(this.authOptions,this.logger);else{if(!t.key){const e="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw R.logAction(this.logger,R.LOG_ERROR,"Auth()",e),new T(e,40160,401)}R.logAction(this.logger,R.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(t)}}get logger(){return this.client.logger}async authorize(e,t){if(t&&t.key&&this.authOptions.key!==t.key)throw new T("Unable to update auth options with incompatible key",40102,401);try{let r=await this._forceNewToken(null!=e?e:null,null!=t?t:null);if(this.client.connection)return new Promise((e,t)=>{this.client.connection.connectionManager.onAuthUpdated(r,(r,s)=>r?t(r):e(s))});return r}catch(e){throw this.client.connection&&e.statusCode===eB.Forbidden&&this.client.connection.connectionManager.actOnErrorFromAuthorize(e),e}}async _forceNewToken(e,t){this.tokenDetails=null,this._saveTokenOptions(e,t),eF(this.authOptions,this.logger);try{return this._ensureValidAuthCredentials(!0)}finally{delete this.tokenParams.timestamp,delete this.authOptions.queryTime}}async requestToken(e,t){let r=t||this.authOptions,s=e||P(this.tokenParams),n,i=this.client;if(r.authCallback)R.logAction(this.logger,R.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),n=r.authCallback;else if(r.authUrl)R.logAction(this.logger,R.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),n=(e,t)=>{let s,n=M({accept:"application/json, text/plain"},r.authHeaders),i=r.authMethod&&"post"===r.authMethod.toLowerCase(),a=r.authUrl.indexOf("?");a>-1&&(s=er(r.authUrl.slice(a)),r.authUrl=r.authUrl.slice(0,a),i||(r.authParams=M(s,r.authParams)));let o=M({},r.authParams||{},e),l=e=>{var r,s;let n=null!=(r=e.body)?r:null,i=null;if(e.error)R.logAction(this.logger,R.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+en(e.error));else{let t=null!=(s=e.headers["content-type"])?s:null;i=Array.isArray(t)?t.join(", "):t,R.logAction(this.logger,R.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+i+"; body: "+ei(n))}if(e.error)return void t(e.error,null);if(e.unpacked)return void t(null,n);if(S.BufferUtils.isBuffer(n)&&(n=n.toString()),!i)return void t(new T("authUrl response is missing a content-type header",40170,401),null);let a=i.indexOf("application/json")>-1,o=i.indexOf("text/plain")>-1||i.indexOf("application/jwt")>-1;if(!a&&!o)return void t(new T("authUrl responded with unacceptable content-type "+i+", should be either text/plain, application/jwt or application/json",40170,401),null);if(a){if(n.length>131072)return void t(new T("authUrl response exceeded max permitted length",40170,401),null);try{n=JSON.parse(n)}catch(e){t(new T("Unexpected error processing authURL response; err = "+e.message,40170,401),null);return}}t(null,n,i)};if(R.logAction(this.logger,R.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+r.authUrl+"; Params: "+JSON.stringify(o)+"; method: "+(i?"POST":"GET")),i){let e=n||{};e["content-type"]="application/x-www-form-urlencoded";let t=et(o).slice(1);ed(this.client.http.doUri(eU.Post,r.authUrl,e,t,s),(e,t)=>e?l(e):l(t))}else ed(this.client.http.doUri(eU.Get,r.authUrl,n||{},null,o),(e,t)=>e?l(e):l(t))};else if(r.key)R.logAction(this.logger,R.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),n=(e,t)=>{ed(this.createTokenRequest(e,r),(e,r)=>t(e,null!=r?r:null))};else throw R.logAction(this.logger,R.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),new T("Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)",40171,403);"capability"in s&&(s.capability=eq(s.capability));let a=(e,t)=>{let s="/keys/"+e.keyName+"/requestToken",n=eC.defaultPostHeaders(this.client.options);r.requestHeaders&&M(n,r.requestHeaders),R.logAction(this.logger,R.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+s+"; Token params: "+JSON.stringify(e)),ed(this.client.http.do(eU.Post,function(e){return i.baseUri(e)+s},n,JSON.stringify(e),null),(e,r)=>e?t(e):t(r.error,r.body,r.unpacked))};return new Promise((e,t)=>{let i=!1,o=this.client.options.timeouts.realtimeRequestTimeout,l=setTimeout(()=>{i=!0;let e="Token request callback timed out after "+o/1e3+" seconds";R.logAction(this.logger,R.LOG_ERROR,"Auth.requestToken()",e),t(new T(e,40170,401))},o);n(s,(s,n,o)=>{if(i)return;if(clearTimeout(l),s){R.logAction(this.logger,R.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+en(s)),t(ez(s));return}if("string"==typeof n)return void(0===n.length?t(new T("Token string is empty",40170,401)):n.length>131072?t(new T("Token string exceeded max permitted length (was "+n.length+" bytes)",40170,401)):"undefined"===n||"null"===n?t(new T("Token string was literal null/undefined",40170,401)):"{"!==n[0]||o&&o.indexOf("application/jwt")>-1?e({token:n}):t(new T("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)));if("object"!=typeof n||null===n){let e="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof n;R.logAction(this.logger,R.LOG_ERROR,"Auth.requestToken()",e),t(new T(e,40170,401));return}let c=JSON.stringify(n).length;if(c>131072&&!r.suppressMaxLengthCheck)return void t(new T("Token request/details object exceeded max permitted stringified size (was "+c+" bytes)",40170,401));if("issued"in n)return void e(n);if(!("keyName"in n)){let e="Expected token request callback to call back with a token string, token request object, or token details object";R.logAction(this.logger,R.LOG_ERROR,"Auth.requestToken()",e),t(new T(e,40170,401));return}a(n,(r,s,n)=>{if(r){R.logAction(this.logger,R.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+en(r)),t(ez(r));return}n||(s=JSON.parse(s)),R.logAction(this.logger,R.LOG_MINOR,"Auth.getToken()","token received"),e(s)})})})}async createTokenRequest(e,t){let r,s,n,i;t=t||this.authOptions,e=e||P(this.tokenParams);let a=t.key;if(!a)throw new T("No key specified",40101,403);let o=a.split(":"),l=o[0],c=o[1];if(!c)throw new T("Invalid key specified",40101,403);if(""===e.clientId)throw new T("clientId cant be an empty string",40012,400);"capability"in e&&(e.capability=eq(e.capability));let d=M({keyName:l},e),u=e.clientId||"",h=e.ttl||"",p=e.capability||"";d.timestamp||(d.timestamp=await this._getTimestamp(t&&t.queryTime));let f=d.nonce||(d.nonce=("000000"+Math.floor(1e16*Math.random())).slice(-16)),m=d.timestamp,g=d.keyName+"\n"+h+"\n"+p+"\n"+u+"\n"+m+"\n"+f+"\n";return d.mac=d.mac||(s=(r=S.BufferUtils).utf8Encode(g),n=r.utf8Encode(c),i=r.hmacSha256(s,n),r.base64Encode(i)),R.logAction(this.logger,R.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),d}async getAuthParams(){if("basic"==this.method)return{key:this.key};{let e=await this._ensureValidAuthCredentials(!1);if(!e)throw Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{access_token:e.token}}}async getAuthHeaders(){if("basic"==this.method)return{authorization:"Basic "+this.basicKey};{let e=await this._ensureValidAuthCredentials(!1);if(!e)throw Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{authorization:"Bearer "+ev(e.token)}}}_saveBasicOptions(e){this.method="basic",this.key=e.key,this.basicKey=ev(e.key),this.authOptions=e||{},"clientId"in e&&this._userSetClientId(e.clientId)}_saveTokenOptions(e,t){this.method="token",e&&(this.tokenParams=e),t&&(t.token&&(t.tokenDetails="string"==typeof t.token?{token:t.token}:t.token),t.tokenDetails&&(this.tokenDetails=t.tokenDetails),"clientId"in t&&this._userSetClientId(t.clientId),this.authOptions=t)}async _ensureValidAuthCredentials(e){let t=this.tokenDetails;if(t){if(this._tokenClientIdMismatch(t.clientId))throw new T("Mismatch between clientId in token ("+t.clientId+") and current clientId ("+this.clientId+")",40102,403);if(!this.client.isTimeOffsetSet()||!t.expires||t.expires>=this.client.getTimestampUsingOffset())return R.logAction(this.logger,R.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+t.expires),t;R.logAction(this.logger,R.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}let r=(this.waitingForTokenRequest||(this.waitingForTokenRequest=e$.create(this.logger))).createPromise();if(null!==this.currentTokenRequestId&&!e)return r;let s=this.currentTokenRequestId=eW++,n,i=null;try{n=await this.requestToken(this.tokenParams,this.authOptions)}catch(e){i=e}if(this.currentTokenRequestId>s)return R.logAction(this.logger,R.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one"),r;this.currentTokenRequestId=null;let a=this.waitingForTokenRequest;return(this.waitingForTokenRequest=null,i)?null==a||a.rejectAll(i):null==a||a.resolveAll(this.tokenDetails=n),r}_userSetClientId(e){if("string"!=typeof e&&null!==e)throw new T("clientId must be either a string or null",40012,400);if("*"===e)throw new T('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);{let t=this._uncheckedSetClientId(e);if(t)throw t}}_uncheckedSetClientId(e){if(!this._tokenClientIdMismatch(e))return this.clientId=this.tokenParams.clientId=e,null;{let t="Unexpected clientId mismatch: client has "+this.clientId+", requested "+e,r=new T(t,40102,401);return R.logAction(this.logger,R.LOG_ERROR,"Auth._uncheckedSetClientId()",t),r}}_tokenClientIdMismatch(e){return!!(this.clientId&&"*"!==this.clientId&&e&&"*"!==e&&this.clientId!==e)}static isTokenErr(e){return e.code&&e.code>=40140&&e.code<40150}revokeTokens(e,t){return this.client.rest.revokeTokens(e,t)}async _getTimestamp(e){return this.client.getTimestamp(e||!!this.authOptions.queryTime)}};function eV(e){let t=[];if(e)for(let r in e)t.push(r+"="+e[r]);return t.join("&")}function eK(e,t){return e+(t?"?":"")+eV(t)}var eJ=class{constructor(e){this.client=e,this.platformHttp=new S.Http(e),this.checkConnectivity=this.platformHttp.checkConnectivity?()=>this.platformHttp.checkConnectivity():void 0}get logger(){var e,t;return null!=(t=null==(e=this.client)?void 0:e.logger)?t:R.defaultLogger}get supportsAuthHeaders(){return this.platformHttp.supportsAuthHeaders}get supportsLinkHeaders(){return this.platformHttp.supportsLinkHeaders}_getHosts(e){let t=e.connection,r=t&&t.connectionManager.host;return r?[r].concat(eC.getFallbackHosts(e.options)):eC.getHosts(e.options)}async do(e,t,r,s,n){try{let i=this.client;if(!i)return{error:new T("http.do called without client",5e4,500)};let a="function"==typeof t?t:function(e){return i.baseUri(e)+t},o=i._currentFallback;if(o)if(o.validUntil>Date.now()){let l=await this.doUri(e,a(o.host),r,s,n);if(l.error&&this.platformHttp.shouldFallback(l.error))return i._currentFallback=null,this.do(e,t,r,s,n);return l}else i._currentFallback=null;let l=this._getHosts(i);if(1===l.length)return this.doUri(e,a(l[0]),r,s,n);let c=null,d=async(t,o)=>{let l=t.shift();c=null!=c?c:new Date;let u=await this.doUri(e,a(l),r,s,n);return u.error&&this.platformHttp.shouldFallback(u.error)&&t.length?Date.now()-c.getTime()>i.options.timeouts.httpMaxRetryDuration?{error:new T(`Timeout for trying fallback hosts retries. Total elapsed time exceeded the ${i.options.timeouts.httpMaxRetryDuration}ms limit`,50003,500)}:d(t,!0):(o&&(i._currentFallback={host:l,validUntil:Date.now()+i.options.timeouts.fallbackRetryTimeout}),u)};return d(l)}catch(e){return{error:new T(`Unexpected error in Http.do: ${en(e)}`,500,5e4)}}}async doUri(e,t,r,s,n){try{var i,a;(i=this.logger).shouldLog(R.LOG_MICRO)&&R.logActionNoStrip(i,R.LOG_MICRO,"Http."+e+"()","Sending; "+eK(t,n)+"; Body"+(S.BufferUtils.isBuffer(s)?" (Base64): "+S.BufferUtils.base64Encode(s):": "+s));let o=await this.platformHttp.doUri(e,t,r,s,n);return this.logger.shouldLog(R.LOG_MICRO)&&(a=this.logger,o.error?R.logActionNoStrip(a,R.LOG_MICRO,"Http."+e+"()","Received Error; "+eK(t,n)+"; Error: "+en(o.error)):R.logActionNoStrip(a,R.LOG_MICRO,"Http."+e+"()","Received; "+eK(t,n)+"; Headers: "+eV(o.headers)+"; StatusCode: "+o.statusCode+"; Body"+(S.BufferUtils.isBuffer(o.body)?" (Base64): "+S.BufferUtils.base64Encode(o.body):": "+o.body))),o}catch(e){return{error:new T(`Unexpected error in Http.doUri: ${en(e)}`,500,5e4)}}}};function eY(e,t,r){let s,n,i;for(let a=0;a<e.length;a++)if(s=e[a],r&&(s=s[r]),Array.isArray(s)){for(;-1!==(n=s.indexOf(t));)s.splice(n,1);r&&0===s.length&&delete e[a][r]}else if(L(s))for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&Array.isArray(s[i])&&eY([s],t,i)}var eX=class{constructor(e){this.logger=e,this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}on(...e){if(1===e.length){let t=e[0];if("function"==typeof t)this.any.push(t);else throw Error("EventListener.on(): Invalid arguments: "+S.Config.inspect(e))}if(2===e.length){let[t,r]=e;if("function"!=typeof r)throw Error("EventListener.on(): Invalid arguments: "+S.Config.inspect(e));if(U(t))this.any.push(r);else if(Array.isArray(t))t.forEach(e=>{this.on(e,r)});else{if("string"!=typeof t)throw Error("EventListener.on(): Invalid arguments: "+S.Config.inspect(e));(this.events[t]||(this.events[t]=[])).push(r)}}}off(...e){if(0==e.length||U(e[0])&&U(e[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}let[t,r]=e,s=null,n=null;if(1!==e.length&&r){if("function"!=typeof r)throw Error("EventEmitter.off(): invalid arguments:"+S.Config.inspect(e));[n,s]=[t,r]}else"function"==typeof t?s=t:n=t;if(s&&U(n))return void eY([this.any,this.events,this.anyOnce,this.eventsOnce],s);if(Array.isArray(n))return void n.forEach(e=>{this.off(e,s)});if("string"!=typeof n)throw Error("EventEmitter.off(): invalid arguments:"+S.Config.inspect(e));s?eY([this.events,this.eventsOnce],s,n):(delete this.events[n],delete this.eventsOnce[n])}listeners(e){if(e){let t=this.events[e]||[];return this.eventsOnce[e]&&Array.prototype.push.apply(t,this.eventsOnce[e]),t.length?t:null}return this.any.length?this.any:null}emit(e,...t){let r={event:e},s=[];this.anyOnce.length&&(Array.prototype.push.apply(s,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(s,this.any);let n=this.eventsOnce[e];n&&(Array.prototype.push.apply(s,n),delete this.eventsOnce[e]);let i=this.events[e];i&&Array.prototype.push.apply(s,i),s.forEach(e=>{var s=this.logger;try{e.apply(r,t)}catch(e){R.logAction(s,R.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+e+"; stack = "+(e&&e.stack))}})}once(...e){let t=e.length;if(0===t||1===t&&"function"!=typeof e[0]){let t=e[0];return new Promise(e=>{this.once(t,e)})}let[r,s]=e;if(1===e.length&&"function"==typeof r)this.anyOnce.push(r);else if(U(r)){if("function"!=typeof s)throw Error("EventEmitter.once(): Invalid arguments:"+S.Config.inspect(e));this.anyOnce.push(s)}else if(Array.isArray(r)){let t=this,n=function(){let i=Array.prototype.slice.call(arguments);if(r.forEach(function(e){t.off(e,n)}),"function"!=typeof s)throw Error("EventEmitter.once(): Invalid arguments:"+S.Config.inspect(e));s.apply(this,i)};r.forEach(function(e){t.on(e,n)})}else{if("string"!=typeof r)throw Error("EventEmitter.once(): Invalid arguments:"+S.Config.inspect(e));let t=this.eventsOnce[r]||(this.eventsOnce[r]=[]);if(s){if("function"!=typeof s)throw Error("EventEmitter.once(): Invalid arguments:"+S.Config.inspect(e));t.push(s)}}}async whenState(e,t){if("string"!=typeof e||"string"!=typeof t)throw Error("whenState requires a valid state String argument");return e===t?null:this.once(e)}},eQ={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18,OBJECT:19,OBJECT_SYNC:20,ANNOTATION:21},eZ=[];Object.keys(eQ).forEach(function(e){eZ[eQ[e]]=e});var e0={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,HAS_OBJECTS:128,PRESENCE:65536,PUBLISH:131072,SUBSCRIBE:262144,PRESENCE_SUBSCRIBE:524288,ANNOTATION_PUBLISH:2097152,ANNOTATION_SUBSCRIBE:4194304,OBJECT_SUBSCRIBE:0x1000000,OBJECT_PUBLISH:0x2000000},e1=Object.keys(e0);e0.MODE_ALL=e0.PRESENCE|e0.PUBLISH|e0.SUBSCRIBE|e0.PRESENCE_SUBSCRIBE|e0.ANNOTATION_PUBLISH|e0.ANNOTATION_SUBSCRIBE|e0.OBJECT_SUBSCRIBE|e0.OBJECT_PUBLISH;var e2=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE","ANNOTATION_PUBLISH","ANNOTATION_SUBSCRIBE","OBJECT_SUBSCRIBE","OBJECT_PUBLISH"];function e4(e,t,r){if(r&&r.cipher){e||eN("Crypto");let s=e.getCipher(r.cipher,t);return{cipher:s.cipherParams,channelCipher:s.cipher}}return null!=r?r:{}}async function e5(e,t){let{data:r,encoding:s}=await e3(e.data,e.encoding,t);return e.data=r,e.encoding=s,e}async function e3(e,t,r){let s=r.channelCipher,n=e,i=t?t+"/":"";return S.BufferUtils.isBuffer(n)||(n=S.BufferUtils.utf8Encode(String(n)),i+="utf-8/"),{data:await s.encrypt(n),encoding:i=i+"cipher+"+s.algorithm}}async function e6(e,t){let{data:r,encoding:s}=e8(e.data,e.encoding);return(e.data=r,e.encoding=s,null!=t&&t.cipher)?e5(e,t):e}function e8(e,t){if("string"==typeof e||S.BufferUtils.isBuffer(e)||null==e)return{data:e,encoding:t};if(L(e)||Array.isArray(e))return{data:JSON.stringify(e),encoding:t?t+"/json":"json"};throw new T("Data type is unsupported",40013,400)}async function e7(e,t){let{data:r,encoding:s,error:n}=await e9(e.data,e.encoding,t);if(e.data=r,e.encoding=s,n)throw n}async function e9(e,t,r){let s,n=r&&r.channelOptions?r:{channelOptions:r,plugins:{},baseEncodedPreviousPayload:void 0},i=e,a=e,o=t;if(t){let e,r=t.split("/"),l=r.length,c="";try{for(;(e=l)>0;){let t=r[--l].match(/([-\w]+)(\+([\w-]+))?/);if(!t)break;switch(c=t[1]){case"base64":a=S.BufferUtils.base64Decode(String(a)),e==r.length&&(i=a);continue;case"utf-8":a=S.BufferUtils.utf8Decode(a);continue;case"json":a=JSON.parse(a);continue;case"cipher":if(null!=n.channelOptions&&n.channelOptions.cipher&&n.channelOptions.channelCipher){let e=t[3],r=n.channelOptions.channelCipher;if(e!=r.algorithm)throw Error("Unable to decrypt message with given cipher; incompatible cipher params");a=await r.decrypt(a);continue}throw Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!n.plugins||!n.plugins.vcdiff)throw new T("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if("undefined"==typeof Uint8Array)throw new T("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{let e=n.baseEncodedPreviousPayload;"string"==typeof e&&(e=S.BufferUtils.utf8Encode(e));let t=S.BufferUtils.toBuffer(e);a=S.BufferUtils.toBuffer(a),i=a=S.BufferUtils.arrayBufferViewToBuffer(n.plugins.vcdiff.decode(a,t))}catch(e){throw new T("Vcdiff delta decode failed with "+e,40018,400)}continue;default:throw Error("Unknown encoding")}}}catch(e){s=new T(`Error processing the ${c} encoding, decoder returned \u2018${e.message}\u2019`,e.code||40013,400)}finally{o=e<=0?null:r.slice(0,e).join("/")}}return s?{error:s,data:a,encoding:o}:(n.baseEncodedPreviousPayload=i,{data:a,encoding:o})}function te(...e){let t=e.length>0?"json":"msgpack",{data:r,encoding:s}=tt(this.data,this.encoding,t);return Object.assign({},this,{encoding:s,data:r})}function tt(e,t,r){return e&&S.BufferUtils.isBuffer(e)?"msgpack"===r?{data:S.BufferUtils.toBuffer(e),encoding:t}:{data:S.BufferUtils.base64Encode(e),encoding:t?t+"/base64":"base64"}:{data:e,encoding:t}}var tr={encryptData:e3,encodeData:e8,encodeDataForWire:tt,decodeData:e9};function ts(e){let t,{id:r,connectionId:s,timestamp:n}=e;switch(e.action){case eQ.MESSAGE:t=e.messages;break;case eQ.PRESENCE:case eQ.SYNC:t=e.presence;break;case eQ.ANNOTATION:t=e.annotations;break;case eQ.OBJECT:case eQ.OBJECT_SYNC:t=e.state;break;default:throw new T("Unexpected action "+e.action,4e4,400)}for(let e=0;e<t.length;e++){let i=t[e];i.connectionId||(i.connectionId=s),i.timestamp||(i.timestamp=n),r&&!i.id&&(i.id=r+":"+e)}}function tn(e,t){let r="["+t;for(let t in e)"data"===t?"string"==typeof e.data?r+="; data="+e.data:S.BufferUtils.isBuffer(e.data)?r+="; data (buffer)="+S.BufferUtils.base64Encode(e.data):void 0!==e.data&&(r+="; data (json)="+JSON.stringify(e.data)):t&&("extras"===t||"operation"===t)?r+="; "+t+"="+JSON.stringify(e[t]):"version"===t?r+="; version="+JSON.stringify(e[t]):"annotations"===t?r+="; annotations="+JSON.stringify(e[t]):void 0!==e[t]&&(r+="; "+t+"="+e[t]);return r+"]"}var ti=class{},ta=class{constructor(e){var t,r,s,n,i,a,o,l,c,d;this.Platform=S,this.ErrorInfo=T,this.Logger=R,this.Defaults=eC,this.Utils=A,this.EventEmitter=eX,this.MessageEncoding=tr,this._additionalHTTPRequestImplementations=null!=(t=e.plugins)?t:null,this.logger=new R,this.logger.setLog(e.logLevel,e.logHandler),R.logAction(this.logger,R.LOG_MICRO,"BaseClient()","initialized with clientOptions "+S.Config.inspect(e)),this._MsgPack=null!=(s=null==(r=e.plugins)?void 0:r.MsgPack)?s:null;const u=this.options=eC.normaliseOptions(e,this._MsgPack,this.logger);if(u.key){const e=u.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!e){const e="invalid key parameter";throw R.logAction(this.logger,R.LOG_ERROR,"BaseClient()",e),new T(e,40400,404)}u.keyName=e[1],u.keySecret=e[2]}if("clientId"in u){if("string"!=typeof u.clientId&&null!==u.clientId)throw new T("clientId must be either a string or null",40012,400);else if("*"===u.clientId)throw new T('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}R.logAction(this.logger,R.LOG_MINOR,"BaseClient()","started; version = "+eC.version),this._currentFallback=null,this.serverTimeOffset=null,this.http=new eJ(this),this.auth=new eG(this,u),this._rest=(null==(n=e.plugins)?void 0:n.Rest)?new e.plugins.Rest(this):null,this._Crypto=null!=(a=null==(i=e.plugins)?void 0:i.Crypto)?a:null,this.__FilteredSubscriptions=null!=(l=null==(o=e.plugins)?void 0:o.MessageInteractions)?l:null,this._Annotations=null!=(d=null==(c=e.plugins)?void 0:c.Annotations)?d:null}get rest(){return this._rest||eN("Rest"),this._rest}get _FilteredSubscriptions(){return this.__FilteredSubscriptions||eN("MessageInteractions"),this.__FilteredSubscriptions}get channels(){return this.rest.channels}get push(){return this.rest.push}device(){var e;return(null==(e=this.options.plugins)?void 0:e.Push)&&this.push.LocalDevice||eN("Push"),this._device||(this._device=this.push.LocalDevice.load(this)),this._device}baseUri(e){return eC.getHttpScheme(this.options)+e+":"+eC.getPort(this.options,!1)}async stats(e){return this.rest.stats(e)}async time(e){return this.rest.time(e)}async request(e,t,r,s,n,i){return this.rest.request(e,t,r,s,n,i)}batchPublish(e){return this.rest.batchPublish(e)}batchPresence(e){return this.rest.batchPresence(e)}setLog(e){this.logger.setLog(e.level,e.handler)}async getTimestamp(e){return!this.isTimeOffsetSet()&&e?this.time():this.getTimestampUsingOffset()}getTimestampUsingOffset(){return Date.now()+(this.serverTimeOffset||0)}isTimeOffsetSet(){return null!==this.serverTimeOffset}};ta.Platform=S;var to=ta,tl=class e{toJSON(){var e,t,r;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:null==(e=this.push)?void 0:e.recipient,state:null==(t=this.push)?void 0:t.state,error:null==(r=this.push)?void 0:r.error}}}toString(){var e,t,r,s;let n="[DeviceDetails";return this.id&&(n+="; id="+this.id),this.platform&&(n+="; platform="+this.platform),this.formFactor&&(n+="; formFactor="+this.formFactor),this.clientId&&(n+="; clientId="+this.clientId),this.metadata&&(n+="; metadata="+this.metadata),this.deviceIdentityToken&&(n+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(null==(e=this.push)?void 0:e.recipient)&&(n+="; push.recipient="+JSON.stringify(this.push.recipient)),(null==(t=this.push)?void 0:t.state)&&(n+="; push.state="+this.push.state),(null==(r=this.push)?void 0:r.error)&&(n+="; push.error="+JSON.stringify(this.push.error)),(null==(s=this.push)?void 0:s.metadata)&&(n+="; push.metadata="+this.push.metadata),n+="]"}static toRequestBody(e,t,r){return eh(e,t,r)}static fromResponseBody(t,r,s){return(s&&(t=eu(t,r,s)),Array.isArray(t))?e.fromValuesArray(t):e.fromValues(t)}static fromValues(t){return t.error=t.error&&T.fromValues(t.error),Object.assign(new e,t)}static fromLocalDevice(t){return Object.assign(new e,t)}static fromValuesArray(t){let r=t.length,s=Array(r);for(let n=0;n<r;n++)s[n]=e.fromValues(t[n]);return s}};async function tc(e,t,r,s){return e.http.supportsAuthHeaders?s(M(await e.auth.getAuthHeaders(),t),r):s(t,M(await e.auth.getAuthParams(),r))}var td=class e{static async get(t,r,s,n,i,a){return e.do(eU.Get,t,r,null,s,n,i,null!=a&&a)}static async delete(t,r,s,n,i,a){return e.do(eU.Delete,t,r,null,s,n,i,a)}static async post(t,r,s,n,i,a,o){return e.do(eU.Post,t,r,s,n,i,a,o)}static async patch(t,r,s,n,i,a,o){return e.do(eU.Patch,t,r,s,n,i,a,o)}static async put(t,r,s,n,i,a,o){return e.do(eU.Put,t,r,s,n,i,a,o)}static async do(e,t,r,s,n,i,a,o){var l,c;a&&((i=i||{}).envelope=a);let d=t.logger;async function u(n,i){var a;if(d.shouldLog(R.LOG_MICRO)){let o=s;if((null==(a=n["content-type"])?void 0:a.indexOf("msgpack"))>0)try{t._MsgPack||eN("MsgPack"),o=t._MsgPack.decode(s)}catch(t){R.logAction(d,R.LOG_MICRO,"Resource."+e+"()","Sending MsgPack Decoding Error: "+en(t))}R.logAction(d,R.LOG_MICRO,"Resource."+e+"()","Sending; "+eK(r,i)+"; Body: "+o)}let o=await t.http.do(e,r,n,s,i);return o.error&&eG.isTokenErr(o.error)?(await t.auth.authorize(null,null),tc(t,n,i,u)):{err:o.error,body:o.body,headers:o.headers,unpacked:o.unpacked,statusCode:o.statusCode}}let h=await tc(t,n,i,u);if(a&&(h=function(e,t,r){if(e.err&&!e.body)return{err:e.err};if(e.statusCode===eB.NoContent)return f(j({},e),g({body:[],unpacked:!0}));let s=e.body;if(!e.unpacked)try{s=eu(s,t,r)}catch(e){if(es(e))return{err:e};return{err:new I(en(e),null)}}if(!s)return{err:new I("unenvelope(): Response body is missing",null)};let{statusCode:n,response:i,headers:a}=s;if(void 0===n)return f(j({},e),g({body:s,unpacked:!0}));if(n<200||n>=300){let t=i&&i.error||e.err;return t||((t=Error("Error in unenveloping "+s)).statusCode=n),{err:t,body:i,headers:a,unpacked:!0,statusCode:n}}return{err:e.err,body:i,headers:a,unpacked:!0,statusCode:n}}(h,t._MsgPack,a)),d.shouldLog(R.LOG_MICRO)&&(l=h,c=i,l.err?R.logAction(d,R.LOG_MICRO,"Resource."+e+"()","Received Error; "+eK(r,c)+"; Error: "+en(l.err)):R.logAction(d,R.LOG_MICRO,"Resource."+e+"()","Received; "+eK(r,c)+"; Headers: "+eV(l.headers)+"; StatusCode: "+l.statusCode+"; Body: "+(S.BufferUtils.isBuffer(l.body)?" (Base64): "+S.BufferUtils.base64Encode(l.body):": "+S.Config.inspect(l.body)))),o)if(h.err)throw h.err;else{let e=j({},h);return delete e.err,e}return h}},tu=class{constructor(e,t,r,s,n,i){this.client=e,this.path=t,this.headers=r,this.envelope=null!=s?s:null,this.bodyHandler=n,this.useHttpPaginatedResponse=i||!1}get logger(){return this.client.logger}async get(e){let t=await td.get(this.client,this.path,this.headers,e,this.envelope,!1);return this.handlePage(t)}async delete(e){let t=await td.delete(this.client,this.path,this.headers,e,this.envelope,!1);return this.handlePage(t)}async post(e,t){let r=await td.post(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(r)}async put(e,t){let r=await td.put(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(r)}async patch(e,t){let r=await td.patch(this.client,this.path,t,this.headers,e,this.envelope,!1);return this.handlePage(r)}async handlePage(e){var t,r;let s,n,i;if(e.err&&(t=e.err,r=e.body,!(this.useHttpPaginatedResponse&&(r||"number"==typeof t.code))))throw R.logAction(this.logger,R.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+en(e.err)),e.err;try{s=e.statusCode==eB.NoContent?[]:await this.bodyHandler(e.body,e.headers||{},e.unpacked)}catch(t){throw e.err||t}return(e.headers&&(n=e.headers.Link||e.headers.link)&&(i=function(e){"string"==typeof e&&(e=e.split(","));let t={};for(let r=0;r<e.length;r++){let s=e[r].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(s){let e=function(e){let t=e.match(/^\.\/(\w+)\?(.*)$/);return t&&t[2]&&er(t[2])}(s[1]);e&&(t[s[2]]=e)}}return t}(n)),this.useHttpPaginatedResponse)?new tp(this,s,e.headers||{},e.statusCode,i,e.err):new th(this,s,i)}},th=class{constructor(e,t,r){this.resource=e,this.items=t,this._relParams=r}async first(){if(this.hasFirst())return this.get(this._relParams.first);throw new T("No link to the first page of results",40400,404)}async current(){if(this.hasCurrent())return this.get(this._relParams.current);throw new T("No link to the current page of results",40400,404)}async next(){return this.hasNext()?this.get(this._relParams.next):null}hasFirst(){return null!=this._relParams&&"first"in this._relParams}hasCurrent(){return null!=this._relParams&&"current"in this._relParams}hasNext(){return null!=this._relParams&&"next"in this._relParams}isLast(){return!this.hasNext()}async get(e){let t=this.resource,r=await td.get(t.client,t.path,t.headers,e,t.envelope,!1);return t.handlePage(r)}},tp=class extends th{constructor(e,t,r,s,n,i){super(e,t,n),this.statusCode=s,this.success=s<300&&s>=200,this.headers=r,this.errorCode=i&&i.code,this.errorMessage=i&&i.message}toJSON(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}}},tf=class e{toJSON(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}}toString(){let e="[PushChannelSubscription";return this.channel&&(e+="; channel="+this.channel),this.deviceId&&(e+="; deviceId="+this.deviceId),this.clientId&&(e+="; clientId="+this.clientId),e+="]"}static fromResponseBody(t,r,s){return(s&&(t=eu(t,r,s)),Array.isArray(t))?e.fromValuesArray(t):e.fromValues(t)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){let r=t.length,s=Array(r);for(let n=0;n<r;n++)s[n]=e.fromValues(t[n]);return s}};tf.toRequestBody=eh;var tm=class{constructor(e){var t;this.client=e,this.admin=new tg(e),S.Config.push&&(null==(t=e.options.plugins)?void 0:t.Push)&&(this.stateMachine=new e.options.plugins.Push.ActivationStateMachine(e),this.LocalDevice=e.options.plugins.Push.localDeviceFactory(tl))}async activate(e,t){await new Promise((r,s)=>{var n;(null==(n=this.client.options.plugins)?void 0:n.Push)?this.stateMachine?this.stateMachine.activatedCallback?s(new T("Activation already in progress",4e4,400)):(this.stateMachine.activatedCallback=e=>{e?s(e):r()},this.stateMachine.updateFailedCallback=t,this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledActivate(this.stateMachine,e))):s(new T("This platform is not supported as a target of push notifications",4e4,400)):s(ek("Push"))})}async deactivate(e){await new Promise((t,r)=>{var s;(null==(s=this.client.options.plugins)?void 0:s.Push)?this.stateMachine?this.stateMachine.deactivatedCallback?r(new T("Deactivation already in progress",4e4,400)):(this.stateMachine.deactivatedCallback=e=>{e?r(e):t()},this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledDeactivate(this.stateMachine,e))):r(new T("This platform is not supported as a target of push notifications",4e4,400)):r(ek("Push"))})}},tg=class{constructor(e){this.client=e,this.deviceRegistrations=new tb(e),this.channelSubscriptions=new tx(e)}async publish(e,t){let r=this.client,s=r.options.useBinaryProtocol?"msgpack":"json",n=eC.defaultPostHeaders(r.options,{format:s}),i={},a=M({recipient:e},t);M(n,r.options.headers),r.options.pushFullWait&&M(i,{fullWait:"true"});let o=eh(a,r._MsgPack,s);await td.post(r,"/push/publish",o,n,i,null,!0)}},tb=class{constructor(e){this.client=e}async save(e){let t=this.client,r=tl.fromValues(e),s=t.options.useBinaryProtocol?"msgpack":"json",n=eC.defaultPostHeaders(t.options,{format:s}),i={};M(n,t.options.headers),t.options.pushFullWait&&M(i,{fullWait:"true"});let a=eh(r,t._MsgPack,s),o=await td.put(t,"/push/deviceRegistrations/"+encodeURIComponent(e.id),a,n,i,null,!0);return tl.fromResponseBody(o.body,t._MsgPack,o.unpacked?void 0:s)}async get(e){let t=this.client,r=t.options.useBinaryProtocol?"msgpack":"json",s=eC.defaultGetHeaders(t.options,{format:r}),n=e.id||e;if("string"!=typeof n||!n.length)throw new T("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400);M(s,t.options.headers);let i=await td.get(t,"/push/deviceRegistrations/"+encodeURIComponent(n),s,{},null,!0);return tl.fromResponseBody(i.body,t._MsgPack,i.unpacked?void 0:r)}async list(e){let t=this.client,r=t.options.useBinaryProtocol?"msgpack":"json",s=this.client.http.supportsLinkHeaders?void 0:r,n=eC.defaultGetHeaders(t.options,{format:r});return M(n,t.options.headers),new tu(t,"/push/deviceRegistrations",n,s,async function(e,s,n){return tl.fromResponseBody(e,t._MsgPack,n?void 0:r)}).get(e)}async remove(e){let t=this.client,r=t.options.useBinaryProtocol?"msgpack":"json",s=eC.defaultGetHeaders(t.options,{format:r}),n={},i=e.id||e;if("string"!=typeof i||!i.length)throw new T("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400);M(s,t.options.headers),t.options.pushFullWait&&M(n,{fullWait:"true"}),await td.delete(t,"/push/deviceRegistrations/"+encodeURIComponent(i),s,n,null,!0)}async removeWhere(e){let t=this.client,r=t.options.useBinaryProtocol?"msgpack":"json",s=eC.defaultGetHeaders(t.options,{format:r});M(s,t.options.headers),t.options.pushFullWait&&M(e,{fullWait:"true"}),await td.delete(t,"/push/deviceRegistrations",s,e,null,!0)}},tx=class e{constructor(t){this.remove=e.prototype.removeWhere,this.client=t}async save(e){let t=this.client,r=tf.fromValues(e),s=t.options.useBinaryProtocol?"msgpack":"json",n=eC.defaultPostHeaders(t.options,{format:s}),i={};M(n,t.options.headers),t.options.pushFullWait&&M(i,{fullWait:"true"});let a=eh(r,t._MsgPack,s),o=await td.post(t,"/push/channelSubscriptions",a,n,i,null,!0);return tf.fromResponseBody(o.body,t._MsgPack,o.unpacked?void 0:s)}async list(e){let t=this.client,r=t.options.useBinaryProtocol?"msgpack":"json",s=this.client.http.supportsLinkHeaders?void 0:r,n=eC.defaultGetHeaders(t.options,{format:r});return M(n,t.options.headers),new tu(t,"/push/channelSubscriptions",n,s,async function(e,s,n){return tf.fromResponseBody(e,t._MsgPack,n?void 0:r)}).get(e)}async removeWhere(e){let t=this.client,r=t.options.useBinaryProtocol?"msgpack":"json",s=eC.defaultGetHeaders(t.options,{format:r});M(s,t.options.headers),t.options.pushFullWait&&M(e,{fullWait:"true"}),await td.delete(t,"/push/channelSubscriptions",s,e,null,!0)}async listChannels(e){let t=this.client,r=t.options.useBinaryProtocol?"msgpack":"json",s=this.client.http.supportsLinkHeaders?void 0:r,n=eC.defaultGetHeaders(t.options,{format:r});return M(n,t.options.headers),t.options.pushFullWait&&M(e,{fullWait:"true"}),new tu(t,"/push/channels",n,s,async function(e,s,n){let i=!n&&r?eu(e,t._MsgPack,r):e;for(let e=0;e<i.length;e++)i[e]=String(i[e]);return i}).get(e)}},ty=["absent","present","enter","leave","update"];async function tw(e,t,r,s){let n=e4(t,e,null!=s?s:null);return tS.fromValues(r).decode(n,e)}async function tv(e,t,r,s){return Promise.all(r.map(function(r){return tw(e,t,r,s)}))}async function tj(e,t){return tS.fromValues(e).decode(t.channelOptions,t.logger)}async function tk(e,t){return Promise.all(e.map(function(e){return tj(e,t)}))}var tN=class e extends ti{isSynthesized(){return!this.id||!this.connectionId||this.id.substring(this.connectionId.length,0)!==this.connectionId}parseId(){if(!this.id)throw Error("parseId(): Presence message does not contain an id");let e=this.id.split(":");return{connectionId:e[0],msgSerial:parseInt(e[1],10),index:parseInt(e[2],10)}}async encode(e){return e6(Object.assign(new tS,this,{action:ty.indexOf(this.action||"present")}),e)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}static fromData(t){return t instanceof e?t:e.fromValues({data:t})}toString(){return tn(this,"PresenceMessage")}},tS=class e extends ti{toJSON(...e){return te.call(this,...e)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}async decode(e,t){let r=Object.assign(new tN,f(j({},this),g({action:ty[this.action]})));try{await e7(r,e)}catch(e){R.logAction(t,R.LOG_ERROR,"WirePresenceMessage.decode()",en(e))}return r}toString(){return tn(this,"WirePresenceMessage")}},t_=tN,tC=class{constructor(e){this.channel=e}get logger(){return this.channel.logger}async get(e){R.logAction(this.logger,R.LOG_MICRO,"RestPresence.get()","channel = "+this.channel.name);let t=this.channel.client,r=t.options.useBinaryProtocol?"msgpack":"json",s=this.channel.client.http.supportsLinkHeaders?void 0:r,n=eC.defaultGetHeaders(t.options,{format:r});return M(n,t.options.headers),new tu(t,this.channel.client.rest.presenceMixin.basePath(this),n,s,async(e,s,n)=>tk(n?e:eu(e,t._MsgPack,r),this.channel)).get(e)}async history(e){return R.logAction(this.logger,R.LOG_MICRO,"RestPresence.history()","channel = "+this.channel.name),this.channel.client.rest.presenceMixin.history(this,e)}},tE=["message.create","message.update","message.delete","meta","message.summary"];async function tR(e,t,r,s){let n=e4(t,e,null!=s?s:null);return tD.fromValues(r).decode(n,e)}async function tA(e,t,r,s){return Promise.all(r.map(function(r){return tR(e,t,r,s)}))}async function tO(e,t){return tD.fromValues(e).decode(t.channelOptions,t.logger)}async function tT(e,t){return Promise.all(e.map(function(e){return tO(e,t)}))}async function tI(e,t){return Promise.all(e.map(e=>e.encode(t)))}function tM(e){let t,r=0;for(let s=0;s<e.length;s++)r+=(t=e[s]).size||(t.size=function(e){let t=0;return e.name&&(t+=e.name.length),e.clientId&&(t+=e.clientId.length),e.extras&&(t+=JSON.stringify(e.extras).length),e.data&&(t+=ea(e.data)),t}(t));return r}var tP=class e extends ti{expandFields(){if(this.version||(this.version={}),!this.version.serial&&this.serial&&(this.version.serial=this.serial),!this.version.timestamp&&this.timestamp&&(this.version.timestamp=this.timestamp),this.annotations?this.annotations.summary||(this.annotations.summary={}):this.annotations={summary:{}},this.annotations&&this.annotations.summary)for(let[e,t]of Object.entries(this.annotations.summary))if(e.endsWith(":distinct.v1")||e.endsWith(":unique.v1")||e.endsWith(":multiple.v1"))for(let[,e]of Object.entries(t))e.clipped||(e.clipped=!1);else e.endsWith(":flag.v1")&&!t.clipped&&(t.clipped=!1)}async encode(e){return e6(Object.assign(new tD,this,{action:tE.indexOf(this.action||"message.create")}),e)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}toString(){return tn(this,"Message")}},tD=class e extends ti{toJSON(...e){return te.call(this,...e)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}async decodeWithErr(e,t){let r,s=Object.assign(new tP,f(j({},this),g({action:tE[this.action||0]||"unknown"})));try{await e7(s,e)}catch(e){R.logAction(t,R.LOG_ERROR,"WireMessage.decode()",en(e)),r=e}return s.expandFields(),{decoded:s,err:r}}async decode(e,t){let{decoded:r}=await this.decodeWithErr(e,t);return r}toString(){return tn(this,"WireMessage")}},tL=tP,t$=class{constructor(e,t,r){var s,n;this._annotations=null,R.logAction(e.logger,R.LOG_MINOR,"RestChannel()","started; name = "+t),this.name=t,this.client=e,this.presence=new tC(this),this.channelOptions=eP(null!=(s=e._Crypto)?s:null,this.logger,r),(null==(n=e.options.plugins)?void 0:n.Push)&&(this._push=new e.options.plugins.Push.PushChannel(this)),e._Annotations&&(this._annotations=new e._Annotations.RestAnnotations(this))}get annotations(){return this._annotations||eN("Annotations"),this._annotations}get push(){return this._push||eN("Push"),this._push}get logger(){return this.client.logger}setOptions(e){var t;this.channelOptions=eP(null!=(t=this.client._Crypto)?t:null,this.logger,e)}async history(e){return R.logAction(this.logger,R.LOG_MICRO,"RestChannel.history()","channel = "+this.name),this.client.rest.channelMixin.history(this,e)}async publish(...e){let t,r,s=e[0],n=e[1];if("string"==typeof s||null===s)t=[tL.fromValues({name:s,data:n})],r=e[2];else if(L(s))t=[tL.fromValues(s)],r=e[1];else if(Array.isArray(s))t=tL.fromValuesArray(s),r=e[1];else throw new T("The single-argument form of publish() expects a message object or an array of message objects",40013,400);r||(r={});let i=this.client,a=i.options,o=a.useBinaryProtocol?"msgpack":"json",l=i.options.idempotentRestPublishing,c=eC.defaultPostHeaders(i.options,{format:o});if(M(c,a.headers),l&&t.every(function(e){return!e.id})){let e=await el(9);t.forEach(function(t,r){t.id=e+":"+r.toString()})}let d=await tI(t,this.channelOptions),u=tM(d),h=a.maxMessageSize;if(u>h)throw new T(`Maximum size of messages that can be published at once exceeded (was ${u} bytes; limit is ${h} bytes)`,40009,400);await this._publish(eh(d,i._MsgPack,o),c,r)}async _publish(e,t,r){await td.post(this.client,this.client.rest.channelMixin.basePath(this)+"/messages",e,t,r,null,!0)}async status(){return this.client.rest.channelMixin.status(this)}},tU=class e{constructor(e){this.entries=e&&e.entries||void 0,this.schema=e&&e.schema||void 0,this.appId=e&&e.appId||void 0,this.inProgress=e&&e.inProgress||void 0,this.unit=e&&e.unit||void 0,this.intervalId=e&&e.intervalId||void 0}static fromValues(t){return new e(t)}},tB=class{static basePath(e){return"/channels/"+encodeURIComponent(e.name)}static history(e,t){let r=e.client,s=r.options.useBinaryProtocol?"msgpack":"json",n=e.client.http.supportsLinkHeaders?void 0:s,i=eC.defaultGetHeaders(r.options,{format:s});return M(i,r.options.headers),new tu(r,this.basePath(e)+"/messages",i,n,async function(t,n,i){return tT(i?t:eu(t,r._MsgPack,s),e)}).get(t)}static async status(e){let t=e.client.options.useBinaryProtocol?"msgpack":"json",r=eC.defaultPostHeaders(e.client.options,{format:t});return(await td.get(e.client,this.basePath(e),r,{},t,!0)).body}},tz=class{static basePath(e){return tB.basePath(e.channel)+"/presence"}static async history(e,t){let r=e.channel.client,s=r.options.useBinaryProtocol?"msgpack":"json",n=e.channel.client.http.supportsLinkHeaders?void 0:s,i=eC.defaultGetHeaders(r.options,{format:s});return M(i,r.options.headers),new tu(r,this.basePath(e)+"/history",i,n,async(t,n,i)=>tk(i?t:eu(t,r._MsgPack,s),e.channel)).get(t)}},tq=class{constructor(e){this.channelMixin=tB,this.presenceMixin=tz,this.Resource=td,this.PaginatedResource=tu,this.DeviceDetails=tl,this.PushChannelSubscription=tf,this.client=e,this.channels=new tF(this.client),this.push=new tm(this.client)}async stats(e){let t=eC.defaultGetHeaders(this.client.options),r=this.client.options.useBinaryProtocol?"msgpack":"json",s=this.client.http.supportsLinkHeaders?void 0:r;return M(t,this.client.options.headers),new tu(this.client,"/stats",t,s,function(e,t,r){let s=r?e:JSON.parse(e);for(let e=0;e<s.length;e++)s[e]=tU.fromValues(s[e]);return s}).get(e)}async time(e){let t=eC.defaultGetHeaders(this.client.options);this.client.options.headers&&M(t,this.client.options.headers);let r=e=>this.client.baseUri(e)+"/time",{error:s,body:n,unpacked:i}=await this.client.http.do(eU.Get,r,t,null,e);if(s)throw s;i||(n=JSON.parse(n));let a=n[0];if(!a)throw new T("Internal error (unexpected result type from GET /time)",5e4,500);return this.client.serverTimeOffset=a-Date.now(),a}async request(e,t,r,s,n,i){var a;let[o,l,c]=this.client.options.useBinaryProtocol?(this.client._MsgPack||eN("MsgPack"),[this.client._MsgPack.encode,this.client._MsgPack.decode,"msgpack"]):[JSON.stringify,JSON.parse,"json"],d=this.client.http.supportsLinkHeaders?void 0:c;s=s||{};let u=e.toLowerCase(),h="get"==u?eC.defaultGetHeaders(this.client.options,{format:c,protocolVersion:r}):eC.defaultPostHeaders(this.client.options,{format:c,protocolVersion:r});"string"!=typeof n&&(n=null!=(a=o(n))?a:null),M(h,this.client.options.headers),i&&M(h,i);let p=new tu(this.client,t,h,d,async function(e,t,r){return D(r?e:l(e))},!0);if(!S.Http.methods.includes(u))throw new T("Unsupported method "+u,40500,405);return S.Http.methodsWithBody.includes(u)?p[u](s,n):p[u](s)}async batchPublish(e){let t,r;Array.isArray(e)?(t=e,r=!1):(t=[e],r=!0);let s=this.client.options.useBinaryProtocol?"msgpack":"json",n=eC.defaultPostHeaders(this.client.options,{format:s});this.client.options.headers&&M(n,this.client.options.headers);let i=eh(t,this.client._MsgPack,s),a=await td.post(this.client,"/messages",i,n,{},null,!0),o=a.unpacked?a.body:eu(a.body,this.client._MsgPack,s);return r?o[0]:o}async batchPresence(e){let t=this.client.options.useBinaryProtocol?"msgpack":"json",r=eC.defaultPostHeaders(this.client.options,{format:t});this.client.options.headers&&M(r,this.client.options.headers);let s=e.join(","),n=await td.get(this.client,"/presence",r,{channels:s},null,!0);return n.unpacked?n.body:eu(n.body,this.client._MsgPack,t)}async revokeTokens(e,t){if(eH(this.client.options))throw new T("Cannot revoke tokens when using token auth",40162,401);let r=this.client.options.keyName,s=j({targets:e.map(e=>`${e.type}:${e.value}`)},null!=t?t:{}),n=this.client.options.useBinaryProtocol?"msgpack":"json",i=eC.defaultPostHeaders(this.client.options,{format:n});this.client.options.headers&&M(i,this.client.options.headers);let a=eh(s,this.client._MsgPack,n),o=await td.post(this.client,`/keys/${r}/revokeTokens`,a,i,{},null,!0);return o.unpacked?o.body:eu(o.body,this.client._MsgPack,n)}},tF=class{constructor(e){this.client=e,this.all=Object.create(null)}get(e,t){e=String(e);let r=this.all[e];return r?t&&r.setOptions(t):this.all[e]=r=new t$(this.client,e,t),r}release(e){delete this.all[String(e)]}},tH=class extends to{constructor(e){super(eC.objectifyOptions(e,!1,"BaseRest",R.defaultLogger,{Rest:tq}))}},tW={Rest:tq},tG=class extends tL{static async fromEncoded(e,t){return tR(R.defaultLogger,S.Crypto,e,t)}static async fromEncodedArray(e,t){return tA(R.defaultLogger,S.Crypto,e,t)}static fromValues(e){return tL.fromValues(e)}},tV=class extends t_{static async fromEncoded(e,t){return tw(R.defaultLogger,S.Crypto,e,t)}static async fromEncodedArray(e,t){return tv(R.defaultLogger,S.Crypto,e,t)}static fromValues(e){return t_.fromValues(e)}},tK=["annotation.create","annotation.delete"];async function tJ(e,t,r){return t0.fromValues(t).decode(r||{},e)}async function tY(e,t,r){return Promise.all(t.map(function(t){return tJ(e,t,r)}))}async function tX(e,t){return t0.fromValues(e).decode(t.channelOptions,t.logger)}async function tQ(e,t){return Promise.all(e.map(function(e){return tX(e,t)}))}var tZ=class e extends ti{async encode(){return e6(Object.assign(new t0,this,{action:tK.indexOf(this.action||"annotation.create")}),{})}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}toString(){return tn(this,"Annotation")}},t0=class e extends ti{toJSON(...e){return te.call(this,...e)}static fromValues(t){return Object.assign(new e,t)}static fromValuesArray(t){return t.map(t=>e.fromValues(t))}async decode(e,t){let r=Object.assign(new tZ,f(j({},this),g({action:tK[this.action]})));try{await e7(r,e)}catch(e){R.logAction(t,R.LOG_ERROR,"WireAnnotation.decode()",en(e))}return r}toString(){return tn(this,"WireAnnotation")}},t1=tZ,t2=class extends t1{static async fromEncoded(e,t){return tJ(R.defaultLogger,e,t)}static async fromEncodedArray(e,t){return tY(R.defaultLogger,e,t)}static fromValues(e){return t1.fromValues(e)}};function t4(e){let t;switch(typeof e){case"string":t=e;break;case"object":t=e.serial}if(!t||"string"!=typeof t)throw new T("First argument of annotations.publish() must be either a Message (or at least an object with a string `serial` property) or a message serial (string)",40003,400);return t}function t5(e,t){let r=t4(e);if(!t||"object"!=typeof t)throw new T("Second argument of annotations.publish() must be an object (the intended annotation to publish)",40003,400);let s=t1.fromValues(t);return s.messageSerial=r,s.action||(s.action="annotation.create"),s}function t3(e,t){return e.client.rest.channelMixin.basePath(e)+"/messages/"+encodeURIComponent(t)+"/annotations"}var t6=class{constructor(e){this.channel=e}async publish(e,t){let r=t5(e,t),s=await r.encode(),n=this.channel.client,i=n.options.useBinaryProtocol?"msgpack":"json",a=eC.defaultPostHeaders(n.options,{format:i});M(a,n.options.headers);let o=eh([s],n._MsgPack,i);await td.post(n,t3(this.channel,r.messageSerial),o,a,{},null,!0)}async delete(e,t){return t.action="annotation.delete",this.publish(e,t)}async get(e,t){let r=this.channel.client,s=t4(e),n=r.options.useBinaryProtocol?"msgpack":"json",i=r.http.supportsLinkHeaders?void 0:n,a=eC.defaultGetHeaders(r.options,{format:n});return M(a,r.options.headers),new tu(r,t3(this.channel,s),a,i,async(e,t,s)=>tQ(s?e:eu(e,r._MsgPack,n),this.channel)).get(t)}};function t8(e){let t=[];if(e)for(let r=0;r<e.length;r++)t.push(e[r].toString());return"[ "+t.join(", ")+" ]"}function t7(e,t,r,s){let n,i,a,o,l;return e.error&&(n=T.fromValues(e.error)),e.messages&&(i=tD.fromValuesArray(e.messages)),t&&e.presence&&(a=t.WirePresenceMessage.fromValuesArray(e.presence)),r&&e.annotations&&(o=r.WireAnnotation.fromValuesArray(e.annotations)),s&&e.state&&(l=s.WireObjectMessage.fromValuesArray(e.state,A,tr)),Object.assign(new rr,f(j({},e),g({presence:a,messages:i,annotations:o,state:l,error:n})))}function t9(e){return t=>{var r;return t7(t,{PresenceMessage:t_,WirePresenceMessage:tS},{Annotation:t1,WireAnnotation:t0,RealtimeAnnotations:ro,RestAnnotations:t6},null!=(r=null==e?void 0:e.ObjectsPlugin)?r:null)}}function re(e){return Object.assign(new rr,e)}function rt(e,t,r,s){let n,i="[ProtocolMessage";void 0!==e.action&&(i+="; action="+eZ[e.action]);let a=["id","channel","channelSerial","connectionId","count","msgSerial","timestamp"];for(let t=0;t<a.length;t++)void 0!==e[n=a[t]]&&(i+="; "+n+"="+e[n]);if(e.messages&&(i+="; messages="+t8(tD.fromValuesArray(e.messages))),e.presence&&t&&(i+="; presence="+t8(t.WirePresenceMessage.fromValuesArray(e.presence))),e.annotations&&r&&(i+="; annotations="+t8(r.WireAnnotation.fromValuesArray(e.annotations))),e.state&&s&&(i+="; state="+t8(s.WireObjectMessage.fromValuesArray(e.state,A,tr))),e.error&&(i+="; error="+T.fromValues(e.error).toString()),e.auth&&e.auth.accessToken&&(i+="; token="+e.auth.accessToken),e.flags&&(i+="; flags="+e1.filter(e.hasFlag).join(",")),e.params){let t="";X(e.params,function(r){t.length>0&&(t+="; "),t+=r+"="+e.params[r]}),t.length>0&&(i+="; params=["+t+"]")}return i+"]"}var rr=class{constructor(){this.hasFlag=e=>(this.flags&e0[e])>0}setFlag(e){return this.flags=this.flags|e0[e]}getMode(){return(this.flags||0)&e0.MODE_ALL}encodeModesToFlags(e){e.forEach(e=>this.setFlag(e))}decodeModesFromFlags(){let e=[];return e2.forEach(t=>{this.hasFlag(t)&&e.push(t)}),e.length>0?e:void 0}},rs=class{constructor(e,t,r,s,n){this.previous=e,this.current=t,"attached"===t&&(this.resumed=r,this.hasBacklog=s),n&&(this.reason=n)}},rn=function(){},ri=class e extends eX{constructor(e,t,r){var s,n,i;super(e.logger),this._annotations=null,this._mode=0,this.retryCount=0,this.history=async function(e){R.logAction(this.logger,R.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name);let t=this.client.rest.channelMixin;if(e&&e.untilAttach){if("attached"!==this.state)throw new T("option untilAttach requires the channel to be attached",4e4,400);if(!this.properties.attachSerial)throw new T("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400);delete e.untilAttach,e.from_serial=this.properties.attachSerial}return t.history(this,e)},this.whenState=e=>eX.prototype.whenState.call(this,e,this.state),R.logAction(this.logger,R.LOG_MINOR,"RealtimeChannel()","started; name = "+t),this.name=t,this.channelOptions=eP(null!=(s=e._Crypto)?s:null,this.logger,r),this.client=e,this._presence=e._RealtimePresence?new e._RealtimePresence.RealtimePresence(this):null,e._Annotations&&(this._annotations=new e._Annotations.RealtimeAnnotations(this)),this.connectionManager=e.connection.connectionManager,this.state="initialized",this.subscriptions=new eX(this.logger),this.syncChannelSerial=void 0,this.properties={attachSerial:void 0,channelSerial:void 0},this.setOptions(r),this.errorReason=null,this._attachResume=!1,this._decodingContext={channelOptions:this.channelOptions,plugins:e.options.plugins||{},baseEncodedPreviousPayload:void 0},this._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},this._allChannelChanges=new eX(this.logger),(null==(n=e.options.plugins)?void 0:n.Push)&&(this._push=new e.options.plugins.Push.PushChannel(this)),(null==(i=e.options.plugins)?void 0:i.Objects)&&(this._objects=new e.options.plugins.Objects.Objects(this))}get presence(){return this._presence||eN("RealtimePresence"),this._presence}get annotations(){return this._annotations||eN("Annotations"),this._annotations}get push(){return this._push||eN("Push"),this._push}get objects(){return this._objects||eN("Objects"),this._objects}invalidStateError(){return new T("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)}static processListenerArgs(e){return"function"==typeof(e=Array.prototype.slice.call(e))[0]&&e.unshift(null),e}async setOptions(e){var t;let r=this.channelOptions,s=function(e){if(e&&"params"in e&&!L(e.params))return new T("options.params must be an object",4e4,400);if(e&&"modes"in e){if(!Array.isArray(e.modes))return new T("options.modes must be an array",4e4,400);for(let t=0;t<e.modes.length;t++){let r=e.modes[t];if(!r||"string"!=typeof r||!e2.includes(String.prototype.toUpperCase.call(r)))return new T("Invalid channel mode: "+r,4e4,400)}}}(e);if(s)throw s;if(this.channelOptions=eP(null!=(t=this.client._Crypto)?t:null,this.logger,e),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(e,r))return this.attachImpl(),new Promise((e,t)=>{this._allChannelChanges.once(["attached","update","detached","failed"],function(r){switch(this.event){case"update":case"attached":e();break;default:t(r.reason)}})})}_shouldReattachToSetOptions(e,t){if("attached"!==this.state&&"attaching"!==this.state)return!1;if(null==e?void 0:e.params){let r=ra(e.params),s=ra(t.params);if(Object.keys(r).length!==Object.keys(s).length||!ey(s,r))return!0}return!(null==e||!e.modes||t.modes&&ej(e.modes,t.modes))}async publish(...e){let t;if(1==e.length)if(L(e[0]))t=[tL.fromValues(e[0])];else if(Array.isArray(e[0]))t=tL.fromValuesArray(e[0]);else throw new T("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else t=[tL.fromValues({name:e[0],data:e[1]})];let r=this.client.options.maxMessageSize,s=await tI(t,this.channelOptions),n=tM(s);if(n>r)throw new T(`Maximum size of messages that can be published at once exceeded (was ${n} bytes; limit is ${r} bytes)`,40009,400);this.throwIfUnpublishableState(),R.logAction(this.logger,R.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+this.state+", message count = "+s.length);let i=re({action:eQ.MESSAGE,channel:this.name,messages:s});return this.sendMessage(i)}throwIfUnpublishableState(){if(!this.connectionManager.activeState())throw this.connectionManager.getError();if("failed"===this.state||"suspended"===this.state)throw this.invalidStateError()}onEvent(e){R.logAction(this.logger,R.LOG_MICRO,"RealtimeChannel.onEvent()","received message");let t=this.subscriptions;for(let r=0;r<e.length;r++){let s=e[r];t.emit(s.name,s)}}async attach(){return"attached"===this.state?null:new Promise((e,t)=>{this._attach(!1,null,(r,s)=>r?t(r):e(s))})}_attach(e,t,r){r||(r=e=>{e&&R.logAction(this.logger,R.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+e.toString())});let s=this.connectionManager;s.activeState()?(("attaching"!==this.state||e)&&this.requestState("attaching",t),this.once(function(e){switch(this.event){case"attached":null==r||r(null,e);break;case"detached":case"suspended":case"failed":null==r||r(e.reason||s.getError()||new T("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":null==r||r(new T("Attach request superseded by a subsequent detach request",9e4,409))}})):r(s.getError())}attachImpl(){R.logAction(this.logger,R.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");let e=re({action:eQ.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this.channelOptions.modes&&e.encodeModesToFlags(ef(this.channelOptions.modes)),this._attachResume&&e.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(e.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(e).catch(rn)}async detach(){let e=this.connectionManager;if(!e.activeState())throw e.getError();switch(this.state){case"suspended":this.notifyState("detached");return;case"detached":return;case"failed":throw new T("Unable to detach; channel state = failed",90001,400);default:this.requestState("detaching");case"detaching":return new Promise((t,r)=>{this.once(function(s){switch(this.event){case"detached":t();break;case"attached":case"suspended":case"failed":r(s.reason||e.getError()||new T("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":r(new T("Detach request superseded by a subsequent attach request",9e4,409))}})})}}detachImpl(){R.logAction(this.logger,R.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");let e=re({action:eQ.DETACH,channel:this.name});this.sendMessage(e).catch(rn)}async subscribe(...t){let[r,s]=e.processListenerArgs(t);if("failed"===this.state)throw T.fromValues(this.invalidStateError());return(r&&"object"==typeof r&&!Array.isArray(r)?this.client._FilteredSubscriptions.subscribeFilter(this,r,s):this.subscriptions.on(r,s),!1!==this.channelOptions.attachOnSubscribe)?this.attach():null}unsubscribe(...t){var r;let[s,n]=e.processListenerArgs(t);"object"==typeof s&&!n||(null==(r=this.filteredSubscriptions)?void 0:r.has(n))?this.client._FilteredSubscriptions.getAndDeleteFilteredSubscriptions(this,s,n).forEach(e=>this.subscriptions.off(e)):this.subscriptions.off(s,n)}sync(){switch(this.state){case"initialized":case"detaching":case"detached":throw new I("Unable to sync to channel; not attached",4e4)}let e=this.connectionManager;if(!e.activeState())throw e.getError();let t=re({action:eQ.SYNC,channel:this.name});this.syncChannelSerial&&(t.channelSerial=this.syncChannelSerial),e.send(t)}async sendMessage(e){return new Promise((t,r)=>{this.connectionManager.send(e,this.client.options.queueMessages,e=>{e?r(e):t()})})}async sendPresence(e){let t=re({action:eQ.PRESENCE,channel:this.name,presence:e});return this.sendMessage(t)}sendState(e){let t=re({action:eQ.OBJECT,channel:this.name,state:e});return this.sendMessage(t)}async processMessage(e){(e.action===eQ.ATTACHED||e.action===eQ.MESSAGE||e.action===eQ.PRESENCE||e.action===eQ.OBJECT||e.action===eQ.ANNOTATION)&&this.setChannelSerial(e.channelSerial);let t,r=!1;switch(e.action){case eQ.ATTACHED:{this.properties.attachSerial=e.channelSerial,this._mode=e.getMode(),this.params=e.params||{};let t=e.decodeModesFromFlags();this.modes=t&&ep(t)||void 0;let r=e.hasFlag("RESUMED"),s=e.hasFlag("HAS_PRESENCE"),n=e.hasFlag("HAS_BACKLOG"),i=e.hasFlag("HAS_OBJECTS");if("attached"===this.state){!r&&(this._presence&&this._presence.onAttached(s),this._objects&&this._objects.onAttached(i));let t=new rs(this.state,this.state,r,n,e.error);this._allChannelChanges.emit("update",t),(!r||this.channelOptions.updateOnAttached)&&this.emit("update",t)}else"detaching"===this.state?this.checkPendingState():this.notifyState("attached",e.error,r,s,n,i);break}case eQ.DETACHED:{let t=e.error?T.fromValues(e.error):new T("Channel detached",90001,404);"detaching"===this.state?this.notifyState("detached",t):"attaching"===this.state?this.notifyState("suspended",t):("attached"===this.state||"suspended"===this.state)&&this.requestState("attaching",t);break}case eQ.SYNC:if(r=!0,t=this.syncChannelSerial=e.channelSerial,!e.presence)break;case eQ.PRESENCE:{if(!e.presence)break;ts(e);let s=this.channelOptions;if(this._presence){let n=await Promise.all(e.presence.map(e=>e.decode(s,this.logger)));this._presence.setPresence(n,r,t)}break}case eQ.OBJECT:case eQ.OBJECT_SYNC:{if(!this._objects||!e.state)return;ts(e);let t=this.client.connection.connectionManager.getActiveTransportFormat(),r=e.state.map(e=>e.decode(this.client,t));e.action===eQ.OBJECT?this._objects.handleObjectMessages(r):this._objects.handleObjectSyncMessages(r,e.channelSerial);break}case eQ.MESSAGE:{if("attached"!==this.state)return void R.logAction(this.logger,R.LOG_MAJOR,"RealtimeChannel.processMessage()",'Message "'+e.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');ts(e);let t=e.messages,r=t[0],s=t[t.length-1];if(r.extras&&r.extras.delta&&r.extras.delta.from!==this._lastPayload.messageId){let t='Delta message decode failure - previous message not available for message "'+e.id+'" on this channel "'+this.name+'".';R.logAction(this.logger,R.LOG_ERROR,"RealtimeChannel.processMessage()",t),this._startDecodeFailureRecovery(new T(t,40018,400));break}let n=[];for(let e=0;e<t.length;e++){let{decoded:r,err:s}=await t[e].decodeWithErr(this._decodingContext,this.logger);if(n[e]=r,s)switch(s.code){case 40018:this._startDecodeFailureRecovery(s);return;case 40019:case 40021:this.notifyState("failed",s);return}}this._lastPayload.messageId=s.id,this._lastPayload.protocolMessageChannelSerial=e.channelSerial,this.onEvent(n);break}case eQ.ANNOTATION:{ts(e);let t=this.channelOptions;if(this._annotations){let r=await Promise.all((e.annotations||[]).map(e=>e.decode(t,this.logger)));this._annotations._processIncoming(r)}break}case eQ.ERROR:{let t=e.error;t&&80016==t.code?this.checkPendingState():this.notifyState("failed",T.fromValues(t));break}default:R.logAction(this.logger,R.LOG_MAJOR,"RealtimeChannel.processMessage()","Protocol error: unrecognised message action ("+e.action+")")}}_startDecodeFailureRecovery(e){this._lastPayload.decodeFailureRecoveryInProgress||(R.logAction(this.logger,R.LOG_MAJOR,"RealtimeChannel.processMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,e,()=>{this._lastPayload.decodeFailureRecoveryInProgress=!1}))}onAttached(){R.logAction(this.logger,R.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)}notifyState(e,t,r,s,n,i){if(R.logAction(this.logger,R.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+e),this.clearStateTimer(),["detached","suspended","failed"].includes(e)&&(this.properties.channelSerial=null),e===this.state)return;this._presence&&this._presence.actOnChannelState(e,s,t),this._objects&&this._objects.actOnChannelState(e,i),"suspended"===e&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),t&&(this.errorReason=t);let a=new rs(this.state,e,r,n,t),o='Channel state for channel "'+this.name+'"',l=e+(t?"; reason: "+t:"");"failed"===e?R.logAction(this.logger,R.LOG_ERROR,o,l):R.logAction(this.logger,R.LOG_MAJOR,o,l),"attaching"!==e&&"suspended"!==e&&(this.retryCount=0),"attached"===e&&this.onAttached(),"attached"===e?this._attachResume=!0:("detaching"===e||"failed"===e)&&(this._attachResume=!1),this.state=e,this._allChannelChanges.emit(e,a),this.emit(e,a)}requestState(e,t){R.logAction(this.logger,R.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+e),this.notifyState(e,t),this.checkPendingState()}checkPendingState(){if(!this.connectionManager.state.sendEvents)return void R.logAction(this.logger,R.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);switch(R.logAction(this.logger,R.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync()}}timeoutPendingState(){switch(this.state){case"attaching":{let e=new T("Channel attach timed out",90007,408);this.notifyState("suspended",e);break}case"detaching":{let e=new T("Channel detach timed out",90007,408);this.notifyState("attached",e);break}default:this.checkPendingState()}}startStateTimerIfNotRunning(){this.stateTimer||(this.stateTimer=setTimeout(()=>{R.logAction(this.logger,R.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),this.stateTimer=null,this.timeoutPendingState()},this.client.options.timeouts.realtimeRequestTimeout))}clearStateTimer(){let e=this.stateTimer;e&&(clearTimeout(e),this.stateTimer=null)}startRetryTimer(){if(this.retryTimer)return;this.retryCount++;let e=eb(this.client.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(()=>{"suspended"===this.state&&this.connectionManager.state.sendEvents&&(this.retryTimer=null,R.logAction(this.logger,R.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),this.requestState("attaching"))},e)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}getReleaseErr(){let e=this.state;return"initialized"===e||"detached"===e||"failed"===e?null:new T("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+e,90001,400)}setChannelSerial(e){R.logAction(this.logger,R.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+e+"; previous = "+this.properties.channelSerial),e&&(this.properties.channelSerial=e)}async status(){return this.client.rest.channelMixin.status(this)}};function ra(e){let t=e||{},{agent:r}=t;var s=t,n=["agent"],i={};for(var a in s)y.call(s,a)&&0>n.indexOf(a)&&(i[a]=s[a]);if(null!=s&&x)for(var a of x(s))0>n.indexOf(a)&&w.call(s,a)&&(i[a]=s[a]);return i}var ro=class{constructor(e){this.channel=e,this.logger=e.logger,this.subscriptions=new eX(this.logger)}async publish(e,t){let r=this.channel.name,s=t5(e,t),n=await s.encode();this.channel.throwIfUnpublishableState(),R.logAction(this.logger,R.LOG_MICRO,"RealtimeAnnotations.publish()","channelName = "+r+", sending annotation with messageSerial = "+s.messageSerial+", type = "+s.type);let i=re({action:eQ.ANNOTATION,channel:r,annotations:[n]});return this.channel.sendMessage(i)}async delete(e,t){return t.action="annotation.delete",this.publish(e,t)}async subscribe(...e){let t=ri.processListenerArgs(e),r=t[0],s=t[1],n=this.channel;if("failed"===n.state)throw T.fromValues(n.invalidStateError());if(this.subscriptions.on(r,s),!1!==this.channel.channelOptions.attachOnSubscribe&&await n.attach(),0===("attached"===this.channel.state&&this.channel._mode&e0.ANNOTATION_SUBSCRIBE))throw new T("You are trying to add an annotation listener, but you haven't requested the annotation_subscribe channel mode in ChannelOptions, so this won't do anything (we only deliver annotations to clients who have explicitly requested them)",93001,400)}unsubscribe(...e){let t=ri.processListenerArgs(e),r=t[0],s=t[1];this.subscriptions.off(r,s)}_processIncoming(e){for(let t of e)this.subscriptions.emit(t.type||"",t)}async get(e,t){return t6.prototype.get.call(this,e,t)}},rl=class e extends tH{constructor(t){var r,s;if(!e._MsgPack)throw Error("Expected DefaultRest._MsgPack to have been set");super(eC.objectifyOptions(t,!0,"Rest",R.defaultLogger,f(j({},tW),g({Crypto:null!=(r=e.Crypto)?r:void 0,MsgPack:null!=(s=e._MsgPack)?s:void 0,Annotations:{Annotation:t1,WireAnnotation:t0,RealtimeAnnotations:ro,RestAnnotations:t6}}))))}static get Crypto(){if(null===this._Crypto)throw Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(e){this._Crypto=e}};rl._Crypto=null,rl.Message=tG,rl.PresenceMessage=tV,rl.Annotation=t2,rl._MsgPack=null,rl._Http=eJ;var rc=rl,rd=class extends eX{constructor(e){super(e),this.messages=[]}count(){return this.messages.length}push(e){this.messages.push(e)}shift(){return this.messages.shift()}last(){return this.messages[this.messages.length-1]}copyAll(){return this.messages.slice()}append(e){this.messages.push.apply(this.messages,e)}prepend(e){this.messages.unshift.apply(this.messages,e)}completeMessages(e,t,r){R.logAction(this.logger,R.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+e+"; count = "+t),r=r||null;let s=this.messages;if(0===s.length)throw Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");let n=s[0];if(n){let i=n.message.msgSerial,a=e+t;if(a>i)for(let e of s.splice(0,a-i))e.callback(r);0==s.length&&this.emit("idle")}}completeAllMessages(e){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,e)}resetSendAttempted(){for(let e of this.messages)e.sendAttempted=!1}clear(){R.logAction(this.logger,R.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")}},ru=class{constructor(e,t){this.message=e,this.callback=t,this.merged=!1;const r=e.action;this.sendAttempted=!1,this.ackRequired="number"==typeof r&&[eQ.MESSAGE,eQ.PRESENCE,eQ.ANNOTATION,eQ.OBJECT].includes(r)}},rh=class extends eX{constructor(e){super(e.logger),this.transport=e,this.messageQueue=new rd(this.logger),e.on("ack",(e,t)=>{this.onAck(e,t)}),e.on("nack",(e,t,r)=>{this.onNack(e,t,r)})}onAck(e,t){R.logAction(this.logger,R.LOG_MICRO,"Protocol.onAck()","serial = "+e+"; count = "+t),this.messageQueue.completeMessages(e,t)}onNack(e,t,r){R.logAction(this.logger,R.LOG_ERROR,"Protocol.onNack()","serial = "+e+"; count = "+t+"; err = "+en(r)),r||(r=new T("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(e,t,r)}onceIdle(e){let t=this.messageQueue;0===t.count()?e():t.once("idle",e)}send(e){e.ackRequired&&this.messageQueue.push(e),this.logger.shouldLog(R.LOG_MICRO)&&R.logActionNoStrip(this.logger,R.LOG_MICRO,"Protocol.send()","sending msg; "+rt(e.message,this.transport.connectionManager.realtime._RealtimePresence,this.transport.connectionManager.realtime._Annotations,this.transport.connectionManager.realtime._objectsPlugin)),e.sendAttempted=!0,this.transport.send(e.message)}getTransport(){return this.transport}getPendingMessages(){return this.messageQueue.copyAll()}clearPendingMessages(){return this.messageQueue.clear()}finish(){let e=this.transport;this.onceIdle(function(){e.disconnect()})}},rp=class{constructor(e,t,r,s){this.previous=e,this.current=t,r&&(this.retryIn=r),s&&(this.reason=s)}},rf={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},rm={disconnected:()=>T.fromValues({statusCode:400,code:rf.DISCONNECTED,message:"Connection to server temporarily unavailable"}),suspended:()=>T.fromValues({statusCode:400,code:rf.SUSPENDED,message:"Connection to server unavailable"}),failed:()=>T.fromValues({statusCode:400,code:rf.FAILED,message:"Connection failed or disconnected by server"}),closing:()=>T.fromValues({statusCode:400,code:rf.CLOSING,message:"Connection closing"}),closed:()=>T.fromValues({statusCode:400,code:rf.CLOSED,message:"Connection closed"}),unknownConnectionErr:()=>T.fromValues({statusCode:500,code:rf.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"}),unknownChannelErr:()=>T.fromValues({statusCode:500,code:rf.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})},rg=re({action:eQ.CLOSE}),rb=re({action:eQ.DISCONNECT}),rx=class extends eX{constructor(e,t,r,s){super(e.logger),s&&(r.format=void 0,r.heartbeats=!0),this.connectionManager=e,this.auth=t,this.params=r,this.timeouts=r.options.timeouts,this.format=r.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}connect(){}close(){this.isConnected&&this.requestClose(),this.finish("closed",rm.closed())}disconnect(e){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",e||rm.disconnected())}fail(e){this.isConnected&&this.requestDisconnect(),this.finish("failed",e||rm.failed())}finish(e,t){var r;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout(null!=(r=this.idleTimer)?r:void 0),this.idleTimer=null,this.emit(e,t),this.dispose())}onProtocolMessage(e){switch(this.logger.shouldLog(R.LOG_MICRO)&&R.logActionNoStrip(this.logger,R.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+rt(e,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),e.action){case eQ.HEARTBEAT:R.logActionNoStrip(this.logger,R.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",e.id);break;case eQ.CONNECTED:this.onConnect(e),this.emit("connected",e.error,e.connectionId,e.connectionDetails,e);break;case eQ.CLOSED:this.onClose(e);break;case eQ.DISCONNECTED:this.onDisconnect(e);break;case eQ.ACK:this.emit("ack",e.msgSerial,e.count);break;case eQ.NACK:this.emit("nack",e.msgSerial,e.count,e.error);break;case eQ.SYNC:this.connectionManager.onChannelMessage(e,this);break;case eQ.ACTIVATE:break;case eQ.AUTH:ed(this.auth.authorize(),e=>{e&&R.logAction(this.logger,R.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+en(e))});break;case eQ.ERROR:if(R.logAction(this.logger,R.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+S.Config.inspect(e.error)+(e.channel?", channel: "+e.channel:"")),void 0===e.channel){this.onFatalError(e);break}this.connectionManager.onChannelMessage(e,this);break;default:this.connectionManager.onChannelMessage(e,this)}}onConnect(e){if(this.isConnected=!0,!e.connectionDetails)throw Error("Transport.onConnect(): Connect message recieved without connectionDetails");let t=e.connectionDetails.maxIdleInterval;t&&(this.maxIdleInterval=t+this.timeouts.realtimeRequestTimeout,this.onActivity())}onDisconnect(e){let t=e&&e.error;R.logAction(this.logger,R.LOG_MINOR,"Transport.onDisconnect()","err = "+en(t)),this.finish("disconnected",t)}onFatalError(e){let t=e&&e.error;R.logAction(this.logger,R.LOG_MINOR,"Transport.onFatalError()","err = "+en(t)),this.finish("failed",t)}onClose(e){let t=e&&e.error;R.logAction(this.logger,R.LOG_MINOR,"Transport.onClose()","err = "+en(t)),this.finish("closed",t)}requestClose(){R.logAction(this.logger,R.LOG_MINOR,"Transport.requestClose()",""),this.send(rg)}requestDisconnect(){R.logAction(this.logger,R.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(rb)}ping(e){let t={action:eQ.HEARTBEAT};e&&(t.id=e),this.send(re(t))}dispose(){R.logAction(this.logger,R.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()}onActivity(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=Date.now(),this.setIdleTimer(this.maxIdleInterval+100))}setIdleTimer(e){this.idleTimer||(this.idleTimer=setTimeout(()=>{this.onIdleTimerExpire()},e))}onIdleTimerExpire(){if(!this.lastActivity||!this.maxIdleInterval)throw Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;let e=Date.now()-this.lastActivity,t=this.maxIdleInterval-e;if(t<=0){let t="No activity seen from realtime in "+e+"ms; assuming connection has dropped";R.logAction(this.logger,R.LOG_ERROR,"Transport.onIdleTimerExpire()",t),this.disconnect(new T(t,80003,408))}else this.setIdleTimer(t+100)}static tryConnect(e,t,r,s,n){let i,a=new e(t,r,s),o=function(e){clearTimeout(i),n({event:this.event,error:e})};return i=setTimeout(()=>{a.off(["preconnect","disconnected","failed"]),a.dispose(),o.call({event:"disconnected"},new T("Timeout waiting for transport to indicate itself viable",5e4,500))},t.options.timeouts.realtimeRequestTimeout),a.on(["failed","disconnected"],o),a.on("preconnect",function(){R.logAction(t.logger,R.LOG_MINOR,"Transport.tryConnect()","viable transport "+a),clearTimeout(i),a.off(["failed","disconnected"],o),n(null,a)}),a.connect(),a}static isAvailable(){throw new T("isAvailable not implemented for transport",5e4,500)}};(i=o||(o={})).WebSocket="web_socket",i.Comet="comet",i.XhrPolling="xhr_polling";var ry=e.g,rw=()=>{var e;return void 0!==S.WebStorage&&(null==(e=S.WebStorage)?void 0:e.localSupported)},rv=()=>{var e;return void 0!==S.WebStorage&&(null==(e=S.WebStorage)?void 0:e.sessionSupported)},rj=function(){},rk="ably-transport-preference";function rN(e){try{return JSON.parse(e)}catch(e){return null}}var rS=class{constructor(e,t,r,s){this.options=e,this.host=t,this.mode=r,this.connectionKey=s,this.format=e.useBinaryProtocol?"msgpack":"json"}getConnectParams(e){let t=e?P(e):{},r=this.options;switch(this.mode){case"resume":t.resume=this.connectionKey;break;case"recover":{let e=rN(r.recover);e&&(t.recover=e.connectionKey)}}return void 0!==r.clientId&&(t.clientId=r.clientId),!1===r.echoMessages&&(t.echo="false"),void 0!==this.format&&(t.format=this.format),void 0!==this.stream&&(t.stream=this.stream),void 0!==this.heartbeats&&(t.heartbeats=this.heartbeats),t.v=eC.protocolVersion,t.agent=eM(this.options),void 0!==r.transportParams&&M(t,r.transportParams),t}toString(){let e="[mode="+this.mode;return this.host&&(e+=",host="+this.host),this.connectionKey&&(e+=",connectionKey="+this.connectionKey),this.format&&(e+=",format="+this.format),e+="]"}},r_=class e extends eX{constructor(e,t){super(e.logger),this.supportedTransports={},this.disconnectedRetryCount=0,this.pendingChannelMessagesState={isProcessing:!1,queue:[]},this.realtime=e,this.initTransports(),this.options=t;const r=t.timeouts,s=r.webSocketConnectTimeout+r.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:s,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:r.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:r.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:r.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new rd(this.logger),this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionStateTtl=r.connectionStateTtl,this.maxIdleInterval=null,this.transports=H(t.transports||eC.defaultTransports,this.supportedTransports),this.transportPreference=null,this.transports.includes(o.WebSocket)&&(this.webSocketTransportAvailable=!0),this.transports.includes(o.XhrPolling)?this.baseTransport=o.XhrPolling:this.transports.includes(o.Comet)&&(this.baseTransport=o.Comet),this.domains=eC.getHosts(t),this.activeProtocol=null,this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.forceFallbackHost=!1,this.connectCounter=0,this.wsCheckResult=null,this.webSocketSlowTimer=null,this.webSocketGiveUpTimer=null,this.abandonedWebSocket=!1,R.logAction(this.logger,R.LOG_MINOR,"Realtime.ConnectionManager()","started"),R.logAction(this.logger,R.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(t.transports||eC.defaultTransports)+"]"),R.logAction(this.logger,R.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),R.logAction(this.logger,R.LOG_MICRO,"Realtime.ConnectionManager()","http domains = ["+this.domains+"]"),!this.transports.length){const e="no requested transports available";throw R.logAction(this.logger,R.LOG_ERROR,"realtime.ConnectionManager()",e),Error(e)}const n=S.Config.addEventListener;n&&(rv()&&"function"==typeof t.recover&&n("beforeunload",this.persistConnection.bind(this)),!0===t.closeOnUnload&&n("beforeunload",()=>{R.logAction(this.logger,R.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),this.requestState({state:"closing"})}),n("online",()=>{var e;this.state==this.states.disconnected||this.state==this.states.suspended?(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager caught browser online event","reattempting connection"),this.requestState({state:"connecting"})):this.state==this.states.connecting&&(null==(e=this.pendingTransport)||e.off(),this.disconnectAllTransports(),this.startConnect())}),n("offline",()=>{this.state==this.states.connected&&(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager caught browser offline event","disconnecting active transport"),this.disconnectAllTransports())}))}static supportedTransports(e){let t={supportedTransports:{}};return this.initTransports(e,t),t.supportedTransports}static initTransports(e,t){let r=j(j({},S.Transports.bundledImplementations),e);[o.WebSocket,...S.Transports.order].forEach(e=>{let s=r[e];s&&s.isAvailable()&&(t.supportedTransports[e]=s)})}initTransports(){e.initTransports(this.realtime._additionalTransportImplementations,this)}createTransportParams(e,t){return new rS(this.options,e,t,this.connectionKey)}getTransportParams(e){(e=>{if(this.connectionKey)return e("resume");if("string"==typeof this.options.recover)return e("recover");let t=this.options.recover,r=this.getSessionRecoverData(),s=this.sessionRecoveryName();if(r&&"function"==typeof t){R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data (recovery scope: "+s+")"),t(r,t=>{t?(this.options.recover=r.recoveryKey,e("recover")):e("clean")});return}e("clean")})(t=>{let r=this.createTransportParams(null,t);if("recover"===t){R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+this.options.recover);let e=rN(this.options.recover);e&&(this.msgSerial=e.msgSerial)}else R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+r.toString());e(r)})}tryATransport(e,t,r){R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+t),this.proposedTransport=rx.tryConnect(this.supportedTransports[t],this,this.realtime.auth,e,(s,n)=>{let i=this.state;if(i==this.states.closing||i==this.states.closed||i==this.states.failed){n&&(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+i.state+" while we were attempting the transport; closing "+n),n.close()),r(!0);return}if(s){if(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+t+" "+s.event+", err: "+s.error.toString()),eG.isTokenErr(s.error)&&!(this.errorReason&&eG.isTokenErr(this.errorReason)))this.errorReason=s.error,ed(this.realtime.auth._forceNewToken(null,null),s=>{s?this.actOnErrorFromAuthorize(s):this.tryATransport(e,t,r)});else if("failed"===s.event)this.notifyState({state:"failed",error:s.error}),r(!0);else if("disconnected"===s.event){var a;!(a=s.error).statusCode||!a.code||a.statusCode>=500||Object.values(rf).includes(a.code)?r(!1):(this.notifyState({state:this.states.connecting.failState,error:s.error}),r(!0))}return}R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+t+"; setting pending"),this.setTransportPending(n,e),r(null,n)})}setTransportPending(e,t){let r=t.mode;R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+e+"; mode = "+r),this.pendingTransport=e,this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),e.once("connected",(t,s,n)=>{this.activateTransport(t,e,s,n),"recover"===r&&this.options.recover&&(delete this.options.recover,this.unpersistConnection())});let s=this;e.on(["disconnected","closed","failed"],function(t){s.deactivateTransport(e,this.event,t)}),this.emit("transport.pending",e)}activateTransport(e,t,r,s){R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+t),e&&R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+e),r&&R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+r),s&&R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(s)),this.persistTransportPreference(t);let n=this.state,i=this.states.connected.state;if(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+n.state),n.state==this.states.closing.state||n.state==this.states.closed.state||n.state==this.states.failed.state)return R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),t.disconnect(),!1;if(delete this.pendingTransport,!t.isConnected)return R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+t+" since it appears to no longer be connected"),!1;let a=this.activeProtocol;this.activeProtocol=new rh(t),this.host=t.params.host;let o=s.connectionKey;if(o&&this.connectionKey!=o&&this.setConnection(r,s,!!e),this.onConnectionDetailsUpdate(s,t),S.Config.nextTick(()=>{t.on("connected",(e,r,s)=>{this.onConnectionDetailsUpdate(s,t),this.emit("update",new rp(i,i,null,e))})}),n.state===this.states.connected.state?e&&(this.errorReason=this.realtime.connection.errorReason=e,this.emit("update",new rp(i,i,null,e))):(this.notifyState({state:"connected",error:e}),this.errorReason=this.realtime.connection.errorReason=e||null),this.emit("transport.active",t),a)if(a.messageQueue.count()>0&&R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+a.transport.shortName+", new one is "+t.shortName+") finishing with "+a.messageQueue.count()+" messages still pending"),a.transport===t){let e="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+t.shortName+"; stack = "+Error().stack;R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.activateTransport()",e)}else a.finish();return!0}deactivateTransport(e,t,r){let s=this.activeProtocol,n=s&&s.getTransport()===e,i=e===this.pendingTransport,a=this.noTransportsScheduledForActivation();if(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+e),R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+t+(n?"; was active":i?"; was pending":"")+(a?"":"; another transport is scheduled for activation")),r&&r.message&&R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+r.message),n&&(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(s.getPendingMessages()),s.clearPendingMessages(),this.activeProtocol=this.host=null),this.emit("transport.inactive",e),n&&a||n&&"failed"===t||"closed"===t||null===s&&i){if("disconnected"===t&&r&&r.statusCode>500&&this.domains.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:t,error:r,retryImmediately:!0});return}let e="failed"===t&&eG.isTokenErr(r)?"disconnected":t;this.notifyState({state:e,error:r});return}}noTransportsScheduledForActivation(){return!this.pendingTransport||!this.pendingTransport.isConnected}setConnection(e,t,r){let s=this.connectionId;(s&&s!==e||!s&&r)&&(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==e&&R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=e,this.realtime.connection.key=this.connectionKey=t.connectionKey}clearConnection(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()}createRecoveryKey(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null}checkConnectionStateFreshness(){if(!this.lastActivity||!this.connectionId)return;let e=Date.now()-this.lastActivity;e>this.connectionStateTtl+this.maxIdleInterval&&(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+e+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}persistConnection(){if(rv()){let e=this.createRecoveryKey();e&&this.setSessionRecoverData({recoveryKey:e,disconnectedAt:Date.now(),location:ry.location,clientId:this.realtime.auth.clientId})}}unpersistConnection(){this.clearSessionRecoverData()}getActiveTransportFormat(){var e;return null==(e=this.activeProtocol)?void 0:e.getTransport().format}getError(){if(this.errorReason){let e=I.fromValues(this.errorReason);return e.cause=this.errorReason,e}return this.getStateError()}getStateError(){var e;return null==(e=rm[this.state.state])?void 0:e.call(rm)}activeState(){return this.state.queueEvents||this.state.sendEvents}enactStateChange(e){let t="Connection state",r=e.current+(e.reason?"; reason: "+e.reason:"");"failed"===e.current?R.logAction(this.logger,R.LOG_ERROR,t,r):R.logAction(this.logger,R.LOG_MAJOR,t,r),R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+e.current+"; reason = "+(e.reason&&e.reason.message));let s=this.state=this.states[e.current];e.reason&&(this.errorReason=e.reason,this.realtime.connection.errorReason=e.reason),(s.terminal||"suspended"===s.state)&&this.clearConnection(),this.emit("connectionstate",e)}startTransitionTimer(e){R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+e.state),this.transitionTimer&&(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(()=>{this.transitionTimer&&(this.transitionTimer=null,R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager "+e.state+" timer expired","requesting new state: "+e.failState),this.notifyState({state:e.failState}))},e.retryDelay)}cancelTransitionTimer(){R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)}startSuspendTimer(){this.suspendTimer||(this.suspendTimer=setTimeout(()=>{this.suspendTimer&&(this.suspendTimer=null,R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),this.states.connecting.failState="suspended",this.notifyState({state:"suspended"}))},this.connectionStateTtl))}checkSuspendTimer(e){"disconnected"!==e&&"suspended"!==e&&"connecting"!==e&&this.cancelSuspendTimer()}cancelSuspendTimer(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)}startRetryTimer(e){this.retryTimer=setTimeout(()=>{R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),this.retryTimer=null,this.requestState({state:"connecting"})},e)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}startWebSocketSlowTimer(){this.webSocketSlowTimer=setTimeout(()=>{R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager WebSocket slow timer","checking connectivity"),this.checkWsConnectivity().then(()=>{R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager WebSocket slow timer","ws connectivity check succeeded"),this.wsCheckResult=!0}).catch(()=>{R.logAction(this.logger,R.LOG_MAJOR,"ConnectionManager WebSocket slow timer","ws connectivity check failed"),this.wsCheckResult=!1}),this.realtime.http.checkConnectivity&&ed(this.realtime.http.checkConnectivity(),(e,t)=>{e||!t?(R.logAction(this.logger,R.LOG_MAJOR,"ConnectionManager WebSocket slow timer","http connectivity check failed"),this.cancelWebSocketGiveUpTimer(),this.notifyState({state:"disconnected",error:new T("Unable to connect (network unreachable)",80003,404)})):R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager WebSocket slow timer","http connectivity check succeeded")})},this.options.timeouts.webSocketSlowTimeout)}cancelWebSocketSlowTimer(){this.webSocketSlowTimer&&(clearTimeout(this.webSocketSlowTimer),this.webSocketSlowTimer=null)}startWebSocketGiveUpTimer(e){this.webSocketGiveUpTimer=setTimeout(()=>{var t,r;this.wsCheckResult||(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager WebSocket give up timer","websocket connection took more than 10s; "+(this.baseTransport?"trying base transport":"")),this.baseTransport?(this.abandonedWebSocket=!0,null==(t=this.proposedTransport)||t.dispose(),null==(r=this.pendingTransport)||r.dispose(),this.connectBase(e,++this.connectCounter)):R.logAction(this.logger,R.LOG_MAJOR,"ConnectionManager WebSocket give up timer","websocket connectivity appears to be unavailable but no other transports to try"))},this.options.timeouts.webSocketConnectTimeout)}cancelWebSocketGiveUpTimer(){this.webSocketGiveUpTimer&&(clearTimeout(this.webSocketGiveUpTimer),this.webSocketGiveUpTimer=null)}notifyState(e){var t;let r=e.state,s="disconnected"===r&&(this.state===this.states.connected||e.retryImmediately||this.state===this.states.connecting&&e.error&&eG.isTokenErr(e.error)&&!(this.errorReason&&eG.isTokenErr(this.errorReason)));if(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+r+(s?"; will retry connection immediately":"")),r==this.state.state||(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.checkSuspendTimer(e.state),("suspended"===r||"connected"===r)&&(this.disconnectedRetryCount=0),this.state.terminal))return;let n=this.states[e.state],i=n.retryDelay;"disconnected"===n.state&&(this.disconnectedRetryCount++,i=eb(n.retryDelay,this.disconnectedRetryCount));let a=new rp(this.state.state,n.state,i,e.error||(null==(t=rm[n.state])?void 0:t.call(rm)));if(s){let e=()=>{this.state===this.states.disconnected&&(this.lastAutoReconnectAttempt=Date.now(),this.requestState({state:"connecting"}))},t=this.lastAutoReconnectAttempt&&Date.now()-this.lastAutoReconnectAttempt+1;t&&t<1e3?(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+t+"ms ago, waiting another "+(1e3-t)+"ms before trying again"),setTimeout(e,1e3-t)):S.Config.nextTick(e)}else("disconnected"===r||"suspended"===r)&&this.startRetryTimer(i);("disconnected"===r&&!s||"suspended"===r||n.terminal)&&S.Config.nextTick(()=>{this.disconnectAllTransports()}),"connected"!=r||this.activeProtocol||R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(a),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(r,a.reason),this.failQueuedMessages(a.reason))}requestState(e){var t;let r=e.state;if(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+r+"; current state: "+this.state.state),r==this.state.state||(this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(r),"connecting"==r&&"connected"==this.state.state||"closing"==r&&"closed"==this.state.state))return;let s=this.states[r],n=new rp(this.state.state,s.state,null,e.error||(null==(t=rm[s.state])?void 0:t.call(rm)));this.enactStateChange(n),"connecting"==r&&S.Config.nextTick(()=>{this.startConnect()}),"closing"==r&&this.closeImpl()}startConnect(){if(this.state!==this.states.connecting)return void R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);let e=this.realtime.auth,t=++this.connectCounter,r=()=>{this.checkConnectionStateFreshness(),this.getTransportParams(e=>{if("recover"===e.mode&&e.options.recover){let t=rN(e.options.recover);t&&this.realtime.channels.recoverChannels(t.channelSerials)}t===this.connectCounter&&this.connectImpl(e,t)})};if(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),"basic"===e.method)r();else{let s=e=>{t===this.connectCounter&&(e?this.actOnErrorFromAuthorize(e):r())};this.errorReason&&eG.isTokenErr(this.errorReason)?ed(e._forceNewToken(null,null),s):ed(e._ensureValidAuthCredentials(!1),s)}}connectImpl(e,t){let r=this.state.state;if(r!==this.states.connecting.state)return void R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect, but was "+r);let s=this.getTransportPreference();s&&s===this.baseTransport&&this.webSocketTransportAvailable&&this.checkWsConnectivity().then(()=>{this.unpersistTransportPreference(),this.state===this.states.connecting&&(R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.connectImpl():","web socket connectivity available, cancelling connection attempt with "+this.baseTransport),this.disconnectAllTransports(),this.connectWs(e,++this.connectCounter))}).catch(rj),s&&s===this.baseTransport||this.baseTransport&&!this.webSocketTransportAvailable?this.connectBase(e,t):this.connectWs(e,t)}connectWs(e,t){R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.connectWs()"),this.wsCheckResult=null,this.abandonedWebSocket=!1,this.startWebSocketSlowTimer(),this.startWebSocketGiveUpTimer(e),this.tryTransportWithFallbacks("web_socket",e,!0,t,()=>!1!==this.wsCheckResult&&!this.abandonedWebSocket)}connectBase(e,t){R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.connectBase()"),this.baseTransport?this.tryTransportWithFallbacks(this.baseTransport,e,!1,t,()=>!0):this.notifyState({state:"disconnected",error:new T("No transports left to try",8e4,404)})}tryTransportWithFallbacks(e,t,r,s,n){R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.tryTransportWithFallbacks()",e);let i=e=>{this.notifyState({state:this.states.connecting.failState,error:e})},a=this.domains.slice(),o=(e,t)=>{if(s===this.connectCounter){if(!n()){t&&t.dispose();return}t||e||c()}},l=a.shift();if(!l)return void i(new T("Unable to connect (no available host)",80003,404));t.host=l;let c=()=>{a.length?this.realtime.http.checkConnectivity?ed(this.realtime.http.checkConnectivity(),(r,l)=>{if(s===this.connectCounter&&n()){if(r)return void i(r);if(!l)return void i(new T("Unable to connect (network unreachable)",80003,404));t.host=ee(a),this.tryATransport(t,e,o)}}):i(new I("Internal error: Http.checkConnectivity not set",null,500)):i(new T("Unable to connect (and no more fallback hosts to try)",80003,404))};if(this.forceFallbackHost&&a.length){this.forceFallbackHost=!1,c();return}this.tryATransport(t,e,o)}closeImpl(){R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),this.pendingTransport&&(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+this.pendingTransport),this.pendingTransport.close()),this.activeProtocol&&(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})}onAuthUpdated(e,t){var r;switch(this.state.state){case"connected":{R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport");let s=null==(r=this.activeProtocol)?void 0:r.getTransport();s&&s.onAuthUpdated&&s.onAuthUpdated(e);let n=re({action:eQ.AUTH,auth:{accessToken:e.token}});this.send(n);let i=()=>{this.off(a),t(null,e)},a=e=>{"failed"===e.current&&(this.off(i),this.off(a),t(e.reason||this.getStateError()))};this.once("connectiondetails",i),this.on("connectionstate",a);break}case"connecting":R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");let r=s=>{switch(s.current){case"connected":this.off(r),t(null,e);break;case"failed":case"closed":case"suspended":this.off(r),t(s.reason||this.getStateError())}};this.on("connectionstate",r),"connecting"===this.state.state?this.startConnect():this.requestState({state:"connecting"})}}}disconnectAllTransports(){R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"),this.connectCounter++,this.pendingTransport&&(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+this.pendingTransport),this.pendingTransport.disconnect()),delete this.pendingTransport,this.proposedTransport&&(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting proposed transport: "+this.pendingTransport),this.proposedTransport.disconnect()),delete this.pendingTransport,this.activeProtocol&&(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())}send(e,t,r){r=r||rj;let s=this.state;if(s.sendEvents){R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new ru(e,r));return}if(!(t&&s.queueEvents)){let e="rejecting event, queueEvent was "+t+", state was "+s.state;R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.send()",e),r(this.errorReason||new T(e,9e4,400));return}this.logger.shouldLog(R.LOG_MICRO)&&R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+rt(e,this.realtime._RealtimePresence,this.realtime._Annotations,this.realtime._objectsPlugin)),this.queue(e,r)}sendImpl(e){let t=e.message;e.ackRequired&&!e.sendAttempted&&(t.msgSerial=this.msgSerial++);try{this.activeProtocol.send(e)}catch(e){R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+e.stack)}}queue(e,t){R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.queue()","queueing event");let r=this.queuedMessages.last(),s=this.options.maxMessageSize;r&&!r.sendAttempted&&function(e,t,r){let s;if(e.channel!==t.channel||(s=e.action)!==eQ.PRESENCE&&s!==eQ.MESSAGE||s!==t.action)return!1;let n=s===eQ.PRESENCE?"presence":"messages",i=e[n].concat(t[n]);return!(tM(i)>r)&&!!Q(i,"clientId")&&!!i.every(function(e){return!e.id})&&(e[n]=i,!0)}(r.message,e,s)?(r.merged||(r.callback=e$.create(this.logger,[r.callback]),r.merged=!0),r.callback.push(t)):this.queuedMessages.push(new ru(e,t))}sendQueuedMessages(){let e;for(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");e=this.queuedMessages.shift();)this.sendImpl(e)}queuePendingMessages(e){e&&e.length&&(R.logAction(this.logger,R.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+e.length+" pending messages"),this.queuedMessages.prepend(e))}failQueuedMessages(e){let t=this.queuedMessages.count();t>0&&(R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+t+" queued messages, err = "+en(e)),this.queuedMessages.completeAllMessages(e))}onChannelMessage(e,t){this.pendingChannelMessagesState.queue.push({message:e,transport:t}),this.pendingChannelMessagesState.isProcessing||this.processNextPendingChannelMessage()}processNextPendingChannelMessage(){if(this.pendingChannelMessagesState.queue.length>0){this.pendingChannelMessagesState.isProcessing=!0;let e=this.pendingChannelMessagesState.queue.shift();this.processChannelMessage(e.message).catch(e=>{R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.processNextPendingChannelMessage() received error ",e)}).finally(()=>{this.pendingChannelMessagesState.isProcessing=!1,this.processNextPendingChannelMessage()})}}async processChannelMessage(e){await this.realtime.channels.processChannelMessage(e)}async ping(){var e;if("connected"!==this.state.state)throw new T("Unable to ping service; not connected",4e4,400);let t=null==(e=this.activeProtocol)?void 0:e.getTransport();if(!t)throw this.getStateError();R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.ping()","transport = "+t);let r=Date.now(),s=eo();return eS(new Promise(e=>{let n=i=>{i===s&&(t.off("heartbeat",n),e(Date.now()-r))};t.on("heartbeat",n),t.ping(s)}),this.options.timeouts.realtimeRequestTimeout,"Timeout waiting for heartbeat response")}abort(e){this.activeProtocol.getTransport().fail(e)}getTransportPreference(){var e,t;return this.transportPreference||rw()&&(null==(t=null==(e=S.WebStorage)?void 0:e.get)?void 0:t.call(e,rk))}persistTransportPreference(e){var t,r;this.transportPreference=e.shortName,rw()&&(null==(r=null==(t=S.WebStorage)?void 0:t.set)||r.call(t,rk,e.shortName))}unpersistTransportPreference(){var e,t;this.transportPreference=null,rw()&&(null==(t=null==(e=S.WebStorage)?void 0:e.remove)||t.call(e,rk))}actOnErrorFromAuthorize(e){if(40171===e.code)this.notifyState({state:"failed",error:e});else if(40102===e.code)this.notifyState({state:"failed",error:e});else if(e.statusCode===eB.Forbidden){let t="Client configured authentication provider returned 403; failing the connection";R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",t),this.notifyState({state:"failed",error:new T(t,80019,403,e)})}else{let t="Client configured authentication provider request failed";R.logAction(this.logger,R.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",t),this.notifyState({state:this.state.failState,error:new T(t,80019,401,e)})}}onConnectionDetailsUpdate(e,t){if(!e)return;this.connectionDetails=e,e.maxMessageSize&&(this.options.maxMessageSize=e.maxMessageSize);let r=e.clientId;if(r){let e=this.realtime.auth._uncheckedSetClientId(r);if(e){R.logAction(this.logger,R.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",e.message),t.fail(e);return}}let s=e.connectionStateTtl;s&&(this.connectionStateTtl=s),this.maxIdleInterval=e.maxIdleInterval,this.emit("connectiondetails",e)}checkWsConnectivity(){let e=this.options.wsConnectivityCheckUrl||eC.wsConnectivityCheckUrl,t=new S.Config.WebSocket(e);return new Promise((e,r)=>{let s=!1;t.onopen=()=>{s||(s=!0,e(),t.close())},t.onclose=t.onerror=()=>{s||(s=!0,r())}})}sessionRecoveryName(){return this.options.recoveryKeyStorageName||"ably-connection-recovery"}getSessionRecoverData(){var e,t;return rv()&&(null==(t=null==(e=S.WebStorage)?void 0:e.getSession)?void 0:t.call(e,this.sessionRecoveryName()))}setSessionRecoverData(e){var t,r;return rv()&&(null==(r=null==(t=S.WebStorage)?void 0:t.setSession)?void 0:r.call(t,this.sessionRecoveryName(),e))}clearSessionRecoverData(){var e,t;return rv()&&(null==(t=null==(e=S.WebStorage)?void 0:e.removeSession)?void 0:t.call(e,this.sessionRecoveryName()))}},rC=class extends eX{constructor(e,t){super(e.logger),this.whenState=e=>eX.prototype.whenState.call(this,e,this.state),this.ably=e,this.connectionManager=new r_(e,t),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.errorReason=null,this.connectionManager.on("connectionstate",e=>{let t=this.state=e.current;S.Config.nextTick(()=>{this.emit(t,e)})}),this.connectionManager.on("update",e=>{S.Config.nextTick(()=>{this.emit("update",e)})})}connect(){R.logAction(this.logger,R.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})}async ping(){return R.logAction(this.logger,R.LOG_MINOR,"Connection.ping()",""),this.connectionManager.ping()}close(){R.logAction(this.logger,R.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})}get recoveryKey(){return this.logger.deprecationWarning("The `Connection.recoveryKey` attribute has been replaced by the `Connection.createRecoveryKey()` method. Replace your usage of `recoveryKey` with the return value of `createRecoveryKey()`. `recoveryKey` will be removed in a future version."),this.createRecoveryKey()}createRecoveryKey(){return this.connectionManager.createRecoveryKey()}},rE=class e extends to{constructor(t){var r,s,n,i;if(super(eC.objectifyOptions(t,!1,"BaseRealtime",R.defaultLogger)),R.logAction(this.logger,R.LOG_MINOR,"Realtime()",""),"string"==typeof EdgeRuntime)throw new T('Ably.Realtime instance cannot be used in Vercel Edge runtime. If you are running Vercel Edge functions, please replace your "new Ably.Realtime()" with "new Ably.Rest()" and use Ably Rest API instead of the Realtime API. If you are server-rendering your application in the Vercel Edge runtime, please use the condition "if (typeof EdgeRuntime === \'string\')" to prevent instantiating Ably.Realtime instance during SSR in the Vercel Edge runtime.',4e4,400);this._additionalTransportImplementations=e.transportImplementationsFromPlugins(this.options.plugins),this._RealtimePresence=null!=(s=null==(r=this.options.plugins)?void 0:r.RealtimePresence)?s:null,this._objectsPlugin=null!=(i=null==(n=this.options.plugins)?void 0:n.Objects)?i:null,this.connection=new rC(this,this.options),this._channels=new rR(this),!1!==this.options.autoConnect&&this.connect()}static transportImplementationsFromPlugins(e){let t={};return(null==e?void 0:e.WebSocketTransport)&&(t[o.WebSocket]=e.WebSocketTransport),(null==e?void 0:e.XHRPolling)&&(t[o.XhrPolling]=e.XHRPolling),t}get channels(){return this._channels}connect(){R.logAction(this.logger,R.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()}close(){R.logAction(this.logger,R.LOG_MINOR,"Realtime.close()",""),this.connection.close()}};rE.EventEmitter=eX;var rR=class extends eX{constructor(e){super(e.logger),this.realtime=e,this.all=Object.create(null),e.connection.connectionManager.on("transport.active",()=>{this.onTransportActive()})}channelSerials(){let e={};for(let t of J(this.all,!0)){let r=this.all[t];r.properties.channelSerial&&(e[t]=r.properties.channelSerial)}return e}recoverChannels(e){for(let t of J(e,!0))this.get(t).properties.channelSerial=e[t]}async processChannelMessage(e){let t=e.channel;if(void 0===t)return void R.logAction(this.logger,R.LOG_ERROR,"Channels.processChannelMessage()","received event unspecified channel, action = "+e.action);let r=this.all[t];r?await r.processMessage(e):R.logAction(this.logger,R.LOG_ERROR,"Channels.processChannelMessage()","received event for non-existent channel: "+t)}onTransportActive(){for(let e in this.all){let t=this.all[e];"attaching"===t.state||"detaching"===t.state?t.checkPendingState():"suspended"===t.state?t._attach(!1,null):"attached"===t.state&&t.requestState("attaching")}}propogateConnectionInterruption(e,t){let r=["attaching","attached","detaching","suspended"],s={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"}[e];for(let e in this.all){let n=this.all[e];r.includes(n.state)&&n.notifyState(s,t)}}get(e,t){e=String(e);let r=this.all[e];if(r){if(t){if(r._shouldReattachToSetOptions(t,r.channelOptions))throw new T("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);r.setOptions(t)}}else r=this.all[e]=new ri(this.realtime,e,t);return r}getDerived(e,t,r){if(t.filter){let r=ev(t.filter),s=ew(e);e=`[filter=${r}${s.qualifierParam}]${s.channelName}`}return this.get(e,r)}release(e){e=String(e);let t=this.all[e];if(!t)return;let r=t.getReleaseErr();if(r)throw r;delete this.all[e]}},rA=rE;function rO(e,t){if(e.isSynthesized()||t.isSynthesized())return e.timestamp>=t.timestamp;let r=e.parseId(),s=t.parseId();return r.msgSerial===s.msgSerial?r.index>s.index:r.msgSerial>s.msgSerial}var rT=class extends eX{constructor(e,t,r=rO){super(e.logger),this.presence=e,this.map=Object.create(null),this.syncInProgress=!1,this.residualMembers=null,this.memberKey=t,this.newerThan=r}get(e){return this.map[e]}getClient(e){let t=this.map,r=[];for(let s in t){let n=t[s];n.clientId==e&&"absent"!=n.action&&r.push(n)}return r}list(e){let t=this.map,r=e&&e.clientId,s=e&&e.connectionId,n=[];for(let e in t){let i=t[e];"absent"!==i.action&&(!r||r==i.clientId)&&(s&&s!=i.connectionId||n.push(i))}return n}put(e){("enter"===e.action||"update"===e.action)&&((e=t_.fromValues(e)).action="present");let t=this.map,r=this.memberKey(e);this.residualMembers&&delete this.residualMembers[r];let s=t[r];return(!s||!!this.newerThan(e,s))&&(t[r]=e,!0)}values(){let e=this.map,t=[];for(let r in e){let s=e[r];"absent"!=s.action&&t.push(s)}return t}remove(e){let t=this.map,r=this.memberKey(e),s=t[r];return(!s||!!this.newerThan(e,s))&&(this.syncInProgress?((e=t_.fromValues(e)).action="absent",t[r]=e):delete t[r],!!s)}startSync(){let e=this.map,t=this.syncInProgress;R.logAction(this.logger,R.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),this.syncInProgress||(this.residualMembers=P(e),this.setInProgress(!0))}endSync(){let e=this.map,t=this.syncInProgress;if(R.logAction(this.logger,R.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t){for(let t in e)"absent"===e[t].action&&delete e[t];for(let t in this.presence._synthesizeLeaves(Y(this.residualMembers)),this.residualMembers)delete e[t];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")}waitSync(e){let t=this.syncInProgress;(R.logAction(this.logger,R.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t)?this.once("sync",e):e()}clear(){this.map={},this.setInProgress(!1),this.residualMembers=null}setInProgress(e){R.logAction(this.logger,R.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+e),this.syncInProgress=e,this.presence.syncComplete=!e}};function rI(e){let t=e.channel.client,r=t.auth.clientId;return(!r||"*"===r)&&"connected"===t.connection.state}var rM=class extends eX{constructor(e){super(e.logger),this.channel=e,this.syncComplete=!1,this.members=new rT(this,e=>e.clientId+":"+e.connectionId),this._myMembers=new rT(this,e=>e.clientId),this.subscriptions=new eX(this.logger),this.pendingPresence=[]}async enter(e){if(rI(this))throw new T("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,e,"enter")}async update(e){if(rI(this))throw new T("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,e,"update")}async enterClient(e,t){return this._enterOrUpdateClient(void 0,e,t,"enter")}async updateClient(e,t){return this._enterOrUpdateClient(void 0,e,t,"update")}async _enterOrUpdateClient(e,t,r,s){let n=this.channel;if(!n.connectionManager.activeState())throw n.connectionManager.getError();R.logAction(this.logger,R.LOG_MICRO,"RealtimePresence."+s+"Client()","channel = "+n.name+", id = "+e+", client = "+(t||"(implicit) "+this.channel.client.auth.clientId));let i=t_.fromData(r);i.action=s,e&&(i.id=e),t&&(i.clientId=t);let a=await i.encode(n.channelOptions);switch(n.state){case"attached":return n.sendPresence([a]);case"initialized":case"detached":n.attach();case"attaching":return new Promise((e,t)=>{this.pendingPresence.push({presence:a,callback:r=>r?t(r):e()})});default:{let e=new I("Unable to "+s+" presence channel while in "+n.state+" state",90001);throw e.code=90001,e}}}async leave(e){if(rI(this))throw new T("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,e)}async leaveClient(e,t){let r=this.channel;if(!r.connectionManager.activeState())throw r.connectionManager.getError();R.logAction(this.logger,R.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+e);let s=t_.fromData(t);s.action="leave",e&&(s.clientId=e);let n=await s.encode(r.channelOptions);switch(r.state){case"attached":return r.sendPresence([n]);case"attaching":return new Promise((e,t)=>{this.pendingPresence.push({presence:n,callback:r=>r?t(r):e()})});case"initialized":case"failed":throw new I("Unable to leave presence channel (incompatible state)",90001);default:throw r.invalidStateError()}}async get(e){let t=!e||!("waitForSync"in e)||e.waitForSync;return new Promise((r,s)=>{function n(t){r(e?t.list(e):t.values())}"suspended"===this.channel.state?t?s(T.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):n(this.members):function(e,t,r){switch(e.state){case"attached":case"suspended":r();break;case"initialized":case"detached":case"detaching":case"attaching":ed(e.attach(),function(e){e?t(e):r()});break;default:t(T.fromValues(e.invalidStateError()))}}(this.channel,e=>s(e),()=>{let e=this.members;t?e.waitSync(function(){n(e)}):n(e)})})}async history(e){R.logAction(this.logger,R.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name);let t=this.channel.client.rest.presenceMixin;if(e&&e.untilAttach)if("attached"===this.channel.state)delete e.untilAttach,e.from_serial=this.channel.properties.attachSerial;else throw new T("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400);return t.history(this,e)}setPresence(e,t,r){let s,n;R.logAction(this.logger,R.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+e.length+" participants; syncChannelSerial = "+r);let i=this.members,a=this._myMembers,o=[],l=this.channel.connectionManager.connectionId;for(let c of(t&&(this.members.startSync(),r&&(n=r.match(/^[\w-]+:(.*)$/))&&(s=n[1])),e))switch(c.action){case"leave":i.remove(c)&&o.push(c),c.connectionId!==l||c.isSynthesized()||a.remove(c);break;case"enter":case"present":case"update":i.put(c)&&o.push(c),c.connectionId===l&&a.put(c)}t&&!s&&(i.endSync(),this.channel.syncChannelSerial=null);for(let e=0;e<o.length;e++){let t=o[e];this.subscriptions.emit(t.action,t)}}onAttached(e){R.logAction(this.logger,R.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+e),e?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();let t=this.pendingPresence,r=t.length;if(r){this.pendingPresence=[];let e=[],s=e$.create(this.logger);R.logAction(this.logger,R.LOG_MICRO,"RealtimePresence.onAttached","sending "+r+" queued presence messages");for(let n=0;n<r;n++){let r=t[n];e.push(r.presence),s.push(r.callback)}this.channel.sendPresence(e).then(()=>s()).catch(e=>s(e))}}actOnChannelState(e,t,r){switch(e){case"attached":this.onAttached(t);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(r)}}failPendingPresence(e){if(this.pendingPresence.length){R.logAction(this.logger,R.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+en(e));for(let t=0;t<this.pendingPresence.length;t++)try{this.pendingPresence[t].callback(e)}catch(e){}this.pendingPresence=[]}}_clearMyMembers(){this._myMembers.clear()}_ensureMyMembersPresent(){let e=this._myMembers,t=this.channel.connectionManager.connectionId;for(let r in e.map){let s=e.map[r];R.logAction(this.logger,R.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+s.clientId+'" into the presence set');let n=s.connectionId===t?s.id:void 0;this._enterOrUpdateClient(n,s.clientId,s.data,"enter").catch(e=>{let t=new T("Presence auto re-enter failed",91004,400,e);R.logAction(this.logger,R.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()","Presence auto re-enter failed; reason = "+en(e));let r=new rs(this.channel.state,this.channel.state,!0,!1,t);this.channel.emit("update",r)})}}_synthesizeLeaves(e){let t=this.subscriptions;e.forEach(function(e){let r=t_.fromValues({action:"leave",connectionId:e.connectionId,clientId:e.clientId,data:e.data,encoding:e.encoding,timestamp:Date.now()});t.emit("leave",r)})}async subscribe(...e){let t=ri.processListenerArgs(e),r=t[0],s=t[1],n=this.channel;if("failed"===n.state)throw T.fromValues(n.invalidStateError());this.subscriptions.on(r,s),!1!==n.channelOptions.attachOnSubscribe&&await n.attach()}unsubscribe(...e){let t=ri.processListenerArgs(e),r=t[0],s=t[1];this.subscriptions.off(r,s)}},rP=o.WebSocket,rD=class extends rx{constructor(e,t,r){super(e,t,r),this.shortName=rP,r.heartbeats=S.Config.useProtocolHeartbeats,this.wsHost=r.host}static isAvailable(){return!!S.Config.WebSocket}createWebSocket(e,t){return this.uri=e+et(t),new S.Config.WebSocket(this.uri)}toString(){return"WebSocketTransport; uri="+this.uri}connect(){R.logAction(this.logger,R.LOG_MINOR,"WebSocketTransport.connect()","starting"),rx.prototype.connect.call(this);let e=this,t=this.params,r=t.options,s=(r.tls?"wss://":"ws://")+this.wsHost+":"+eC.getPort(r)+"/";R.logAction(this.logger,R.LOG_MINOR,"WebSocketTransport.connect()","uri: "+s),ed(this.auth.getAuthParams(),function(r,n){if(e.isDisposed)return;let i="";for(let e in n)i+=" "+e+": "+n[e]+";";if(R.logAction(e.logger,R.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+i+" err: "+r),r)return void e.disconnect(r);let a=t.getConnectParams(n);try{let t=e.wsConnection=e.createWebSocket(s,a);t.binaryType=S.Config.binaryType,t.onopen=function(){e.onWsOpen()},t.onclose=function(t){e.onWsClose(t)},t.onmessage=function(t){e.onWsData(t.data)},t.onerror=function(t){e.onWsError(t)},t.on&&t.on("ping",function(){e.onActivity()})}catch(t){R.logAction(e.logger,R.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(t.stack||t.message)),e.disconnect(t)}})}send(e){let t=this.wsConnection;if(!t)return void R.logAction(this.logger,R.LOG_ERROR,"WebSocketTransport.send()","No socket connection");try{t.send(eh(e,this.connectionManager.realtime._MsgPack,this.params.format))}catch(t){let e="Exception from ws connection when trying to send: "+en(t);R.logAction(this.logger,R.LOG_ERROR,"WebSocketTransport.send()",e),this.finish("disconnected",new T(e,5e4,500))}}onWsData(e){R.logAction(this.logger,R.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+e.length+"; type = "+typeof e);try{var t,r,s,n,i;this.onProtocolMessage((t=this.connectionManager.realtime._MsgPack,r=this.connectionManager.realtime._RealtimePresence,s=this.connectionManager.realtime._Annotations,n=this.connectionManager.realtime._objectsPlugin,i=this.format,t7(eu(e,t,i),r,s,n)))}catch(e){R.logAction(this.logger,R.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+e.stack)}}onWsOpen(){R.logAction(this.logger,R.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")}onWsClose(e){let t,r;if("object"==typeof e?(r=e.code,t=e.wasClean||1e3===r):t=1e3==(r=e),delete this.wsConnection,t){R.logAction(this.logger,R.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");let e=new T("Websocket closed",80003,400);this.finish("disconnected",e)}else{let e="Unclean disconnection of WebSocket ; code = "+r,t=new T(e,80003,400);R.logAction(this.logger,R.LOG_MINOR,"WebSocketTransport.onWsClose()",e),this.finish("disconnected",t)}this.emit("disposed")}onWsError(e){R.logAction(this.logger,R.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+e.message),S.Config.nextTick(()=>{this.disconnect(Error(e.message))})}dispose(){R.logAction(this.logger,R.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;let e=this.wsConnection;e&&(e.onmessage=function(){},delete this.wsConnection,S.Config.nextTick(()=>{if(R.logAction(this.logger,R.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!e)throw Error("WebSocketTransport.dispose(): wsConnection is not defined");e.close()}))}},rL=class{static subscribeFilter(e,t,r){let s=e=>{var s,n,i,a,o,l;let c={name:e.name,refTimeserial:null==(n=null==(s=e.extras)?void 0:s.ref)?void 0:n.timeserial,refType:null==(a=null==(i=e.extras)?void 0:i.ref)?void 0:a.type,isRef:!!(null==(l=null==(o=e.extras)?void 0:o.ref)?void 0:l.timeserial),clientId:e.clientId};Object.entries(t).find(([e,t])=>void 0!==t&&c[e]!==t)||r(e)};this.addFilteredSubscription(e,t,r,s),e.subscriptions.on(s)}static addFilteredSubscription(e,t,r,s){var n;if(e.filteredSubscriptions||(e.filteredSubscriptions=new Map),e.filteredSubscriptions.has(r)){let i=e.filteredSubscriptions.get(r);i.set(t,(null==(n=null==i?void 0:i.get(t))?void 0:n.concat(s))||[s])}else e.filteredSubscriptions.set(r,new Map([[t,[s]]]))}static getAndDeleteFilteredSubscriptions(e,t,r){if(!e.filteredSubscriptions)return[];if(!r&&t)return Array.from(e.filteredSubscriptions.entries()).map(([r,s])=>{var n;let i=s.get(t);return s.delete(t),0===s.size&&(null==(n=e.filteredSubscriptions)||n.delete(r)),i}).reduce((e,t)=>t?e.concat(...t):e,[]);if(!r||!e.filteredSubscriptions.has(r))return[];let s=e.filteredSubscriptions.get(r);if(!t){let t=Array.from(s.values()).reduce((e,t)=>e.concat(...t),[]);return e.filteredSubscriptions.delete(r),t}let n=s.get(t);return s.delete(t),n||[]}},r$=class e extends rA{constructor(t){var r;const s=e._MsgPack;if(!s)throw Error("Expected DefaultRealtime._MsgPack to have been set");super(eC.objectifyOptions(t,!0,"Realtime",R.defaultLogger,f(j({},tW),g({Crypto:null!=(r=e.Crypto)?r:void 0,MsgPack:s,RealtimePresence:{RealtimePresence:rM,PresenceMessage:t_,WirePresenceMessage:tS},Annotations:{Annotation:t1,WireAnnotation:t0,RealtimeAnnotations:ro,RestAnnotations:t6},WebSocketTransport:rD,MessageInteractions:rL}))))}static get Crypto(){if(null===this._Crypto)throw Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(e){this._Crypto=e}};r$.Utils=A,r$.ConnectionManager=r_,r$.ProtocolMessage=rr,r$._Crypto=null,r$.Message=tG,r$.PresenceMessage=tV,r$.Annotation=t2,r$._MsgPack=null,r$._Http=eJ,r$._PresenceMap=rT,r$._MessageEncoding=tr;var rU=r$,rB=Uint8Array,rz=Uint32Array,rq=Math.pow,rF=new rz(8),rH=[],rW=new rz(64);function rG(e){return(e-(0|e))*rq(2,32)|0}for(var rV=2,rK=0;rK<64;){for(c=2,l=!0;c<=rV/2;c++)rV%c==0&&(l=!1);l&&(rK<8&&(rF[rK]=rG(rq(rV,.5))),rH[rK]=rG(rq(rV,1/3)),rK++),rV++}var rJ=!!new rB(new rz([1]).buffer)[0];function rY(e){return rJ?e>>>24|(e>>>16&255)<<8|(65280&e)<<8|e<<24:e}function rX(e,t){return e>>>t|e<<32-t}function rQ(e){var t=rF.slice(),r=e.length,s=8*r,n=512-(s+64)%512-1+s+65,i=new rB(n/8),a=new rz(i.buffer);i.set(e,0),i[r]=128,a[a.length-1]=rY(s);for(var o=0;o<n/32;o+=16){var l=t.slice();for(c=0;c<64;c++){if(c<16)d=rY(a[o+c]);else{var c,d,u=rW[c-15],h=rW[c-2];d=rW[c-7]+rW[c-16]+(rX(u,7)^rX(u,18)^u>>>3)+(rX(h,17)^rX(h,19)^h>>>10)}rW[c]=d|=0;for(var p=(rX(l[4],6)^rX(l[4],11)^rX(l[4],25))+(l[4]&l[5]^~l[4]&l[6])+l[7]+d+rH[c],f=(rX(l[0],2)^rX(l[0],13)^rX(l[0],22))+(l[0]&l[1]^l[2]&(l[0]^l[1])),m=7;m>0;m--)l[m]=l[m-1];l[0]=p+f|0,l[4]=l[4]+p|0}for(c=0;c<8;c++)t[c]=t[c]+l[c]|0}return new rB(new rz(t.map(function(e){return rY(e)})).buffer)}var rZ=new class{constructor(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}uint8ViewToBase64(e){let t,r,s,n,i,a="",o=this.base64CharSet,l=e.byteLength,c=l%3,d=l-c;for(let l=0;l<d;l+=3)t=(0xfc0000&(i=e[l]<<16|e[l+1]<<8|e[l+2]))>>18,r=(258048&i)>>12,s=(4032&i)>>6,n=63&i,a+=o[t]+o[r]+o[s]+o[n];return 1==c?(t=(252&(i=e[d]))>>2,r=(3&i)<<4,a+=o[t]+o[r]+"=="):2==c&&(t=(64512&(i=e[d]<<8|e[d+1]))>>10,r=(1008&i)>>4,s=(15&i)<<2,a+=o[t]+o[r]+o[s]+"="),a}base64ToArrayBuffer(e){let t=null==atob?void 0:atob(e),r=t.length,s=new Uint8Array(r);for(let e=0;e<r;e++){let r=t.charCodeAt(e);s[e]=r}return this.toArrayBuffer(s)}isBuffer(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}toBuffer(e){if(!ArrayBuffer)throw Error("Can't convert to Buffer: browser does not support the necessary types");if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(this.toArrayBuffer(e));throw Error("BufferUtils.toBuffer expected an ArrayBuffer or a view onto one")}toArrayBuffer(e){if(!ArrayBuffer)throw Error("Can't convert to ArrayBuffer: browser does not support the necessary types");if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);throw Error("BufferUtils.toArrayBuffer expected an ArrayBuffer or a view onto one")}base64Encode(e){return this.uint8ViewToBase64(this.toBuffer(e))}base64UrlEncode(e){return this.base64Encode(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}base64Decode(e){if(ArrayBuffer&&S.Config.atob)return this.base64ToArrayBuffer(e);throw Error("Expected ArrayBuffer to exist and Platform.Config.atob to be configured")}hexEncode(e){return this.toBuffer(e).reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"")}hexDecode(e){if(e.length%2!=0)throw Error("Can't create a byte array from a hex string of odd length");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++)t[r]=parseInt(e.slice(2*r,2*(r+1)),16);return this.toArrayBuffer(t)}utf8Encode(e){if(S.Config.TextEncoder){let t=new S.Config.TextEncoder().encode(e);return this.toArrayBuffer(t)}throw Error("Expected TextEncoder to be configured")}utf8Decode(e){if(!this.isBuffer(e))throw Error("Expected input of utf8decode to be an arraybuffer or typed array");if(TextDecoder)return new TextDecoder().decode(e);throw Error("Expected TextDecoder to be configured")}areBuffersEqual(e,t){if(!e||!t)return!1;let r=this.toArrayBuffer(e),s=this.toArrayBuffer(t);if(r.byteLength!=s.byteLength)return!1;let n=new Uint8Array(r),i=new Uint8Array(s);for(var a=0;a<n.length;a++)if(n[a]!=i[a])return!1;return!0}byteLength(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}arrayBufferViewToBuffer(e){return this.toArrayBuffer(e)}concat(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.byteLength,0)),r=0;for(let s of e){let e=this.toBuffer(s);t.set(e,r),r+=e.byteLength}return t.buffer}sha256(e){let t=rQ(this.toBuffer(e));return this.toArrayBuffer(t)}hmacSha256(e,t){let r=function(e,t){if(e.length>64&&(e=rQ(e)),e.length<64){let t=new Uint8Array(64);t.set(e,0),e=t}for(var r=new Uint8Array(64),s=new Uint8Array(64),n=0;n<64;n++)r[n]=54^e[n],s[n]=92^e[n];var i=new Uint8Array(t.length+64);i.set(r,0),i.set(t,64);var a=new Uint8Array(96);return a.set(s,0),a.set(rQ(i),64),rQ(a)}(this.toBuffer(t),this.toBuffer(e));return this.toArrayBuffer(r)}},r0=((a=r0||{})[a.REQ_SEND=0]="REQ_SEND",a[a.REQ_RECV=1]="REQ_RECV",a[a.REQ_RECV_POLL=2]="REQ_RECV_POLL",a[a.REQ_RECV_STREAM=3]="REQ_RECV_STREAM",a);function r1(){return new T("No HTTP request plugin provided. Provide at least one of the FetchRequest or XHRRequest plugins.",400,4e4)}var r2=((d=class{constructor(e){var t;this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this.client=null!=e?e:null;const r=(null==e?void 0:e.options.connectivityCheckUrl)||eC.connectivityCheckUrl,s=null!=(t=null==e?void 0:e.options.connectivityCheckParams)?t:null,n=!(null==e?void 0:e.options.connectivityCheckUrl),i=j(j({},r2.bundledRequestImplementations),null==e?void 0:e._additionalHTTPRequestImplementations),a=i.XHRRequest,o=i.FetchRequest,l=!!(a||o);if(!l)throw r1();S.Config.xhrSupported&&a?(this.supportsAuthHeaders=!0,this.Request=async function(t,r,s,n,i){return new Promise(o=>{var l;let c=a.createRequest(r,s,n,i,r0.REQ_SEND,null!=(l=e&&e.options.timeouts)?l:null,this.logger,t);c.once("complete",(e,t,r,s,n)=>o({error:e,body:t,headers:r,unpacked:s,statusCode:n})),c.exec()})},(null==e?void 0:e.options.disableConnectivityCheck)?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var e,t;R.logAction(this.logger,R.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+r);let i=await this.doUri(eU.Get,r,null,null,s),a=!1;return a=n?!i.error&&(null==(e=i.body)?void 0:e.replace(/\n/,""))=="yes":!i.error&&(t=i.statusCode)>=200&&t<400,R.logAction(this.logger,R.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+a),a}):S.Config.fetchSupported&&o?(this.supportsAuthHeaders=!0,this.Request=async(t,r,s,n,i)=>o(t,null!=e?e:null,r,s,n,i),(null==e?void 0:e.options.disableConnectivityCheck)?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var e;R.logAction(this.logger,R.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+r);let t=await this.doUri(eU.Get,r,null,null,null),s=!t.error&&(null==(e=t.body)?void 0:e.replace(/\n/,""))=="yes";return R.logAction(this.logger,R.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+s),s}):this.Request=async()=>({error:l?new I("no supported HTTP transports available",null,400):r1()})}get logger(){var e,t;return null!=(t=null==(e=this.client)?void 0:e.logger)?t:R.defaultLogger}async doUri(e,t,r,s,n){return this.Request?this.Request(e,t,r,n,s):{error:new I("Request invoked before assigned to",null,500)}}shouldFallback(e){let t=e.statusCode;return 408===t&&!e.code||400===t&&!e.code||t>=500&&t<=504}}).methods=[eU.Get,eU.Delete,eU.Post,eU.Put,eU.Patch],d.methodsWithoutBody=[eU.Get,eU.Delete],d.methodsWithBody=[eU.Post,eU.Put,eU.Patch],d),r4="ablyjs-storage-test",r5=e.g,r3=new class{constructor(){try{r5.sessionStorage.setItem(r4,r4),r5.sessionStorage.removeItem(r4),this.sessionSupported=!0}catch(e){this.sessionSupported=!1}try{r5.localStorage.setItem(r4,r4),r5.localStorage.removeItem(r4),this.localSupported=!0}catch(e){this.localSupported=!1}}get(e){return this._get(e,!1)}getSession(e){return this._get(e,!0)}remove(e){return this._remove(e,!1)}removeSession(e){return this._remove(e,!0)}set(e,t,r){return this._set(e,t,r,!1)}setSession(e,t,r){return this._set(e,t,r,!0)}_set(e,t,r,s){let n={value:t};return r&&(n.expires=Date.now()+r),this.storageInterface(s).setItem(e,JSON.stringify(n))}_get(e,t){if(t&&!this.sessionSupported)throw Error("Session Storage not supported");if(!t&&!this.localSupported)throw Error("Local Storage not supported");let r=this.storageInterface(t).getItem(e);if(!r)return null;let s=JSON.parse(r);return s.expires&&s.expires<Date.now()?(this.storageInterface(t).removeItem(e),null):s.value}_remove(e,t){return this.storageInterface(t).removeItem(e)}storageInterface(e){return e?r5.sessionStorage:r5.localStorage}},r6=ex(),r8="string"==typeof EdgeRuntime;"undefined"!=typeof Window||"undefined"!=typeof WorkerGlobalScope||r8||console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");var r7={agent:"browser",logTimestamps:!0,userAgent:r6.navigator&&r6.navigator.userAgent.toString(),currentUrl:r6.location&&r6.location.href,binaryType:"arraybuffer",WebSocket:r6.WebSocket,fetchSupported:!!r6.fetch,xhrSupported:r6.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,allowComet:(t=r6.location,!r6.WebSocket||!t||!t.origin||t.origin.indexOf("http")>-1),useProtocolHeartbeats:!0,supportsBinary:!!r6.TextDecoder,preferBinary:!1,ArrayBuffer:r6.ArrayBuffer,atob:r6.atob,nextTick:"function"==typeof r6.queueMicrotask?e=>r6.queueMicrotask(e):e=>Promise.resolve().then(e),addEventListener:r6.addEventListener,inspect:JSON.stringify,stringByteSize:function(e){return r6.TextDecoder&&new r6.TextEncoder().encode(e).length||e.length},TextEncoder:r6.TextEncoder,TextDecoder:r6.TextDecoder,getRandomArrayBuffer:async function(e){let t=new Uint8Array(e);return r6.crypto.getRandomValues(t),t.buffer},isWebworker:!!("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope),push:{platform:"browser",formFactor:"desktop",storage:r3}};function r9(e){return e.code&&!eG.isTokenErr(e)&&([80015,80017,80030].includes(e.code)||e.code>=4e4&&e.code<5e4)?[re({action:eQ.ERROR,error:e})]:[re({action:eQ.DISCONNECTED,error:e})]}var se=class extends rx{constructor(e,t,r){super(e,t,r,!0),this.onAuthUpdated=e=>{this.authParams={access_token:e.token}},this.stream=!("stream"in r)||r.stream,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}connect(){R.logAction(this.logger,R.LOG_MINOR,"CometTransport.connect()","starting"),rx.prototype.connect.call(this);let e=this.params,t=e.options,r=e.host||t.primaryDomain,s=eC.getPort(t),n=t.tls?"https://":"http://";this.baseUri=n+r+":"+s+"/comet/";let i=this.baseUri+"connect";R.logAction(this.logger,R.LOG_MINOR,"CometTransport.connect()","uri: "+i),ed(this.auth.getAuthParams(),(e,t)=>{if(e)return void this.disconnect(e);if(this.isDisposed)return;this.authParams=t;let r=this.params.getConnectParams(t);"stream"in r&&(this.stream=r.stream),R.logAction(this.logger,R.LOG_MINOR,"CometTransport.connect()","connectParams:"+et(r));let s=!1,n=this.recvRequest=this.createRequest(i,null,r,null,this.stream?r0.REQ_RECV_STREAM:r0.REQ_RECV);n.on("data",e=>{this.recvRequest&&(s||(s=!0,this.emit("preconnect")),this.onData(e))}),n.on("complete",e=>{(this.recvRequest||(e=e||new T("Request cancelled",80003,400)),this.recvRequest=null,s||e||(s=!0,this.emit("preconnect")),this.onActivity(),e)?e.code?this.onData(r9(e)):this.disconnect(e):S.Config.nextTick(()=>{this.recv()})}),n.exec()})}requestClose(){R.logAction(this.logger,R.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)}requestDisconnect(){R.logAction(this.logger,R.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)}_requestCloseOrDisconnect(e){let t=e?this.closeUri:this.disconnectUri;if(t){let r=this.createRequest(t,null,this.authParams,null,r0.REQ_SEND);r.on("complete",t=>{t&&(R.logAction(this.logger,R.LOG_ERROR,"CometTransport.request"+(e?"Close()":"Disconnect()"),"request returned err = "+en(t)),this.finish("disconnected",t))}),r.exec()}}dispose(){R.logAction(this.logger,R.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(R.logAction(this.logger,R.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",rm.disconnected()),S.Config.nextTick(()=>{this.emit("disposed")}))}onConnect(e){var t;if(this.isDisposed)return;let r=null==(t=e.connectionDetails)?void 0:t.connectionKey;rx.prototype.onConnect.call(this,e);let s=this.baseUri+r;R.logAction(this.logger,R.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+s),this.sendUri=s+"/send",this.recvUri=s+"/recv",this.closeUri=s+"/close",this.disconnectUri=s+"/disconnect"}send(e){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(e);return}let t=this.pendingItems||[];t.push(e),this.pendingItems=null,this.sendItems(t)}sendAnyPending(){let e=this.pendingItems;e&&(this.pendingItems=null,this.sendItems(e))}sendItems(e){let t=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(e),r0.REQ_SEND);t.on("complete",(e,t)=>{(e&&R.logAction(this.logger,R.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+en(e)),this.sendRequest=null,e)?e.code?this.onData(r9(e)):this.disconnect(e):(t&&this.onData(t),this.pendingItems&&S.Config.nextTick(()=>{this.sendRequest||this.sendAnyPending()}))}),t.exec()}recv(){if(this.recvRequest||!this.isConnected)return;let e=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?r0.REQ_RECV_STREAM:r0.REQ_RECV_POLL);e.on("data",e=>{this.onData(e)}),e.on("complete",e=>{(this.recvRequest=null,this.onActivity(),e)?e.code?this.onData(r9(e)):this.disconnect(e):S.Config.nextTick(()=>{this.recv()})}),e.exec()}onData(e){try{let t=this.decodeResponse(e);if(t&&t.length)for(let e=0;e<t.length;e++)this.onProtocolMessage(t7(t[e],this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin))}catch(e){R.logAction(this.logger,R.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+e.stack)}}encodeRequest(e){return JSON.stringify(e)}decodeResponse(e){return"string"==typeof e?JSON.parse(e):e}},st=function(){},sr=0,ss={},sn=class e extends eX{constructor(e,t,r,s,n,i,a,o){super(a),(r=r||{}).rnd=eo(),this.uri=e+et(r),this.headers=t||{},this.body=s,this.method=o?o.toUpperCase():U(s)?"GET":"POST",this.requestMode=n,this.timeouts=i,this.timedOut=!1,this.requestComplete=!1,this.id=String(++sr),ss[this.id]=this}static createRequest(t,r,s,n,i,a,o,l){let c=a||eC.TIMEOUTS;return new e(t,r,P(s),n,i,c,o,l)}complete(e,t,r,s,n){this.requestComplete||(this.requestComplete=!0,!e&&t&&this.emit("data",t),this.emit("complete",e,t,r,s,n),this.dispose())}abort(){this.dispose()}exec(){let e,t,r,s=this.headers,n=this.requestMode==r0.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,i=this.timer=setTimeout(()=>{this.timedOut=!0,o.abort()},n),a=this.method,o=this.xhr=new XMLHttpRequest,l=s.accept,c=this.body,d="text";for(let e in l?0===l.indexOf("application/x-msgpack")&&(d="arraybuffer"):s.accept="application/json",c&&(s["content-type"]||(s["content-type"]="application/json")).indexOf("application/json")>-1&&"string"!=typeof c&&(c=JSON.stringify(c)),o.open(a,this.uri,!0),o.responseType=d,"authorization"in s&&(o.withCredentials=!0),s)o.setRequestHeader(e,s[e]);let u=(e,t,r,s)=>{var n;let i=t+" (event type: "+e.type+")";(null==(n=this==null?void 0:this.xhr)?void 0:n.statusText)&&(i+=", current statusText is "+this.xhr.statusText),R.logAction(this.logger,R.LOG_ERROR,"Request.on"+e.type+"()",i),this.complete(new I(i,r,s))};o.onerror=e=>{u(e,"XHR error occurred",null,400)},o.onabort=e=>{this.timedOut?u(e,"Request aborted due to request timeout expiring",null,408):u(e,"Request cancelled",null,400)},o.ontimeout=e=>{u(e,"Request timed out",null,408)};let h=0,p=!1,f=()=>{var s;(clearTimeout(i),r=t<400,204==t)?this.complete(null,null,null,null,t):e=this.requestMode==r0.REQ_RECV_STREAM&&r&&(s=o).getResponseHeader&&(s.getResponseHeader("transfer-encoding")||!s.getResponseHeader("content-length"))},m=()=>{let e;try{let n=o.getResponseHeader&&o.getResponseHeader("content-type");if(n?n.indexOf("application/json")>=0:"text"==o.responseType){let t="arraybuffer"===o.responseType?S.BufferUtils.utf8Decode(o.response):String(o.responseText);e=t.length?JSON.parse(t):t,p=!0}else e=o.response;void 0!==e.response?(r=(t=e.statusCode)<400,s=e.headers,e=e.response):s=function(e){let t=e.getAllResponseHeaders().trim().split("\r\n"),r={};for(let e=0;e<t.length;e++){let s=t[e].split(":").map(e=>e.trim());r[s[0].toLowerCase()]=s[1]}return r}(o)}catch(e){this.complete(new I("Malformed response body from server: "+e.message,null,400));return}if(r||Array.isArray(e))return void this.complete(null,e,s,p,t);let n=function(e,t){if(ep(J(t)).includes("x-ably-errorcode"))return e.error&&T.fromValues(e.error)}(e,s);n||(n=new I("Error response received from server: "+t+" body was: "+S.Config.inspect(e),null,t)),this.complete(n,e,s,p,t)};function g(){let e,t,r=o.responseText,s=r.length-1;for(;h<s&&(e=r.indexOf("\n",h))>-1;)t=r.slice(h,e),h=e+1,b(t)}let b=e=>{try{e=JSON.parse(e)}catch(e){this.complete(new I("Malformed response body from server: "+e.message,null,400));return}this.emit("data",e)},x=()=>{g(),this.streamComplete=!0,S.Config.nextTick(()=>{this.complete()})};o.onreadystatechange=()=>{let r=o.readyState;r<3||0!==o.status&&(void 0===t&&(t=o.status,f()),3==r&&e?g():4==r&&(e?x():m()))},o.send(c)}dispose(){let e=this.xhr;if(e){e.onreadystatechange=e.onerror=e.onabort=e.ontimeout=st,this.xhr=null;let t=this.timer;t&&(clearTimeout(t),this.timer=null),this.requestComplete||e.abort()}delete ss[this.id]}},si=o.XhrPolling,sa=class extends se{constructor(e,t,r){super(e,t,r),this.shortName=si,r.stream=!1,this.shortName=si}static isAvailable(){return!!(S.Config.xhrSupported&&S.Config.allowComet)}toString(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected}createRequest(e,t,r,s,n){return sn.createRequest(e,t,r,s,n,this.timeouts,this.logger)}},so={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",wsConnectivityCheckUrl:"wss://ws-up.ably-realtime.com",defaultTransports:[o.XhrPolling,o.WebSocket]};function sl(e,t,r){for(let s=0,n=r.length;s<n;s++){let n=r.charCodeAt(s);if(n<128){e.setUint8(t++,n>>>0&127);continue}if(n<2048){e.setUint8(t++,n>>>6&31|192),e.setUint8(t++,n>>>0&63|128);continue}if(n<65536){e.setUint8(t++,n>>>12&15|224),e.setUint8(t++,n>>>6&63|128),e.setUint8(t++,n>>>0&63|128);continue}if(n<1114112){e.setUint8(t++,n>>>18&7|240),e.setUint8(t++,n>>>12&63|128),e.setUint8(t++,n>>>6&63|128),e.setUint8(t++,n>>>0&63|128);continue}throw Error("bad codepoint "+n)}}function sc(e,t,r){let s="";for(let n=t,i=t+r;n<i;n++){let t=e.getUint8(n);if((128&t)==0){s+=String.fromCharCode(t);continue}if((224&t)==192){s+=String.fromCharCode((15&t)<<6|63&e.getUint8(++n));continue}if((240&t)==224){s+=String.fromCharCode((15&t)<<12|(63&e.getUint8(++n))<<6|63&e.getUint8(++n));continue}if((248&t)==240){s+=String.fromCharCode((7&t)<<18|(63&e.getUint8(++n))<<12|(63&e.getUint8(++n))<<6|63&e.getUint8(++n));continue}throw Error("Invalid byte "+t.toString(16))}return s}function sd(e){let t=0;for(let r=0,s=e.length;r<s;r++){let s=e.charCodeAt(r);if(s<128){t+=1;continue}if(s<2048){t+=2;continue}if(s<65536){t+=3;continue}if(s<1114112){t+=4;continue}throw Error("bad codepoint "+s)}return t}var su=class{constructor(e,t){this.map=e=>{let t={};for(let r=0;r<e;r++)t[this.parse()]=this.parse();return t},this.bin=e=>{let t=new ArrayBuffer(e);return new Uint8Array(t).set(new Uint8Array(this.view.buffer,this.offset,e),0),this.offset+=e,t},this.buf=this.bin,this.str=e=>{let t=sc(this.view,this.offset,e);return this.offset+=e,t},this.array=e=>{let t=Array(e);for(let r=0;r<e;r++)t[r]=this.parse();return t},this.ext=e=>(this.offset+=e,{type:this.view.getInt8(this.offset),data:this.buf(e)}),this.parse=()=>{var e,t,r,s;let n,i,a=this.view.getUint8(this.offset);if((128&a)==0)return this.offset++,a;if((240&a)==128)return i=15&a,this.offset++,this.map(i);if((240&a)==144)return i=15&a,this.offset++,this.array(i);if((224&a)==160)return i=31&a,this.offset++,this.str(i);if((224&a)==224)return n=this.view.getInt8(this.offset),this.offset++,n;switch(a){case 192:return this.offset++,null;case 193:this.offset++;return;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return i=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(i);case 197:return i=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(i);case 198:return i=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(i);case 199:return i=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(i);case 200:return i=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(i);case 201:return i=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(i);case 202:return n=this.view.getFloat32(this.offset+1),this.offset+=5,n;case 203:return n=this.view.getFloat64(this.offset+1),this.offset+=9,n;case 204:return n=this.view.getUint8(this.offset+1),this.offset+=2,n;case 205:return n=this.view.getUint16(this.offset+1),this.offset+=3,n;case 206:return n=this.view.getUint32(this.offset+1),this.offset+=5,n;case 207:return e=this.view,t=(t=this.offset+1)||0,n=0x100000000*e.getUint32(t)+e.getUint32(t+4),this.offset+=9,n;case 208:return n=this.view.getInt8(this.offset+1),this.offset+=2,n;case 209:return n=this.view.getInt16(this.offset+1),this.offset+=3,n;case 210:return n=this.view.getInt32(this.offset+1),this.offset+=5,n;case 211:return r=this.view,s=(s=this.offset+1)||0,n=0x100000000*r.getInt32(s)+r.getUint32(s+4),this.offset+=9,n;case 212:return i=1,this.offset++,this.ext(i);case 213:return i=2,this.offset++,this.ext(i);case 214:return i=4,this.offset++,this.ext(i);case 215:return i=8,this.offset++,this.ext(i);case 216:return i=16,this.offset++,this.ext(i);case 217:return i=this.view.getUint8(this.offset+1),this.offset+=2,this.str(i);case 218:return i=this.view.getUint16(this.offset+1),this.offset+=3,this.str(i);case 219:return i=this.view.getUint32(this.offset+1),this.offset+=5,this.str(i);case 220:return i=this.view.getUint16(this.offset+1),this.offset+=3,this.array(i);case 221:return i=this.view.getUint32(this.offset+1),this.offset+=5,this.array(i);case 222:return i=this.view.getUint16(this.offset+1),this.offset+=3,this.map(i);case 223:return i=this.view.getUint32(this.offset+1),this.offset+=5,this.map(i)}throw Error("Unknown type 0x"+a.toString(16))},this.offset=t||0,this.view=e}};function sh(e,t){return Object.keys(e).filter(function(r){let s=e[r],n=typeof s;return(!t||null!=s)&&("function"!==n||!!s.toJSON)})}var sp={encode:function(e,t){let r=function e(t,r){let s=typeof t;if("string"===s){let e=sd(t);if(e<32)return 1+e;if(e<256)return 2+e;if(e<65536)return 3+e;if(e<0x100000000)return 5+e}if(ArrayBuffer.isView&&ArrayBuffer.isView(t)&&(t=t.buffer),t instanceof ArrayBuffer){let e=t.byteLength;if(e<256)return 2+e;if(e<65536)return 3+e;if(e<0x100000000)return 5+e}if("number"==typeof t){if(Math.floor(t)!==t)return 9;if(t>=0){if(t<128)return 1;if(t<256)return 2;if(t<65536)return 3;if(t<0x100000000)return 5;if(t<0xffffffffffffffff)return 9;throw Error("Number too big 0x"+t.toString(16))}if(t>=-32)return 1;if(t>=-128)return 2;if(t>=-32768)return 3;if(t>=-0x80000000)return 5;if(t>=-0x8000000000000000)return 9;throw Error("Number too small -0x"+t.toString(16).substr(1))}if("boolean"===s)return 1;if(null===t)return+!r;if(void 0===t)return 3*!r;if("function"==typeof t.toJSON)return e(t.toJSON(),r);if("object"===s){let s,n=0;if(Array.isArray(t)){s=t.length;for(let i=0;i<s;i++)n+=e(t[i],r)}else{let i=sh(t,r);s=i.length;for(let a=0;a<s;a++){let s=i[a];n+=e(s)+e(t[s],r)}}if(s<16)return 1+n;if(s<65536)return 3+n;if(s<0x100000000)return 5+n;throw Error("Array or object too long 0x"+s.toString(16))}if("function"===s)return 0;throw Error("Unknown type "+s)}(e,t);if(0===r)return;let s=new ArrayBuffer(r);return function e(t,r,s,n){let i=typeof t;if("string"==typeof t){let e=sd(t);if(e<32)return r.setUint8(s,160|e),sl(r,s+1,t),1+e;if(e<256)return r.setUint8(s,217),r.setUint8(s+1,e),sl(r,s+2,t),2+e;if(e<65536)return r.setUint8(s,218),r.setUint16(s+1,e),sl(r,s+3,t),3+e;if(e<0x100000000)return r.setUint8(s,219),r.setUint32(s+1,e),sl(r,s+5,t),5+e}if(ArrayBuffer.isView&&ArrayBuffer.isView(t)&&(t=t.buffer),t instanceof ArrayBuffer){let e=t.byteLength;if(e<256)return r.setUint8(s,196),r.setUint8(s+1,e),new Uint8Array(r.buffer).set(new Uint8Array(t),s+2),2+e;if(e<65536)return r.setUint8(s,197),r.setUint16(s+1,e),new Uint8Array(r.buffer).set(new Uint8Array(t),s+3),3+e;if(e<0x100000000)return r.setUint8(s,198),r.setUint32(s+1,e),new Uint8Array(r.buffer).set(new Uint8Array(t),s+5),5+e}if("number"==typeof t){var a,o,l,c;if(Math.floor(t)!==t)return r.setUint8(s,203),r.setFloat64(s+1,t),9;if(t>=0){if(t<128)return r.setUint8(s,t),1;if(t<256)return r.setUint8(s,204),r.setUint8(s+1,t),2;if(t<65536)return r.setUint8(s,205),r.setUint16(s+1,t),3;if(t<0x100000000)return r.setUint8(s,206),r.setUint32(s+1,t),5;if(t<0xffffffffffffffff)return r.setUint8(s,207),a=s+1,(o=t)<0xffffffffffffffff?(r.setUint32(a,Math.floor(23283064365386963e-26*o)),r.setInt32(a+4,-1&o)):(r.setUint32(a,0xffffffff),r.setUint32(a+4,0xffffffff)),9;throw Error("Number too big 0x"+t.toString(16))}if(t>=-32)return r.setInt8(s,t),1;if(t>=-128)return r.setUint8(s,208),r.setInt8(s+1,t),2;if(t>=-32768)return r.setUint8(s,209),r.setInt16(s+1,t),3;if(t>=-0x80000000)return r.setUint8(s,210),r.setInt32(s+1,t),5;if(t>=-0x8000000000000000)return r.setUint8(s,211),l=s+1,(c=t)<0x8000000000000000?(r.setInt32(l,Math.floor(23283064365386963e-26*c)),r.setInt32(l+4,-1&c)):(r.setUint32(l,0x7fffffff),r.setUint32(l+4,0x7fffffff)),9;throw Error("Number too small -0x"+(-t).toString(16).substr(1))}if("undefined"===i)return n?0:(r.setUint8(s,212),r.setUint8(s+1,0),r.setUint8(s+2,0),3);if(null===t)return n?0:(r.setUint8(s,192),1);if("boolean"===i)return r.setUint8(s,t?195:194),1;if("function"==typeof t.toJSON)return e(t.toJSON(),r,s,n);if("object"===i){let i,a,o=0,l=Array.isArray(t);if((a=l?t.length:(i=sh(t,n)).length)<16?(r.setUint8(s,a|(l?144:128)),o=1):a<65536?(r.setUint8(s,l?220:222),r.setUint16(s+1,a),o=3):a<0x100000000&&(r.setUint8(s,l?221:223),r.setUint32(s+1,a),o=5),l)for(let i=0;i<a;i++)o+=e(t[i],r,s+o,n);else if(i)for(let l=0;l<a;l++){let a=i[l];o+=e(a,r,s+o),o+=e(t[a],r,s+o,n)}return o}if("function"===i)return 0;throw Error("Unknown type "+i)}(e,new DataView(s),0,t),s},decode:function(e){let t=new su(new DataView(e)),r=t.parse();if(t.offset!==e.byteLength)throw Error(e.byteLength-t.offset+" trailing bytes");return r},inspect:function(e){let t,r;if(void 0===e)return"undefined";if(e instanceof ArrayBuffer?(r="ArrayBuffer",t=new DataView(e)):e instanceof DataView&&(r="DataView",t=e),!t)return JSON.stringify(e);let s=[];for(let r=0;r<e.byteLength;r++){if(r>20){s.push("...");break}let e=t.getUint8(r).toString(16);1===e.length&&(e="0"+e),s.push(e)}return"<"+r+" "+s.join(" ")+">"},utf8Write:sl,utf8Read:sc,utf8ByteCount:sd};async function sf(e,t,r,s,n,i){let a,o=new Headers(s||{}),l=e?e.toUpperCase():U(i)?"GET":"POST",c=new AbortController,d=new Promise(e=>{a=setTimeout(()=>{c.abort(),e({error:new I("Request timed out",null,408)})},t?t.options.timeouts.httpRequestTimeout:eC.TIMEOUTS.httpRequestTimeout)}),u={method:l,headers:o,body:i,signal:c.signal};S.Config.isWebworker||(u.credentials=o.has("authorization")?"include":"same-origin");let h=(async()=>{try{var e;let t,s,i=new URLSearchParams(n||{});i.set("rnd",eo());let o=r+"?"+i,l=await ex().fetch(o,u);if(clearTimeout(a),204==l.status)return{error:null,statusCode:l.status};let c=l.headers.get("Content-Type");t=c&&c.indexOf("application/x-msgpack")>-1?await l.arrayBuffer():c&&c.indexOf("application/json")>-1?await l.json():await l.text();let d=!!c&&-1===c.indexOf("application/x-msgpack"),h=(e=l.headers,s={},e.forEach((e,t)=>{s[t]=e}),s);if(!l.ok)return{error:function(e,t){if(t.get("x-ably-errorcode"))return e.error&&T.fromValues(e.error)}(t,l.headers)||new I("Error response received from server: "+l.status+" body was: "+S.Config.inspect(t),null,l.status),body:t,headers:h,unpacked:d,statusCode:l.status};return{error:null,body:t,headers:h,unpacked:d,statusCode:l.status}}catch(e){return clearTimeout(a),{error:e}}})();return Promise.race([d,h])}var sm=function(e,t){class r{constructor(e,t,r,s){this.algorithm=e,this.keyLength=t,this.mode=r,this.key=s}}class s{static getDefaultParams(e){if(!e.key)throw Error("Crypto.getDefaultParams: a key is required");var s="string"==typeof e.key?t.toArrayBuffer(t.base64Decode(e.key.replace("_","/").replace("-","+"))):e.key instanceof ArrayBuffer?e.key:t.toArrayBuffer(e.key),n=new r(e.algorithm||"aes",8*s.byteLength,e.mode||"cbc",s);if(e.keyLength&&e.keyLength!==n.keyLength)throw Error("Crypto.getDefaultParams: a keyLength of "+e.keyLength+" was specified, but the key actually has length "+n.keyLength);if("aes"===n.algorithm&&"cbc"===n.mode&&128!==n.keyLength&&256!==n.keyLength)throw Error("Unsupported key length "+n.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)");return n}static async generateRandomKey(t){try{return e.getRandomArrayBuffer((t||256)/8)}catch(e){throw new T("Failed to generate random key: "+e.message,400,5e4,e)}}static getCipher(e,t){var s,i=e instanceof r?e:this.getDefaultParams(e);return{cipherParams:i,cipher:new n(i,null!=(s=e.iv)?s:null,t)}}}s.CipherParams=r;class n{constructor(e,r,s){if(this.logger=s,!crypto.subtle)if(isSecureContext)throw Error("Crypto operations are not possible since the browsers SubtleCrypto class is unavailable (reason unknown).");else throw Error("Crypto operations are is not possible since the current environment is a non-secure context and hence the browsers SubtleCrypto class is not available.");this.algorithm=e.algorithm+"-"+String(e.keyLength)+"-"+e.mode,this.webCryptoAlgorithm=e.algorithm+"-"+e.mode,this.key=t.toArrayBuffer(e.key),this.iv=r?t.toArrayBuffer(r):null}concat(e,r){let s=new ArrayBuffer(e.byteLength+r.byteLength),n=new DataView(s),i=new DataView(t.toArrayBuffer(e));for(let e=0;e<i.byteLength;e++)n.setInt8(e,i.getInt8(e));let a=new DataView(t.toArrayBuffer(r));for(let e=0;e<a.byteLength;e++)n.setInt8(i.byteLength+e,a.getInt8(e));return s}async encrypt(e){R.logAction(this.logger,R.LOG_MICRO,"CBCCipher.encrypt()","");let t=await this.getIv(),r=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["encrypt"]),s=await crypto.subtle.encrypt({name:this.webCryptoAlgorithm,iv:t},r,e);return this.concat(t,s)}async decrypt(e){R.logAction(this.logger,R.LOG_MICRO,"CBCCipher.decrypt()","");let r=t.toArrayBuffer(e),s=r.slice(0,16),n=r.slice(16),i=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["decrypt"]);return crypto.subtle.decrypt({name:this.webCryptoAlgorithm,iv:s},i,n)}async getIv(){if(this.iv){var r=this.iv;return this.iv=null,r}let s=await e.getRandomArrayBuffer(16);return t.toArrayBuffer(s)}}return s}(r7,rZ);for(let e of(S.Crypto=sm,S.BufferUtils=rZ,S.Http=r2,S.Config=r7,S.Transports={order:["xhr_polling"],bundledImplementations:{web_socket:rD,xhr_polling:sa}},S.WebStorage=r3,[rc,rU]))e.Crypto=sm,e._MsgPack=sp;r2.bundledRequestImplementations={XHRRequest:sn,FetchRequest:sf},R.initLogHandlers(),S.Defaults=Object.assign(eC,so),S.Config.agent&&(S.Defaults.agent+=" "+S.Config.agent);var sg={ErrorInfo:T,Rest:rc,Realtime:rU,msgpack:sp,makeProtocolMessageFromDeserialized:t9};return"object"==typeof h.exports&&(h.exports=((e,t,r,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of Object.getOwnPropertyNames(t))Object.prototype.hasOwnProperty.call(e,n)||n===r||Object.defineProperty(e,n,{get:()=>t[n],enumerable:!(s=Object.getOwnPropertyDescriptor(t,n))||s.enumerable});return e})(h.exports,u)),h.exports})()},67423,(e,t,r)=>{"use strict";function s({widthInt:e,heightInt:t,blurWidth:r,blurHeight:s,blurDataURL:n,objectFit:i}){let a=r?40*r:e,o=s?40*s:t,l=a&&o?`viewBox='0 0 ${a} ${o}'`:"";return`%3Csvg xmlns='http://www.w3.org/2000/svg' ${l}%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='${l?"none":"contain"===i?"xMidYMid":"cover"===i?"xMidYMid slice":"none"}' style='filter: url(%23b);' href='${n}'/%3E%3C/svg%3E`}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImageBlurSvg",{enumerable:!0,get:function(){return s}})},87690,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={VALID_LOADERS:function(){return i},imageConfigDefault:function(){return a}};for(var n in s)Object.defineProperty(r,n,{enumerable:!0,get:s[n]});let i=["default","imgix","cloudinary","akamai","custom"],a={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},8927,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImgProps",{enumerable:!0,get:function(){return l}}),e.r(33525);let s=e.r(67423),n=e.r(87690),i=["-moz-initial","fill","none","scale-down",void 0];function a(e){return void 0!==e.default}function o(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function l({src:e,sizes:t,unoptimized:r=!1,priority:l=!1,preload:c=!1,loading:d,className:u,quality:h,width:p,height:f,fill:m=!1,style:g,overrideSrc:b,onLoad:x,onLoadingComplete:y,placeholder:w="empty",blurDataURL:v,fetchPriority:j,decoding:k="async",layout:N,objectFit:S,objectPosition:_,lazyBoundary:C,lazyRoot:E,...R},A){var O;let T,I,M,{imgConf:P,showAltText:D,blurComplete:L,defaultLoader:$}=A,U=P||n.imageConfigDefault;if("allSizes"in U)T=U;else{let e=[...U.deviceSizes,...U.imageSizes].sort((e,t)=>e-t),t=U.deviceSizes.sort((e,t)=>e-t),r=U.qualities?.sort((e,t)=>e-t);T={...U,allSizes:e,deviceSizes:t,qualities:r}}if(void 0===$)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let B=R.loader||$;delete R.loader,delete R.srcSet;let z="__next_img_default"in B;if(z){if("custom"===T.loader)throw Object.defineProperty(Error(`Image with src "${e}" is missing "loader" prop.
Read more: https://nextjs.org/docs/messages/next-image-missing-loader`),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let e=B;B=t=>{let{config:r,...s}=t;return e(s)}}if(N){"fill"===N&&(m=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[N];e&&(g={...g,...e});let r={responsive:"100vw",fill:"100vw"}[N];r&&!t&&(t=r)}let q="",F=o(p),H=o(f);if((O=e)&&"object"==typeof O&&(a(O)||void 0!==O.src)){let t=a(e)?e.default:e;if(!t.src)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!t.height||!t.width)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(I=t.blurWidth,M=t.blurHeight,v=v||t.blurDataURL,q=t.src,!m)if(F||H){if(F&&!H){let e=F/t.width;H=Math.round(t.height*e)}else if(!F&&H){let e=H/t.height;F=Math.round(t.width*e)}}else F=t.width,H=t.height}let W=!l&&!c&&("lazy"===d||void 0===d);(!(e="string"==typeof e?e:q)||e.startsWith("data:")||e.startsWith("blob:"))&&(r=!0,W=!1),T.unoptimized&&(r=!0),z&&!T.dangerouslyAllowSVG&&e.split("?",1)[0].endsWith(".svg")&&(r=!0);let G=o(h),V=Object.assign(m?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:S,objectPosition:_}:{},D?{}:{color:"transparent"},g),K=L||"empty"===w?null:"blur"===w?`url("data:image/svg+xml;charset=utf-8,${(0,s.getImageBlurSvg)({widthInt:F,heightInt:H,blurWidth:I,blurHeight:M,blurDataURL:v||"",objectFit:V.objectFit})}")`:`url("${w}")`,J=i.includes(V.objectFit)?"fill"===V.objectFit?"100% 100%":"cover":V.objectFit,Y=K?{backgroundSize:J,backgroundPosition:V.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:K}:{},X=function({config:e,src:t,unoptimized:r,width:s,quality:n,sizes:i,loader:a}){if(r)return{src:t,srcSet:void 0,sizes:void 0};let{widths:o,kind:l}=function({deviceSizes:e,allSizes:t},r,s){if(s){let r=/(^|\s)(1?\d?\d)vw/g,n=[];for(let e;e=r.exec(s);)n.push(parseInt(e[2]));if(n.length){let r=.01*Math.min(...n);return{widths:t.filter(t=>t>=e[0]*r),kind:"w"}}return{widths:t,kind:"w"}}return"number"!=typeof r?{widths:e,kind:"w"}:{widths:[...new Set([r,2*r].map(e=>t.find(t=>t>=e)||t[t.length-1]))],kind:"x"}}(e,s,i),c=o.length-1;return{sizes:i||"w"!==l?i:"100vw",srcSet:o.map((r,s)=>`${a({config:e,src:t,quality:n,width:r})} ${"w"===l?r:s+1}${l}`).join(", "),src:a({config:e,src:t,quality:n,width:o[c]})}}({config:T,src:e,unoptimized:r,width:F,quality:G,sizes:t,loader:B}),Q=W?"lazy":d;return{props:{...R,loading:Q,fetchPriority:j,width:F,height:H,decoding:k,className:u,style:{...V,...Y},sizes:X.sizes,srcSet:X.srcSet,src:b||X.src},meta:{unoptimized:r,preload:c||l,placeholder:w,fill:m}}}},98879,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return o}});let s=e.r(71645),n="undefined"==typeof window,i=n?()=>{}:s.useLayoutEffect,a=n?()=>{}:s.useEffect;function o(e){let{headManager:t,reduceComponentsToState:r}=e;function o(){if(t&&t.mountedInstances){let e=s.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(r(e))}}return n&&(t?.mountedInstances?.add(e.children),o()),i(()=>(t?.mountedInstances?.add(e.children),()=>{t?.mountedInstances?.delete(e.children)})),i(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),a(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},25633,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={default:function(){return m},defaultHead:function(){return u}};for(var n in s)Object.defineProperty(r,n,{enumerable:!0,get:s[n]});let i=e.r(55682),a=e.r(90809),o=e.r(43476),l=a._(e.r(71645)),c=i._(e.r(98879)),d=e.r(42732);function u(){return[(0,o.jsx)("meta",{charSet:"utf-8"},"charset"),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")]}function h(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===l.default.Fragment?e.concat(l.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}e.r(33525);let p=["name","httpEquiv","charSet","itemProp"];function f(e){let t,r,s,n;return e.reduce(h,[]).reverse().concat(u().reverse()).filter((t=new Set,r=new Set,s=new Set,n={},e=>{let i=!0,a=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){a=!0;let r=e.key.slice(e.key.indexOf("$")+1);t.has(r)?i=!1:t.add(r)}switch(e.type){case"title":case"base":r.has(e.type)?i=!1:r.add(e.type);break;case"meta":for(let t=0,r=p.length;t<r;t++){let r=p[t];if(e.props.hasOwnProperty(r))if("charSet"===r)s.has(r)?i=!1:s.add(r);else{let t=e.props[r],s=n[r]||new Set;("name"!==r||!a)&&s.has(t)?i=!1:(s.add(t),n[r]=s)}}}return i})).reverse().map((e,t)=>{let r=e.key||t;return l.default.cloneElement(e,{key:r})})}let m=function({children:e}){let t=(0,l.useContext)(d.HeadManagerContext);return(0,o.jsx)(c.default,{reduceComponentsToState:f,headManager:t,children:e})};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18556,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ImageConfigContext",{enumerable:!0,get:function(){return i}});let s=e.r(55682)._(e.r(71645)),n=e.r(87690),i=s.default.createContext(n.imageConfigDefault)},65856,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RouterContext",{enumerable:!0,get:function(){return s}});let s=e.r(55682)._(e.r(71645)).default.createContext(null)},70965,(e,t,r)=>{"use strict";function s(e,t){let r=e||75;return t?.qualities?.length?t.qualities.reduce((e,t)=>Math.abs(t-r)<Math.abs(e-r)?t:e,0):r}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"findClosestQuality",{enumerable:!0,get:function(){return s}})},1948,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return i}});let s=e.r(70965);function n({config:e,src:t,width:r,quality:n}){if(t.startsWith("/")&&t.includes("?")&&e.localPatterns?.length===1&&"**"===e.localPatterns[0].pathname&&""===e.localPatterns[0].search)throw Object.defineProperty(Error(`Image with src "${t}" is using a query string which is not configured in images.localPatterns.
Read more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns`),"__NEXT_ERROR_CODE",{value:"E871",enumerable:!1,configurable:!0});let i=(0,s.findClosestQuality)(n,e);return`${e.path}?url=${encodeURIComponent(t)}&w=${r}&q=${i}${t.startsWith("/_next/static/media/"),""}`}n.__next_img_default=!0;let i=n},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return n}});let s=e.r(71645);function n(e,t){let r=(0,s.useRef)(null),n=(0,s.useRef)(null);return(0,s.useCallback)(s=>{if(null===s){let e=r.current;e&&(r.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(r.current=i(e,s)),t&&(n.current=i(t,s))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},5500,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return w}});let s=e.r(55682),n=e.r(90809),i=e.r(43476),a=n._(e.r(71645)),o=s._(e.r(74080)),l=s._(e.r(25633)),c=e.r(8927),d=e.r(87690),u=e.r(18556);e.r(33525);let h=e.r(65856),p=s._(e.r(1948)),f=e.r(18581),m={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function g(e,t,r,s,n,i,a){let o=e?.src;e&&e["data-loaded-src"]!==o&&(e["data-loaded-src"]=o,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&n(!0),r?.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let s=!1,n=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>s,isPropagationStopped:()=>n,persist:()=>{},preventDefault:()=>{s=!0,t.preventDefault()},stopPropagation:()=>{n=!0,t.stopPropagation()}})}s?.current&&s.current(e)}}))}function b(e){return a.use?{fetchPriority:e}:{fetchpriority:e}}"undefined"==typeof window&&(globalThis.__NEXT_IMAGE_IMPORTED=!0);let x=(0,a.forwardRef)(({src:e,srcSet:t,sizes:r,height:s,width:n,decoding:o,className:l,style:c,fetchPriority:d,placeholder:u,loading:h,unoptimized:p,fill:m,onLoadRef:x,onLoadingCompleteRef:y,setBlurComplete:w,setShowAltText:v,sizesInput:j,onLoad:k,onError:N,...S},_)=>{let C=(0,a.useCallback)(e=>{e&&(N&&(e.src=e.src),e.complete&&g(e,u,x,y,w,p,j))},[e,u,x,y,w,N,p,j]),E=(0,f.useMergedRef)(_,C);return(0,i.jsx)("img",{...S,...b(d),loading:h,width:n,height:s,decoding:o,"data-nimg":m?"fill":"1",className:l,style:c,sizes:r,srcSet:t,src:e,ref:E,onLoad:e=>{g(e.currentTarget,u,x,y,w,p,j)},onError:e=>{v(!0),"empty"!==u&&w(!0),N&&N(e)}})});function y({isAppRouter:e,imgAttributes:t}){let r={as:"image",imageSrcSet:t.srcSet,imageSizes:t.sizes,crossOrigin:t.crossOrigin,referrerPolicy:t.referrerPolicy,...b(t.fetchPriority)};return e&&o.default.preload?(o.default.preload(t.src,r),null):(0,i.jsx)(l.default,{children:(0,i.jsx)("link",{rel:"preload",href:t.srcSet?void 0:t.src,...r},"__nimg-"+t.src+t.srcSet+t.sizes)})}let w=(0,a.forwardRef)((e,t)=>{let r=(0,a.useContext)(h.RouterContext),s=(0,a.useContext)(u.ImageConfigContext),n=(0,a.useMemo)(()=>{let e=m||s||d.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),r=e.deviceSizes.sort((e,t)=>e-t),n=e.qualities?.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:r,qualities:n,localPatterns:"undefined"==typeof window?s?.localPatterns:e.localPatterns}},[s]),{onLoad:o,onLoadingComplete:l}=e,f=(0,a.useRef)(o);(0,a.useEffect)(()=>{f.current=o},[o]);let g=(0,a.useRef)(l);(0,a.useEffect)(()=>{g.current=l},[l]);let[b,w]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),{props:k,meta:N}=(0,c.getImgProps)(e,{defaultLoader:p.default,imgConf:n,blurComplete:b,showAltText:v});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x,{...k,unoptimized:N.unoptimized,placeholder:N.placeholder,fill:N.fill,onLoadRef:f,onLoadingCompleteRef:g,setBlurComplete:w,setShowAltText:j,sizesInput:e.sizes,ref:t}),N.preload?(0,i.jsx)(y,{isAppRouter:!r,imgAttributes:k}):null]})});("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},94909,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={default:function(){return d},getImageProps:function(){return c}};for(var n in s)Object.defineProperty(r,n,{enumerable:!0,get:s[n]});let i=e.r(55682),a=e.r(8927),o=e.r(5500),l=i._(e.r(1948));function c(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:l.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let d=o.Image},57688,(e,t,r)=>{t.exports=e.r(94909)},52683,e=>{"use strict";let t,r,s,n,i,a,o,l,c,d,u,h,p,f,m,g,b,x,y,w,v,j;var k,N,S,_,C,E,R,A,O,T,I,M,P,D,L,$,U,B,z,q,F,H,W,G,V,K,J,Y,X,Q,Z,ee,et,er=e.i(43476),es=e.i(71645),en=e.i(63178),ei=e.i(18566);function ea(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function eo(e){var t;let r,s=(t=e,(r=es.forwardRef((e,t)=>{let{children:r,...s}=e;if(es.isValidElement(r)){var n;let e,i,a=(n=r,(i=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(i=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),o=function(e,t){let r={...t};for(let s in t){let n=e[s],i=t[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...e)=>{let t=i(...e);return n(...e),t}:n&&(r[s]=n):"style"===s?r[s]={...n,...i}:"className"===s&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==es.Fragment&&(o.ref=t?function(...e){return t=>{let r=!1,s=e.map(e=>{let s=ea(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():ea(e[t],null)}}}}(t,a):a),es.cloneElement(r,o)}return es.Children.count(r)>1?es.Children.only(null):null})).displayName=`${t}.SlotClone`,r),n=es.forwardRef((e,t)=>{let{children:r,...n}=e,i=es.Children.toArray(r),a=i.find(ed);if(a){let e=a.props.children,r=i.map(t=>t!==a?t:es.Children.count(e)>1?es.Children.only(null):es.isValidElement(e)?e.props.children:null);return(0,er.jsx)(s,{...n,ref:t,children:es.isValidElement(e)?es.cloneElement(e,void 0,r):null})}return(0,er.jsx)(s,{...n,ref:t,children:r})});return n.displayName=`${e}.Slot`,n}var el=eo("Slot"),ec=Symbol("radix.slottable");function ed(e){return es.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===ec}function eu(){for(var e,t,r=0,s="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,s,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t)){var i=t.length;for(r=0;r<i;r++)t[r]&&(s=e(t[r]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s);return n}(e))&&(s&&(s+=" "),s+=t);return s}let eh=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,ep=(e,t)=>r=>{var s;if((null==t?void 0:t.variants)==null)return eu(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:n,defaultVariants:i}=t,a=Object.keys(n).map(e=>{let t=null==r?void 0:r[e],s=null==i?void 0:i[e];if(null===t)return null;let a=eh(t)||eh(s);return n[e][a]}),o=r&&Object.entries(r).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return eu(e,a,null==t||null==(s=t.compoundVariants)?void 0:s.reduce((e,t)=>{let{class:r,className:s,...n}=t;return Object.entries(n).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...o}[t]):({...i,...o})[t]===r})?[...e,r,s]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)},ef=(e,t)=>{if(0===e.length)return t.classGroupId;let r=e[0],s=t.nextPart.get(r),n=s?ef(e.slice(1),s):void 0;if(n)return n;if(0===t.validators.length)return;let i=e.join("-");return t.validators.find(({validator:e})=>e(i))?.classGroupId},em=/^\[(.+)\]$/,eg=(e,t,r,s)=>{e.forEach(e=>{if("string"==typeof e){(""===e?t:eb(t,e)).classGroupId=r;return}"function"==typeof e?ex(e)?eg(e(s),t,r,s):t.validators.push({validator:e,classGroupId:r}):Object.entries(e).forEach(([e,n])=>{eg(n,eb(t,e),r,s)})})},eb=(e,t)=>{let r=e;return t.split("-").forEach(e=>{r.nextPart.has(e)||r.nextPart.set(e,{nextPart:new Map,validators:[]}),r=r.nextPart.get(e)}),r},ex=e=>e.isThemeGetter,ey=/\s+/;function ew(){let e,t,r=0,s="";for(;r<arguments.length;)(e=arguments[r++])&&(t=ev(e))&&(s&&(s+=" "),s+=t);return s}let ev=e=>{let t;if("string"==typeof e)return e;let r="";for(let s=0;s<e.length;s++)e[s]&&(t=ev(e[s]))&&(r&&(r+=" "),r+=t);return r},ej=e=>{let t=t=>t[e]||[];return t.isThemeGetter=!0,t},ek=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,eN=/^\((?:(\w[\w-]*):)?(.+)\)$/i,eS=/^\d+\/\d+$/,e_=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,eC=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,eE=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,eR=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,eA=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,eO=e=>eS.test(e),eT=e=>!!e&&!Number.isNaN(Number(e)),eI=e=>!!e&&Number.isInteger(Number(e)),eM=e=>e.endsWith("%")&&eT(e.slice(0,-1)),eP=e=>e_.test(e),eD=()=>!0,eL=e=>eC.test(e)&&!eE.test(e),e$=()=>!1,eU=e=>eR.test(e),eB=e=>eA.test(e),ez=e=>!eF(e)&&!eJ(e),eq=e=>e2(e,e6,e$),eF=e=>ek.test(e),eH=e=>e2(e,e8,eL),eW=e=>e2(e,e7,eT),eG=e=>e2(e,e5,e$),eV=e=>e2(e,e3,eB),eK=e=>e2(e,te,eU),eJ=e=>eN.test(e),eY=e=>e4(e,e8),eX=e=>e4(e,e9),eQ=e=>e4(e,e5),eZ=e=>e4(e,e6),e0=e=>e4(e,e3),e1=e=>e4(e,te,!0),e2=(e,t,r)=>{let s=ek.exec(e);return!!s&&(s[1]?t(s[1]):r(s[2]))},e4=(e,t,r=!1)=>{let s=eN.exec(e);return!!s&&(s[1]?t(s[1]):r)},e5=e=>"position"===e||"percentage"===e,e3=e=>"image"===e||"url"===e,e6=e=>"length"===e||"size"===e||"bg-size"===e,e8=e=>"length"===e,e7=e=>"number"===e,e9=e=>"family-name"===e,te=e=>"shadow"===e,tt=function(e,...t){let r,s,n,i=function(o){var l;let c;return s=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=new Map,s=new Map,n=(n,i)=>{r.set(n,i),++t>e&&(t=0,s=r,r=new Map)};return{get(e){let t=r.get(e);return void 0!==t?t:void 0!==(t=s.get(e))?(n(e,t),t):void 0},set(e,t){r.has(e)?r.set(e,t):n(e,t)}}})((l=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{prefix:t,experimentalParseClassName:r}=e,s=e=>{let t,r,s=[],n=0,i=0,a=0;for(let t=0;t<e.length;t++){let o=e[t];if(0===n&&0===i){if(":"===o){s.push(e.slice(a,t)),a=t+1;continue}if("/"===o){r=t;continue}}"["===o?n++:"]"===o?n--:"("===o?i++:")"===o&&i--}let o=0===s.length?e:e.substring(a),l=(t=o).endsWith("!")?t.substring(0,t.length-1):t.startsWith("!")?t.substring(1):t;return{modifiers:s,hasImportantModifier:l!==o,baseClassName:l,maybePostfixModifierPosition:r&&r>a?r-a:void 0}};if(t){let e=t+":",r=s;s=t=>t.startsWith(e)?r(t.substring(e.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:t,maybePostfixModifierPosition:void 0}}if(r){let e=s;s=t=>r({className:t,parseClassName:e})}return s})(l),sortModifiers:(c=Object.fromEntries(l.orderSensitiveModifiers.map(e=>[e,!0])),e=>{if(e.length<=1)return e;let t=[],r=[];return e.forEach(e=>{"["===e[0]||c[e]?(t.push(...r.sort(),e),r=[]):r.push(e)}),t.push(...r.sort()),t}),...(e=>{let t=(e=>{let{theme:t,classGroups:r}=e,s={nextPart:new Map,validators:[]};for(let e in r)eg(r[e],s,e,t);return s})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:e=>{let r=e.split("-");return""===r[0]&&1!==r.length&&r.shift(),ef(r,t)||(e=>{if(em.test(e)){let t=em.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}})(e)},getConflictingClassGroupIds:(e,t)=>{let n=r[e]||[];return t&&s[e]?[...n,...s[e]]:n}}})(l)}).cache.get,n=r.cache.set,i=a,a(o)};function a(e){let t=s(e);if(t)return t;let i=((e,t)=>{let{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:n,sortModifiers:i}=t,a=[],o=e.trim().split(ey),l="";for(let e=o.length-1;e>=0;e-=1){let t=o[e],{isExternal:c,modifiers:d,hasImportantModifier:u,baseClassName:h,maybePostfixModifierPosition:p}=r(t);if(c){l=t+(l.length>0?" "+l:l);continue}let f=!!p,m=s(f?h.substring(0,p):h);if(!m){if(!f||!(m=s(h))){l=t+(l.length>0?" "+l:l);continue}f=!1}let g=i(d).join(":"),b=u?g+"!":g,x=b+m;if(a.includes(x))continue;a.push(x);let y=n(m,f);for(let e=0;e<y.length;++e){let t=y[e];a.push(b+t)}l=t+(l.length>0?" "+l:l)}return l})(e,r);return n(e,i),i}return function(){return i(ew.apply(null,arguments))}}(()=>{let e=ej("color"),t=ej("font"),r=ej("text"),s=ej("font-weight"),n=ej("tracking"),i=ej("leading"),a=ej("breakpoint"),o=ej("container"),l=ej("spacing"),c=ej("radius"),d=ej("shadow"),u=ej("inset-shadow"),h=ej("text-shadow"),p=ej("drop-shadow"),f=ej("blur"),m=ej("perspective"),g=ej("aspect"),b=ej("ease"),x=ej("animate"),y=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],v=()=>[...w(),eJ,eF],j=()=>["auto","hidden","clip","visible","scroll"],k=()=>["auto","contain","none"],N=()=>[eJ,eF,l],S=()=>[eO,"full","auto",...N()],_=()=>[eI,"none","subgrid",eJ,eF],C=()=>["auto",{span:["full",eI,eJ,eF]},eI,eJ,eF],E=()=>[eI,"auto",eJ,eF],R=()=>["auto","min","max","fr",eJ,eF],A=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],O=()=>["start","end","center","stretch","center-safe","end-safe"],T=()=>["auto",...N()],I=()=>[eO,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],M=()=>[e,eJ,eF],P=()=>[...w(),eQ,eG,{position:[eJ,eF]}],D=()=>["no-repeat",{repeat:["","x","y","space","round"]}],L=()=>["auto","cover","contain",eZ,eq,{size:[eJ,eF]}],$=()=>[eM,eY,eH],U=()=>["","none","full",c,eJ,eF],B=()=>["",eT,eY,eH],z=()=>["solid","dashed","dotted","double"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],F=()=>[eT,eM,eQ,eG],H=()=>["","none",f,eJ,eF],W=()=>["none",eT,eJ,eF],G=()=>["none",eT,eJ,eF],V=()=>[eT,eJ,eF],K=()=>[eO,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[eP],breakpoint:[eP],color:[eD],container:[eP],"drop-shadow":[eP],ease:["in","out","in-out"],font:[ez],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[eP],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[eP],shadow:[eP],spacing:["px",eT],text:[eP],"text-shadow":[eP],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",eO,eF,eJ,g]}],container:["container"],columns:[{columns:[eT,eF,eJ,o]}],"break-after":[{"break-after":y()}],"break-before":[{"break-before":y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:v()}],overflow:[{overflow:j()}],"overflow-x":[{"overflow-x":j()}],"overflow-y":[{"overflow-y":j()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:S()}],"inset-x":[{"inset-x":S()}],"inset-y":[{"inset-y":S()}],start:[{start:S()}],end:[{end:S()}],top:[{top:S()}],right:[{right:S()}],bottom:[{bottom:S()}],left:[{left:S()}],visibility:["visible","invisible","collapse"],z:[{z:[eI,"auto",eJ,eF]}],basis:[{basis:[eO,"full","auto",o,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[eT,eO,"auto","initial","none",eF]}],grow:[{grow:["",eT,eJ,eF]}],shrink:[{shrink:["",eT,eJ,eF]}],order:[{order:[eI,"first","last","none",eJ,eF]}],"grid-cols":[{"grid-cols":_()}],"col-start-end":[{col:C()}],"col-start":[{"col-start":E()}],"col-end":[{"col-end":E()}],"grid-rows":[{"grid-rows":_()}],"row-start-end":[{row:C()}],"row-start":[{"row-start":E()}],"row-end":[{"row-end":E()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":R()}],"auto-rows":[{"auto-rows":R()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...A(),"normal"]}],"justify-items":[{"justify-items":[...O(),"normal"]}],"justify-self":[{"justify-self":["auto",...O()]}],"align-content":[{content:["normal",...A()]}],"align-items":[{items:[...O(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...O(),{baseline:["","last"]}]}],"place-content":[{"place-content":A()}],"place-items":[{"place-items":[...O(),"baseline"]}],"place-self":[{"place-self":["auto",...O()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:T()}],mx:[{mx:T()}],my:[{my:T()}],ms:[{ms:T()}],me:[{me:T()}],mt:[{mt:T()}],mr:[{mr:T()}],mb:[{mb:T()}],ml:[{ml:T()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:I()}],w:[{w:[o,"screen",...I()]}],"min-w":[{"min-w":[o,"screen","none",...I()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...I()]}],h:[{h:["screen","lh",...I()]}],"min-h":[{"min-h":["screen","lh","none",...I()]}],"max-h":[{"max-h":["screen","lh",...I()]}],"font-size":[{text:["base",r,eY,eH]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,eJ,eW]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",eM,eF]}],"font-family":[{font:[eX,eF,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,eJ,eF]}],"line-clamp":[{"line-clamp":[eT,"none",eJ,eW]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",eJ,eF]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",eJ,eF]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:M()}],"text-color":[{text:M()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:[eT,"from-font","auto",eJ,eH]}],"text-decoration-color":[{decoration:M()}],"underline-offset":[{"underline-offset":[eT,"auto",eJ,eF]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",eJ,eF]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",eJ,eF]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:P()}],"bg-repeat":[{bg:D()}],"bg-size":[{bg:L()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},eI,eJ,eF],radial:["",eJ,eF],conic:[eI,eJ,eF]},e0,eV]}],"bg-color":[{bg:M()}],"gradient-from-pos":[{from:$()}],"gradient-via-pos":[{via:$()}],"gradient-to-pos":[{to:$()}],"gradient-from":[{from:M()}],"gradient-via":[{via:M()}],"gradient-to":[{to:M()}],rounded:[{rounded:U()}],"rounded-s":[{"rounded-s":U()}],"rounded-e":[{"rounded-e":U()}],"rounded-t":[{"rounded-t":U()}],"rounded-r":[{"rounded-r":U()}],"rounded-b":[{"rounded-b":U()}],"rounded-l":[{"rounded-l":U()}],"rounded-ss":[{"rounded-ss":U()}],"rounded-se":[{"rounded-se":U()}],"rounded-ee":[{"rounded-ee":U()}],"rounded-es":[{"rounded-es":U()}],"rounded-tl":[{"rounded-tl":U()}],"rounded-tr":[{"rounded-tr":U()}],"rounded-br":[{"rounded-br":U()}],"rounded-bl":[{"rounded-bl":U()}],"border-w":[{border:B()}],"border-w-x":[{"border-x":B()}],"border-w-y":[{"border-y":B()}],"border-w-s":[{"border-s":B()}],"border-w-e":[{"border-e":B()}],"border-w-t":[{"border-t":B()}],"border-w-r":[{"border-r":B()}],"border-w-b":[{"border-b":B()}],"border-w-l":[{"border-l":B()}],"divide-x":[{"divide-x":B()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":B()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...z(),"hidden","none"]}],"divide-style":[{divide:[...z(),"hidden","none"]}],"border-color":[{border:M()}],"border-color-x":[{"border-x":M()}],"border-color-y":[{"border-y":M()}],"border-color-s":[{"border-s":M()}],"border-color-e":[{"border-e":M()}],"border-color-t":[{"border-t":M()}],"border-color-r":[{"border-r":M()}],"border-color-b":[{"border-b":M()}],"border-color-l":[{"border-l":M()}],"divide-color":[{divide:M()}],"outline-style":[{outline:[...z(),"none","hidden"]}],"outline-offset":[{"outline-offset":[eT,eJ,eF]}],"outline-w":[{outline:["",eT,eY,eH]}],"outline-color":[{outline:M()}],shadow:[{shadow:["","none",d,e1,eK]}],"shadow-color":[{shadow:M()}],"inset-shadow":[{"inset-shadow":["none",u,e1,eK]}],"inset-shadow-color":[{"inset-shadow":M()}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:M()}],"ring-offset-w":[{"ring-offset":[eT,eH]}],"ring-offset-color":[{"ring-offset":M()}],"inset-ring-w":[{"inset-ring":B()}],"inset-ring-color":[{"inset-ring":M()}],"text-shadow":[{"text-shadow":["none",h,e1,eK]}],"text-shadow-color":[{"text-shadow":M()}],opacity:[{opacity:[eT,eJ,eF]}],"mix-blend":[{"mix-blend":[...q(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":q()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[eT]}],"mask-image-linear-from-pos":[{"mask-linear-from":F()}],"mask-image-linear-to-pos":[{"mask-linear-to":F()}],"mask-image-linear-from-color":[{"mask-linear-from":M()}],"mask-image-linear-to-color":[{"mask-linear-to":M()}],"mask-image-t-from-pos":[{"mask-t-from":F()}],"mask-image-t-to-pos":[{"mask-t-to":F()}],"mask-image-t-from-color":[{"mask-t-from":M()}],"mask-image-t-to-color":[{"mask-t-to":M()}],"mask-image-r-from-pos":[{"mask-r-from":F()}],"mask-image-r-to-pos":[{"mask-r-to":F()}],"mask-image-r-from-color":[{"mask-r-from":M()}],"mask-image-r-to-color":[{"mask-r-to":M()}],"mask-image-b-from-pos":[{"mask-b-from":F()}],"mask-image-b-to-pos":[{"mask-b-to":F()}],"mask-image-b-from-color":[{"mask-b-from":M()}],"mask-image-b-to-color":[{"mask-b-to":M()}],"mask-image-l-from-pos":[{"mask-l-from":F()}],"mask-image-l-to-pos":[{"mask-l-to":F()}],"mask-image-l-from-color":[{"mask-l-from":M()}],"mask-image-l-to-color":[{"mask-l-to":M()}],"mask-image-x-from-pos":[{"mask-x-from":F()}],"mask-image-x-to-pos":[{"mask-x-to":F()}],"mask-image-x-from-color":[{"mask-x-from":M()}],"mask-image-x-to-color":[{"mask-x-to":M()}],"mask-image-y-from-pos":[{"mask-y-from":F()}],"mask-image-y-to-pos":[{"mask-y-to":F()}],"mask-image-y-from-color":[{"mask-y-from":M()}],"mask-image-y-to-color":[{"mask-y-to":M()}],"mask-image-radial":[{"mask-radial":[eJ,eF]}],"mask-image-radial-from-pos":[{"mask-radial-from":F()}],"mask-image-radial-to-pos":[{"mask-radial-to":F()}],"mask-image-radial-from-color":[{"mask-radial-from":M()}],"mask-image-radial-to-color":[{"mask-radial-to":M()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[eT]}],"mask-image-conic-from-pos":[{"mask-conic-from":F()}],"mask-image-conic-to-pos":[{"mask-conic-to":F()}],"mask-image-conic-from-color":[{"mask-conic-from":M()}],"mask-image-conic-to-color":[{"mask-conic-to":M()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:P()}],"mask-repeat":[{mask:D()}],"mask-size":[{mask:L()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",eJ,eF]}],filter:[{filter:["","none",eJ,eF]}],blur:[{blur:H()}],brightness:[{brightness:[eT,eJ,eF]}],contrast:[{contrast:[eT,eJ,eF]}],"drop-shadow":[{"drop-shadow":["","none",p,e1,eK]}],"drop-shadow-color":[{"drop-shadow":M()}],grayscale:[{grayscale:["",eT,eJ,eF]}],"hue-rotate":[{"hue-rotate":[eT,eJ,eF]}],invert:[{invert:["",eT,eJ,eF]}],saturate:[{saturate:[eT,eJ,eF]}],sepia:[{sepia:["",eT,eJ,eF]}],"backdrop-filter":[{"backdrop-filter":["","none",eJ,eF]}],"backdrop-blur":[{"backdrop-blur":H()}],"backdrop-brightness":[{"backdrop-brightness":[eT,eJ,eF]}],"backdrop-contrast":[{"backdrop-contrast":[eT,eJ,eF]}],"backdrop-grayscale":[{"backdrop-grayscale":["",eT,eJ,eF]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[eT,eJ,eF]}],"backdrop-invert":[{"backdrop-invert":["",eT,eJ,eF]}],"backdrop-opacity":[{"backdrop-opacity":[eT,eJ,eF]}],"backdrop-saturate":[{"backdrop-saturate":[eT,eJ,eF]}],"backdrop-sepia":[{"backdrop-sepia":["",eT,eJ,eF]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",eJ,eF]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[eT,"initial",eJ,eF]}],ease:[{ease:["linear","initial",b,eJ,eF]}],delay:[{delay:[eT,eJ,eF]}],animate:[{animate:["none",x,eJ,eF]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[m,eJ,eF]}],"perspective-origin":[{"perspective-origin":v()}],rotate:[{rotate:W()}],"rotate-x":[{"rotate-x":W()}],"rotate-y":[{"rotate-y":W()}],"rotate-z":[{"rotate-z":W()}],scale:[{scale:G()}],"scale-x":[{"scale-x":G()}],"scale-y":[{"scale-y":G()}],"scale-z":[{"scale-z":G()}],"scale-3d":["scale-3d"],skew:[{skew:V()}],"skew-x":[{"skew-x":V()}],"skew-y":[{"skew-y":V()}],transform:[{transform:[eJ,eF,"","none","gpu","cpu"]}],"transform-origin":[{origin:v()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:K()}],"translate-x":[{"translate-x":K()}],"translate-y":[{"translate-y":K()}],"translate-z":[{"translate-z":K()}],"translate-none":["translate-none"],accent:[{accent:M()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:M()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",eJ,eF]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",eJ,eF]}],fill:[{fill:["none",...M()]}],"stroke-w":[{stroke:[eT,eY,eH,eW]}],stroke:[{stroke:["none",...M()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function tr(...e){return tt(eu(e))}let ts=ep("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function tn({className:e,variant:t,size:r,asChild:s=!1,...n}){return(0,er.jsx)(s?el:"button",{"data-slot":"button",className:tr(ts({variant:t,size:r,className:e})),...n})}let ti=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},ta=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var to={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let tl=(0,es.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:n="",children:i,iconNode:a,...o},l)=>(0,es.createElement)("svg",{ref:l,...to,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:ta("lucide",n),...o},[...a.map(([e,t])=>(0,es.createElement)(e,t)),...Array.isArray(i)?i:[i]])),tc=(e,t)=>{let r=(0,es.forwardRef)(({className:r,...s},n)=>(0,es.createElement)(tl,{ref:n,iconNode:t,className:ta(`lucide-${ti(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...s}));return r.displayName=ti(e),r},td=tc("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),tu=tc("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),th=tc("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),tp=tc("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),tf=tc("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),tm=tc("heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),tg=tc("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),tb=tc("sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),tx=tc("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function ty(e){let[t,r]=(0,es.useState)(!1),{src:s,alt:n,style:i,className:a,...o}=e;return t?(0,er.jsx)("div",{className:`inline-block bg-gray-100 text-center align-middle ${a??""}`,style:i,children:(0,er.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,er.jsx)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODgiIGhlaWdodD0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIuMyIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIzLjciPjxyZWN0IHg9IjE2IiB5PSIxNiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiByeD0iNiIvPjxwYXRoIGQ9Im0xNiA1OCAxNi0xOCAzMiAzMiIvPjxjaXJjbGUgY3g9IjUzIiBjeT0iMzUiIHI9IjciLz48L3N2Zz4KCg==",alt:"Error loading image",...o,"data-original-url":s})})}):(0,er.jsx)("img",{src:s,alt:n,className:a,style:i,...o,onError:()=>{r(!0)}})}function tw({onGetStarted:e,onLogin:t,onViewFeature:r,onViewHelp:s,onViewPrivacy:n,onViewTerms:i,onViewAbout:a,onViewCookies:o}){let[l,c]=(0,es.useState)(null),d=[{icon:td,title:"Group Chats",description:"Keep your entire crew in one thread without losing context.",color:"from-pink-500 to-purple-500",id:"group-chats"},{icon:tu,title:"4K Video Calls",description:"Face-to-face chats that actually look like real life.",color:"from-blue-500 to-cyan-500",id:"video-calls"},{icon:tf,title:"8K Screen Share",description:"Crisp screen shares for homework help, beats, or builds.",color:"from-green-500 to-emerald-500",id:"screen-share"},{icon:tg,title:"Stories & Snaps",description:"Post quick moments that disappear before things get messy.",color:"from-yellow-500 to-orange-500",id:"stories"},{icon:th,title:"Friends Network",description:"Organize friends, teams, and clubs without juggling apps.",color:"from-red-500 to-pink-500",id:"friends"},{icon:tb,title:"Gen Z Vibes",description:"Glass, gradients, and motion that feel intentionalnot corporate.",color:"from-purple-500 to-indigo-500",id:"gen-z"}];return(0,er.jsxs)("div",{className:"min-h-screen overflow-hidden bg-gradient-to-br from-purple-900 via-pink-800 to-orange-700 relative",children:[(0,er.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,er.jsx)("div",{className:"absolute -top-40 -left-40 w-96 h-96 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob"}),(0,er.jsx)("div",{className:"absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-2000"}),(0,er.jsx)("div",{className:"absolute -bottom-40 left-20 w-96 h-96 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-4000"})]}),(0,er.jsxs)("nav",{className:"relative z-10 flex items-center justify-between p-6 backdrop-blur-md bg-white/5 border-b border-white/10",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-500 rounded-2xl flex items-center justify-center",children:(0,er.jsx)(tp,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("span",{className:"text-white text-2xl",children:"MoveSplash"})]}),(0,er.jsx)(tn,{onClick:t,className:"bg-white/10 backdrop-blur-md border border-white/20 text-white hover:bg-white/20",children:"Log In"})]}),(0,er.jsxs)("div",{className:"relative z-10 container mx-auto px-6 pt-20 pb-32",children:[(0,er.jsxs)("div",{className:"text-center max-w-4xl mx-auto",children:[(0,er.jsxs)("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 backdrop-blur-md rounded-full border border-white/20 mb-8",children:[(0,er.jsx)(tb,{className:"w-4 h-4 text-yellow-300"}),(0,er.jsx)("span",{className:"text-white/90 text-sm",children:"Built for real friends, not bots."})]}),(0,er.jsx)("h1",{className:"text-6xl md:text-7xl text-white mb-6 bg-clip-text text-transparent bg-gradient-to-r from-white via-pink-200 to-purple-200",children:"One place for the people you actually talk to."}),(0,er.jsx)("p",{className:"text-xl text-white/80 mb-12 max-w-2xl mx-auto",children:"MoveSplash combines group chats, zero-lag video calls, and disappearing stories so you do not have to bounce between five different apps."}),(0,er.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[(0,er.jsxs)(tn,{onClick:e,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 px-8 py-6 text-lg group",children:["Get Started",(0,er.jsx)(tx,{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform"})]}),(0,er.jsx)(tn,{variant:"outline",className:"bg-white/10 backdrop-blur-md border-white/20 text-white hover:bg-white/20 px-8 py-6 text-lg",children:"See it in action"})]})]}),(0,er.jsx)("div",{className:"mt-24 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto",children:d.map((e,t)=>(0,er.jsxs)("div",{onMouseEnter:()=>c(t),onMouseLeave:()=>c(null),onClick:()=>r?.(e.id),className:`p-6 backdrop-blur-xl bg-white/10 rounded-3xl border border-white/20 transition-all duration-300 cursor-pointer ${l===t?"transform scale-105 bg-white/15":""}`,children:[(0,er.jsx)("div",{className:`w-14 h-14 bg-gradient-to-br ${e.color} rounded-2xl flex items-center justify-center mb-4`,children:(0,er.jsx)(e.icon,{className:"w-7 h-7 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:e.title}),(0,er.jsx)("p",{className:"text-white/70",children:e.description}),(0,er.jsxs)("div",{className:"text-white/50 text-sm mt-2 flex items-center gap-1",children:["Learn more ",(0,er.jsx)(tx,{className:"w-4 h-4"})]})]},t))})]}),(0,er.jsx)("div",{className:"relative z-10 bg-white/5 backdrop-blur-lg border-y border-white/10 py-16",children:(0,er.jsx)("div",{className:"container mx-auto px-6",children:(0,er.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-4xl text-white mb-2",children:"10M+"}),(0,er.jsx)("div",{className:"text-white/60",children:"Active Users"})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-4xl text-white mb-2",children:"500M+"}),(0,er.jsx)("div",{className:"text-white/60",children:"Messages Sent"})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-4xl text-white mb-2",children:"50M+"}),(0,er.jsx)("div",{className:"text-white/60",children:"Video Calls"})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-4xl text-white mb-2",children:"100M+"}),(0,er.jsx)("div",{className:"text-white/60",children:"Stories Shared"})]})]})})}),(0,er.jsx)("div",{className:"relative z-10 container mx-auto px-6 py-24",children:(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("h2",{className:"text-4xl text-white mb-6",children:"Group chat energy without the chaos."}),(0,er.jsx)("p",{className:"text-white/80 text-lg mb-6",children:"Twenty-person threads stay organized with inline replies, reactions, and pinned highlights. Everything delivers instantly, so plans do not go stale."}),(0,er.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,er.jsx)("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-md rounded-full border border-white/20 text-white/90",children:" Inline replies"}),(0,er.jsx)("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-md rounded-full border border-white/20 text-white/90",children:" Custom emoji packs"}),(0,er.jsx)("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-md rounded-full border border-white/20 text-white/90",children:" Drop-anything sharing"})]})]}),(0,er.jsx)("div",{className:"relative h-96 rounded-3xl overflow-hidden backdrop-blur-xl bg-white/10 border border-white/20 p-6",children:(0,er.jsx)(ty,{src:"https://images.unsplash.com/photo-1584947113929-2d02f9c06203?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxtb2Rlcm4lMjB0ZWNobm9sb2d5JTIwc29jaWFsfGVufDF8fHx8MTc2MDcyNzI5Nnww&ixlib=rb-4.1.0&q=80&w=1080",alt:"Chat interface",className:"w-full h-full object-cover rounded-2xl"})})]})}),(0,er.jsx)("div",{className:"relative z-10 container mx-auto px-6 pb-24",children:(0,er.jsxs)("div",{className:"max-w-4xl mx-auto text-center p-12 backdrop-blur-xl bg-gradient-to-br from-white/10 to-white/5 rounded-3xl border border-white/20",children:[(0,er.jsx)("h2",{className:"text-4xl text-white mb-6",children:"Ready to stop hopping between apps?"}),(0,er.jsx)("p",{className:"text-white/80 text-lg mb-8",children:"MoveSplash keeps chats, calls, stories, and plans in one place so you can just hang out."}),(0,er.jsx)(tn,{onClick:e,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 px-8 py-6 text-lg",children:"Create Free Account"})]})}),(0,er.jsx)("footer",{className:"relative z-10 border-t border-white/10 bg-black/20 backdrop-blur-lg",children:(0,er.jsxs)("div",{className:"container mx-auto px-6 py-12",children:[(0,er.jsxs)("div",{className:"grid md:grid-cols-4 gap-8 mb-8",children:[(0,er.jsxs)("div",{className:"md:col-span-1",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,er.jsx)(tp,{className:"w-8 h-8 text-purple-400"}),(0,er.jsx)("span",{className:"text-2xl text-white",children:"MoveSplash"})]}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"A calmer social app for real-life friends, side projects, and late-night ideas."})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-4",children:"Features"}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm",children:[(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:()=>r?.("group-chats"),className:"hover:text-white transition-colors",children:"Group Chats"})}),(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:()=>r?.("video-calls"),className:"hover:text-white transition-colors",children:"Video Calls"})}),(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:()=>r?.("screen-share"),className:"hover:text-white transition-colors",children:"Screen Share"})}),(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:()=>r?.("stories"),className:"hover:text-white transition-colors",children:"Stories & Snaps"})}),(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:()=>r?.("friends"),className:"hover:text-white transition-colors",children:"Friends Network"})})]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-4",children:"Company"}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm",children:[(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:s,className:"hover:text-white transition-colors",children:"Help Center"})}),(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:a,className:"hover:text-white transition-colors",children:"About Us"})})]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-4",children:"Legal"}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm",children:[(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:n,className:"hover:text-white transition-colors",children:"Privacy Policy"})}),(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:i,className:"hover:text-white transition-colors",children:"Terms of Use"})}),(0,er.jsx)("li",{children:(0,er.jsx)("button",{onClick:o,className:"hover:text-white transition-colors",children:"Cookie Policy"})})]})]})]}),(0,er.jsxs)("div",{className:"border-t border-white/10 pt-6 flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,er.jsx)("p",{className:"text-white/50 text-sm",children:" 2025 MoveSplash, Inc. All rights reserved."}),(0,er.jsxs)("div",{className:"flex gap-6",children:[(0,er.jsx)("a",{href:"#",className:"text-white/50 hover:text-white transition-colors",children:(0,er.jsx)(tm,{className:"w-5 h-5"})}),(0,er.jsx)("a",{href:"#",className:"text-white/50 hover:text-white transition-colors",children:(0,er.jsx)(tg,{className:"w-5 h-5"})}),(0,er.jsx)("a",{href:"#",className:"text-white/50 hover:text-white transition-colors",children:(0,er.jsx)(tb,{className:"w-5 h-5"})})]})]})]})}),(0,er.jsx)("style",{children:`
        @keyframes blob {
          0% { transform: translate(0px, 0px) scale(1); }
          33% { transform: translate(30px, -50px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
          100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob {
          animation: blob 7s infinite;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
      `})]})}var tv=e.i(47167);class tj extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class tk extends tj{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class tN extends tj{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class tS extends tj{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}(k=z||(z={})).Any="any",k.ApNortheast1="ap-northeast-1",k.ApNortheast2="ap-northeast-2",k.ApSouth1="ap-south-1",k.ApSoutheast1="ap-southeast-1",k.ApSoutheast2="ap-southeast-2",k.CaCentral1="ca-central-1",k.EuCentral1="eu-central-1",k.EuWest1="eu-west-1",k.EuWest2="eu-west-2",k.EuWest3="eu-west-3",k.SaEast1="sa-east-1",k.UsEast1="us-east-1",k.UsWest1="us-west-1",k.UsWest2="us-west-2";class t_{constructor(t,{headers:r={},customFetch:s,region:n=z.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=(t=>{let r;return r=t||("undefined"==typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){var t,r,s,n;return t=this,r=arguments,s=void 0,n=function*(e,t={}){var r;try{let s,{headers:n,method:i,body:a,signal:o}=t,l={},{region:c}=t;c||(c=this.region);let d=new URL(`${this.url}/${e}`);c&&"any"!==c&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c)),a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",s=a):"string"==typeof a?(l["Content-Type"]="text/plain",s=a):"undefined"!=typeof FormData&&a instanceof FormData?s=a:(l["Content-Type"]="application/json",s=JSON.stringify(a)));let u=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:s,signal:o}).catch(e=>{if("AbortError"===e.name)throw e;throw new tk(e)}),h=u.headers.get("x-relay-error");if(h&&"true"===h)throw new tN(u);if(!u.ok)throw new tS(u);let p=(null!=(r=u.headers.get("Content-Type"))?r:"text/plain").split(";")[0].trim();return{data:"application/json"===p?yield u.json():"application/octet-stream"===p?yield u.blob():"text/event-stream"===p?u:"multipart/form-data"===p?yield u.formData():yield u.text(),error:null,response:u}}catch(e){if(e instanceof Error&&"AbortError"===e.name)return{data:null,error:new tk(e)};return{data:null,error:e,response:e instanceof tS||e instanceof tN?e.context:void 0}}},new(s||(s=Promise))(function(e,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof s?r:new s(function(e){e(r)})).then(a,o)}l((n=n.apply(t,r||[])).next())})}}let{PostgrestClient:tC,PostgrestQueryBuilder:tE,PostgrestFilterBuilder:tR,PostgrestTransformBuilder:tA,PostgrestBuilder:tO,PostgrestError:tT}=e.i(82215).default,tI=class{static detectEnvironment(){var t;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==e.g.WebSocket)return{type:"native",constructor:e.g.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null==(t=navigator.userAgent)?void 0:t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(void 0!==tv.default){let e=tv.default.versions;if(e&&e.node){let t=parseInt(e.node.replace(/^v/,"").split(".")[0]);return t>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}};(N=q||(q={}))[N.connecting=0]="connecting",N[N.open=1]="open",N[N.closing=2]="closing",N[N.closed=3]="closed",(S=F||(F={})).closed="closed",S.errored="errored",S.joined="joined",S.joining="joining",S.leaving="leaving",(_=H||(H={})).close="phx_close",_.error="phx_error",_.join="phx_join",_.reply="phx_reply",_.leave="phx_leave",_.access_token="access_token",(W||(W={})).websocket="websocket",(C=G||(G={})).Connecting="connecting",C.Open="open",C.Closing="closing",C.Closed="closed";class tM{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let s=t.getUint8(1),n=t.getUint8(2),i=this.HEADER_LENGTH+2,a=r.decode(e.slice(i,i+s));i+=s;let o=r.decode(e.slice(i,i+n));return i+=n,{ref:null,topic:a,event:o,payload:JSON.parse(r.decode(e.slice(i,e.byteLength)))}}}class tP{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(E=V||(V={})).abstime="abstime",E.bool="bool",E.date="date",E.daterange="daterange",E.float4="float4",E.float8="float8",E.int2="int2",E.int4="int4",E.int4range="int4range",E.int8="int8",E.int8range="int8range",E.json="json",E.jsonb="jsonb",E.money="money",E.numeric="numeric",E.oid="oid",E.reltime="reltime",E.text="text",E.time="time",E.timestamp="timestamp",E.timestamptz="timestamptz",E.timetz="timetz",E.tsrange="tsrange",E.tstzrange="tstzrange";let tD=(e,t,r={})=>{var s;let n=null!=(s=r.skipTypes)?s:[];return t?Object.keys(t).reduce((r,s)=>(r[s]=tL(s,e,t,n),r),{}):{}},tL=(e,t,r,s)=>{let n=t.find(t=>t.name===e),i=null==n?void 0:n.type,a=r[e];return i&&!s.includes(i)?t$(i,a):tU(a)},t$=(e,t)=>{if("_"===e.charAt(0))return tF(t,e.slice(1,e.length));switch(e){case V.bool:return tB(t);case V.float4:case V.float8:case V.int2:case V.int4:case V.int8:case V.numeric:case V.oid:return tz(t);case V.json:case V.jsonb:return tq(t);case V.timestamp:return tH(t);case V.abstime:case V.date:case V.daterange:case V.int4range:case V.int8range:case V.money:case V.reltime:case V.text:case V.time:case V.timestamptz:case V.timetz:case V.tsrange:case V.tstzrange:default:return tU(t)}},tU=e=>e,tB=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},tz=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},tq=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},tF=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,s=e[r];if("{"===e[0]&&"}"===s){let s,n=e.slice(1,r);try{s=JSON.parse("["+n+"]")}catch(e){s=n?n.split(","):[]}return s.map(e=>t$(t,e))}return e},tH=e=>"string"==typeof e?e.replace(" ","T"):e,tW=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")+"/api/broadcast"};class tG{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null==(r=this.receivedResp)?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}(R=K||(K={})).SYNC="sync",R.JOIN="join",R.LEAVE="leave";class tV{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=tV.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=tV.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=tV.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){let n=this.cloneDeep(e),i=this.transformState(t),a={},o={};return this.map(n,(e,t)=>{i[e]||(o[e]=t)}),this.map(i,(e,t)=>{let r=n[e];if(r){let s=t.map(e=>e.presence_ref),n=r.map(e=>e.presence_ref),i=t.filter(e=>0>n.indexOf(e.presence_ref)),l=r.filter(e=>0>s.indexOf(e.presence_ref));i.length>0&&(a[e]=i),l.length>0&&(o[e]=l)}else a[e]=t}),this.syncDiff(n,{joins:a,leaves:o},r,s)}static syncDiff(e,t,r,s){let{joins:n,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(n,(t,s)=>{var n;let i=null!=(n=e[t])?n:[];if(e[t]=this.cloneDeep(s),i.length>0){let r=e[t].map(e=>e.presence_ref),s=i.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...s)}r(t,i,s)}),this.map(i,(t,r)=>{let n=e[t];if(!n)return;let i=r.map(e=>e.presence_ref);n=n.filter(e=>0>i.indexOf(e.presence_ref)),e[t]=n,s(t,n,r),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let s=e[r];return"metas"in s?t[r]=s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(A=J||(J={})).ALL="*",A.INSERT="INSERT",A.UPDATE="UPDATE",A.DELETE="DELETE",(O=Y||(Y={})).BROADCAST="broadcast",O.PRESENCE="presence",O.POSTGRES_CHANGES="postgres_changes",O.SYSTEM="system",(T=X||(X={})).SUBSCRIBED="SUBSCRIBED",T.TIMED_OUT="TIMED_OUT",T.CLOSED="CLOSED",T.CHANNEL_ERROR="CHANNEL_ERROR";class tK{constructor(e,t={config:{}},r){var s,n;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=F.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new tG(this,H.join,this.params,this.timeout),this.rejoinTimer=new tP(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=F.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=F.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=F.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=F.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=F.errored,this.rejoinTimer.scheduleTimeout())}),this._on(H.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new tV(this),this.broadcastEndpointURL=tW(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null==(n=null==(s=this.params.config)?void 0:s.broadcast)?void 0:n.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==F.closed){let{config:{broadcast:i,presence:a,private:o}}=this.params,l=null!=(s=null==(r=this.bindings.postgres_changes)?void 0:r.map(e=>e.filter))?s:[],c=!!this.bindings[Y.PRESENCE]&&this.bindings[Y.PRESENCE].length>0||(null==(n=this.params.config.presence)?void 0:n.enabled)===!0,d={},u={broadcast:i,presence:Object.assign(Object.assign({},a),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(X.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(X.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0===t){null==e||e(X.SUBSCRIBED);return}{let s=this.bindings.postgres_changes,n=null!=(r=null==s?void 0:s.length)?r:0,i=[];for(let r=0;r<n;r++){let n=s[r],{filter:{event:a,schema:o,table:l,filter:c}}=n,d=t&&t[r];if(d&&d.event===a&&d.schema===o&&d.table===l&&d.filter===c)i.push(Object.assign(Object.assign({},n),{id:d.id}));else{this.unsubscribe(),this.state=F.errored,null==e||e(X.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=i,e&&e(X.SUBSCRIBED);return}}).receive("error",t=>{this.state=F.errored,null==e||e(X.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(X.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===F.joined&&e===Y.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,n,i;let a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null==(i=null==(n=null==(s=this.params)?void 0:s.config)?void 0:n.broadcast)?void 0:i.ack)||r("ok"),a.receive("ok",()=>r("ok")),a.receive("error",()=>r("error")),a.receive("timeout",()=>r("timed out"))});{let{event:n,payload:i}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!=(r=t.timeout)?r:this.timeout);return await (null==(s=e.body)?void 0:s.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=F.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(H.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{(r=new tG(this,H.leave,{},e)).receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=F.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){let s=new AbortController,n=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(n),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new tG(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,n;let i=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:c}=H;if(r&&[a,o,l,c].indexOf(i)>=0&&r!==this._joinRef())return;let d=this._onMessage(i,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null==(s=this.bindings.postgres_changes)||s.filter(e=>{var t,r,s;return(null==(t=e.filter)?void 0:t.event)==="*"||(null==(s=null==(r=e.filter)?void 0:r.event)?void 0:s.toLocaleLowerCase())===i}).map(e=>e.callback(d,r)):null==(n=this.bindings[i])||n.filter(e=>{var r,s,n,a,o,l;if(!["broadcast","presence","postgres_changes"].includes(i))return e.type.toLocaleLowerCase()===i;if("id"in e){let i=e.id,a=null==(r=e.filter)?void 0:r.event;return i&&(null==(s=t.ids)?void 0:s.includes(i))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null==(n=t.data)?void 0:n.type.toLocaleLowerCase()))}{let r=null==(o=null==(a=null==e?void 0:e.filter)?void 0:a.event)?void 0:o.toLocaleLowerCase();return"*"===r||r===(null==(l=null==t?void 0:t.event)?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof d&&"ids"in d){let e=d.data,{schema:t,table:r,commit_timestamp:s,type:n,errors:i}=e;d=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:s,eventType:n,new:{},old:{},errors:i}),this._getPayloadRecords(e))}e.callback(d,r)})}_isClosed(){return this.state===F.closed}_isJoined(){return this.state===F.joined}_isJoining(){return this.state===F.joining}_isLeaving(){return this.state===F.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let s=e.toLocaleLowerCase(),n={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(n):this.bindings[s]=[n],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null==(s=e.type)?void 0:s.toLocaleLowerCase())===r&&tK.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(H.close,{},e)}_onError(e){this._on(H.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=F.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=tD(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=tD(e.columns,e.old_record)),t}}let tJ=()=>{},tY=[1e3,2e3,5e3,1e4],tX=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class tQ{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=tJ,this.ref=0,this.reconnectTimer=null,this.logger=tJ,this.conn=null,this.sendBuffer=[],this.serializer=new tM,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=t=>{let r;return r=t||("undefined"==typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)).catch(e=>{throw Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>r(...e)},!(null==(s=null==r?void 0:r.params)?void 0:s.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${W.websocket}`,this.httpEndpoint=tW(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==r?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=tI.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;if(e.includes("Node.js"))throw Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case q.connecting:return G.Connecting;case q.open:return G.Open;case q.closing:return G.Closing;default:return G.Closed}}isConnected(){return this.connectionState()===G.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){let r=`realtime:${e}`,s=this.getChannels().find(e=>e.topic===r);if(s)return s;{let r=new tK(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){let{topic:t,event:r,payload:s,ref:n}=e,i=()=>{this.encode(e,e=>{var t;null==(t=this.conn)||t.send(e)})};this.log("push",`${t} ${r} (${n})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,null==(e=this.conn)||e.close(1e3,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||null==(e=this.reconnectTimer)||e.scheduleTimeout()},100);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(e){this.log("error","error in heartbeat callback",e)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:t,event:r,payload:s,ref:n}=e,i=n?`(${n})`:"",a=s.status||"";this.log("receive",`${a} ${t} ${r} ${i}`.trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,n)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null==(t=this.reconnectTimer)||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(t=this.reconnectTimer)||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(H.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([tX],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t,version:"realtime-js/2.75.1"}),e.joinedOnce&&e._isJoined()&&e._push(H.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(t){this.log("error",`error in ${e} callback`,t)}})}catch(t){this.log("error",`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new tP(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},10)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,n,i,a,o,l,c;if(this.transport=null!=(t=null==e?void 0:e.transport)?t:null,this.timeout=null!=(r=null==e?void 0:e.timeout)?r:1e4,this.heartbeatIntervalMs=null!=(s=null==e?void 0:e.heartbeatIntervalMs)?s:25e3,this.worker=null!=(n=null==e?void 0:e.worker)&&n,this.accessToken=null!=(i=null==e?void 0:e.accessToken)?i:null,this.heartbeatCallback=null!=(a=null==e?void 0:e.heartbeatCallback)?a:tJ,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(o=null==e?void 0:e.reconnectAfterMs)?o:e=>tY[e-1]||1e4,this.encode=null!=(l=null==e?void 0:e.encode)?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!=(c=null==e?void 0:e.decode)?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}var tZ=e.i(67034);class t0 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function t1(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class t2 extends t0{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class t4 extends t0{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let t5=t=>{let r;return r=t||("undefined"==typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)},t3=e=>{if(Array.isArray(e))return e.map(e=>t3(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=t3(r)}),t};var t6=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};let t8=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e);function t7(t,r,s,n,i,a){return t6(this,void 0,void 0,function*(){return new Promise((o,l)=>{let c;t(s,(c={method:r,headers:(null==n?void 0:n.headers)||{}},"GET"===r||!a?c:((e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(a)?(c.headers=Object.assign({"Content-Type":"application/json"},null==n?void 0:n.headers),c.body=JSON.stringify(a)):c.body=a,(null==n?void 0:n.duplex)&&(c.duplex=n.duplex),Object.assign(Object.assign({},c),i)))).then(e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(t=>t6(void 0,void 0,void 0,function*(){var r,s,i,a;let o=yield(r=void 0,s=void 0,i=void 0,a=function*(){return"undefined"==typeof Response?(yield e.A(11737)).Response:Response},new(i||(i=Promise))(function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(n,o)}l((a=a.apply(r,s||[])).next())}));t instanceof o&&!(null==n?void 0:n.noResolveJson)?t.json().then(e=>{let r=t.status||500,s=(null==e?void 0:e.statusCode)||r+"";l(new t2(t8(e),r,s))}).catch(e=>{l(new t4(t8(e),e))}):l(new t4(t8(t),t))}))})})}function t9(e,t,r,s){return t6(this,void 0,void 0,function*(){return t7(e,"GET",t,r,s)})}function re(e,t,r,s,n){return t6(this,void 0,void 0,function*(){return t7(e,"POST",t,s,n,r)})}function rt(e,t,r,s,n){return t6(this,void 0,void 0,function*(){return t7(e,"PUT",t,s,n,r)})}function rr(e,t,r,s,n){return t6(this,void 0,void 0,function*(){return t7(e,"DELETE",t,s,n,r)})}class rs{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){var e,t,r,s;return e=this,t=void 0,r=void 0,s=function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}},new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})}}Q=Symbol.toStringTag;let rn=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Q]="BlobDownloadBuilder",this.promise=null}asStream(){return new rs(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){var e,t,r,s;return e=this,t=void 0,r=void 0,s=function*(){try{let e=yield this.downloadFn();return{data:yield e.blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}},new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})}};var ri=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};let ra={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ro={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rl{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=t5(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return ri(this,void 0,void 0,function*(){try{let n,i=Object.assign(Object.assign({},ro),s),a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)}),o=i.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((n=new FormData).append("cacheControl",i.cacheControl),o&&n.append("metadata",this.encodeMetadata(o)),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((n=r).append("cacheControl",i.cacheControl),o&&n.append("metadata",this.encodeMetadata(o))):(n=r,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==s?void 0:s.headers)&&(a=Object.assign(Object.assign({},a),s.headers));let l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield("PUT"==e?rt:re)(this.fetch,`${this.url}/object/${c}`,n,Object.assign({headers:a},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{data:{path:l,id:d.Id,fullPath:d.Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}upload(e,t,r){return ri(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return ri(this,void 0,void 0,function*(){let n=this._removeEmptyFolders(e),i=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",t);try{let e,t=Object.assign({upsert:ro.upsert},s),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);let o=yield rt(this.fetch,a.toString(),e,{headers:i});return{data:{path:n,fullPath:o.Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return ri(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(s["x-upsert"]="true");let n=yield re(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(this.url+n.url),a=i.searchParams.get("token");if(!a)throw new t0("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}update(e,t,r){return ri(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return ri(this,void 0,void 0,function*(){try{return{data:yield re(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}copy(e,t,r){return ri(this,void 0,void 0,function*(){try{return{data:{path:(yield re(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return ri(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),n=yield re(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n={signedUrl:encodeURI(`${this.url}${n.signedURL}${i}`)},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return ri(this,void 0,void 0,function*(){try{let s=yield re(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:s.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}download(e,t){let r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=s?`?${s}`:"",i=this._getFinalPath(e);return new rn(()=>t9(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}info(e){return ri(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield t9(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:t3(e),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}exists(e){return ri(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,r,s){return t6(this,void 0,void 0,function*(){return t7(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e)&&e instanceof t4){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),s=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&s.push(n);let i=void 0!==(null==t?void 0:t.transform),a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&s.push(a);let o=s.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i?"render/image":"object"}/public/${r}${o}`)}}}remove(e){return ri(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}list(e,t,r){return ri(this,void 0,void 0,function*(){try{let s=Object.assign(Object.assign(Object.assign({},ra),t),{prefix:e||""});return{data:yield re(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}listV2(e,t){return ri(this,void 0,void 0,function*(){try{let r=Object.assign({},e);return{data:yield re(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==tZ.Buffer?tZ.Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let rc={"X-Client-Info":"storage-js/2.75.1"};var rd=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};class ru{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const n=new URL(e);(null==s?void 0:s.useNewHostname)&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rc),t),this.fetch=t5(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return rd(this,void 0,void 0,function*(){try{return{data:yield t9(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}getBucket(e){return rd(this,void 0,void 0,function*(){try{return{data:yield t9(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}createBucket(e){return rd(this,arguments,void 0,function*(e,t={public:!1}){try{return{data:yield re(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return rd(this,void 0,void 0,function*(){try{return{data:yield rt(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}emptyBucket(e){return rd(this,void 0,void 0,function*(){try{return{data:yield re(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}deleteBucket(e){return rd(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(t1(e))return{data:null,error:e};throw e}})}}class rh extends ru{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new rl(this.url,this.headers,e,this.fetch)}}let rp="";rp="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let rf={headers:{"X-Client-Info":`supabase-js-${rp}/2.75.1`}},rm={schema:"public"},rg={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},rb={};var rx=e.i(6085);let ry="2.75.1",rw={"X-Client-Info":`gotrue-js/${ry}`},rv="X-Supabase-Api-Version",rj={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class rN extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function rS(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class r_ extends rN{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class rC extends rN{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class rE extends rN{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class rR extends rE{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class rA extends rE{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rO extends rE{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class rT extends rE{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rI extends rE{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rM extends rE{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function rP(e){return rS(e)&&"AuthRetryableFetchError"===e.name}class rD extends rE{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class rL extends rE{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let r$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),rU=" 	\n\r=".split(""),rB=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<rU.length;t+=1)e[rU[t].charCodeAt(0)]=-2;for(let t=0;t<r$.length;t+=1)e[r$[t].charCodeAt(0)]=t;return e})();function rz(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)r(r$[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)r(r$[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function rq(e,t,r){let s=rB[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===s)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function rF(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return r(e);for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,s,r)};for(let t=0;t<e.length;t+=1)rq(e.charCodeAt(t),n,i);return t.join("")}function rH(e){let t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)rq(e.charCodeAt(t),r,s);return new Uint8Array(t)}function rW(e){let t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};return e.forEach(e=>rz(e,r,s)),rz(null,r,s),t.join("")}let rG=()=>"undefined"!=typeof window&&"undefined"!=typeof document,rV={tested:!1,writable:!1},rK=()=>{if(!rG())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(rV.tested)return rV.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),rV.tested=!0,rV.writable=!0}catch(e){rV.tested=!0,rV.writable=!1}return rV.writable},rJ=t=>{let r;return r=t||("undefined"==typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)},rY=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},rX=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},rQ=async(e,t)=>{await e.removeItem(t)};class rZ{constructor(){this.promise=new rZ.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function r0(e){let t=e.split(".");if(3!==t.length)throw new rL("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!rk.test(t[e]))throw new rL("JWT not in base64url format");return{header:JSON.parse(rF(t[0])),payload:JSON.parse(rF(t[1])),signature:rH(t[2]),raw:{header:t[0],payload:t[1]}}}async function r1(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function r2(e){return("0"+e.toString(16)).substr(-2)}async function r4(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function r5(e){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e):btoa(await r4(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function r3(e,t,r=!1){let s=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,r2).join("")}(),n=s;r&&(n+="/PASSWORD_RECOVERY"),await rY(e,`${t}-code-verifier`,n);let i=await r5(s),a=s===i?"plain":"s256";return[i,a]}rZ.promiseConstructor=Promise;let r6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,r8=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function r7(e){if(!r8.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function r9(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function se(e){return JSON.parse(JSON.stringify(e))}var st=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)0>t.indexOf(s[n])&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r};let sr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ss=[502,503,504];async function sn(e){var t;let r,s;if(!("object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json))throw new rM(sr(e),0);if(ss.includes(e.status))throw new rM(sr(e),e.status);try{r=await e.json()}catch(e){throw new rC(sr(e),e)}let n=function(e){let t=e.headers.get(rv);if(!t||!t.match(r6))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(n&&n.getTime()>=rj["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?s=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(s=r.error_code),s){if("weak_password"===s)throw new rD(sr(r),e.status,(null==(t=r.weak_password)?void 0:t.reasons)||[]);else if("session_not_found"===s)throw new rR}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new rD(sr(r),e.status,r.weak_password.reasons);throw new r_(sr(r),e.status||500,s)}async function si(e,t,r,s){var n;let i=Object.assign({},null==s?void 0:s.headers);i[rv]||(i[rv]=rj["2024-01-01"].name),(null==s?void 0:s.jwt)&&(i.Authorization=`Bearer ${s.jwt}`);let a=null!=(n=null==s?void 0:s.query)?n:{};(null==s?void 0:s.redirectTo)&&(a.redirect_to=s.redirectTo);let o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await sa(e,t,r+o,{headers:i,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function sa(e,t,r,s,n,i){let a,o,l=(o={method:t,headers:(null==s?void 0:s.headers)||{}},"GET"===t?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==s?void 0:s.headers),o.body=JSON.stringify(i),Object.assign(Object.assign({},o),n)));try{a=await e(r,Object.assign({},l))}catch(e){throw console.error(e),new rM(sr(e),0)}if(a.ok||await sn(a),null==s?void 0:s.noResolveJson)return a;try{return await a.json()}catch(e){await sn(e)}}function so(e){var t,r,s;let n=null;(s=e).access_token&&s.refresh_token&&s.expires_in&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:n,user:null!=(t=e.user)?t:e},error:null}}function sl(e){let t=so(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function sc(e){var t;return{data:{user:null!=(t=e.user)?t:e},error:null}}function sd(e){return{data:e,error:null}}function su(e){let{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},user:Object.assign({},st(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function sh(e){return e}let sp=["global","local","others"];var sf=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)0>t.indexOf(s[n])&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r};class sm{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=rJ(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=sp[0]){if(0>sp.indexOf(t))throw Error(`@supabase/auth-js: Parameter scope must be one of ${sp.join(", ")}`);try{return await si(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(rS(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await si(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:sc})}catch(e){if(rS(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=sf(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),await si(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:su,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(rS(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await si(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:sc})}catch(e){if(rS(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,s,n,i,a,o;try{let l={nextPage:null,lastPage:0,total:0},c=await si(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(n=null==(s=null==e?void 0:e.perPage)?void 0:s.toString())?n:""},xform:sh});if(c.error)throw c.error;let d=await c.json(),u=null!=(i=c.headers.get("x-total-count"))?i:0,h=null!=(o=null==(a=c.headers.get("link"))?void 0:a.split(","))?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(e){if(rS(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){r7(e);try{return await si(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:sc})}catch(e){if(rS(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){r7(e);try{return await si(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:sc})}catch(e){if(rS(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){r7(e);try{return await si(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:sc})}catch(e){if(rS(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){r7(e.userId);try{let{data:t,error:r}=await si(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(rS(e))return{data:null,error:e};throw e}}async _deleteFactor(e){r7(e.userId),r7(e.id);try{return{data:await si(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(rS(e))return{data:null,error:e};throw e}}async _listOAuthClients(e){var t,r,s,n,i,a,o;try{let l={nextPage:null,lastPage:0,total:0},c=await si(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(n=null==(s=null==e?void 0:e.perPage)?void 0:s.toString())?n:""},xform:sh});if(c.error)throw c.error;let d=await c.json(),u=null!=(i=c.headers.get("x-total-count"))?i:0,h=null!=(o=null==(a=c.headers.get("link"))?void 0:a.split(","))?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(e){if(rS(e))return{data:{clients:[]},error:e};throw e}}async _createOAuthClient(e){try{return await si(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(rS(e))return{data:null,error:e};throw e}}async _getOAuthClient(e){try{return await si(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(rS(e))return{data:null,error:e};throw e}}async _deleteOAuthClient(e){try{return await si(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(rS(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(e){try{return await si(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(rS(e))return{data:null,error:e};throw e}}}function sg(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let sb={debug:!!(globalThis&&rK()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class sx extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class sy extends sx{}async function sw(e,t,r){sb.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),sb.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async s=>{if(s){sb.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{sb.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}if(0===t)throw sb.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new sy(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(sb.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}))}function sv(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}class sj extends Error{constructor({message:e,code:t,cause:r,name:s}){var n;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=null!=(n=null!=s?s:r instanceof Error?r.name:void 0)?n:"Unknown Error",this.code=t}}class sk extends sj{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}var sN=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)0>t.indexOf(s[n])&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r};let sS=new class{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function s_(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function sC(){var e,t;return!!(rG()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null==(e=null==navigator?void 0:navigator.credentials)?void 0:e.create)&&"function"==typeof(null==(t=null==navigator?void 0:navigator.credentials)?void 0:t.get))}async function sE(e){try{let t=await navigator.credentials.create(e);if(!t)return{data:null,error:new sk("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new sk("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){var r,s,n;let{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new sj({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if((null==(r=i.authenticatorSelection)?void 0:r.requireResidentKey)===!0)return new sj({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});else if("conditional"===t.mediation&&(null==(s=i.authenticatorSelection)?void 0:s.userVerification)==="required")return new sj({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});else if((null==(n=i.authenticatorSelection)?void 0:n.userVerification)==="required")return new sj({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new sj({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new sj({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new sj(0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!s_(t))return new sj({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rp.id!==t)return new sj({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new sj({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new sj({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new sj({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}async function sR(e){try{let t=await navigator.credentials.get(e);if(!t)return{data:null,error:new sk("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new sk("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new sj({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new sj({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!s_(t))return new sj({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new sj({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new sj({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new sj({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}let sA={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},sO={userVerification:"preferred",hints:["security-key"]};function sT(...e){let t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),r=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),s={};for(let n of e)if(n)for(let e in n){let i=n[e];if(void 0!==i)if(Array.isArray(i))s[e]=i;else if(r(i))s[e]=i;else if(t(i)){let r=s[e];t(r)?s[e]=sT(r,i):s[e]=sT(i)}else s[e]=i}return s}class sI{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},n){try{var i,a,o,l;let{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:d};let u=null!=s?s:sS.createNewAbortSignal();if("create"===c.webauthn.type){let{user:e}=c.webauthn.credential_options.publicKey;e.name||(e.name=`${e.id}:${r}`),e.displayName||(e.displayName=e.name)}switch(c.webauthn.type){case"create":{let t=(i=c.webauthn.credential_options.publicKey,a=null==n?void 0:n.create,sT(sA,i,a||{})),{data:r,error:s}=await sE({publicKey:t,signal:u});if(r)return{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:r}},error:null};return{data:null,error:s}}case"request":{let t=(o=c.webauthn.credential_options.publicKey,l=null==n?void 0:n.request,sT(sO,o,l||{})),{data:r,error:s}=await sR(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:t,signal:u}));if(r)return{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:r}},error:null};return{data:null,error:s}}}}catch(e){if(rS(e))return{data:null,error:e};return{data:null,error:new rC("Unexpected error in challenge",e)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:r="undefined"!=typeof window?[window.location.origin]:void 0,signal:s}},n){if(!t)return{data:null,error:new rN("rpId is required for WebAuthn authentication")};try{if(!sC())return{data:null,error:new rC("Browser does not support WebAuthn",null)};let{data:i,error:a}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:n});if(!i)return{data:null,error:a};let{webauthn:o}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:o.type,rpId:t,rpOrigins:r,credential_response:o.credential_response}})}catch(e){if(rS(e))return{data:null,error:e};return{data:null,error:new rC("Unexpected error in authenticate",e)}}}async _register({friendlyName:e,rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:r="undefined"!=typeof window?[window.location.origin]:void 0,signal:s},n){if(!t)return{data:null,error:new rN("rpId is required for WebAuthn registration")};try{if(!sC())return{data:null,error:new rC("Browser does not support WebAuthn",null)};let{data:i,error:a}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(t=>{var r;return null==(r=t.data)?void 0:r.all.find(t=>"webauthn"===t.factor_type&&t.friendly_name===e&&"unverified"!==t.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null==e?void 0:e.id}):void 0),{data:null,error:a};let{data:o,error:l}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:n});if(!o)return{data:null,error:l};return this._verify({factorId:i.id,challengeId:o.challengeId,webauthn:{rpId:t,rpOrigins:r,type:o.webauthn.type,credential_response:o.webauthn.credential_response}})}catch(e){if(rS(e))return{data:null,error:e};return{data:null,error:new rC("Unexpected error in register",e)}}}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}let sM={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:rw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function sP(e,t,r){return await r()}let sD={};class sL{get jwks(){var e,t;return null!=(t=null==(e=sD[this.storageKey])?void 0:e.jwks)?t:{keys:[]}}set jwks(e){sD[this.storageKey]=Object.assign(Object.assign({},sD[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!=(t=null==(e=sD[this.storageKey])?void 0:e.cachedAt)?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){sD[this.storageKey]=Object.assign(Object.assign({},sD[this.storageKey]),{cachedAt:e})}constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=sL.nextInstanceID,sL.nextInstanceID+=1,this.instanceID>0&&rG()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},sM),e);if(this.logDebugMessages=!!s.debug,"function"==typeof s.debug&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new sm({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=rJ(s.fetch),this.lock=s.lock||sP,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:rG()&&(null==(t=null==globalThis?void 0:globalThis.navigator)?void 0:t.locks)?this.lock=sw:this.lock=sP,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new sI(this)},this.persistSession?(s.storage?this.storage=s.storage:rK()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=sg(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=sg(this.memoryStorage)),rG()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null==(r=this.broadcastChannel)||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ry}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),rG()&&this.detectSessionInUrl&&"none"!==r){let{data:s,error:n}=await this._getSessionFromURL(t,r);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),rS(n)&&"AuthImplicitGrantRedirectError"===n.name){let t=null==(e=n.details)?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:n}}return await this._removeSession(),{error:n}}let{session:i,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(rS(e))return{error:e};return{error:new rC("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{let{data:n,error:i}=await si(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(r=null==(t=null==e?void 0:e.options)?void 0:t.data)?r:{},gotrue_meta_security:{captcha_token:null==(s=null==e?void 0:e.options)?void 0:s.captchaToken}},xform:so});if(i||!n)return{data:{user:null,session:null},error:i};let a=n.session,o=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:o,session:a},error:null}}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,s;try{let n;if("email"in e){let{email:r,password:s,options:i}=e,a=null,o=null;"pkce"===this.flowType&&([a,o]=await r3(this.storage,this.storageKey)),n=await si(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:s,data:null!=(t=null==i?void 0:i.data)?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:o},xform:so})}else if("phone"in e){let{phone:t,password:i,options:a}=e;n=await si(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!=(r=null==a?void 0:a.data)?r:{},channel:null!=(s=null==a?void 0:a.channel)?s:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:so})}else throw new rO("You must provide either an email or phone number and a password");let{data:i,error:a}=n;if(a||!i)return{data:{user:null,session:null},error:a};let o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:s,options:n}=e;t=await si(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:sl})}else if("phone"in e){let{phone:r,password:s,options:n}=e;t=await si(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:sl})}else throw new rO("You must provide either an email or phone number and a password");let{data:r,error:s}=t;if(s)return{data:{user:null,session:null},error:s};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new rA};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s}}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,s,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null==(t=e.options)?void 0:t.redirectTo,scopes:null==(r=e.options)?void 0:r.scopes,queryParams:null==(s=e.options)?void 0:s.queryParams,skipBrowserRedirect:null==(n=e.options)?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,n,i,a,o,l,c,d,u,h;let p,f;if("message"in e)p=e.message,f=e.signature;else{let d,{chain:u,wallet:m,statement:g,options:b}=e;if(rG())if("object"==typeof m)d=m;else{let e=window;if("ethereum"in e&&"object"==typeof e.ethereum&&"request"in e.ethereum&&"function"==typeof e.ethereum.request)d=e.ethereum;else throw Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof m||!(null==b?void 0:b.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");d=m}let x=new URL(null!=(t=null==b?void 0:b.url)?t:window.location.href),y=await d.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!y||0===y.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let w=sv(y[0]),v=null==(r=null==b?void 0:b.signInWithEthereum)?void 0:r.chainId;v||(v=parseInt(await d.request({method:"eth_chainId"}),16)),p=function(e){var t;let{chainId:r,domain:s,expirationTime:n,issuedAt:i=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:d,uri:u,version:h}=e;if(!Number.isInteger(r))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!u)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(null==(t=e.statement)?void 0:t.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);let p=sv(e.address),f=d?`${d}://${s}`:s,m=e.statement?`${e.statement}
`:"",g=`${f} wants you to sign in with your Ethereum account:
${p}

${m}`,b=`URI: ${u}
Version: ${h}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(n&&(b+=`
Expiration Time: ${n.toISOString()}`),o&&(b+=`
Not Before: ${o.toISOString()}`),l&&(b+=`
Request ID: ${l}`),c){let e="\nResources:";for(let t of c){if(!t||"string"!=typeof t)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`
- ${t}`}b+=e}return`${g}
${b}`}({domain:x.host,address:w,statement:g,uri:x.href,version:"1",chainId:v,nonce:null==(s=null==b?void 0:b.signInWithEthereum)?void 0:s.nonce,issuedAt:null!=(i=null==(n=null==b?void 0:b.signInWithEthereum)?void 0:n.issuedAt)?i:new Date,expirationTime:null==(a=null==b?void 0:b.signInWithEthereum)?void 0:a.expirationTime,notBefore:null==(o=null==b?void 0:b.signInWithEthereum)?void 0:o.notBefore,requestId:null==(l=null==b?void 0:b.signInWithEthereum)?void 0:l.requestId,resources:null==(c=null==b?void 0:b.signInWithEthereum)?void 0:c.resources}),f=await d.request({method:"personal_sign",params:[(h=p,"0x"+Array.from(new TextEncoder().encode(h),e=>e.toString(16).padStart(2,"0")).join("")),w]})}try{let{data:t,error:r}=await si(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:f},(null==(d=e.options)?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null==(u=e.options)?void 0:u.captchaToken}}:null),xform:so});if(r)throw r;if(!t||!t.session||!t.user)return{data:{user:null,session:null},error:new rA};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSolana(e){var t,r,s,n,i,a,o,l,c,d,u,h;let p,f;if("message"in e)p=e.message,f=e.signature;else{let u,{chain:h,wallet:m,statement:g,options:b}=e;if(rG())if("object"==typeof m)u=m;else{let e=window;if("solana"in e&&"object"==typeof e.solana&&("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))u=e.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof m||!(null==b?void 0:b.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");u=m}let x=new URL(null!=(t=null==b?void 0:b.url)?t:window.location.href);if("signIn"in u&&u.signIn){let e,t=await u.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==b?void 0:b.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),g?{statement:g}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)p="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),f=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in u)||"function"!=typeof u.signMessage||!("publicKey"in u)||"object"!=typeof u||!u.publicKey||!("toBase58"in u.publicKey)||"function"!=typeof u.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${x.host} wants you to sign in with your Solana account:`,u.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${x.href}`,`Issued At: ${null!=(s=null==(r=null==b?void 0:b.signInWithSolana)?void 0:r.issuedAt)?s:new Date().toISOString()}`,...(null==(n=null==b?void 0:b.signInWithSolana)?void 0:n.notBefore)?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...(null==(i=null==b?void 0:b.signInWithSolana)?void 0:i.expirationTime)?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...(null==(a=null==b?void 0:b.signInWithSolana)?void 0:a.chainId)?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...(null==(o=null==b?void 0:b.signInWithSolana)?void 0:o.nonce)?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...(null==(l=null==b?void 0:b.signInWithSolana)?void 0:l.requestId)?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...(null==(d=null==(c=null==b?void 0:b.signInWithSolana)?void 0:c.resources)?void 0:d.length)?["Resources",...b.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");let e=await u.signMessage(new TextEncoder().encode(p),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=e}}try{let{data:t,error:r}=await si(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:rW(f)},(null==(u=e.options)?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null==(h=e.options)?void 0:h.captchaToken}}:null),xform:so});if(r)throw r;if(!t||!t.session||!t.user)return{data:{user:null,session:null},error:new rA};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async _exchangeCodeForSession(e){let t=await rX(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(null!=t?t:"").split("/");try{let{data:t,error:n}=await si(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:so});if(await rQ(this.storage,`${this.storageKey}-code-verifier`),n)throw n;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new rA};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=s?s:null}),error:n}}catch(e){if(rS(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:s,access_token:n,nonce:i}=e,{data:a,error:o}=await si(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:n,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:so});if(o)return{data:{user:null,session:null},error:o};if(!a||!a.session||!a.user)return{data:{user:null,session:null},error:new rA};return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:o}}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,s,n,i;try{if("email"in e){let{email:s,options:n}=e,i=null,a=null;"pkce"===this.flowType&&([i,a]=await r3(this.storage,this.storageKey));let{error:o}=await si(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!=(t=null==n?void 0:n.data)?t:{},create_user:null==(r=null==n?void 0:n.shouldCreateUser)||r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:a},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:r}=e,{data:a,error:o}=await si(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!=(s=null==r?void 0:r.data)?s:{},create_user:null==(n=null==r?void 0:r.shouldCreateUser)||n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!=(i=null==r?void 0:r.channel)?i:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new rO("You must provide either an email or phone number.")}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let s,n;"options"in e&&(s=null==(t=e.options)?void 0:t.redirectTo,n=null==(r=e.options)?void 0:r.captchaToken);let{data:i,error:a}=await si(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:s,xform:so});if(a)throw a;if(!i)throw Error("An error occurred on token verification.");let o=i.session,l=i.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,s;try{let n=null,i=null;return"pkce"===this.flowType&&([n,i]=await r3(this.storage,this.storageKey)),await si(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!=(r=null==(t=e.options)?void 0:t.redirectTo)?r:void 0}),(null==(s=null==e?void 0:e.options)?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:i}),headers:this.headers,xform:sd})}catch(e){if(rS(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new rR;let{error:s}=await si(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:s,options:n}=e,{error:i}=await si(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){let{phone:r,type:s,options:n}=e,{data:i,error:a}=await si(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:a}}throw new rO("You must provide either an email or phone number and a type")}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await rX(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){let t=await rX(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=r9()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,s)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,s))})}return{data:{session:e},error:null}}let{data:s,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{session:null},error:n};return{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await si(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:sc});return await this._useSession(async e=>{var t,r,s;let{data:n,error:i}=e;if(i)throw i;return(null==(t=n.session)?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await si(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(s=null==(r=n.session)?void 0:r.access_token)?s:void 0,xform:sc}):{data:{user:null},error:new rR}})}catch(e){if(rS(e))return rS(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await rQ(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:s,error:n}=r;if(n)throw n;if(!s.session)throw new rR;let i=s.session,a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await r3(this.storage,this.storageKey));let{data:l,error:c}=await si(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:i.access_token,xform:sc});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(e){if(rS(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new rR;let t=Date.now()/1e3,r=t,s=!0,n=null,{payload:i}=r0(e.access_token);if(i.exp&&(s=(r=i.exp)<=t),s){let{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};n=t}else{let{data:s,error:i}=await this._getUser(e.access_token);if(i)throw i;n={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(e){if(rS(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:s,error:n}=t;if(n)throw n;e=null!=(r=s.session)?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new rR;let{data:s,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!rG())throw new rT("No browser detected.");if(e.error||e.error_description||e.error_code)throw new rT(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new rI("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new rT("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new rI("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:s,access_token:n,refresh_token:i,expires_in:a,expires_at:o,token_type:l}=e;if(!n||!a||!i||!l)throw new rT("No session defined in URL");let c=Math.round(Date.now()/1e3),d=parseInt(a),u=c+d;o&&(u=parseInt(o));let h=u-c;1e3*h<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);let p=u-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,u,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,u,c);let{data:f,error:m}=await this._getUser(n);if(m)throw m;let g={provider_token:r,provider_refresh_token:s,access_token:n,expires_in:d,expires_at:u,refresh_token:i,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(e){if(rS(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await rX(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:s,error:n}=t;if(n)return{error:n};let i=null==(r=s.session)?void 0:r.access_token;if(i){let{error:t}=await this.admin.signOut(i,e);if(t&&!(rS(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await rQ(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{let{data:{session:s},error:n}=t;if(n)throw n;await (null==(r=this.stateChangeEmitters.get(e))?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(t){await (null==(s=this.stateChangeEmitters.get(e))?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;"pkce"===this.flowType&&([r,s]=await r3(this.storage,this.storageKey,!0));try{return await si(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(rS(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!=(e=t.user.identities)?e:[]},error:null}}catch(e){if(rS(e))return{data:null,error:e};throw e}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{let{data:r,error:s}=await this._useSession(async t=>{var r,s,n,i,a;let{data:o,error:l}=t;if(l)throw l;let c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null==(r=e.options)?void 0:r.redirectTo,scopes:null==(s=e.options)?void 0:s.scopes,queryParams:null==(n=e.options)?void 0:n.queryParams,skipBrowserRedirect:!0});return await si(this.fetch,"GET",c,{headers:this.headers,jwt:null!=(a=null==(i=o.session)?void 0:i.access_token)?a:void 0})});if(s)throw s;return!rG()||(null==(t=e.options)?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(rS(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{let{error:s,data:{session:n}}=t;if(s)throw s;let{options:i,provider:a,token:o,access_token:l,nonce:c}=e,{data:d,error:u}=await si(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!=(r=null==n?void 0:n.access_token)?r:void 0,body:{provider:a,id_token:o,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:so});if(u)return{data:{user:null,session:null},error:u};if(!d||!d.session||!d.user)return{data:{user:null,session:null},error:new rA};return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),{data:d,error:u}}catch(e){if(rS(e))return{data:{user:null,session:null},error:e};throw e}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;let{data:n,error:i}=t;if(i)throw i;return await si(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!=(s=null==(r=n.session)?void 0:r.access_token)?s:void 0})})}catch(e){if(rS(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,s;let n=Date.now();return await (r=async r=>(r>0&&await r1(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await si(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:so})),s=(e,t)=>{let r=200*Math.pow(2,e);return t&&rP(t)&&Date.now()+r-n<3e4},new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{let t=await r(n);if(!s(n,null,t))return void e(t)}catch(e){if(!s(n,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),rS(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),rG()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let s=await rX(this.storage,this.storageKey);if(s&&this.userStorage){let t=await rX(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:s.user},await rY(this.userStorage,this.storageKey+"-user",t)),s.user=null!=(e=null==t?void 0:t.user)?e:r9()}else if(s&&!s.user&&!s.user){let e=await rX(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(s.user=e.user,await rQ(this.storage,this.storageKey+"-user"),await rY(this.storage,this.storageKey,s)):s.user=r9()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),null!==s&&await this._removeSession();return}let n=(null!=(t=s.expires_at)?t:1/0)*1e3-Date.now()<9e4;if(this._debug(r,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&s.refresh_token){let{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),rP(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(s.user&&!0===s.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(s.access_token);!t&&(null==e?void 0:e.user)?(s.user=e.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(r,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(e){this._debug(r,"error",e),console.error(e);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new rR;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new rZ;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new rR;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let s={data:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(e){if(this._debug(s,"error",e),rS(e)){let r={data:null,error:e};return rP(e)||await this._removeSession(),null==(t=this.refreshingDeferred)||t.resolve(r),r}throw null==(r=this.refreshingDeferred)||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){let s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let s=[],n=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){s.push(e)}});if(await Promise.all(n),s.length>0){for(let e=0;e<s.length;e+=1)console.error(s[e]);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;let t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await rY(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let s=se(e);await rY(this.storage,this.storageKey,s)}else{let e=se(t);await rY(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await rQ(this.storage,this.storageKey),await rQ(this.storage,this.storageKey+"-code-verifier"),await rQ(this.storage,this.storageKey+"-user"),this.userStorage&&await rQ(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&rG()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let s=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof sx)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!rG()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"!==document.visibilityState?this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"):await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let s=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await r3(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});s.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);s.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:s,error:n}=t;return n?{data:null,error:n}:await si(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null==(r=null==s?void 0:s.session)?void 0:r.access_token})})}catch(e){if(rS(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;let{data:n,error:i}=t;if(i)return{data:null,error:i};let a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await si(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&"totp"===o.type&&(null==(s=null==o?void 0:o.totp)?void 0:s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(e){if(rS(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r,s,n;let{data:i,error:a}=t;if(a)return{data:null,error:a};let o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?(s=e.webauthn.credential_response,"toJSON"in s&&"function"==typeof s.toJSON?s.toJSON():{id:s.id,rawId:s.id,response:{attestationObject:rW(new Uint8Array(s.response.attestationObject)),clientDataJSON:rW(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:null!=(n=s.authenticatorAttachment)?n:void 0}):function(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();let r=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:rW(new Uint8Array(s.authenticatorData)),clientDataJSON:rW(new Uint8Array(s.clientDataJSON)),signature:rW(new Uint8Array(s.signature)),userHandle:s.userHandle?rW(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:null!=(t=e.authenticatorAttachment)?t:void 0}}(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await si(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:null==(r=null==i?void 0:i.session)?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(e){if(rS(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:s,error:n}=t;if(n)return{data:null,error:n};let i=await si(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null==(r=null==s?void 0:s.session)?void 0:r.access_token});if(i.error)return i;let{data:a}=i;if("webauthn"!==a.type)return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);let{challenge:t,user:r,excludeCredentials:s}=e,n=sN(e,["challenge","user","excludeCredentials"]),i=rH(t).buffer,a=Object.assign(Object.assign({},r),{id:rH(r.id).buffer}),o=Object.assign(Object.assign({},n),{challenge:i,user:a});if(s&&s.length>0){o.excludeCredentials=Array(s.length);for(let e=0;e<s.length;e++){let t=s[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:rH(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);let{challenge:t,allowCredentials:r}=e,s=sN(e,["challenge","allowCredentials"]),n=rH(t).buffer,i=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){i.allowCredentials=Array(r.length);for(let e=0;e<r.length;e++){let t=r[e];i.allowCredentials[e]=Object.assign(Object.assign({},t),{id:rH(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return i}(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(rS(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;let{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};let s={all:[],phone:[],totp:[],webauthn:[]};for(let r of null!=(e=null==t?void 0:t.factors)?e:[])s.all.push(r),"verified"===r.status&&s[r.factor_type].push(r);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:s},error:n}=e;if(n)return{data:null,error:n};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:i}=r0(s.access_token),a=null;i.aal&&(a=i.aal);let o=a;return(null!=(r=null==(t=s.user.factors)?void 0:t.filter(e=>"verified"===e.status))?r:[]).length>0&&(o="aal2"),{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:i.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;let s=Date.now();if((r=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>s)return r;let{data:n,error:i}=await si(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return n.keys&&0!==n.keys.length&&(this.jwks=n,this.jwks_cached_at=s,r=n.keys.find(t=>t.kid===e))?r:null}async getClaims(e,t={}){try{var r;let s,n=e;if(!n){let{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};n=e.session.access_token}let{header:i,payload:a,signature:o,raw:{header:l,payload:c}}=r0(n);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(a.exp);let d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!d){let{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:a,header:i,signature:o},error:null}}let u=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(i.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,(r=`${l}.${c}`,s=[],!function(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){let t=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(s,t)}}(r,e=>s.push(e)),new Uint8Array(s))))throw new rL("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(e){if(rS(e))return{data:null,error:e};throw e}}}sL.nextInstanceID=0;let s$=sL;class sU extends s${constructor(e){super(e)}}(function(){if("undefined"!=typeof window||void 0===tv.default)return!1;let e=tv.default.version;if(null==e)return!1;let t=e.match(/^v(\d+)\./);return!!t&&18>=parseInt(t[1],10)})()&&console.warn(`  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217`);let sB="opmvuhlheenygwbqwljk",sz="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9wbXZ1aGxoZWVueWd3YnF3bGprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2OTkxMjMsImV4cCI6MjA3NjI3NTEyM30.teI8M7lSDyunxTtcltbw8duAGnjJ8P8hgZXbRlDFYb4",sq=new class e{constructor(e,t,r){var s,n,i;this.supabaseUrl=e,this.supabaseKey=t;const a=function(e){let t=null==e?void 0:e.trim();if(!t)throw Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(t.endsWith("/")?t:t+"/")}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(e);if(!t)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,l=function(e,t){var r,s;let{db:n,auth:i,realtime:a,global:o}=e,{db:l,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},d),a),storage:{},global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},null!=(r=null==u?void 0:u.headers)?r:{}),null!=(s=null==o?void 0:o.headers)?s:{})}),accessToken:()=>{var e,t,r,s;return e=this,t=void 0,s=function*(){return""},new(r=void 0,r=Promise)(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})}};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=r?r:{},{db:rm,realtime:rb,auth:Object.assign(Object.assign({},rg),{storageKey:o}),global:rf});this.storageKey=null!=(s=l.auth.storageKey)?s:"",this.headers=null!=(n=l.global.headers)?n:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(i=l.auth)?i:{},this.headers,l.global.fetch),this.fetch=((e,t,r)=>{let s,n=(s=r||("undefined"==typeof fetch?rx.default:fetch),(...e)=>s(...e)),i="undefined"==typeof Headers?rx.Headers:Headers;return(r,s)=>{var a,o,l,c;return a=void 0,o=void 0,l=void 0,c=function*(){var a;let o=null!=(a=yield t())?a:e,l=new i(null==s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),n(r,Object.assign(Object.assign({},s),{headers:l}))},new(l||(l=Promise))(function(e,t){function r(e){try{n(c.next(e))}catch(e){t(e)}}function s(e){try{n(c.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):((n=t.value)instanceof l?n:new l(function(e){e(n)})).then(r,s)}n((c=c.apply(a,o||[])).next())})}})(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new tC(new URL("rest/v1",a).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new rh(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new t_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,s;return e=this,t=void 0,r=void 0,s=function*(){var e,t;if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return null!=(t=null==(e=r.session)?void 0:e.access_token)?t:this.supabaseKey},new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:i,flowType:a,lock:o,debug:l},c,d){let u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new sU({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:n,flowType:a,lock:o,debug:l,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new tQ(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}("https://opmvuhlheenygwbqwljk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9wbXZ1aGxoZWVueWd3YnF3bGprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2OTkxMjMsImV4cCI6MjA3NjI3NTEyM30.teI8M7lSDyunxTtcltbw8duAGnjJ8P8hgZXbRlDFYb4",void 0);function sF({onLogin:e,onBack:t,onSignup:r}){let s=(0,ei.useRouter)(),[n,i]=(0,es.useState)(""),[a,o]=(0,es.useState)(""),[l,c]=(0,es.useState)(!1),[d,u]=(0,es.useState)(null);async function h(t){if(t.preventDefault(),u(null),!n||!a)return void u("Please fill in both email and password.");c(!0);try{if(e)await e(n,a);else{let{data:e,error:t}=await sq.auth.signInWithPassword({email:n,password:a});if(t)return void u(t.message);if(!e.session)return void u("Login failed. Please try again.");s.push("/")}}catch(e){console.error(e),u("Something went wrong while logging in. Please try again.")}finally{c(!1)}}return(0,er.jsx)("main",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-50",children:(0,er.jsxs)("div",{className:"w-full max-w-md rounded-2xl border border-slate-800 bg-slate-900/70 p-8 shadow-xl",children:[(0,er.jsx)("h1",{className:"text-2xl font-semibold mb-2",children:"Sign in to MoveYSplash"}),(0,er.jsx)("p",{className:"text-sm text-slate-400 mb-6",children:"Enter your credentials to get back into your workspace."}),(0,er.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,er.jsxs)("label",{className:"block text-sm",children:[(0,er.jsx)("span",{className:"mb-1 block text-slate-200",children:"Email"}),(0,er.jsx)("input",{type:"email",autoComplete:"email",className:"w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm outline-none focus:border-indigo-500",value:n,onChange:e=>i(e.target.value)})]}),(0,er.jsxs)("label",{className:"block text-sm",children:[(0,er.jsx)("span",{className:"mb-1 block text-slate-200",children:"Password"}),(0,er.jsx)("input",{type:"password",autoComplete:"current-password",className:"w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm outline-none focus:border-indigo-500",value:a,onChange:e=>o(e.target.value)})]}),d&&(0,er.jsx)("p",{className:"text-sm text-red-400 border border-red-500/30 rounded-md px-3 py-2 bg-red-950/30",children:d}),(0,er.jsx)("button",{type:"submit",disabled:l,className:"w-full rounded-lg bg-indigo-500 py-2 text-sm font-medium hover:bg-indigo-400 disabled:opacity-60",children:l?"Signing in":"Sign in"})]}),(0,er.jsxs)("div",{className:"mt-6 flex items-center justify-between text-sm text-slate-400",children:[(0,er.jsx)("button",{type:"button",onClick:t,className:"rounded-lg border border-slate-800 px-3 py-2 text-slate-200 hover:border-slate-700",children:"Back"}),(0,er.jsx)("button",{type:"button",onClick:r,className:"text-indigo-300 hover:text-indigo-200 underline-offset-4 hover:underline",children:"Create account"})]})]})})}function sH({onSignup:e,onBack:t,onLogin:r}){let s=(0,ei.useRouter)(),[n,i]=(0,es.useState)(""),[a,o]=(0,es.useState)(""),[l,c]=(0,es.useState)(""),[d,u]=(0,es.useState)(""),[h,p]=(0,es.useState)(!1),[f,m]=(0,es.useState)(null),[g,b]=(0,es.useState)(null);async function x(t){if(t.preventDefault(),m(null),b(null),!n||!l||!d||!a)return void m("Please fill in your name, birthdate, email, and password.");if(d.length<8)return void m("Password should be at least 8 characters long.");p(!0);try{if(e)await e(n,l,d,a);else{let{data:e,error:t}=await sq.auth.signUp({email:l,password:d,options:{data:{name:n,birthdate:a},emailRedirectTo:`${window.location.origin}/`}});if(t)return void m(t.message);if(!e.user)return void m("Signup failed. Please try again.");b("Account created. Check your email to confirm your address, then sign in."),setTimeout(()=>s.push("/login"),2500)}}catch(e){console.error(e),m("Something went wrong while signing up. Please try again.")}finally{p(!1)}}return(0,er.jsx)("main",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-50",children:(0,er.jsxs)("div",{className:"w-full max-w-md rounded-2xl border border-slate-800 bg-slate-900/70 p-8 shadow-xl",children:[(0,er.jsx)("h1",{className:"text-2xl font-semibold mb-2",children:"Create your account"}),(0,er.jsx)("p",{className:"text-sm text-slate-400 mb-6",children:"We'll send a confirmation link before you can log in."}),(0,er.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,er.jsxs)("label",{className:"block text-sm",children:[(0,er.jsx)("span",{className:"mb-1 block text-slate-200",children:"Full name"}),(0,er.jsx)("input",{type:"text",autoComplete:"name",className:"w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm outline-none focus:border-indigo-500",value:n,onChange:e=>i(e.target.value)})]}),(0,er.jsxs)("label",{className:"block text-sm",children:[(0,er.jsx)("span",{className:"mb-1 block text-slate-200",children:"Birthdate"}),(0,er.jsx)("input",{type:"date",autoComplete:"bday",className:"w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm outline-none focus:border-indigo-500",value:a,onChange:e=>o(e.target.value)})]}),(0,er.jsxs)("label",{className:"block text-sm",children:[(0,er.jsx)("span",{className:"mb-1 block text-slate-200",children:"Email"}),(0,er.jsx)("input",{type:"email",autoComplete:"email",className:"w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm outline-none focus:border-indigo-500",value:l,onChange:e=>c(e.target.value)})]}),(0,er.jsxs)("label",{className:"block text-sm",children:[(0,er.jsx)("span",{className:"mb-1 block text-slate-200",children:"Password"}),(0,er.jsx)("input",{type:"password",autoComplete:"new-password",className:"w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm outline-none focus:border-indigo-500",value:d,onChange:e=>u(e.target.value)})]}),f&&(0,er.jsx)("p",{className:"text-sm text-red-400 border border-red-500/30 rounded-md px-3 py-2 bg-red-950/30",children:f}),g&&(0,er.jsx)("p",{className:"text-sm text-emerald-400 border border-emerald-500/30 rounded-md px-3 py-2 bg-emerald-950/30",children:g}),(0,er.jsx)("button",{type:"submit",disabled:h,className:"w-full rounded-lg bg-indigo-500 py-2 text-sm font-medium hover:bg-indigo-400 disabled:opacity-60",children:h?"Creating account":"Sign up"})]}),(0,er.jsxs)("div",{className:"mt-6 flex items-center justify-between text-sm text-slate-400",children:[(0,er.jsx)("button",{type:"button",onClick:t,className:"rounded-lg border border-slate-800 px-3 py-2 text-slate-200 hover:border-slate-700",children:"Back"}),(0,er.jsx)("button",{type:"button",onClick:r,className:"text-indigo-300 hover:text-indigo-200 underline-offset-4 hover:underline",children:"Already have an account?"})]})]})})}var sW=globalThis?.document?es.useLayoutEffect:()=>{},sG=e.i(74080),sV=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),sK=e.i(2239);function sJ(){return()=>{}}var sY="Avatar",[sX,sQ]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(sY),[sZ,s0]=sX(sY),s1=es.forwardRef((e,t)=>{let{__scopeAvatar:r,...s}=e,[n,i]=es.useState("idle");return(0,er.jsx)(sZ,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:(0,er.jsx)(sV.span,{...s,ref:t})})});s1.displayName=sY;var s2="AvatarImage",s4=es.forwardRef((e,t)=>{var r;let s,{__scopeAvatar:n,src:i,onLoadingStatusChange:a=()=>{},...o}=e,l=s0(s2,n),c=function(e,{referrerPolicy:t,crossOrigin:r}){let s=(0,sK.useSyncExternalStore)(sJ,()=>!0,()=>!1),n=es.useRef(null),i=s?(n.current||(n.current=new window.Image),n.current):null,[a,o]=es.useState(()=>s6(i,e));return sW(()=>{o(s6(i,e))},[i,e]),sW(()=>{let e=e=>()=>{o(e)};if(!i)return;let s=e("loaded"),n=e("error");return i.addEventListener("load",s),i.addEventListener("error",n),t&&(i.referrerPolicy=t),"string"==typeof r&&(i.crossOrigin=r),()=>{i.removeEventListener("load",s),i.removeEventListener("error",n)}},[i,r,t]),a}(i,o),d=(r=e=>{a(e),l.onImageLoadingStatusChange(e)},s=es.useRef(r),es.useEffect(()=>{s.current=r}),es.useMemo(()=>(...e)=>s.current?.(...e),[]));return sW(()=>{"idle"!==c&&d(c)},[c,d]),"loaded"===c?(0,er.jsx)(sV.img,{...o,ref:t,src:i}):null});s4.displayName=s2;var s5="AvatarFallback",s3=es.forwardRef((e,t)=>{let{__scopeAvatar:r,delayMs:s,...n}=e,i=s0(s5,r),[a,o]=es.useState(void 0===s);return es.useEffect(()=>{if(void 0!==s){let e=window.setTimeout(()=>o(!0),s);return()=>window.clearTimeout(e)}},[s]),a&&"loaded"!==i.imageLoadingStatus?(0,er.jsx)(sV.span,{...n,ref:t}):null});function s6(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function s8({className:e,...t}){return(0,er.jsx)(s1,{"data-slot":"avatar",className:tr("relative flex size-10 shrink-0 overflow-hidden rounded-full",e),...t})}function s7({className:e,...t}){return(0,er.jsx)(s4,{"data-slot":"avatar-image",className:tr("aspect-square size-full",e),...t})}function s9({className:e,...t}){return(0,er.jsx)(s3,{"data-slot":"avatar-fallback",className:tr("bg-muted flex size-full items-center justify-center rounded-full",e),...t})}s3.displayName=s5;var ne=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function nt(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var nr=globalThis?.document?es.useLayoutEffect:()=>{},ns=e=>{var t;let r,s,{present:n,children:i}=e,a=function(e){var t,r;let[s,n]=es.useState(),i=es.useRef(null),a=es.useRef(e),o=es.useRef("none"),[l,c]=(t=e?"mounted":"unmounted",r={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},es.useReducer((e,t)=>r[e][t]??e,t));return es.useEffect(()=>{let e=nn(i.current);o.current="mounted"===l?e:"none"},[l]),nr(()=>{let t=i.current,r=a.current;if(r!==e){let s=o.current,n=nn(t);e?c("MOUNT"):"none"===n||t?.display==="none"?c("UNMOUNT"):r&&s!==n?c("ANIMATION_OUT"):c("UNMOUNT"),a.current=e}},[e,c]),nr(()=>{if(s){let e,t=s.ownerDocument.defaultView??window,r=r=>{let n=nn(i.current).includes(CSS.escape(r.animationName));if(r.target===s&&n&&(c("ANIMATION_END"),!a.current)){let r=s.style.animationFillMode;s.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===s.style.animationFillMode&&(s.style.animationFillMode=r)})}},n=e=>{e.target===s&&(o.current=nn(i.current))};return s.addEventListener("animationstart",n),s.addEventListener("animationcancel",r),s.addEventListener("animationend",r),()=>{t.clearTimeout(e),s.removeEventListener("animationstart",n),s.removeEventListener("animationcancel",r),s.removeEventListener("animationend",r)}}c("ANIMATION_END")},[s,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:es.useCallback(e=>{i.current=e?getComputedStyle(e):null,n(e)},[])}}(n),o="function"==typeof i?i({present:a.isPresent}):es.Children.only(i),l=function(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=nt(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():nt(e[t],null)}}}}(...e),e)}(a.ref,(t=o,(s=(r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?t.ref:(s=(r=Object.getOwnPropertyDescriptor(t,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?t.props.ref:t.props.ref||t.ref));return"function"==typeof i||a.isPresent?es.cloneElement(o,{ref:l}):null};function nn(e){return e?.animationName||"none"}function ni(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function na(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=ni(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():ni(e[t],null)}}}}(...e),e)}function no(e){let t=es.useRef(e);return es.useEffect(()=>{t.current=e}),es.useMemo(()=>(...e)=>t.current?.(...e),[])}ns.displayName="Presence";var nl=es.createContext(void 0);function nc(e){let t=es.useContext(nl);return e||t||"ltr"}var nd=globalThis?.document?es.useLayoutEffect:()=>{};function nu(e,[t,r]){return Math.min(r,Math.max(t,e))}function nh(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}"undefined"!=typeof window&&window.document&&window.document.createElement;var np="ScrollArea",[nf,nm]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(np),[ng,nb]=nf(np),nx=es.forwardRef((e,t)=>{let{__scopeScrollArea:r,type:s="hover",dir:n,scrollHideDelay:i=600,...a}=e,[o,l]=es.useState(null),[c,d]=es.useState(null),[u,h]=es.useState(null),[p,f]=es.useState(null),[m,g]=es.useState(null),[b,x]=es.useState(0),[y,w]=es.useState(0),[v,j]=es.useState(!1),[k,N]=es.useState(!1),S=na(t,e=>l(e)),_=nc(n);return(0,er.jsx)(ng,{scope:r,type:s,dir:_,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:d,content:u,onContentChange:h,scrollbarX:p,onScrollbarXChange:f,scrollbarXEnabled:v,onScrollbarXEnabledChange:j,scrollbarY:m,onScrollbarYChange:g,scrollbarYEnabled:k,onScrollbarYEnabledChange:N,onCornerWidthChange:x,onCornerHeightChange:w,children:(0,er.jsx)(ne.div,{dir:_,...a,ref:S,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":y+"px",...e.style}})})});nx.displayName=np;var ny="ScrollAreaViewport",nw=es.forwardRef((e,t)=>{let{__scopeScrollArea:r,children:s,nonce:n,...i}=e,a=nb(ny,r),o=na(t,es.useRef(null),a.onViewportChange);return(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),(0,er.jsx)(ne.div,{"data-radix-scroll-area-viewport":"",...i,ref:o,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,er.jsx)("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});nw.displayName=ny;var nv="ScrollAreaScrollbar",nj=es.forwardRef((e,t)=>{let{forceMount:r,...s}=e,n=nb(nv,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=n,o="horizontal"===e.orientation;return es.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),"hover"===n.type?(0,er.jsx)(nk,{...s,ref:t,forceMount:r}):"scroll"===n.type?(0,er.jsx)(nN,{...s,ref:t,forceMount:r}):"auto"===n.type?(0,er.jsx)(nS,{...s,ref:t,forceMount:r}):"always"===n.type?(0,er.jsx)(n_,{...s,ref:t}):null});nj.displayName=nv;var nk=es.forwardRef((e,t)=>{let{forceMount:r,...s}=e,n=nb(nv,e.__scopeScrollArea),[i,a]=es.useState(!1);return es.useEffect(()=>{let e=n.scrollArea,t=0;if(e){let r=()=>{window.clearTimeout(t),a(!0)},s=()=>{t=window.setTimeout(()=>a(!1),n.scrollHideDelay)};return e.addEventListener("pointerenter",r),e.addEventListener("pointerleave",s),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",r),e.removeEventListener("pointerleave",s)}}},[n.scrollArea,n.scrollHideDelay]),(0,er.jsx)(ns,{present:r||i,children:(0,er.jsx)(nS,{"data-state":i?"visible":"hidden",...s,ref:t})})}),nN=es.forwardRef((e,t)=>{var r;let{forceMount:s,...n}=e,i=nb(nv,e.__scopeScrollArea),a="horizontal"===e.orientation,o=nH(()=>c("SCROLL_END"),100),[l,c]=(r={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},es.useReducer((e,t)=>r[e][t]??e,"hidden"));return es.useEffect(()=>{if("idle"===l){let e=window.setTimeout(()=>c("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(e)}},[l,i.scrollHideDelay,c]),es.useEffect(()=>{let e=i.viewport,t=a?"scrollLeft":"scrollTop";if(e){let r=e[t],s=()=>{let s=e[t];r!==s&&(c("SCROLL"),o()),r=s};return e.addEventListener("scroll",s),()=>e.removeEventListener("scroll",s)}},[i.viewport,a,c,o]),(0,er.jsx)(ns,{present:s||"hidden"!==l,children:(0,er.jsx)(n_,{"data-state":"hidden"===l?"hidden":"visible",...n,ref:t,onPointerEnter:nh(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:nh(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),nS=es.forwardRef((e,t)=>{let r=nb(nv,e.__scopeScrollArea),{forceMount:s,...n}=e,[i,a]=es.useState(!1),o="horizontal"===e.orientation,l=nH(()=>{if(r.viewport){let e=r.viewport.offsetWidth<r.viewport.scrollWidth,t=r.viewport.offsetHeight<r.viewport.scrollHeight;a(o?e:t)}},10);return nW(r.viewport,l),nW(r.content,l),(0,er.jsx)(ns,{present:s||i,children:(0,er.jsx)(n_,{"data-state":i?"visible":"hidden",...n,ref:t})})}),n_=es.forwardRef((e,t)=>{let{orientation:r="vertical",...s}=e,n=nb(nv,e.__scopeScrollArea),i=es.useRef(null),a=es.useRef(0),[o,l]=es.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=nU(o.viewport,o.content),d={...s,sizes:o,onSizesChange:l,hasThumb:!!(c>0&&c<1),onThumbChange:e=>i.current=e,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:e=>a.current=e};function u(e,t){return function(e,t,r,s="ltr"){let n=nB(r),i=t||n/2,a=r.scrollbar.paddingStart+i,o=r.scrollbar.size-r.scrollbar.paddingEnd-(n-i),l=r.content-r.viewport;return nq([a,o],"ltr"===s?[0,l]:[-1*l,0])(e)}(e,a.current,o,t)}return"horizontal"===r?(0,er.jsx)(nC,{...d,ref:t,onThumbPositionChange:()=>{if(n.viewport&&i.current){let e=nz(n.viewport.scrollLeft,o,n.dir);i.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{n.viewport&&(n.viewport.scrollLeft=e)},onDragScroll:e=>{n.viewport&&(n.viewport.scrollLeft=u(e,n.dir))}}):"vertical"===r?(0,er.jsx)(nE,{...d,ref:t,onThumbPositionChange:()=>{if(n.viewport&&i.current){let e=nz(n.viewport.scrollTop,o);i.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{n.viewport&&(n.viewport.scrollTop=e)},onDragScroll:e=>{n.viewport&&(n.viewport.scrollTop=u(e))}}):null}),nC=es.forwardRef((e,t)=>{let{sizes:r,onSizesChange:s,...n}=e,i=nb(nv,e.__scopeScrollArea),[a,o]=es.useState(),l=es.useRef(null),c=na(t,l,i.onScrollbarXChange);return es.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),(0,er.jsx)(nO,{"data-orientation":"horizontal",...n,ref:c,sizes:r,style:{bottom:0,left:"rtl"===i.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===i.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":nB(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,r)=>{if(i.viewport){var s,n;let a=i.viewport.scrollLeft+t.deltaX;e.onWheelScroll(a),s=a,n=r,s>0&&s<n&&t.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&s({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:n$(a.paddingLeft),paddingEnd:n$(a.paddingRight)}})}})}),nE=es.forwardRef((e,t)=>{let{sizes:r,onSizesChange:s,...n}=e,i=nb(nv,e.__scopeScrollArea),[a,o]=es.useState(),l=es.useRef(null),c=na(t,l,i.onScrollbarYChange);return es.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),(0,er.jsx)(nO,{"data-orientation":"vertical",...n,ref:c,sizes:r,style:{top:0,right:"ltr"===i.dir?0:void 0,left:"rtl"===i.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":nB(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,r)=>{if(i.viewport){var s,n;let a=i.viewport.scrollTop+t.deltaY;e.onWheelScroll(a),s=a,n=r,s>0&&s<n&&t.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&s({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:n$(a.paddingTop),paddingEnd:n$(a.paddingBottom)}})}})}),[nR,nA]=nf(nv),nO=es.forwardRef((e,t)=>{let{__scopeScrollArea:r,sizes:s,hasThumb:n,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:d,onResize:u,...h}=e,p=nb(nv,r),[f,m]=es.useState(null),g=na(t,e=>m(e)),b=es.useRef(null),x=es.useRef(""),y=p.viewport,w=s.content-s.viewport,v=no(d),j=no(l),k=nH(u,10);function N(e){b.current&&c({x:e.clientX-b.current.left,y:e.clientY-b.current.top})}return es.useEffect(()=>{let e=e=>{let t=e.target;f?.contains(t)&&v(e,w)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[y,f,w,v]),es.useEffect(j,[s,j]),nW(f,k),nW(p.content,k),(0,er.jsx)(nR,{scope:r,scrollbar:f,hasThumb:n,onThumbChange:no(i),onThumbPointerUp:no(a),onThumbPositionChange:j,onThumbPointerDown:no(o),children:(0,er.jsx)(ne.div,{...h,ref:g,style:{position:"absolute",...h.style},onPointerDown:nh(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),b.current=f.getBoundingClientRect(),x.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),N(e))}),onPointerMove:nh(e.onPointerMove,N),onPointerUp:nh(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=x.current,p.viewport&&(p.viewport.style.scrollBehavior=""),b.current=null})})})}),nT="ScrollAreaThumb",nI=es.forwardRef((e,t)=>{let{forceMount:r,...s}=e,n=nA(nT,e.__scopeScrollArea);return(0,er.jsx)(ns,{present:r||n.hasThumb,children:(0,er.jsx)(nM,{ref:t,...s})})}),nM=es.forwardRef((e,t)=>{let{__scopeScrollArea:r,style:s,...n}=e,i=nb(nT,r),a=nA(nT,r),{onThumbPositionChange:o}=a,l=na(t,e=>a.onThumbChange(e)),c=es.useRef(void 0),d=nH(()=>{c.current&&(c.current(),c.current=void 0)},100);return es.useEffect(()=>{let e=i.viewport;if(e){let t=()=>{d(),c.current||(c.current=nF(e,o),o())};return o(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[i.viewport,d,o]),(0,er.jsx)(ne.div,{"data-state":a.hasThumb?"visible":"hidden",...n,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:nh(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),r=e.clientX-t.left,s=e.clientY-t.top;a.onThumbPointerDown({x:r,y:s})}),onPointerUp:nh(e.onPointerUp,a.onThumbPointerUp)})});nI.displayName=nT;var nP="ScrollAreaCorner",nD=es.forwardRef((e,t)=>{let r=nb(nP,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&s?(0,er.jsx)(nL,{...e,ref:t}):null});nD.displayName=nP;var nL=es.forwardRef((e,t)=>{let{__scopeScrollArea:r,...s}=e,n=nb(nP,r),[i,a]=es.useState(0),[o,l]=es.useState(0),c=!!(i&&o);return nW(n.scrollbarX,()=>{let e=n.scrollbarX?.offsetHeight||0;n.onCornerHeightChange(e),l(e)}),nW(n.scrollbarY,()=>{let e=n.scrollbarY?.offsetWidth||0;n.onCornerWidthChange(e),a(e)}),c?(0,er.jsx)(ne.div,{...s,ref:t,style:{width:i,height:o,position:"absolute",right:"ltr"===n.dir?0:void 0,left:"rtl"===n.dir?0:void 0,bottom:0,...e.style}}):null});function n$(e){return e?parseInt(e,10):0}function nU(e,t){let r=e/t;return isNaN(r)?0:r}function nB(e){let t=nU(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-r)*t,18)}function nz(e,t,r="ltr"){let s=nB(t),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-n,a=t.content-t.viewport,o=nu(e,"ltr"===r?[0,a]:[-1*a,0]);return nq([0,a],[0,i-s])(o)}function nq(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}var nF=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return!function n(){let i={left:e.scrollLeft,top:e.scrollTop},a=r.left!==i.left,o=r.top!==i.top;(a||o)&&t(),r=i,s=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(s)};function nH(e,t){let r=no(e),s=es.useRef(0);return es.useEffect(()=>()=>window.clearTimeout(s.current),[]),es.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function nW(e,t){let r=no(t);nd(()=>{let t=0;if(e){let s=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(r)});return s.observe(e),()=>{window.cancelAnimationFrame(t),s.unobserve(e)}}},[e,r])}function nG({className:e,children:t,...r}){return(0,er.jsxs)(nx,{"data-slot":"scroll-area",className:tr("relative",e),...r,children:[(0,er.jsx)(nw,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,er.jsx)(nV,{}),(0,er.jsx)(nD,{})]})}function nV({className:e,orientation:t="vertical",...r}){return(0,er.jsx)(nj,{"data-slot":"scroll-area-scrollbar",orientation:t,className:tr("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",e),...r,children:(0,er.jsx)(nI,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function nK(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function nJ(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function nY(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function nX(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=nY(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():nY(e[t],null)}}}}(...e),e)}function nQ(e){let t=e+"CollectionProvider",[r,s]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(t),[n,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=e=>{let{scope:t,children:r}=e,s=es.default.useRef(null),i=es.default.useRef(new Map).current;return(0,er.jsx)(n,{scope:t,itemMap:i,collectionRef:s,children:r})};a.displayName=t;let o=e+"CollectionSlot",l=eo(o),c=es.default.forwardRef((e,t)=>{let{scope:r,children:s}=e,n=nX(t,i(o,r).collectionRef);return(0,er.jsx)(l,{ref:n,children:s})});c.displayName=o;let d=e+"CollectionItemSlot",u="data-radix-collection-item",h=eo(d),p=es.default.forwardRef((e,t)=>{let{scope:r,children:s,...n}=e,a=es.default.useRef(null),o=nX(t,a),l=i(d,r);return es.default.useEffect(()=>(l.itemMap.set(a,{ref:a,...n}),()=>void l.itemMap.delete(a))),(0,er.jsx)(h,{...{[u]:""},ref:o,children:s})});return p.displayName=d,[{Provider:a,Slot:c,ItemSlot:p},function(t){let r=i(e+"CollectionConsumer",t);return es.default.useCallback(()=>{let e=r.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${u}]`));return Array.from(r.itemMap.values()).sort((e,r)=>t.indexOf(e.ref.current)-t.indexOf(r.ref.current))},[r.collectionRef,r.itemMap])},s]}"undefined"!=typeof window&&window.document&&window.document.createElement,"undefined"!=typeof window&&window.document&&window.document.createElement;var nZ=new WeakMap;function n0(e,t){var r,s;let n,i,a;if("at"in Array.prototype)return Array.prototype.at.call(e,t);let o=(r=e,s=t,n=r.length,(a=(i=n1(s))>=0?i:n+i)<0||a>=n?-1:a);return -1===o?void 0:e[o]}function n1(e){return e!=e||0===e?0:Math.trunc(e)}function n2(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}(class e extends Map{#e;constructor(e){super(e),this.#e=[...super.keys()],nZ.set(this,!0)}set(e,t){return nZ.get(this)&&(this.has(e)?this.#e[this.#e.indexOf(e)]=e:this.#e.push(e)),super.set(e,t),this}insert(e,t,r){let s,n=this.has(t),i=this.#e.length,a=n1(e),o=a>=0?a:i+a,l=o<0||o>=i?-1:o;if(l===this.size||n&&l===this.size-1||-1===l)return this.set(t,r),this;let c=this.size+ +!n;a<0&&o++;let d=[...this.#e],u=!1;for(let e=o;e<c;e++)if(o===e){let i=d[e];d[e]===t&&(i=d[e+1]),n&&this.delete(t),s=this.get(i),this.set(t,r)}else{u||d[e-1]!==t||(u=!0);let r=d[u?e:e-1],n=s;s=this.get(r),this.delete(r),this.set(r,n)}return this}with(t,r,s){let n=new e(this);return n.insert(t,r,s),n}before(e){let t=this.#e.indexOf(e)-1;if(!(t<0))return this.entryAt(t)}setBefore(e,t,r){let s=this.#e.indexOf(e);return -1===s?this:this.insert(s,t,r)}after(e){let t=this.#e.indexOf(e);if(-1!==(t=-1===t||t===this.size-1?-1:t+1))return this.entryAt(t)}setAfter(e,t,r){let s=this.#e.indexOf(e);return -1===s?this:this.insert(s+1,t,r)}first(){return this.entryAt(0)}last(){return this.entryAt(-1)}clear(){return this.#e=[],super.clear()}delete(e){let t=super.delete(e);return t&&this.#e.splice(this.#e.indexOf(e),1),t}deleteAt(e){let t=this.keyAt(e);return void 0!==t&&this.delete(t)}at(e){let t=n0(this.#e,e);if(void 0!==t)return this.get(t)}entryAt(e){let t=n0(this.#e,e);if(void 0!==t)return[t,this.get(t)]}indexOf(e){return this.#e.indexOf(e)}keyAt(e){return n0(this.#e,e)}from(e,t){let r=this.indexOf(e);if(-1===r)return;let s=r+t;return s<0&&(s=0),s>=this.size&&(s=this.size-1),this.at(s)}keyFrom(e,t){let r=this.indexOf(e);if(-1===r)return;let s=r+t;return s<0&&(s=0),s>=this.size&&(s=this.size-1),this.keyAt(s)}find(e,t){let r=0;for(let s of this){if(Reflect.apply(e,t,[s,r,this]))return s;r++}}findIndex(e,t){let r=0;for(let s of this){if(Reflect.apply(e,t,[s,r,this]))return r;r++}return -1}filter(t,r){let s=[],n=0;for(let e of this)Reflect.apply(t,r,[e,n,this])&&s.push(e),n++;return new e(s)}map(t,r){let s=[],n=0;for(let e of this)s.push([e[0],Reflect.apply(t,r,[e,n,this])]),n++;return new e(s)}reduce(...e){let[t,r]=e,s=0,n=r??this.at(0);for(let r of this)n=0===s&&1===e.length?r:Reflect.apply(t,this,[n,r,s,this]),s++;return n}reduceRight(...e){let[t,r]=e,s=r??this.at(-1);for(let r=this.size-1;r>=0;r--){let n=this.at(r);s=r===this.size-1&&1===e.length?n:Reflect.apply(t,this,[s,n,r,this])}return s}toSorted(t){return new e([...this.entries()].sort(t))}toReversed(){let t=new e;for(let e=this.size-1;e>=0;e--){let r=this.keyAt(e),s=this.get(r);t.set(r,s)}return t}toSpliced(...t){let r=[...this.entries()];return r.splice(...t),new e(r)}slice(t,r){let s=new e,n=this.size-1;if(void 0===t)return s;t<0&&(t+=this.size),void 0!==r&&r>0&&(n=r-1);for(let e=t;e<=n;e++){let t=this.keyAt(e),r=this.get(t);s.set(t,r)}return s}every(e,t){let r=0;for(let s of this){if(!Reflect.apply(e,t,[s,r,this]))return!1;r++}return!0}some(e,t){let r=0;for(let s of this){if(Reflect.apply(e,t,[s,r,this]))return!0;r++}return!1}});var n4=globalThis?.document?es.useLayoutEffect:()=>{},n5=es[" useId ".trim().toString()]||(()=>void 0),n3=0;function n6(e){let[t,r]=es.useState(n5());return n4(()=>{e||r(e=>e??String(n3++))},[e]),e||(t?`radix-${t}`:"")}var n8=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),n7=globalThis?.document?es.useLayoutEffect:()=>{};globalThis?.document&&es.useLayoutEffect,es[" useEffectEvent ".trim().toString()],es[" useInsertionEffect ".trim().toString()];var n9=es[" useInsertionEffect ".trim().toString()]||n7;Symbol("RADIX:SYNC_STATE");var ie="rovingFocusGroup.onEntryFocus",it={bubbles:!1,cancelable:!0},ir="RovingFocusGroup",[is,ii,ia]=nQ(ir),[io,il]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(ir,[ia]),[ic,id]=io(ir),iu=es.forwardRef((e,t)=>(0,er.jsx)(is.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,er.jsx)(is.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,er.jsx)(ih,{...e,ref:t})})}));iu.displayName=ir;var ih=es.forwardRef((e,t)=>{let r,{__scopeRovingFocusGroup:s,orientation:n,loop:i=!1,dir:a,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...h}=e,p=es.useRef(null),f=function(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=n2(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():n2(e[t],null)}}}}(...e),e)}(t,p),m=nc(a),[g,b]=function({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return n9(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}({prop:o,defaultProp:l??null,onChange:c,caller:ir}),[x,y]=es.useState(!1),w=(r=es.useRef(d),es.useEffect(()=>{r.current=d}),es.useMemo(()=>(...e)=>r.current?.(...e),[])),v=ii(s),j=es.useRef(!1),[k,N]=es.useState(0);return es.useEffect(()=>{let e=p.current;if(e)return e.addEventListener(ie,w),()=>e.removeEventListener(ie,w)},[w]),(0,er.jsx)(ic,{scope:s,orientation:n,dir:m,loop:i,currentTabStopId:g,onItemFocus:es.useCallback(e=>b(e),[b]),onItemShiftTab:es.useCallback(()=>y(!0),[]),onFocusableItemAdd:es.useCallback(()=>N(e=>e+1),[]),onFocusableItemRemove:es.useCallback(()=>N(e=>e-1),[]),children:(0,er.jsx)(n8.div,{tabIndex:x||0===k?-1:0,"data-orientation":n,...h,ref:f,style:{outline:"none",...e.style},onMouseDown:nJ(e.onMouseDown,()=>{j.current=!0}),onFocus:nJ(e.onFocus,e=>{let t=!j.current;if(e.target===e.currentTarget&&t&&!x){let t=new CustomEvent(ie,it);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=v().filter(e=>e.focusable);ib([e.find(e=>e.active),e.find(e=>e.id===g),...e].filter(Boolean).map(e=>e.ref.current),u)}}j.current=!1}),onBlur:nJ(e.onBlur,()=>y(!1))})})}),ip="RovingFocusGroupItem",im=es.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:r,focusable:s=!0,active:n=!1,tabStopId:i,children:a,...o}=e,l=n6(),c=i||l,d=id(ip,r),u=d.currentTabStopId===c,h=ii(r),{onFocusableItemAdd:p,onFocusableItemRemove:f,currentTabStopId:m}=d;return es.useEffect(()=>{if(s)return p(),()=>f()},[s,p,f]),(0,er.jsx)(is.ItemSlot,{scope:r,id:c,focusable:s,active:n,children:(0,er.jsx)(n8.span,{tabIndex:u?0:-1,"data-orientation":d.orientation,...o,ref:t,onMouseDown:nJ(e.onMouseDown,e=>{s?d.onItemFocus(c):e.preventDefault()}),onFocus:nJ(e.onFocus,()=>d.onItemFocus(c)),onKeyDown:nJ(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void d.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,r){var s;let n=(s=e.key,"rtl"!==r?s:"ArrowLeft"===s?"ArrowRight":"ArrowRight"===s?"ArrowLeft":s);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(n))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(n)))return ig[n]}(e,d.orientation,d.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let n=h().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)n.reverse();else if("prev"===t||"next"===t){var r,s;"prev"===t&&n.reverse();let i=n.indexOf(e.currentTarget);n=d.loop?(r=n,s=i+1,r.map((e,t)=>r[(s+t)%r.length])):n.slice(i+1)}setTimeout(()=>ib(n))}}),children:"function"==typeof a?a({isCurrentTabStop:u,hasTabStop:null!=m}):a})})});im.displayName=ip;var ig={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ib(e,t=!1){let r=document.activeElement;for(let s of e)if(s===r||(s.focus({preventScroll:t}),document.activeElement!==r))return}var ix=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),iy=globalThis?.document?es.useLayoutEffect:()=>{},iw=es[" useInsertionEffect ".trim().toString()]||iy;Symbol("RADIX:SYNC_STATE");var iv="Tabs",[ij,ik]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(iv,[il]),iN=il(),[iS,i_]=ij(iv),iC=es.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,onValueChange:n,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,d=nc(o),[u,h]=function({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return iw(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}({prop:s,onChange:n,defaultProp:i??"",caller:iv});return(0,er.jsx)(iS,{scope:r,baseId:n6(),value:u,onValueChange:h,orientation:a,dir:d,activationMode:l,children:(0,er.jsx)(ix.div,{dir:d,"data-orientation":a,...c,ref:t})})});iC.displayName=iv;var iE="TabsList",iR=es.forwardRef((e,t)=>{let{__scopeTabs:r,loop:s=!0,...n}=e,i=i_(iE,r),a=iN(r);return(0,er.jsx)(iu,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:s,children:(0,er.jsx)(ix.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:t})})});iR.displayName=iE;var iA="TabsTrigger",iO=es.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,disabled:n=!1,...i}=e,a=i_(iA,r),o=iN(r),l=iM(a.baseId,s),c=iP(a.baseId,s),d=s===a.value;return(0,er.jsx)(im,{asChild:!0,...o,focusable:!n,active:d,children:(0,er.jsx)(ix.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":c,"data-state":d?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:l,...i,ref:t,onMouseDown:nK(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():a.onValueChange(s)}),onKeyDown:nK(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&a.onValueChange(s)}),onFocus:nK(e.onFocus,()=>{let e="manual"!==a.activationMode;d||n||!e||a.onValueChange(s)})})})});iO.displayName=iA;var iT="TabsContent",iI=es.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,forceMount:n,children:i,...a}=e,o=i_(iT,r),l=iM(o.baseId,s),c=iP(o.baseId,s),d=s===o.value,u=es.useRef(d);return es.useEffect(()=>{let e=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,er.jsx)(ns,{present:n||d,children:({present:r})=>(0,er.jsx)(ix.div,{"data-state":d?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!r,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0},children:r&&i})})});function iM(e,t){return`${e}-trigger-${t}`}function iP(e,t){return`${e}-content-${t}`}function iD({className:e,...t}){return(0,er.jsx)(iC,{"data-slot":"tabs",className:tr("flex flex-col gap-2",e),...t})}function iL({className:e,...t}){return(0,er.jsx)(iR,{"data-slot":"tabs-list",className:tr("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",e),...t})}function i$({className:e,...t}){return(0,er.jsx)(iO,{"data-slot":"tabs-trigger",className:tr("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function iU({className:e,...t}){return(0,er.jsx)(iI,{"data-slot":"tabs-content",className:tr("flex-1 outline-none",e),...t})}iI.displayName=iT;let iB=ep("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function iz({className:e,variant:t,asChild:r=!1,...s}){return(0,er.jsx)(r?el:"span",{"data-slot":"badge",className:tr(iB({variant:t}),e),...s})}let iq=tc("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),iF=tc("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),iH=tc("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),iW=tc("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),iG=tc("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),iV=tc("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),iK=Array(12).fill(0),iJ=({visible:e,className:t})=>es.default.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},es.default.createElement("div",{className:"sonner-spinner"},iK.map((e,t)=>es.default.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${t}`})))),iY=es.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},es.default.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),iX=es.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},es.default.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),iQ=es.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},es.default.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),iZ=es.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},es.default.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),i0=es.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},es.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),es.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),i1=1,i2=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...s}=e,n="number"==typeof(null==e?void 0:e.id)||(null==(t=e.id)?void 0:t.length)>0?e.id:i1++,i=this.toasts.find(e=>e.id===n),a=void 0===e.dismissible||e.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),i?this.toasts=this.toasts.map(t=>t.id===n?(this.publish({...t,...e,id:n,title:r}),{...t,...e,id:n,dismissible:a,title:r}):t):this.addToast({title:r,...s,dismissible:a,id:n}),n},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{let r,s;if(!t)return;void 0!==t.loading&&(s=this.create({...t,promise:e,type:"loading",message:t.loading,description:"function"!=typeof t.description?t.description:void 0}));let n=Promise.resolve(e instanceof Function?e():e),i=void 0!==s,a=n.then(async e=>{if(r=["resolve",e],es.default.isValidElement(e))i=!1,this.create({id:s,type:"default",message:e});else if(i4(e)&&!e.ok){i=!1;let r="function"==typeof t.error?await t.error(`HTTP error! status: ${e.status}`):t.error,n="function"==typeof t.description?await t.description(`HTTP error! status: ${e.status}`):t.description,a="object"!=typeof r||es.default.isValidElement(r)?{message:r}:r;this.create({id:s,type:"error",description:n,...a})}else if(e instanceof Error){i=!1;let r="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,a="object"!=typeof r||es.default.isValidElement(r)?{message:r}:r;this.create({id:s,type:"error",description:n,...a})}else if(void 0!==t.success){i=!1;let r="function"==typeof t.success?await t.success(e):t.success,n="function"==typeof t.description?await t.description(e):t.description,a="object"!=typeof r||es.default.isValidElement(r)?{message:r}:r;this.create({id:s,type:"success",description:n,...a})}}).catch(async e=>{if(r=["reject",e],void 0!==t.error){i=!1;let r="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,a="object"!=typeof r||es.default.isValidElement(r)?{message:r}:r;this.create({id:s,type:"error",description:n,...a})}}).finally(()=>{i&&(this.dismiss(s),s=void 0),null==t.finally||t.finally.call(t)}),o=()=>new Promise((e,t)=>a.then(()=>"reject"===r[0]?t(r[1]):e(r[1])).catch(t));return"string"!=typeof s&&"number"!=typeof s?{unwrap:o}:Object.assign(s,{unwrap:o})},this.custom=(e,t)=>{let r=(null==t?void 0:t.id)||i1++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},i4=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status,i5=Object.assign((e,t)=>{let r=(null==t?void 0:t.id)||i1++;return i2.addToast({title:e,...t,id:r}),r},{success:i2.success,info:i2.info,warning:i2.warning,error:i2.error,custom:i2.custom,message:i2.message,promise:i2.promise,dismiss:i2.dismiss,loading:i2.loading},{getHistory:()=>i2.toasts,getToasts:()=>i2.getActiveToasts()});function i3(e){return void 0!==e.label}function i6(...e){return e.filter(Boolean).join(" ")}!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");let i8=e=>{var t,r,s,n,i,a,o,l,c,d,u,h,p;let{invert:f,toast:m,unstyled:g,interacting:b,setHeights:x,visibleToasts:y,heights:w,index:v,toasts:j,expanded:k,removeToast:N,defaultRichColors:S,closeButton:_,style:C,cancelButtonStyle:E,actionButtonStyle:R,className:A="",descriptionClassName:O="",duration:T,position:I,gap:M,expandByDefault:P,classNames:D,icons:L,closeButtonAriaLabel:$="Close toast"}=e,[U,B]=es.default.useState(null),[z,q]=es.default.useState(null),[F,H]=es.default.useState(!1),[W,G]=es.default.useState(!1),[V,K]=es.default.useState(!1),[J,Y]=es.default.useState(!1),[X,Q]=es.default.useState(!1),[Z,ee]=es.default.useState(0),[et,er]=es.default.useState(0),en=es.default.useRef(m.duration||T||4e3),ei=es.default.useRef(null),ea=es.default.useRef(null),eo=0===v,el=v+1<=y,ec=m.type,ed=!1!==m.dismissible,eu=m.className||"",eh=m.descriptionClassName||"",ep=es.default.useMemo(()=>w.findIndex(e=>e.toastId===m.id)||0,[w,m.id]),ef=es.default.useMemo(()=>{var e;return null!=(e=m.closeButton)?e:_},[m.closeButton,_]),em=es.default.useMemo(()=>m.duration||T||4e3,[m.duration,T]),eg=es.default.useRef(0),eb=es.default.useRef(0),ex=es.default.useRef(0),ey=es.default.useRef(null),[ew,ev]=I.split("-"),ej=es.default.useMemo(()=>w.reduce((e,t,r)=>r>=ep?e:e+t.height,0),[w,ep]),ek=(()=>{let[e,t]=es.default.useState(document.hidden);return es.default.useEffect(()=>{let e=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),e})(),eN=m.invert||f,eS="loading"===ec;eb.current=es.default.useMemo(()=>ep*M+ej,[ep,ej]),es.default.useEffect(()=>{en.current=em},[em]),es.default.useEffect(()=>{H(!0)},[]),es.default.useEffect(()=>{let e=ea.current;if(e){let t=e.getBoundingClientRect().height;return er(t),x(e=>[{toastId:m.id,height:t,position:m.position},...e]),()=>x(e=>e.filter(e=>e.toastId!==m.id))}},[x,m.id]),es.default.useLayoutEffect(()=>{if(!F)return;let e=ea.current,t=e.style.height;e.style.height="auto";let r=e.getBoundingClientRect().height;e.style.height=t,er(r),x(e=>e.find(e=>e.toastId===m.id)?e.map(e=>e.toastId===m.id?{...e,height:r}:e):[{toastId:m.id,height:r,position:m.position},...e])},[F,m.title,m.description,x,m.id,m.jsx,m.action,m.cancel]);let e_=es.default.useCallback(()=>{G(!0),ee(eb.current),x(e=>e.filter(e=>e.toastId!==m.id)),setTimeout(()=>{N(m)},200)},[m,N,x,eb]);es.default.useEffect(()=>{let e;if((!m.promise||"loading"!==ec)&&m.duration!==1/0&&"loading"!==m.type){if(k||b||ek){if(ex.current<eg.current){let e=new Date().getTime()-eg.current;en.current=en.current-e}ex.current=new Date().getTime()}else en.current!==1/0&&(eg.current=new Date().getTime(),e=setTimeout(()=>{null==m.onAutoClose||m.onAutoClose.call(m,m),e_()},en.current));return()=>clearTimeout(e)}},[k,b,m,ec,ek,e_]),es.default.useEffect(()=>{m.delete&&(e_(),null==m.onDismiss||m.onDismiss.call(m,m))},[e_,m.delete]);let eC=m.icon||(null==L?void 0:L[ec])||(e=>{switch(e){case"success":return iY;case"info":return iQ;case"warning":return iX;case"error":return iZ;default:return null}})(ec);return es.default.createElement("li",{tabIndex:0,ref:ea,className:i6(A,eu,null==D?void 0:D.toast,null==m||null==(t=m.classNames)?void 0:t.toast,null==D?void 0:D.default,null==D?void 0:D[ec],null==m||null==(r=m.classNames)?void 0:r[ec]),"data-sonner-toast":"","data-rich-colors":null!=(d=m.richColors)?d:S,"data-styled":!(m.jsx||m.unstyled||g),"data-mounted":F,"data-promise":!!m.promise,"data-swiped":X,"data-removed":W,"data-visible":el,"data-y-position":ew,"data-x-position":ev,"data-index":v,"data-front":eo,"data-swiping":V,"data-dismissible":ed,"data-type":ec,"data-invert":eN,"data-swipe-out":J,"data-swipe-direction":z,"data-expanded":!!(k||P&&F),"data-testid":m.testId,style:{"--index":v,"--toasts-before":v,"--z-index":j.length-v,"--offset":`${W?Z:eb.current}px`,"--initial-height":P?"auto":`${et}px`,...C,...m.style},onDragEnd:()=>{K(!1),B(null),ey.current=null},onPointerDown:e=>{2===e.button||eS||!ed||(ei.current=new Date,ee(eb.current),e.target.setPointerCapture(e.pointerId),"BUTTON"!==e.target.tagName&&(K(!0),ey.current={x:e.clientX,y:e.clientY}))},onPointerUp:()=>{var e,t,r,s,n;if(J||!ed)return;ey.current=null;let i=Number((null==(e=ea.current)?void 0:e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),a=Number((null==(t=ea.current)?void 0:t.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),o=new Date().getTime()-(null==(r=ei.current)?void 0:r.getTime()),l="x"===U?i:a,c=Math.abs(l)/o;if(Math.abs(l)>=45||c>.11){ee(eb.current),null==m.onDismiss||m.onDismiss.call(m,m),"x"===U?q(i>0?"right":"left"):q(a>0?"down":"up"),e_(),Y(!0);return}null==(s=ea.current)||s.style.setProperty("--swipe-amount-x","0px"),null==(n=ea.current)||n.style.setProperty("--swipe-amount-y","0px"),Q(!1),K(!1),B(null)},onPointerMove:t=>{var r,s,n,i;if(!ey.current||!ed||(null==(r=window.getSelection())?void 0:r.toString().length)>0)return;let a=t.clientY-ey.current.y,o=t.clientX-ey.current.x,l=null!=(i=e.swipeDirections)?i:function(e){let[t,r]=e.split("-"),s=[];return t&&s.push(t),r&&s.push(r),s}(I);!U&&(Math.abs(o)>1||Math.abs(a)>1)&&B(Math.abs(o)>Math.abs(a)?"x":"y");let c={x:0,y:0},d=e=>1/(1.5+Math.abs(e)/20);if("y"===U){if(l.includes("top")||l.includes("bottom"))if(l.includes("top")&&a<0||l.includes("bottom")&&a>0)c.y=a;else{let e=a*d(a);c.y=Math.abs(e)<Math.abs(a)?e:a}}else if("x"===U&&(l.includes("left")||l.includes("right")))if(l.includes("left")&&o<0||l.includes("right")&&o>0)c.x=o;else{let e=o*d(o);c.x=Math.abs(e)<Math.abs(o)?e:o}(Math.abs(c.x)>0||Math.abs(c.y)>0)&&Q(!0),null==(s=ea.current)||s.style.setProperty("--swipe-amount-x",`${c.x}px`),null==(n=ea.current)||n.style.setProperty("--swipe-amount-y",`${c.y}px`)}},ef&&!m.jsx&&"loading"!==ec?es.default.createElement("button",{"aria-label":$,"data-disabled":eS,"data-close-button":!0,onClick:eS||!ed?()=>{}:()=>{e_(),null==m.onDismiss||m.onDismiss.call(m,m)},className:i6(null==D?void 0:D.closeButton,null==m||null==(s=m.classNames)?void 0:s.closeButton)},null!=(u=null==L?void 0:L.close)?u:i0):null,(ec||m.icon||m.promise)&&null!==m.icon&&((null==L?void 0:L[ec])!==null||m.icon)?es.default.createElement("div",{"data-icon":"",className:i6(null==D?void 0:D.icon,null==m||null==(n=m.classNames)?void 0:n.icon)},m.promise||"loading"===m.type&&!m.icon?m.icon||((null==L?void 0:L.loading)?es.default.createElement("div",{className:i6(null==D?void 0:D.loader,null==m||null==(p=m.classNames)?void 0:p.loader,"sonner-loader"),"data-visible":"loading"===ec},L.loading):es.default.createElement(iJ,{className:i6(null==D?void 0:D.loader,null==m||null==(h=m.classNames)?void 0:h.loader),visible:"loading"===ec})):null,"loading"!==m.type?eC:null):null,es.default.createElement("div",{"data-content":"",className:i6(null==D?void 0:D.content,null==m||null==(i=m.classNames)?void 0:i.content)},es.default.createElement("div",{"data-title":"",className:i6(null==D?void 0:D.title,null==m||null==(a=m.classNames)?void 0:a.title)},m.jsx?m.jsx:"function"==typeof m.title?m.title():m.title),m.description?es.default.createElement("div",{"data-description":"",className:i6(O,eh,null==D?void 0:D.description,null==m||null==(o=m.classNames)?void 0:o.description)},"function"==typeof m.description?m.description():m.description):null),es.default.isValidElement(m.cancel)?m.cancel:m.cancel&&i3(m.cancel)?es.default.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||E,onClick:e=>{!i3(m.cancel)||ed&&(null==m.cancel.onClick||m.cancel.onClick.call(m.cancel,e),e_())},className:i6(null==D?void 0:D.cancelButton,null==m||null==(l=m.classNames)?void 0:l.cancelButton)},m.cancel.label):null,es.default.isValidElement(m.action)?m.action:m.action&&i3(m.action)?es.default.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||R,onClick:e=>{!i3(m.action)||(null==m.action.onClick||m.action.onClick.call(m.action,e),e.defaultPrevented||e_())},className:i6(null==D?void 0:D.actionButton,null==m||null==(c=m.classNames)?void 0:c.actionButton)},m.action.label):null)};function i7(){if("undefined"==typeof window||"undefined"==typeof document)return"ltr";let e=document.documentElement.getAttribute("dir");return"auto"!==e&&e?e:window.getComputedStyle(document.documentElement).direction}let i9=es.default.forwardRef(function(e,t){let{id:r,invert:s,position:n="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:d,theme:u="light",richColors:h,duration:p,style:f,visibleToasts:m=3,toastOptions:g,dir:b=i7(),gap:x=14,icons:y,containerAriaLabel:w="Notifications"}=e,[v,j]=es.default.useState([]),k=es.default.useMemo(()=>r?v.filter(e=>e.toasterId===r):v.filter(e=>!e.toasterId),[v,r]),N=es.default.useMemo(()=>Array.from(new Set([n].concat(k.filter(e=>e.position).map(e=>e.position)))),[k,n]),[S,_]=es.default.useState([]),[C,E]=es.default.useState(!1),[R,A]=es.default.useState(!1),[O,T]=es.default.useState("system"!==u?u:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),I=es.default.useRef(null),M=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),P=es.default.useRef(null),D=es.default.useRef(!1),L=es.default.useCallback(e=>{j(t=>{var r;return(null==(r=t.find(t=>t.id===e.id))?void 0:r.delete)||i2.dismiss(e.id),t.filter(({id:t})=>t!==e.id)})},[]);return es.default.useEffect(()=>i2.subscribe(e=>{e.dismiss?requestAnimationFrame(()=>{j(t=>t.map(t=>t.id===e.id?{...t,delete:!0}:t))}):setTimeout(()=>{sG.default.flushSync(()=>{j(t=>{let r=t.findIndex(t=>t.id===e.id);return -1!==r?[...t.slice(0,r),{...t[r],...e},...t.slice(r+1)]:[e,...t]})})})}),[v]),es.default.useEffect(()=>{if("system"!==u)return void T(u);if("system"===u&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?T("dark"):T("light")),"undefined"==typeof window)return;let e=window.matchMedia("(prefers-color-scheme: dark)");try{e.addEventListener("change",({matches:e})=>{e?T("dark"):T("light")})}catch(t){e.addListener(({matches:e})=>{try{e?T("dark"):T("light")}catch(e){console.error(e)}})}},[u]),es.default.useEffect(()=>{v.length<=1&&E(!1)},[v]),es.default.useEffect(()=>{let e=e=>{var t,r;i.every(t=>e[t]||e.code===t)&&(E(!0),null==(r=I.current)||r.focus()),"Escape"===e.code&&(document.activeElement===I.current||(null==(t=I.current)?void 0:t.contains(document.activeElement)))&&E(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[i]),es.default.useEffect(()=>{if(I.current)return()=>{P.current&&(P.current.focus({preventScroll:!0}),P.current=null,D.current=!1)}},[I.current]),es.default.createElement("section",{ref:t,"aria-label":`${w} ${M}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},N.map((t,r)=>{var n;let i,[u,w]=t.split("-");return k.length?es.default.createElement("ol",{key:t,dir:"auto"===b?i7():b,tabIndex:-1,ref:I,className:l,"data-sonner-toaster":!0,"data-sonner-theme":O,"data-y-position":u,"data-x-position":w,style:{"--front-toast-height":`${(null==(n=S[0])?void 0:n.height)||0}px`,"--width":"356px","--gap":`${x}px`,...f,...(i={},[c,d].forEach((e,t)=>{let r=1===t,s=r?"--mobile-offset":"--offset",n=r?"16px":"24px";function a(e){["top","right","bottom","left"].forEach(t=>{i[`${s}-${t}`]="number"==typeof e?`${e}px`:e})}"number"==typeof e||"string"==typeof e?a(e):"object"==typeof e?["top","right","bottom","left"].forEach(t=>{void 0===e[t]?i[`${s}-${t}`]=n:i[`${s}-${t}`]="number"==typeof e[t]?`${e[t]}px`:e[t]}):a(n)}),i)},onBlur:e=>{D.current&&!e.currentTarget.contains(e.relatedTarget)&&(D.current=!1,P.current&&(P.current.focus({preventScroll:!0}),P.current=null))},onFocus:e=>{!(e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible)&&(D.current||(D.current=!0,P.current=e.relatedTarget))},onMouseEnter:()=>E(!0),onMouseMove:()=>E(!0),onMouseLeave:()=>{R||E(!1)},onDragEnd:()=>E(!1),onPointerDown:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||A(!0)},onPointerUp:()=>A(!1)},k.filter(e=>!e.position&&0===r||e.position===t).map((r,n)=>{var i,l;return es.default.createElement(i8,{key:r.id,icons:y,index:n,toast:r,defaultRichColors:h,duration:null!=(i=null==g?void 0:g.duration)?i:p,className:null==g?void 0:g.className,descriptionClassName:null==g?void 0:g.descriptionClassName,invert:s,visibleToasts:m,closeButton:null!=(l=null==g?void 0:g.closeButton)?l:o,interacting:R,position:t,style:null==g?void 0:g.style,unstyled:null==g?void 0:g.unstyled,classNames:null==g?void 0:g.classNames,cancelButtonStyle:null==g?void 0:g.cancelButtonStyle,actionButtonStyle:null==g?void 0:g.actionButtonStyle,closeButtonAriaLabel:null==g?void 0:g.closeButtonAriaLabel,removeToast:L,toasts:k.filter(e=>e.position==r.position),heights:S.filter(e=>e.position==r.position),setHeights:_,expandByDefault:a,gap:x,expanded:C,swipeDirections:e.swipeDirections})})):null}))}),ae=[{value:"light",label:"Light"},{value:"dark",label:"Dark"},{value:"dynamic",label:"Auto (Day/Night)"}];function at(e){return"light"===e||"dark"===e?e:"dynamic"===e||"system"===e?"dynamic":"dark"}function ar(e,t=new Date){return"dynamic"===e?!function(e=new Date){let t=e.getHours();return t>=19||t<6}(t)?"light":"dark":e}let as=`https://${sB}.supabase.co/functions/v1/make-server-a14c7986`,an=(0,es.createContext)(void 0);function ai(){let e=(0,es.useContext)(an);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}let aa={profileVisibility:"public",whoCanMessage:"everyone",whoCanCall:"friends",showOnlineStatus:!0,showReadReceipts:!0,allowTagging:!0,pushNotifications:!0,emailNotifications:!0,smsNotifications:!1,notifyLikes:!0,notifyComments:!0,notifyMessages:!0,notifyFriendRequests:!0,notifyStories:!1,soundEnabled:!0,soundVolume:75,theme:"dark",language:"en",fontSize:"medium",autoPlayVideos:!0,reduceAnimations:!1,phoneNumber:""},ao={small:"14px",medium:"16px",large:"18px"},al=e=>"small"===e?"small":"medium"===e?"medium":"large",ac=e=>{let t={...e};return t.theme&&(t.theme=at(t.theme)),t.fontSize&&(t.fontSize=al(t.fontSize)),t.language&&(t.language="en"),t},ad=e=>({...aa,...ac(e??{})}),au=e=>{let t=e.joinedAt?new Date(e.joinedAt):new Date;return{id:e.id,ablyClientId:e.ablyClientId??e.id,name:e.name,username:e.username,email:e.email,avatar:e.avatar,bio:e.bio??"",location:e.location??"",website:e.website??"",joinedAt:t,friendIds:Array.isArray(e.friendIds)?e.friendIds:[],blockedIds:Array.isArray(e.blockedIds)?e.blockedIds:[],savedPostIds:Array.isArray(e.savedPostIds)?e.savedPostIds.filter(e=>"string"==typeof e):[],posts:[],achievements:[],settings:ad()}},ah=(e,t)=>{let r=au(e);return{...r,posts:t?.posts??r.posts,achievements:t?.achievements??r.achievements,settings:t?.settings??r.settings}},ap=(e,t)=>{if("object"!=typeof e||null===e)return null;let r=e.id,s=e.postId,n=e.postOwnerId??e.postOwner??t,i=e.authorId;if("string"!=typeof r||0===r.trim().length||"string"!=typeof s||0===s.trim().length||"string"!=typeof n||0===n.trim().length||"string"!=typeof i||0===i.trim().length)return null;let a=e.createdAt,o="string"==typeof a&&a?new Date(a):new Date;return{id:r,postId:s,postOwnerId:n,authorId:i,authorName:"string"==typeof e.authorName&&e.authorName?e.authorName:"Unknown user",authorAvatar:"string"==typeof e.authorAvatar?e.authorAvatar??"":"",content:"string"==typeof e.content?e.content:"",createdAt:o}};function af({children:e}){let[t,r]=(0,es.useState)(null),[s,n]=(0,es.useState)(new Map),[i,a]=(0,es.useState)(null),[o,l]=(0,es.useState)(null),{setTheme:c}=(0,en.useTheme)();(0,es.useEffect)(()=>{(async()=>{try{let e=await fetch(`${as}/users`,{headers:{Authorization:`Bearer ${sz}`}});if(!e.ok)return void console.error("Failed to load users from Supabase");let{users:t}=await e.json();n(e=>{let r=new Map(e);return t.forEach(t=>{let s=au(t),n=e.get(t.id)??(s.ablyClientId?e.get(s.ablyClientId):void 0),i=n?{...s,posts:n.posts,achievements:n.achievements,settings:ad(n.settings)}:s;r.set(i.id,i),i.ablyClientId&&i.ablyClientId!==i.id&&r.set(i.ablyClientId,i)}),r})}catch(e){console.error("Error loading users from Supabase:",e)}})()},[]),(0,es.useEffect)(()=>{let e=at(t?.settings?.theme??aa.theme),r=()=>{c(ar(e))};if(r(),"dynamic"===e){let e=setInterval(r,6e5);return()=>clearInterval(e)}},[t?.settings?.theme,c]),(0,es.useEffect)(()=>{let e=al(t?.settings?.fontSize??aa.fontSize),r="undefined"!=typeof document?document.documentElement:null;r&&r.style.setProperty("--font-size",ao[e])},[t?.settings?.fontSize]),(0,es.useEffect)(()=>{if(!t){a(null),l(null);return}i&&i!==t.id||(a(t.id),l(t))},[t,i]);let d=(0,es.useCallback)(e=>{let t=[],r=new Date,n=r.getTime()-e.joinedAt.getTime();Array.from(s.values()).sort((e,t)=>e.joinedAt.getTime()-t.joinedAt.getTime()).slice(0,100).some(t=>t.id===e.id)&&t.push({id:"early-adopter",name:"Early Adopter",description:"One of the first 100 users on MoveSplash",earnedAt:e.joinedAt,icon:"Award",color:"from-purple-500 to-pink-500"}),e.posts.length>=50&&t.push({id:"top-contributor",name:"Top Contributor",description:"Created over 50 posts",earnedAt:e.posts[49]?.timestamp||r,icon:"TrendingUp",color:"from-orange-500 to-yellow-500"});let i=e.posts.filter(e=>e.media&&e.media.length>0);return i.length>=30&&t.push({id:"story-master",name:"Story Master",description:"Shared 30+ posts with photos or videos",earnedAt:i[29]?.timestamp||r,icon:"Camera",color:"from-blue-500 to-cyan-500"}),e.friendIds.length>=100&&t.push({id:"super-friend",name:"Super Friend",description:"Connected with over 100 friends",earnedAt:r,icon:"Users",color:"from-green-500 to-emerald-500"}),e.posts.reduce((e,t)=>e+t.likes,0)>=1e3&&t.push({id:"rising-star",name:"Rising Star",description:"Received over 1000 likes",earnedAt:r,icon:"Star",color:"from-yellow-500 to-orange-500"}),e.posts.reduce((e,t)=>e+t.comments,0)>=500&&t.push({id:"conversation-starter",name:"Conversation Starter",description:"Generated over 500 comments",earnedAt:r,icon:"MessageCircle",color:"from-cyan-500 to-blue-500"}),e.posts.some(e=>e.likes>=500)&&t.push({id:"viral-creator",name:"Viral Creator",description:"Created a post with 500+ likes",earnedAt:e.posts.find(e=>e.likes>=500)?.timestamp||r,icon:"Zap",color:"from-pink-500 to-purple-500"}),n/864e5>=30&&e.posts.length>=30&&t.push({id:"consistent-creator",name:"Consistent Creator",description:"Posted consistently for 30+ days",earnedAt:r,icon:"Calendar",color:"from-indigo-500 to-purple-500"}),t},[s]);(0,es.useEffect)(()=>{if(!t)return;let e=d(t),s=t.achievements;s.length===e.length&&s.every((t,r)=>t.id===e[r]?.id)||(r(t=>t?{...t,achievements:e}:null),n(r=>{let s=new Map(r),n=s.get(t.id);if(n){let r={...n,achievements:e};s.set(t.id,r),n.ablyClientId&&n.ablyClientId!==n.id&&s.set(n.ablyClientId,r)}return s}))},[t,d]);let u=async e=>{if(!t)return!1;let s={...t,...e};r(s),n(e=>{let t=new Map(e);return t.set(s.id,s),s.ablyClientId&&s.ablyClientId!==s.id&&t.set(s.ablyClientId,s),t});try{let e=await fetch(`${as}/users/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({name:s.name,username:s.username,email:s.email,avatar:s.avatar,bio:s.bio,location:s.location,website:s.website,joinedAt:s.joinedAt.toISOString(),friendIds:s.friendIds,blockedIds:s.blockedIds})}),i=await e.json().catch(()=>null);if(!e.ok||!i?.user)return console.error("Failed to sync user data to server"),r(t),n(e=>{let r=new Map(e);return r.set(t.id,t),t.ablyClientId&&t.ablyClientId!==t.id&&r.set(t.ablyClientId,t),r}),!1;let a=i.user,o=au(a),l={...s,name:o.name,username:o.username,email:o.email,avatar:o.avatar,bio:o.bio,location:o.location,website:o.website,joinedAt:o.joinedAt,friendIds:o.friendIds,blockedIds:o.blockedIds};return r(l),n(e=>{let t=new Map(e);return t.set(l.id,l),l.ablyClientId&&l.ablyClientId!==l.id&&t.set(l.ablyClientId,l),t}),!0}catch(e){return console.error("Error syncing user data:",e),r(t),n(e=>{let r=new Map(e);return r.set(t.id,t),t.ablyClientId&&t.ablyClientId!==t.id&&r.set(t.ablyClientId,t),r}),!1}},h=async e=>{if(t){let s=ac(e),i={...t.settings,...s},a={...t,settings:i};r(a),n(e=>{let t=new Map(e);return t.set(a.id,a),t});try{(await fetch(`${as}/users/${t.id}/settings`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify(i)})).ok||console.error("Failed to sync settings to server")}catch(e){console.error("Error syncing settings:",e)}}},p=async(e,r)=>{if(!t)return{success:!1,error:"No user is signed in"};try{let s=await fetch(`${as}/auth/change-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({userId:t.id,oldPassword:e,newPassword:r})}),n=await s.json().catch(()=>({}));if(!s.ok||n?.success!==!0){let e="string"==typeof n?.error&&n.error.trim().length>0?n.error:"Unable to change password right now";return{success:!1,error:e}}return{success:!0}}catch(e){return console.error("Error changing password:",e),{success:!1,error:"Unexpected error while updating password"}}},f=async e=>{if(t){let s={...e,id:`${t.id}-post-${Date.now()}`,userId:t.id,timestamp:new Date,likes:0,comments:0,shares:0,likedBy:[]},i={...t,posts:[s,...t.posts]};r(i),n(e=>{let t=new Map(e);return t.set(i.id,i),t});try{await fetch(`${as}/posts`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({userId:t.id,text:e.text,media:e.media})})}catch(e){console.error("Error syncing post:",e)}}},m=async e=>{if(t){let s={...t,posts:t.posts.filter(t=>t.id!==e)};r(s),n(e=>{let t=new Map(e);return t.set(s.id,s),t});try{await fetch(`${as}/posts/${t.id}/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${sz}`}})}catch(e){console.error("Error deleting post:",e)}}},g=async(e,s)=>{let a=null;n(n=>{let o=new Map(n);return o.forEach((n,l)=>{let c=n.posts.findIndex(t=>t.id===e);if(-1!==c){let d=n.posts[c],u=d.likedBy.includes(s),h={...d,likes:u?d.likes-1:d.likes+1,likedBy:u?d.likedBy.filter(e=>e!==s):[...d.likedBy,s]},p=[...n.posts];p[c]=h;let f={...n,posts:p};o.set(l,f),t&&l===t.id&&r(f),i&&(l===i||n.ablyClientId===i)&&(a=f),fetch(`${as}/posts/${n.id}/${e}/like`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({likerUserId:s})}).catch(e=>console.error("Error syncing like:",e))}}),o}),a&&l(a)},b=async(e,s,a)=>{let o={platform:a.platform,sharerUserId:a.sharerUserId??t?.id??"",message:a.message??""};try{let a=await fetch(`${as}/posts/${e}/${s}/share`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify(o)}),c=await a.json().catch(()=>null);if(!a.ok||!c?.post){if(404!==a.status){let e=c?.error??`status ${a.status}`;return console.error("Error recording share:",e),null}let t=await fetch(`${as}/shares`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({...o,postOwnerId:e,postId:s})});if(c=await t.json().catch(()=>null),!t.ok||!c?.post){let e=c?.error??`status ${t.status}`;return console.error("Error recording share (fallback):",e),null}}let d=c.post,u=d?.shares,h="number"==typeof u&&Number.isFinite(u)?u:null,p=h,f=null,m=null;n(t=>{let r=new Map(t),n=r.get(e);if(!n)return t;let a=n.posts.findIndex(e=>e.id===s);if(-1===a)return t;let o=[...n.posts],l=o[a],c=h??l.shares+1;p=c,o[a]={...l,shares:c};let d={...n,posts:o};return f=d,r.set(d.id,d),d.ablyClientId&&d.ablyClientId!==d.id&&r.set(d.ablyClientId,d),i&&(d.id===i||d.ablyClientId===i)&&(m=d),r});let g=f,b=g?g.id:null;return g&&b&&t&&t.id===b&&r(g),m&&l(m),p??h??null}catch(e){return console.error("Error sharing post:",e),null}},x=async(e,s)=>{if(!t)throw console.warn("toggleSavePost requires a logged-in user"),Error("User must be signed in to save posts");let i=t.id,a=`${e}:${s}`,o=Array.isArray(t.savedPostIds)?t.savedPostIds:[],c=o.includes(a)?o.filter(e=>e!==a):[...o,a],d=e=>{r(t=>t&&t.id===i?{...t,savedPostIds:e}:t),n(r=>{let s=new Map(r),n=s.get(i)??(t&&t.id===i?t:null);if(n){let t={...n,savedPostIds:e};s.set(n.id,t),n.ablyClientId&&n.ablyClientId!==n.id&&s.set(n.ablyClientId,t)}return s}),l(t=>t&&(t.id===i||t.ablyClientId===i)?{...t,savedPostIds:e}:t)};d(c);let u=e=>Array.isArray(e)?e.filter(e=>"string"==typeof e):c,h=async(e,t)=>{let r=await fetch(e,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify(t)}),s=await r.json().catch(()=>null);if(!r.ok||!s?.success){let e=Error(s?.error??`status ${r.status}`);throw e.status=r.status,e}return u(s.savedPostIds)},p=async e=>{let t=await fetch(`${as}/users/${i}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({savedPostIds:e})}),r=await t.json().catch(()=>null);if(!t.ok||!r?.user){let e=Error(r?.error??`status ${t.status}`);throw e.status=t.status,e}return u(r.user.savedPostIds)};try{let t=await h(`${as}/posts/${e}/${s}/bookmark`,{userId:i});return d(t),t.includes(a)}catch(t){if(404===t.status||405===t.status)try{let t=await h(`${as}/bookmarks`,{userId:i,postOwnerId:e,postId:s});return d(t),t.includes(a)}catch(e){if(404===e.status||405===e.status)try{let e=await p(c);return d(e),e.includes(a)}catch(e){throw d(o),console.error("Error persisting saved posts via user update:",e),e instanceof Error?e:Error(String(e))}throw d(o),console.error("Error toggling saved post (fallback):",e),e instanceof Error?e:Error(String(e))}throw d(o),console.error("Error toggling saved post:",t),t instanceof Error?t:Error(String(t))}},y=async(e,t)=>{let r={Authorization:`Bearer ${sz}`},s=async t=>{let r=await t.json().catch(()=>null);if(!t.ok)throw Error(r?.error??`status ${t.status}`);return(Array.isArray(r?.comments)?r.comments:[]).map(t=>ap(t,e)).filter(e=>!!e).sort((e,t)=>e.createdAt.getTime()-t.createdAt.getTime())};try{let n=new URLSearchParams({ownerId:e,postId:t}),i=await fetch(`${as}/comments?${n.toString()}`,{headers:r});try{return await s(i)}catch(a){if(404!==i.status)throw a instanceof Error?a:Error(String(a));let n=await fetch(`${as}/posts/${e}/${t}/comments`,{headers:r});return await s(n)}}catch(e){return console.error("Error fetching comments:",e),[]}},w=async(e,s,a)=>{if(!t)return console.warn("addComment requires a logged-in user"),null;let o=a.trim();if(!o)return null;try{let a=await fetch(`${as}/comments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({postOwnerId:e,postId:s,authorId:t.id,content:o})}),c=await a.json().catch(()=>null);if(!a.ok||!c?.comment){if(404!==a.status){let e=c?.error??`status ${a.status}`;return console.error("Error creating comment:",e),null}let r=await fetch(`${as}/posts/${e}/${s}/comments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({authorId:t.id,content:o})});if(c=await r.json().catch(()=>null),!r.ok||!c?.comment){let e=c?.error??`status ${r.status}`;return console.error("Error creating comment (fallback):",e),null}}let d=ap(c.comment,e);if(!d)return null;let u=c.post,h=u?.comments,p="number"==typeof h&&Number.isFinite(h)?h:null,f=p,m=null,g=null;n(t=>{let r=new Map(t),n=r.get(e);if(!n)return t;let a=n.posts.findIndex(e=>e.id===s);if(-1===a)return t;let o=[...n.posts],l=o[a],c=p??l.comments+1;f=c,o[a]={...l,comments:c};let d={...n,posts:o};return m=d,r.set(d.id,d),d.ablyClientId&&d.ablyClientId!==d.id&&r.set(d.ablyClientId,d),i&&(d.id===i||d.ablyClientId===i)&&(g=d),r});let b=m,x=b?b.id:null;b&&x&&t.id===x&&r(b),g&&l(g);let y=null!=f?f:null!=p?p:1;return{comment:d,totalComments:y}}catch(e){return console.error("Error adding comment:",e),null}},v=async e=>{if(!t||e===t.id)return console.warn("addFriend requires a different logged-in user"),!1;try{let s=await fetch(`${as}/friends/${t.id}/${e}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({actorName:t.name,actorAvatar:t.avatar})}),i=await s.json().catch(()=>null);if(!s.ok||!i?.currentUser){let e=i?.error??`status ${s.status}`;return console.error("Error adding friend:",e),!1}let a=ah(i.currentUser,t);return r(a),n(e=>{let t=new Map(e);t.set(a.id,a);let r=i.targetUser;if(r){let s=e.get(r.id),n=ah(r,s);t.set(n.id,n)}return t}),E(),!0}catch(e){return console.error("Error adding friend:",e),!1}},j=async e=>{if(!t||e===t.id)return!1;try{let s=await fetch(`${as}/friends/${t.id}/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${sz}`}}),i=await s.json().catch(()=>null);if(!s.ok||!i?.currentUser){let e=i?.error??`status ${s.status}`;return console.error("Error removing friend:",e),!1}let a=ah(i.currentUser,t);return r(a),n(e=>{let t=new Map(e);t.set(a.id,a);let r=i.targetUser;if(r){let s=e.get(r.id),n=ah(r,s);t.set(n.id,n)}return t}),E(),!0}catch(e){return console.error("Error removing friend:",e),!1}},k=async e=>{if(!t||e===t.id)return!1;try{let s=await fetch(`${as}/blocks/${t.id}/${e}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({})}),i=await s.json().catch(()=>null);if(!s.ok||!i?.currentUser){let e=i?.error??`status ${s.status}`;return console.error("Error blocking user:",e),!1}let a=ah(i.currentUser,t);return r(a),n(e=>{let t=new Map(e);t.set(a.id,a);let r=i.targetUser;if(r){let s=e.get(r.id),n=ah(r,s);t.set(n.id,n)}return t}),E(),!0}catch(e){return console.error("Error blocking user:",e),!1}},N=async e=>{if(!t||e===t.id)return!1;try{let s=await fetch(`${as}/blocks/${t.id}/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${sz}`}}),i=await s.json().catch(()=>null);if(!s.ok||!i?.currentUser){let e=i?.error??`status ${s.status}`;return console.error("Error unblocking user:",e),!1}let a=ah(i.currentUser,t);return r(a),n(e=>{let t=new Map(e);return t.set(a.id,a),t}),E(),!0}catch(e){return console.error("Error unblocking user:",e),!1}},S=(0,es.useCallback)(async e=>{try{let t=await fetch(`${as}/users/${e}`,{headers:{Authorization:`Bearer ${sz}`}});if(!t.ok)return null;let{user:r}=await t.json(),s=await fetch(`${as}/users/${e}/settings`,{headers:{Authorization:`Bearer ${sz}`}}),n=ad();if(s.ok){let{settings:e}=await s.json();n=ad(e)}let i=await fetch(`${as}/users/${e}/posts`,{headers:{Authorization:`Bearer ${sz}`}}),a=[];if(i.ok){let{posts:e}=await i.json();a=e.map(e=>({...e,timestamp:new Date(e.timestamp)}))}return{...r,ablyClientId:r.ablyClientId??r.id,bio:r.bio??"",location:r.location??"",website:r.website??"",joinedAt:new Date(r.joinedAt??new Date().toISOString()),friendIds:Array.isArray(r.friendIds)?r.friendIds:[],blockedIds:Array.isArray(r.blockedIds)?r.blockedIds:[],savedPostIds:Array.isArray(r.savedPostIds)?r.savedPostIds.filter(e=>"string"==typeof e):[],posts:a,settings:n,achievements:[]}}catch(e){return console.error("Error fetching user snapshot:",e),null}},[]),_=async e=>{try{let t=await S(e);if(!t)return!1;return r(t),n(e=>{let r=new Map(e);return r.set(t.id,t),t.ablyClientId&&t.ablyClientId!==t.id&&r.set(t.ablyClientId,t),r}),i&&i!==t.id||(a(t.id),l(t)),!0}catch(e){return console.error("Error loading user data:",e),!1}},C=(0,es.useCallback)(async e=>{if(!e)return t?(a(t.id),l(t),!0):(a(null),l(null),!1);if(t&&e===t.id)return a(t.id),l(t),!0;let r=await S(e);return!!r&&(a(r.id),l(r),n(e=>{let t=new Map(e);return t.set(r.id,r),r.ablyClientId&&r.ablyClientId!==r.id&&t.set(r.ablyClientId,r),t}),!0)},[t,S]),E=(0,es.useCallback)(async()=>{try{let e=await fetch(`${as}/users`,{headers:{Authorization:`Bearer ${sz}`}});if(!e.ok)throw Error(`status ${e.status}`);let t=await e.json().catch(()=>null),s=Array.isArray(t?.users)?t.users:[];n(e=>{let t=new Map;return s.forEach(r=>{if("object"!=typeof r||null===r)return;let s=e.get(r.id),n=ah(r,s);t.set(n.id,n),n.ablyClientId&&n.ablyClientId!==n.id&&t.set(n.ablyClientId,n)}),e.forEach((e,r)=>{t.has(r)||t.set(r,e)}),t}),r(e=>{if(!e)return e;let t=s.find(t=>"object"==typeof t&&null!==t&&t.id===e.id);if(!t)return e;let r=ah(t,e),n=[...e.friendIds].sort(),i=[...r.friendIds].sort(),a=n.length===i.length&&n.every((e,t)=>e===i[t]),o=[...e.blockedIds].sort(),l=[...r.blockedIds].sort(),c=o.length===l.length&&o.every((e,t)=>e===l[t]);return a&&c?e:r})}catch(e){console.error("Error refreshing users:",e)}},[]);(0,es.useEffect)(()=>{E()},[E]);let R=async(e,t)=>{try{console.log("[Login] Attempting login for:",e);let s=await fetch(`${as}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({email:e,password:t})}),i=await s.json().catch(()=>null);if(console.log("[Login] Server response status:",s.status),!s.ok||!i?.user){let e=i?.error??`status ${s.status}`;return console.log("[Login]  Server login failed:",e),!1}let a=i.user;if(console.log("[Login]  Server login successful for:",a.name),!await _(a.id)){console.warn("[Login]  Using normalized login payload while Supabase details load");let e=au(a);r(e),n(t=>{let r=new Map(t);return r.set(e.id,e),e.ablyClientId&&e.ablyClientId!==e.id&&r.set(e.ablyClientId,e),r})}return!0}catch(e){return console.error("[Login] Error during login:",e),!1}},A=async(e,t,s,i)=>{try{let a=await fetch(`${as}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({name:e,email:t,password:s,birthdate:i})}),o=await a.json().catch(()=>null);if(!a.ok||!o?.user){let e=o?.error??`status ${a.status}`;return console.error("Registration failed:",e),!1}let l=o.user,c=o.settings;if(!await _(l.id)){let e={...au(l),settings:ad(c)};r(e),n(t=>{let r=new Map(t);return r.set(e.id,e),e.ablyClientId&&e.ablyClientId!==e.id&&r.set(e.ablyClientId,e),r})}return console.log("User registered successfully:",l.email),!0}catch(e){return console.error("Signup error:",e),!1}};return(0,er.jsx)(an.Provider,{value:{currentUser:t,profileUser:o,profileUserId:i,allUsers:s,updateUser:u,updateSettings:h,changePassword:p,addPost:f,deletePost:m,likePost:g,sharePost:b,toggleSavePost:x,fetchComments:y,addComment:w,addFriend:v,removeFriend:j,blockUser:k,unblockUser:N,refreshAllUsers:E,getUserStats:()=>{if(!t)return{totalPosts:0,totalFriends:0,totalLikes:0,rank:0};let e=t.posts.length,r=t.friendIds.length;return{totalPosts:e,totalFriends:r,totalLikes:t.posts.reduce((e,t)=>e+t.likes,0),rank:Array.from(s.values()).map(e=>({id:e.id,score:10*e.posts.length+e.posts.reduce((e,t)=>e+t.likes,0)+5*e.friendIds.length})).sort((e,t)=>t.score-e.score).findIndex(e=>e.id===t.id)+1}},getAchievements:()=>t?d(t):[],login:R,signup:A,logout:()=>{r(null)},loadUserData:_,loadProfileUser:C},children:e})}let am=`https://${sB}.supabase.co/functions/v1/make-server-a14c7986`,ag=e=>({id:e.id,type:e.type,user:{name:e.actorName,avatar:e.actorAvatar},content:e.content,createdAt:e.createdAt,isRead:e.isRead,actionRequired:e.actionRequired}),ab=e=>{let t=new Date(e);if(Number.isNaN(t.getTime()))return"";let r=Math.floor((Date.now()-t.getTime())/6e4);if(r<=0)return"Just now";if(r<60)return`${r}m ago`;let s=Math.floor(r/60);if(s<24)return`${s}h ago`;let n=Math.floor(s/24);return n<7?`${n}d ago`:t.toLocaleDateString()};function ax({onNavigate:e}){let{currentUser:t}=ai(),[r,s]=(0,es.useState)(!1),n=(0,es.useRef)(null),i=(0,es.useRef)(null),a=(0,es.useRef)(null),[o,l]=(0,es.useState)([]),[c,d]=(0,es.useState)(!1),[u,h]=(0,es.useState)(null),p=(0,es.useMemo)(()=>t?{"Content-Type":"application/json",Authorization:`Bearer ${sz}`}:null,[t]),f=o.filter(e=>!e.isRead).length,m=!!(t&&p),g=o.length>0,b=f>0,x=(0,es.useCallback)(async()=>{if(!t||!p){l([]),d(!1);return}a.current&&a.current.abort();let e=new AbortController;a.current=e,d(!0),h(null);try{let r=await fetch(`${am}/notifications/${t.id}`,{headers:p,signal:e.signal});if(!r.ok)throw Error("Failed to load notifications");let s=await r.json().catch(()=>({})),n=Array.isArray(s?.notifications)?s.notifications:[];l(n.map(ag))}catch(e){if("AbortError"===e.name)return;console.error("Error loading notifications:",e),h("Unable to load notifications right now.")}finally{e.signal.aborted||d(!1)}},[t,p]);(0,es.useEffect)(()=>{x()},[x]),(0,es.useEffect)(()=>()=>{a.current?.abort()},[]);let y=(0,es.useCallback)(()=>{x()},[x]),w=e=>{switch(e){case"like":return(0,er.jsx)(tm,{className:"w-4 h-4 text-pink-500"});case"comment":return(0,er.jsx)(td,{className:"w-4 h-4 text-blue-500"});case"friend_request":return(0,er.jsx)(iF,{className:"w-4 h-4 text-green-500"});case"message":return(0,er.jsx)(td,{className:"w-4 h-4 text-purple-500"});case"video_call":return(0,er.jsx)(tu,{className:"w-4 h-4 text-orange-500"});case"story":return(0,er.jsx)(tg,{className:"w-4 h-4 text-yellow-500"});case"share":return(0,er.jsx)(tf,{className:"w-4 h-4 text-cyan-500"});default:return(0,er.jsx)(iq,{className:"w-4 h-4 text-white"})}},v=(0,es.useCallback)(async e=>{if(l(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t)),t&&p)try{await fetch(`${am}/notifications/${t.id}/${e}`,{method:"PUT",headers:p,body:JSON.stringify({isRead:!0})})}catch(e){console.error("Error marking notification as read:",e)}},[p,t]),j=(0,es.useCallback)(async()=>{if(!b)return void i5.info("No unread notifications.");if(l(e=>e.map(e=>({...e,isRead:!0}))),!t||!p)return void i5.info("Sign in to sync notification status.");try{await fetch(`${am}/notifications/${t.id}/mark-all-read`,{method:"POST",headers:p}),i5.success("All notifications marked as read")}catch(e){console.error("Error marking all as read:",e),i5.error("Unable to update notifications right now.")}},[p,t,b]),k=(0,es.useCallback)(async()=>{if(!g)return void i5.info("No notifications to clear.");if(l([]),!t||!p)return void i5.info("Sign in to clear notifications.");try{await fetch(`${am}/notifications/${t.id}`,{method:"DELETE",headers:p}),i5.success("All notifications cleared")}catch(e){console.error("Error clearing notifications:",e),i5.error("Unable to clear notifications at the moment.")}},[p,t,g]),N=(0,es.useCallback)(async e=>{await v(e),i5.success("Friend request accepted! ")},[v]),S=(0,es.useCallback)(async e=>{if(l(t=>t.filter(t=>t.id!==e)),t&&p)try{await fetch(`${am}/notifications/${t.id}/${e}`,{method:"DELETE",headers:p})}catch(e){console.error("Error deleting friend request notification:",e)}i5.success("Friend request declined")},[p,t]),_=(0,es.useCallback)(t=>{v(t.id),"message"===t.type&&e?(e("messages"),s(!1)):"video_call"===t.type&&e?(e("video"),s(!1)):"story"===t.type&&e?(e("stories"),s(!1)):"friend_request"===t.type&&e&&(e("friends"),s(!1))},[v,e]),C=o.filter(e=>!e.isRead);return(0,es.useEffect)(()=>{let e=e=>{n.current&&!n.current.contains(e.target)&&i.current&&!i.current.contains(e.target)&&s(!1)};return r&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[r]),(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsxs)(tn,{ref:i,variant:"ghost",size:"sm",onClick:()=>s(!r),className:"relative text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(iq,{className:"w-5 h-5"}),f>0&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)("span",{className:"absolute top-1 right-1 w-2 h-2 bg-pink-500 rounded-full animate-pulse"}),(0,er.jsx)(iz,{className:"absolute -top-2 -right-2 bg-gradient-to-r from-pink-500 to-purple-500 text-white border-0 text-xs h-5 min-w-5 flex items-center justify-center",children:f})]})]}),r&&(0,er.jsxs)("div",{ref:n,className:"fixed right-6 top-16 w-96 p-0 backdrop-blur-xl bg-gradient-to-br from-purple-900/95 to-pink-900/95 border-white/20 border rounded-lg shadow-2xl z-[9999] animate-in fade-in slide-in-from-top-2 duration-200",children:[(0,er.jsx)("div",{className:"p-4 border-b border-white/20",children:(0,er.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,er.jsx)("h3",{className:"text-white text-lg",children:"Notifications"}),(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:y,disabled:c,className:"text-xs text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-50",children:"Refresh"}),b&&(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:j,disabled:!m||c,className:"text-xs text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-50",children:"Mark all read"}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:k,disabled:!m||!g||c,className:"text-xs text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-50",children:"Clear all"})]})]})}),(0,er.jsxs)(iD,{defaultValue:"all",className:"w-full",children:[(0,er.jsxs)(iL,{className:"w-full bg-white/10 border-white/20 mx-4 my-2 w-[calc(100%-2rem)]",children:[(0,er.jsxs)(i$,{value:"all",className:"flex-1 data-[state=active]:bg-white/20 text-white",children:["All (",o.length,")"]}),(0,er.jsxs)(i$,{value:"unread",className:"flex-1 data-[state=active]:bg-white/20 text-white",children:["Unread (",f,")"]})]}),(0,er.jsx)(iU,{value:"all",className:"mt-0",children:c?(0,er.jsxs)("div",{className:"h-[400px] flex items-center justify-center text-white/70 gap-2",children:[(0,er.jsx)(iV,{className:"w-4 h-4 animate-spin"}),"Syncing notifications..."]}):u?(0,er.jsxs)("div",{className:"h-[400px] flex flex-col items-center justify-center text-center px-6 gap-3",children:[(0,er.jsx)("p",{className:"text-white/80",children:u}),(0,er.jsx)(tn,{size:"sm",variant:"outline",onClick:()=>x(),className:"bg-white/10 border-white/30 text-white hover:bg-white/20",children:"Retry"})]}):t?(0,er.jsx)(nG,{className:"h-[400px]",children:(0,er.jsx)("div",{className:"space-y-1 py-2",children:0===o.length?(0,er.jsxs)("div",{className:"text-center py-12",children:[(0,er.jsx)(iq,{className:"w-12 h-12 text-white/30 mx-auto mb-3"}),(0,er.jsx)("p",{className:"text-white/50",children:"No notifications"})]}):o.map(e=>(0,er.jsx)("div",{onClick:()=>_(e),className:`p-3 cursor-pointer transition-all hover:bg-white/10 ${!e.isRead?"bg-white/5":""}`,children:(0,er.jsxs)("div",{className:"flex gap-3",children:[(0,er.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,er.jsxs)(s8,{className:"w-10 h-10 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:e.user.avatar}),(0,er.jsx)(s9,{children:e.user.name[0]})]}),(0,er.jsx)("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-gradient-to-br from-purple-900 to-pink-900 rounded-full flex items-center justify-center border border-white/20",children:w(e.type)})]}),(0,er.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,er.jsxs)("p",{className:"text-white text-sm",children:[(0,er.jsx)("span",{className:"font-medium",children:e.user.name})," ",(0,er.jsx)("span",{className:"text-white/70",children:e.content})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,er.jsx)(iG,{className:"w-3 h-3 text-white/40"}),(0,er.jsx)("span",{className:"text-white/50 text-xs",children:ab(e.createdAt)}),!e.isRead&&(0,er.jsx)("div",{className:"w-2 h-2 bg-pink-500 rounded-full"})]}),e.actionRequired&&"friend_request"===e.type&&(0,er.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,er.jsxs)(tn,{size:"sm",onClick:t=>{t.stopPropagation(),N(e.id)},className:"flex-1 bg-green-500 hover:bg-green-600 text-white border-0",children:[(0,er.jsx)(iW,{className:"w-3 h-3 mr-1"}),"Accept"]}),(0,er.jsxs)(tn,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),S(e.id)},className:"flex-1 text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(iH,{className:"w-3 h-3 mr-1"}),"Decline"]})]})]})]})},e.id))})}):(0,er.jsx)("div",{className:"h-[400px] flex flex-col items-center justify-center text-center px-6 gap-3 text-white/70",children:(0,er.jsx)("p",{children:"Sign in to view your notifications."})})}),(0,er.jsx)(iU,{value:"unread",className:"mt-0",children:c?(0,er.jsxs)("div",{className:"h-[400px] flex items-center justify-center text-white/70 gap-2",children:[(0,er.jsx)(iV,{className:"w-4 h-4 animate-spin"}),"Syncing notifications..."]}):u?(0,er.jsxs)("div",{className:"h-[400px] flex flex-col items-center justify-center text-center px-6 gap-3",children:[(0,er.jsx)("p",{className:"text-white/80",children:u}),(0,er.jsx)(tn,{size:"sm",variant:"outline",onClick:()=>x(),className:"bg-white/10 border-white/30 text-white hover:bg-white/20",children:"Retry"})]}):t?(0,er.jsx)(nG,{className:"h-[400px]",children:(0,er.jsx)("div",{className:"space-y-1 py-2",children:0===C.length?(0,er.jsxs)("div",{className:"text-center py-12",children:[(0,er.jsx)(iW,{className:"w-12 h-12 text-white/30 mx-auto mb-3"}),(0,er.jsx)("p",{className:"text-white/50",children:"All caught up!"})]}):C.map(e=>(0,er.jsx)("div",{onClick:()=>_(e),className:"p-3 cursor-pointer transition-all hover:bg-white/10 bg-white/5",children:(0,er.jsxs)("div",{className:"flex gap-3",children:[(0,er.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,er.jsxs)(s8,{className:"w-10 h-10 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:e.user.avatar}),(0,er.jsx)(s9,{children:e.user.name[0]})]}),(0,er.jsx)("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-gradient-to-br from-purple-900 to-pink-900 rounded-full flex items-center justify-center border border-white/20",children:w(e.type)})]}),(0,er.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,er.jsxs)("p",{className:"text-white text-sm",children:[(0,er.jsx)("span",{className:"font-medium",children:e.user.name})," ",(0,er.jsx)("span",{className:"text-white/70",children:e.content})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,er.jsx)(iG,{className:"w-3 h-3 text-white/40"}),(0,er.jsx)("span",{className:"text-white/50 text-xs",children:ab(e.createdAt)}),(0,er.jsx)("div",{className:"w-2 h-2 bg-pink-500 rounded-full"})]}),e.actionRequired&&"friend_request"===e.type&&(0,er.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,er.jsxs)(tn,{size:"sm",onClick:t=>{t.stopPropagation(),N(e.id)},className:"flex-1 bg-green-500 hover:bg-green-600 text-white border-0",children:[(0,er.jsx)(iW,{className:"w-3 h-3 mr-1"}),"Accept"]}),(0,er.jsxs)(tn,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),S(e.id)},className:"flex-1 text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(iH,{className:"w-3 h-3 mr-1"}),"Decline"]})]})]})]})},e.id))})}):(0,er.jsx)("div",{className:"h-[400px] flex flex-col items-center justify-center text-center px-6 gap-3 text-white/70",children:(0,er.jsx)("p",{children:"Sign in to view your notifications."})})})]})]})]})}let ay=tc("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),aw=tc("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),av=tc("log-out",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);function aj({currentView:e,onNavigate:t,onLogout:r,onOpenSettings:s}){let{resolvedTheme:n}=(0,en.useTheme)(),i="light"===n,a=[{id:"feed",icon:ay,label:"Feed"},{id:"messages",icon:td,label:"Messages",badge:5},{id:"video",icon:tu,label:"Video"},{id:"friends",icon:th,label:"Friends"},{id:"stories",icon:tg,label:"Stories",badge:3}],o=i?"bg-white/90 text-slate-900 shadow-sm":"bg-white/20 text-white",l=i?"text-slate-600 hover:text-slate-900 hover:bg-white/70":"text-white/60 hover:text-white hover:bg-white/10",c=i?"text-slate-600 hover:text-slate-900 hover:bg-white/70 transition-colors duration-200":"text-white/70 hover:text-white hover:bg-white/10 transition-colors duration-200",d=i?"text-slate-800":"text-white";return(0,er.jsx)("nav",{className:tr("backdrop-blur-xl border-b sticky top-0 z-50 transition-colors duration-300",i?"bg-white/80 border-slate-200":"bg-white/10 border-white/20"),children:(0,er.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-4",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-500 rounded-2xl flex items-center justify-center",children:(0,er.jsx)(tp,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("span",{className:tr("text-xl hidden md:block font-semibold transition-colors",d),children:"MoveSplash"})]}),(0,er.jsx)("div",{className:"flex items-center gap-2",children:a.map(r=>(0,er.jsxs)("button",{onClick:()=>t(r.id),className:tr("relative px-4 py-2 rounded-xl flex items-center gap-2 transition-all",e===r.id?o:l),children:[(0,er.jsx)(r.icon,{className:"w-5 h-5"}),(0,er.jsx)("span",{className:"hidden md:inline",children:r.label}),r.badge&&r.badge>0&&(0,er.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full flex items-center justify-center text-white text-xs",children:r.badge})]},r.id))}),(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(ax,{onNavigate:t}),(0,er.jsx)(tn,{variant:"ghost",size:"sm",onClick:s,className:c,children:(0,er.jsx)(aw,{className:"w-5 h-5"})}),(0,er.jsx)("div",{className:tr("w-px h-6 mx-2 transition-colors duration-300",i?"bg-slate-200":"bg-white/20")}),(0,er.jsxs)("button",{onClick:()=>t("profile"),className:tr("flex items-center gap-2 rounded-xl px-2 py-1 transition-colors",i?"hover:bg-white/70":"hover:bg-white/10"),children:[(0,er.jsxs)(s8,{className:tr("w-8 h-8 border-2",i?"border-slate-200":"border-white/20"),children:[(0,er.jsx)(s7,{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=You"}),(0,er.jsx)(s9,{children:"You"})]}),(0,er.jsx)("span",{className:tr("hidden md:inline transition-colors",d),children:"You"})]}),(0,er.jsx)(tn,{variant:"ghost",size:"sm",onClick:r,className:c,children:(0,er.jsx)(av,{className:"w-5 h-5"})})]})]})})})}function ak({className:e,...t}){return(0,er.jsx)("div",{"data-slot":"card",className:tr("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",e),...t})}function aN({className:e,...t}){return(0,er.jsx)("textarea",{"data-slot":"textarea",className:tr("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}let aS=tc("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),a_=tc("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),aC=tc("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),aE=tc("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),aR=tc("bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]),aA={"Smileys & Emotion":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"Gestures & Hands":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"Hearts & Love":["","","","","","","","","","","","","","","","","","","","","","","","","","",""],"Celebration & Party":["","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"Activities & Sports":["","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"Food & Drink":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"Nature & Animals":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"Travel & Places":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"Objects & Symbols":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]};function aO({onSelect:e}){return(0,er.jsx)("div",{className:"w-80 backdrop-blur-xl bg-gradient-to-br from-purple-900/90 to-pink-900/90 border border-white/20 rounded-2xl p-0",children:(0,er.jsx)(nG,{className:"h-96",children:(0,er.jsx)("div",{className:"p-4 space-y-4",children:Object.entries(aA).map(([t,r])=>(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-white/70 text-sm mb-2 px-1",children:t}),(0,er.jsx)("div",{className:"grid grid-cols-8 gap-1",children:r.map((t,r)=>(0,er.jsx)("button",{onClick:()=>e(t),className:"text-2xl hover:scale-125 transition-transform p-2 hover:bg-white/10 rounded-lg",children:t},r))})]},t))})})})}function aT(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function aI(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function aM(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=aI(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():aI(e[t],null)}}}}(...e),e)}"undefined"!=typeof window&&window.document&&window.document.createElement;var aP=globalThis?.document?es.useLayoutEffect:()=>{},aD=es[" useInsertionEffect ".trim().toString()]||aP;function aL(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}Symbol("RADIX:SYNC_STATE"),"undefined"!=typeof window&&window.document&&window.document.createElement;var a$=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function aU(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function aB(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=aU(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():aU(e[t],null)}}}}(...e),e)}function az(e){let t=es.useRef(e);return es.useEffect(()=>{t.current=e}),es.useMemo(()=>(...e)=>t.current?.(...e),[])}var aq="dismissableLayer.update",aF=es.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),aH=es.forwardRef((e,t)=>{let{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:n,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=es.useContext(aF),[d,u]=es.useState(null),h=d?.ownerDocument??globalThis?.document,[,p]=es.useState({}),f=aB(t,e=>u(e)),m=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=m.indexOf(g),x=d?m.indexOf(d):-1,y=c.layersWithOutsidePointerEventsDisabled.size>0,w=x>=b,v=function(e,t=globalThis?.document){let r=az(e),s=es.useRef(!1),n=es.useRef(()=>{});return es.useEffect(()=>{let e=e=>{if(e.target&&!s.current){let s=function(){aG("dismissableLayer.pointerDownOutside",r,i,{discrete:!0})},i={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",n.current),n.current=s,t.addEventListener("click",n.current,{once:!0})):s()}else t.removeEventListener("click",n.current);s.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",e),t.removeEventListener("click",n.current)}},[t,r]),{onPointerDownCapture:()=>s.current=!0}}(e=>{let t=e.target,r=[...c.branches].some(e=>e.contains(t));w&&!r&&(n?.(e),a?.(e),e.defaultPrevented||o?.())},h),j=function(e,t=globalThis?.document){let r=az(e),s=es.useRef(!1);return es.useEffect(()=>{let e=e=>{e.target&&!s.current&&aG("dismissableLayer.focusOutside",r,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}(e=>{let t=e.target;![...c.branches].some(e=>e.contains(t))&&(i?.(e),a?.(e),e.defaultPrevented||o?.())},h);return!function(e,t=globalThis?.document){let r,s=(r=es.useRef(e),es.useEffect(()=>{r.current=e}),es.useMemo(()=>(...e)=>r.current?.(...e),[]));es.useEffect(()=>{let e=e=>{"Escape"===e.key&&s(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[s,t])}(e=>{x===c.layers.size-1&&(s?.(e),!e.defaultPrevented&&o&&(e.preventDefault(),o()))},h),es.useEffect(()=>{if(d)return r&&(0===c.layersWithOutsidePointerEventsDisabled.size&&(Z=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),aW(),()=>{r&&1===c.layersWithOutsidePointerEventsDisabled.size&&(h.body.style.pointerEvents=Z)}},[d,h,r,c]),es.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),aW())},[d,c]),es.useEffect(()=>{let e=()=>p({});return document.addEventListener(aq,e),()=>document.removeEventListener(aq,e)},[]),(0,er.jsx)(a$.div,{...l,ref:f,style:{pointerEvents:y?w?"auto":"none":void 0,...e.style},onFocusCapture:aL(e.onFocusCapture,j.onFocusCapture),onBlurCapture:aL(e.onBlurCapture,j.onBlurCapture),onPointerDownCapture:aL(e.onPointerDownCapture,v.onPointerDownCapture)})});function aW(){let e=new CustomEvent(aq);document.dispatchEvent(e)}function aG(e,t,r,{discrete:s}){let n=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});if(t&&n.addEventListener(e,t,{once:!0}),s)n&&sG.flushSync(()=>n.dispatchEvent(i));else n.dispatchEvent(i)}function aV(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}aH.displayName="DismissableLayer",es.forwardRef((e,t)=>{let r=es.useContext(aF),s=es.useRef(null),n=aB(t,s);return es.useEffect(()=>{let e=s.current;if(e)return r.branches.add(e),()=>{r.branches.delete(e)}},[r.branches]),(0,er.jsx)(a$.div,{...e,ref:n})}).displayName="DismissableLayerBranch";var aK=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function aJ(e){let t=es.useRef(e);return es.useEffect(()=>{t.current=e}),es.useMemo(()=>(...e)=>t.current?.(...e),[])}var aY="focusScope.autoFocusOnMount",aX="focusScope.autoFocusOnUnmount",aQ={bubbles:!1,cancelable:!0},aZ=es.forwardRef((e,t)=>{let{loop:r=!1,trapped:s=!1,onMountAutoFocus:n,onUnmountAutoFocus:i,...a}=e,[o,l]=es.useState(null),c=aJ(n),d=aJ(i),u=es.useRef(null),h=function(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=aV(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():aV(e[t],null)}}}}(...e),e)}(t,e=>l(e)),p=es.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;es.useEffect(()=>{if(s){let e=function(e){if(p.paused||!o)return;let t=e.target;o.contains(t)?u.current=t:a2(u.current,{select:!0})},t=function(e){if(p.paused||!o)return;let t=e.relatedTarget;null!==t&&(o.contains(t)||a2(u.current,{select:!0}))};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let r=new MutationObserver(function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&a2(o)});return o&&r.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),r.disconnect()}}},[s,o,p.paused]),es.useEffect(()=>{if(o){a4.add(p);let e=document.activeElement;if(!o.contains(e)){let t=new CustomEvent(aY,aQ);o.addEventListener(aY,c),o.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){let r=document.activeElement;for(let s of e)if(a2(s,{select:t}),document.activeElement!==r)return}(a0(o).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&a2(o))}return()=>{o.removeEventListener(aY,c),setTimeout(()=>{let t=new CustomEvent(aX,aQ);o.addEventListener(aX,d),o.dispatchEvent(t),t.defaultPrevented||a2(e??document.body,{select:!0}),o.removeEventListener(aX,d),a4.remove(p)},0)}}},[o,c,d,p]);let f=es.useCallback(e=>{if(!r&&!s||p.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){var i;let t,s=e.currentTarget,[a,o]=[a1(t=a0(i=s),i),a1(t.reverse(),i)];a&&o?e.shiftKey||n!==o?e.shiftKey&&n===a&&(e.preventDefault(),r&&a2(o,{select:!0})):(e.preventDefault(),r&&a2(a,{select:!0})):n===s&&e.preventDefault()}},[r,s,p.paused]);return(0,er.jsx)(aK.div,{tabIndex:-1,...a,ref:h,onKeyDown:f})});function a0(e){let t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function a1(e,t){for(let r of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(r,{upTo:t}))return r}function a2(e,{select:t=!1}={}){if(e&&e.focus){var r;let s=document.activeElement;e.focus({preventScroll:!0}),e!==s&&(r=e)instanceof HTMLInputElement&&"select"in r&&t&&e.select()}}aZ.displayName="FocusScope";var a4=(j=[],{add(e){let t=j[0];e!==t&&t?.pause(),(j=a5(j,e)).unshift(e)},remove(e){j=a5(j,e),j[0]?.resume()}});function a5(e,t){let r=[...e],s=r.indexOf(t);return -1!==s&&r.splice(s,1),r}var a3=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),a6=globalThis?.document?es.useLayoutEffect:()=>{},a8=es.forwardRef((e,t)=>{let{container:r,...s}=e,[n,i]=es.useState(!1);a6(()=>i(!0),[]);let a=r||n&&globalThis?.document?.body;return a?sG.default.createPortal((0,er.jsx)(a3.div,{...s,ref:t}),a):null});a8.displayName="Portal";var a7=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),a9=0;function oe(){es.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??ot()),document.body.insertAdjacentElement("beforeend",e[1]??ot()),a9++,()=>{1===a9&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),a9--}},[])}function ot(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var or=function(){return(or=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function os(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)0>t.indexOf(s[n])&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}var on=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),oi="width-before-scroll-bar";function oa(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var oo="undefined"!=typeof window?es.useLayoutEffect:es.useEffect,ol=new WeakMap,oc=(void 0===I&&(I={}),(void 0===M&&(M=function(e){return e}),P=[],D=!1,L={read:function(){if(D)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return P.length?P[P.length-1]:null},useMedium:function(e){var t=M(e,D);return P.push(t),function(){P=P.filter(function(e){return e!==t})}},assignSyncMedium:function(e){for(D=!0;P.length;){var t=P;P=[],t.forEach(e)}P={push:function(t){return e(t)},filter:function(){return P}}},assignMedium:function(e){D=!0;var t=[];if(P.length){var r=P;P=[],r.forEach(e),t=P}var s=function(){var r=t;t=[],r.forEach(e)},n=function(){return Promise.resolve().then(s)};n(),P={push:function(e){t.push(e),n()},filter:function(e){return t=t.filter(e),P}}}}).options=or({async:!0,ssr:!1},I),L),od=function(){},ou=es.forwardRef(function(e,t){var r,s,n,i,a=es.useRef(null),o=es.useState({onScrollCapture:od,onWheelCapture:od,onTouchMoveCapture:od}),l=o[0],c=o[1],d=e.forwardProps,u=e.children,h=e.className,p=e.removeScrollBar,f=e.enabled,m=e.shards,g=e.sideCar,b=e.noRelative,x=e.noIsolation,y=e.inert,w=e.allowPinchZoom,v=e.as,j=e.gapMode,k=os(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),N=(r=[a,t],s=function(e){return r.forEach(function(t){return oa(t,e)})},(n=(0,es.useState)(function(){return{value:null,callback:s,facade:{get current(){return n.value},set current(value){var e=n.value;e!==value&&(n.value=value,n.callback(value,e))}}}})[0]).callback=s,i=n.facade,oo(function(){var e=ol.get(i);if(e){var t=new Set(e),s=new Set(r),n=i.current;t.forEach(function(e){s.has(e)||oa(e,null)}),s.forEach(function(e){t.has(e)||oa(e,n)})}ol.set(i,r)},[r]),i),S=or(or({},k),l);return es.createElement(es.Fragment,null,f&&es.createElement(g,{sideCar:oc,removeScrollBar:p,shards:m,noRelative:b,noIsolation:x,inert:y,setCallbacks:c,allowPinchZoom:!!w,lockRef:a,gapMode:j}),d?es.cloneElement(es.Children.only(u),or(or({},S),{ref:N})):es.createElement(void 0===v?"div":v,or({},S,{className:h,ref:N}),u))});ou.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},ou.classNames={fullWidth:oi,zeroRight:on};var oh=function(e){var t=e.sideCar,r=os(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw Error("Sidecar medium not found");return es.createElement(s,or({},r))};oh.isSideCarExport=!0;var op=function(){var e=0,t=null;return{add:function(r){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=ee||("undefined"!=typeof __webpack_nonce__?__webpack_nonce__:void 0);return t&&e.setAttribute("nonce",t),e}())){var s,n;(s=t).styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r)),n=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(n)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},of=function(){var e=op();return function(t,r){es.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},om=function(){var e=of();return function(t){return e(t.styles,t.dynamic),null}},og={left:0,top:0,right:0,gap:0},ob=function(e){return parseInt(e||"",10)||0},ox=function(e){var t=window.getComputedStyle(document.body),r=t["padding"===e?"paddingLeft":"marginLeft"],s=t["padding"===e?"paddingTop":"marginTop"],n=t["padding"===e?"paddingRight":"marginRight"];return[ob(r),ob(s),ob(n)]},oy=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return og;var t=ox(e),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,s-r+t[2]-t[0])}},ow=om(),ov="data-scroll-locked",oj=function(e,t,r,s){var n=e.left,i=e.top,a=e.right,o=e.gap;return void 0===r&&(r="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(s,";\n   padding-right: ").concat(o,"px ").concat(s,";\n  }\n  body[").concat(ov,"] {\n    overflow: hidden ").concat(s,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(s,";"),"margin"===r&&"\n    padding-left: ".concat(n,"px;\n    padding-top: ").concat(i,"px;\n    padding-right: ").concat(a,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(s,";\n    "),"padding"===r&&"padding-right: ".concat(o,"px ").concat(s,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(on," {\n    right: ").concat(o,"px ").concat(s,";\n  }\n  \n  .").concat(oi," {\n    margin-right: ").concat(o,"px ").concat(s,";\n  }\n  \n  .").concat(on," .").concat(on," {\n    right: 0 ").concat(s,";\n  }\n  \n  .").concat(oi," .").concat(oi," {\n    margin-right: 0 ").concat(s,";\n  }\n  \n  body[").concat(ov,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(o,"px;\n  }\n")},ok=function(){var e=parseInt(document.body.getAttribute(ov)||"0",10);return isFinite(e)?e:0},oN=function(){es.useEffect(function(){return document.body.setAttribute(ov,(ok()+1).toString()),function(){var e=ok()-1;e<=0?document.body.removeAttribute(ov):document.body.setAttribute(ov,e.toString())}},[])},oS=function(e){var t=e.noRelative,r=e.noImportant,s=e.gapMode,n=void 0===s?"margin":s;oN();var i=es.useMemo(function(){return oy(n)},[n]);return es.createElement(ow,{styles:oj(i,!t,n,r?"":"!important")})},o_=!1;if("undefined"!=typeof window)try{var oC=Object.defineProperty({},"passive",{get:function(){return o_=!0,!0}});window.addEventListener("test",oC,oC),window.removeEventListener("test",oC,oC)}catch(e){o_=!1}var oE=!!o_&&{passive:!1},oR=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return"hidden"!==r[t]&&(r.overflowY!==r.overflowX||"TEXTAREA"===e.tagName||"visible"!==r[t])},oA=function(e,t){var r=t.ownerDocument,s=t;do{if("undefined"!=typeof ShadowRoot&&s instanceof ShadowRoot&&(s=s.host),oO(e,s)){var n=oT(e,s);if(n[1]>n[2])return!0}s=s.parentNode}while(s&&s!==r.body)return!1},oO=function(e,t){return"v"===e?oR(t,"overflowY"):oR(t,"overflowX")},oT=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},oI=function(e,t,r,s,n){var i,a=(i=window.getComputedStyle(t).direction,"h"===e&&"rtl"===i?-1:1),o=a*s,l=r.target,c=t.contains(l),d=!1,u=o>0,h=0,p=0;do{if(!l)break;var f=oT(e,l),m=f[0],g=f[1]-f[2]-a*m;(m||g)&&oO(e,l)&&(h+=g,p+=m);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(t.contains(l)||t===l))return u&&(n&&1>Math.abs(h)||!n&&o>h)?d=!0:!u&&(n&&1>Math.abs(p)||!n&&-o>p)&&(d=!0),d},oM=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},oP=function(e){return[e.deltaX,e.deltaY]},oD=function(e){return e&&"current"in e?e.current:e},oL=0,o$=[];let oU=($=function(e){var t=es.useRef([]),r=es.useRef([0,0]),s=es.useRef(),n=es.useState(oL++)[0],i=es.useState(om)[0],a=es.useRef(e);es.useEffect(function(){a.current=e},[e]),es.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(n));var t=(function(e,t,r){if(r||2==arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))})([e.lockRef.current],(e.shards||[]).map(oD),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(n))}),function(){document.body.classList.remove("block-interactivity-".concat(n)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(n))})}}},[e.inert,e.lockRef.current,e.shards]);var o=es.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!a.current.allowPinchZoom;var n,i=oM(e),o=r.current,l="deltaX"in e?e.deltaX:o[0]-i[0],c="deltaY"in e?e.deltaY:o[1]-i[1],d=e.target,u=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===u&&"range"===d.type)return!1;var h=oA(u,d);if(!h)return!0;if(h?n=u:(n="v"===u?"h":"v",h=oA(u,d)),!h)return!1;if(!s.current&&"changedTouches"in e&&(l||c)&&(s.current=n),!n)return!0;var p=s.current||n;return oI(p,t,e,"h"===p?l:c,!0)},[]),l=es.useCallback(function(e){if(o$.length&&o$[o$.length-1]===i){var r="deltaY"in e?oP(e):oM(e),s=t.current.filter(function(t){var s;return t.name===e.type&&(t.target===e.target||e.target===t.shadowParent)&&(s=t.delta,s[0]===r[0]&&s[1]===r[1])})[0];if(s&&s.should){e.cancelable&&e.preventDefault();return}if(!s){var n=(a.current.shards||[]).map(oD).filter(Boolean).filter(function(t){return t.contains(e.target)});(n.length>0?o(e,n[0]):!a.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),c=es.useCallback(function(e,r,s,n){var i={name:e,delta:r,target:s,should:n,shadowParent:function(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}(s)};t.current.push(i),setTimeout(function(){t.current=t.current.filter(function(e){return e!==i})},1)},[]),d=es.useCallback(function(e){r.current=oM(e),s.current=void 0},[]),u=es.useCallback(function(t){c(t.type,oP(t),t.target,o(t,e.lockRef.current))},[]),h=es.useCallback(function(t){c(t.type,oM(t),t.target,o(t,e.lockRef.current))},[]);es.useEffect(function(){return o$.push(i),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:h}),document.addEventListener("wheel",l,oE),document.addEventListener("touchmove",l,oE),document.addEventListener("touchstart",d,oE),function(){o$=o$.filter(function(e){return e!==i}),document.removeEventListener("wheel",l,oE),document.removeEventListener("touchmove",l,oE),document.removeEventListener("touchstart",d,oE)}},[]);var p=e.removeScrollBar,f=e.inert;return es.createElement(es.Fragment,null,f?es.createElement(i,{styles:"\n  .block-interactivity-".concat(n," {pointer-events: none;}\n  .allow-interactivity-").concat(n," {pointer-events: all;}\n")}):null,p?es.createElement(oS,{noRelative:e.noRelative,gapMode:e.gapMode}):null)},oc.useMedium($),oh);var oB=es.forwardRef(function(e,t){return es.createElement(ou,or({},e,{ref:t,sideCar:oU}))});oB.classNames=ou.classNames;var oz=new WeakMap,oq=new WeakMap,oF={},oH=0,oW=function(e){return e&&(e.host||oW(e.parentNode))},oG=function(e,t,r,s){var n=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var r=oW(e);return r&&t.contains(r)?r:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return!!e});oF[r]||(oF[r]=new WeakMap);var i=oF[r],a=[],o=new Set,l=new Set(n),c=function(e){!e||o.has(e)||(o.add(e),c(e.parentNode))};n.forEach(c);var d=function(e){!e||l.has(e)||Array.prototype.forEach.call(e.children,function(e){if(o.has(e))d(e);else try{var t=e.getAttribute(s),n=null!==t&&"false"!==t,l=(oz.get(e)||0)+1,c=(i.get(e)||0)+1;oz.set(e,l),i.set(e,c),a.push(e),1===l&&n&&oq.set(e,!0),1===c&&e.setAttribute(r,"true"),n||e.setAttribute(s,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return d(t),o.clear(),oH++,function(){a.forEach(function(e){var t=oz.get(e)-1,n=i.get(e)-1;oz.set(e,t),i.set(e,n),t||(oq.has(e)||e.removeAttribute(s),oq.delete(e)),n||e.removeAttribute(r)}),--oH||(oz=new WeakMap,oz=new WeakMap,oq=new WeakMap,oF={})}},oV=function(e,t,r){void 0===r&&(r="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),n=t||("undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body);return n?(s.push.apply(s,Array.from(n.querySelectorAll("[aria-live], script"))),oG(s,n,r,"aria-hidden")):function(){return null}},oK="Dialog",[oJ,oY]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(oK),[oX,oQ]=oJ(oK),oZ=e=>{let{__scopeDialog:t,children:r,open:s,defaultOpen:n,onOpenChange:i,modal:a=!0}=e,o=es.useRef(null),l=es.useRef(null),[c,d]=function({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return aD(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}({prop:s,defaultProp:n??!1,onChange:i,caller:oK});return(0,er.jsx)(oX,{scope:t,triggerRef:o,contentRef:l,contentId:n6(),titleId:n6(),descriptionId:n6(),open:c,onOpenChange:d,onOpenToggle:es.useCallback(()=>d(e=>!e),[d]),modal:a,children:r})};oZ.displayName=oK;var o0="DialogTrigger",o1=es.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=oQ(o0,r),i=aM(t,n.triggerRef);return(0,er.jsx)(a7.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":lu(n.open),...s,ref:i,onClick:aT(e.onClick,n.onOpenToggle)})});o1.displayName=o0;var o2="DialogPortal",[o4,o5]=oJ(o2,{forceMount:void 0}),o3=e=>{let{__scopeDialog:t,forceMount:r,children:s,container:n}=e,i=oQ(o2,t);return(0,er.jsx)(o4,{scope:t,forceMount:r,children:es.Children.map(s,e=>(0,er.jsx)(ns,{present:r||i.open,children:(0,er.jsx)(a8,{asChild:!0,container:n,children:e})}))})};o3.displayName=o2;var o6="DialogOverlay",o8=es.forwardRef((e,t)=>{let r=o5(o6,e.__scopeDialog),{forceMount:s=r.forceMount,...n}=e,i=oQ(o6,e.__scopeDialog);return i.modal?(0,er.jsx)(ns,{present:s||i.open,children:(0,er.jsx)(o9,{...n,ref:t})}):null});o8.displayName=o6;var o7=eo("DialogOverlay.RemoveScroll"),o9=es.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=oQ(o6,r);return(0,er.jsx)(oB,{as:o7,allowPinchZoom:!0,shards:[n.contentRef],children:(0,er.jsx)(a7.div,{"data-state":lu(n.open),...s,ref:t,style:{pointerEvents:"auto",...s.style}})})}),le="DialogContent",lt=es.forwardRef((e,t)=>{let r=o5(le,e.__scopeDialog),{forceMount:s=r.forceMount,...n}=e,i=oQ(le,e.__scopeDialog);return(0,er.jsx)(ns,{present:s||i.open,children:i.modal?(0,er.jsx)(lr,{...n,ref:t}):(0,er.jsx)(ls,{...n,ref:t})})});lt.displayName=le;var lr=es.forwardRef((e,t)=>{let r=oQ(le,e.__scopeDialog),s=es.useRef(null),n=aM(t,r.contentRef,s);return es.useEffect(()=>{let e=s.current;if(e)return oV(e)},[]),(0,er.jsx)(ln,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:aT(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:aT(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:aT(e.onFocusOutside,e=>e.preventDefault())})}),ls=es.forwardRef((e,t)=>{let r=oQ(le,e.__scopeDialog),s=es.useRef(!1),n=es.useRef(!1);return(0,er.jsx)(ln,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(s.current||r.triggerRef.current?.focus(),t.preventDefault()),s.current=!1,n.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(n.current=!0));let i=t.target;r.triggerRef.current?.contains(i)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&n.current&&t.preventDefault()}})}),ln=es.forwardRef((e,t)=>{let{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:n,onCloseAutoFocus:i,...a}=e,o=oQ(le,r),l=es.useRef(null),c=aM(t,l);return oe(),(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(aZ,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:n,onUnmountAutoFocus:i,children:(0,er.jsx)(aH,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":lu(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(lm,{titleId:o.titleId}),(0,er.jsx)(lg,{contentRef:l,descriptionId:o.descriptionId})]})]})}),li="DialogTitle",la=es.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=oQ(li,r);return(0,er.jsx)(a7.h2,{id:n.titleId,...s,ref:t})});la.displayName=li;var lo="DialogDescription",ll=es.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=oQ(lo,r);return(0,er.jsx)(a7.p,{id:n.descriptionId,...s,ref:t})});ll.displayName=lo;var lc="DialogClose",ld=es.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=oQ(lc,r);return(0,er.jsx)(a7.button,{type:"button",...s,ref:t,onClick:aT(e.onClick,()=>n.onOpenChange(!1))})});function lu(e){return e?"open":"closed"}ld.displayName=lc;var lh="DialogTitleWarning",[lp,lf]=(U={contentName:le,titleName:li,docsSlug:"dialog"},t=es.createContext(U),(r=e=>{let{children:r,...s}=e,n=es.useMemo(()=>s,Object.values(s));return(0,er.jsx)(t.Provider,{value:n,children:r})}).displayName=lh+"Provider",[r,function(e){let r=es.useContext(t);if(r)return r;if(void 0!==U)return U;throw Error(`\`${e}\` must be used within \`${lh}\``)}]),lm=({titleId:e})=>{let t=lf(lh),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return es.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},lg=({contentRef:e,descriptionId:t})=>{let r=lf("DialogDescriptionWarning"),s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${r.contentName}}.`;return es.useEffect(()=>{let r=e.current?.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(s))},[s,e,t]),null};function lb({...e}){return(0,er.jsx)(oZ,{"data-slot":"dialog",...e})}function lx({...e}){return(0,er.jsx)(o1,{"data-slot":"dialog-trigger",...e})}function ly({...e}){return(0,er.jsx)(o3,{"data-slot":"dialog-portal",...e})}function lw({...e}){return(0,er.jsx)(ld,{"data-slot":"dialog-close",...e})}function lv({className:e,...t}){return(0,er.jsx)(o8,{"data-slot":"dialog-overlay",className:tr("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function lj({className:e,children:t,...r}){return(0,er.jsxs)(ly,{"data-slot":"dialog-portal",children:[(0,er.jsx)(lv,{}),(0,er.jsxs)(lt,{"data-slot":"dialog-content",className:tr("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...r,children:[t,(0,er.jsxs)(ld,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,er.jsx)(iH,{}),(0,er.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function lk({className:e,...t}){return(0,er.jsx)("div",{"data-slot":"dialog-header",className:tr("flex flex-col gap-2 text-center sm:text-left",e),...t})}function lN({className:e,...t}){return(0,er.jsx)("div",{"data-slot":"dialog-footer",className:tr("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function lS({className:e,...t}){return(0,er.jsx)(la,{"data-slot":"dialog-title",className:tr("text-lg leading-none font-semibold",e),...t})}function l_({className:e,...t}){return(0,er.jsx)(ll,{"data-slot":"dialog-description",className:tr("text-muted-foreground text-sm",e),...t})}let lC=tc("facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),lE=tc("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),lR=tc("mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),lA=tc("twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),lO=["web","copy","facebook","twitter","whatsapp","telegram","email","movesplash"],lT={web:{label:"Share with device",description:"Use your device share sheet",icon:tf,highlight:!0},copy:{label:"Copy link",description:"Copy post link to clipboard",icon:lE},facebook:{label:"Facebook",description:"Share to your Facebook feed",icon:lC},twitter:{label:"X (Twitter)",description:"Post to X with a prefilled tweet",icon:lA},whatsapp:{label:"WhatsApp",description:"Share with your WhatsApp contacts",icon:td},telegram:{label:"Telegram",description:"Share via Telegram",icon:aE},email:{label:"Email",description:"Send by email",icon:lR},movesplash:{label:"MoveYSplash Messages",description:"Drop this post into a MoveYSplash conversation",icon:th,highlight:!0}};function lI({open:e,post:t,onClose:r,onSelect:s}){let[n,i]=(0,es.useState)(!1);(0,es.useEffect)(()=>{i("undefined"!=typeof navigator&&"function"==typeof navigator.share)},[]);let a=(0,es.useMemo)(()=>lO.filter(e=>"web"!==e||!!n),[n]),o=(0,es.useMemo)(()=>{let e=t?.text?.trim();return e?e.length<=180?e:`${e.slice(0,177)}`:""},[t]);return(0,er.jsx)(lb,{open:e,onOpenChange:e=>!e&&r(),children:(0,er.jsxs)(lj,{className:"max-w-lg bg-gradient-to-br from-slate-900/90 to-purple-900/80 text-white border-white/10",children:[(0,er.jsx)(lk,{children:(0,er.jsxs)(lS,{className:"flex items-center gap-2 text-white",children:[(0,er.jsx)(tf,{className:"w-5 h-5"}),"Share post"]})}),t&&(0,er.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 space-y-3",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsxs)(s8,{className:"w-10 h-10 border border-white/20",children:[(0,er.jsx)(s7,{src:t.authorAvatar}),(0,er.jsx)(s9,{children:t.authorName[0]??"U"})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-white font-medium",children:t.authorName}),t.authorUsername&&(0,er.jsx)("div",{className:"text-white/60 text-sm",children:t.authorUsername})]})]}),o?(0,er.jsx)("p",{className:"text-white/80 text-sm whitespace-pre-wrap leading-relaxed",children:o}):(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"No caption  share the vibes!"})]}),(0,er.jsx)("div",{className:"grid grid-cols-1 gap-2",children:a.map(e=>{let t=lT[e];return(0,er.jsxs)(tn,{type:"button",variant:"ghost",className:tr("justify-start bg-white/5 hover:bg-white/15 border border-white/10 text-left flex items-center gap-3",t.highlight&&"border-white/20 bg-white/10"),onClick:()=>s(e),children:[(0,er.jsx)(t.icon,{className:"w-5 h-5 text-white"}),(0,er.jsxs)("div",{className:"flex flex-col items-start",children:[(0,er.jsx)("span",{className:"text-white font-medium",children:t.label}),(0,er.jsx)("span",{className:"text-white/60 text-xs",children:t.description})]})]},e)})}),(0,er.jsxs)("div",{className:"mt-2 text-xs text-white/40 flex items-center gap-2",children:[(0,er.jsx)(tb,{className:"w-4 h-4"}),"Sharing boosts your post reach and inspires more connections."]})]})})}let lM=(e,t)=>window.location?.origin?`${window.location.origin}/posts/${encodeURIComponent(e)}/${encodeURIComponent(t)}`:`https://movesplash.app/posts/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,lP=(e,t)=>{let r=t?.trim();return r&&r.length>0?r.length>280?`${r.slice(0,277)}`:r:`Check out this MoveYSplash post from ${e}!`},lD=e=>{let t=lM(e.memberId,e.userpostId),r=lP(e.authorName,e.text);return`${e.authorName} on MoveYSplash:
${r}

${t}`},lL=`https://${sB}.supabase.co/functions/v1/make-server-a14c7986`,l$=e=>`https://api.dicebear.com/7.x/avataaars/svg?seed=${encodeURIComponent(e||"user")}`;function lU({onShareToMessages:e}={}){let{currentUser:t,allUsers:r,addPost:s,fetchComments:n,addComment:i,sharePost:a,toggleSavePost:o}=ai(),[l,c]=(0,es.useState)(""),[d,u]=(0,es.useState)(!1),[h,p]=(0,es.useState)([]),f=(0,es.useRef)(null),m=(0,es.useRef)(null),[g,b]=(0,es.useState)([]),[x,y]=(0,es.useState)(!1),[w,v]=(0,es.useState)(!1),[j,k]=(0,es.useState)({}),[N,S]=(0,es.useState)(null),[_,C]=(0,es.useState)(!1),[E,R]=(0,es.useState)(null),A=(0,es.useCallback)(async()=>{y(!0);try{let e=await fetch(`${lL}/posts`,{headers:{Authorization:`Bearer ${sz}`}});if(!e.ok)throw Error(`status ${e.status}`);let t=await e.json().catch(()=>null),r=(Array.isArray(t?.posts)?t.posts:[]).map(e=>{if("object"!=typeof e||null===e)return null;let t=e.id,r=e.userId;if("string"!=typeof t||"string"!=typeof r)return null;let s="string"==typeof e.text?e.text:"string"==typeof e.content?e.content:"",n="string"==typeof e.timestamp&&e.timestamp?e.timestamp:new Date().toISOString(),i="number"==typeof e.likes&&Number.isFinite(e.likes)?e.likes:0,a="number"==typeof e.comments&&Number.isFinite(e.comments)?e.comments:0,o="number"==typeof e.shares&&Number.isFinite(e.shares)?e.shares:0,l=Array.isArray(e.likedBy)?e.likedBy.filter(e=>"string"==typeof e):[],c=(Array.isArray(e.media)?e.media:[]).map((e,r)=>{if("object"!=typeof e||null===e)return null;let s="string"==typeof e.url?e.url:"";if(!s)return null;let n="video"===e.type?"video":"image";return{id:`${t}-media-${r}`,type:n,url:s}}).filter(e=>!!e);return{id:t,userId:r,text:s,media:c,likes:i,comments:a,shares:o,timestamp:n,likedBy:l}}).filter(e=>!!e).sort((e,t)=>Date.parse(t.timestamp)-Date.parse(e.timestamp));b(r),k({})}catch(e){console.error("Error loading feed posts:",e),i5.error("Unable to load feed right now.")}finally{y(!1)}},[]);(0,es.useEffect)(()=>{A()},[A]);let O=async()=>{if(!t)return void i5.info("Sign in to share whats on your mind.");if(!l.trim()&&0===h.length)return void i5.error("Please write something or add media");v(!0);try{await s({text:l,media:h.length>0?h.map(e=>({type:e.type,url:e.url})):void 0}),c(""),p([]),u(!1),i5.success("Posted! "),await A()}catch(e){console.error("Error creating post:",e),i5.error("Unable to post right now.")}finally{v(!1)}},T=async r=>{if(!N||_)return;let s=lM(N.memberId,N.userpostId),n=lP(N.authorName,N.text),i=`${n}

${s}`,o=lD(N),l=!1,c=e=>{window.open(e,"_blank","noopener,noreferrer")};switch(r){case"copy":try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(i);else{let e=document.createElement("textarea");e.value=i,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e)}i5.success("Post link copied to clipboard!"),l=!0}catch(e){console.error("Unable to copy link:",e),i5.error("Unable to copy the link. Please try again.")}break;case"facebook":c(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`),i5.info("Opening Facebook share"),l=!0;break;case"twitter":c(`https://twitter.com/intent/tweet?text=${encodeURIComponent(`${n} ${s}`)}`),i5.info("Opening X (Twitter)"),l=!0;break;case"whatsapp":c(`https://wa.me/?text=${encodeURIComponent(i)}`),i5.info("Launching WhatsApp"),l=!0;break;case"telegram":c(`https://t.me/share/url?url=${encodeURIComponent(s)}&text=${encodeURIComponent(n)}`),i5.info("Opening Telegram"),l=!0;break;case"email":{let e=`mailto:?subject=${encodeURIComponent("Check this MoveYSplash post")}&body=${encodeURIComponent(i)}`;window.location.href=e,i5.info("Composing email"),l=!0;break}case"movesplash":e?.({message:o,postId:N.userpostId,postOwnerId:N.memberId}),i5.success("Draft ready in MoveYSplash Messages "),l=!0;break;case"web":if(navigator.share)try{await navigator.share({title:`${N.authorName} on MoveYSplash`,text:n,url:s}),i5.success("Shared successfully! "),l=!0}catch(e){e instanceof DOMException&&"AbortError"===e.name?i5.info("Share cancelled."):(console.error("Web share failed:",e),i5.error("Unable to share via your device."))}else i5.info("Device share sheet is not available.")}if(l){C(!0);try{let e=await a(N.memberId,N.userpostId,{platform:r,sharerUserId:t?.id??void 0,message:o});b(t=>t.map(t=>t.id===N.userpostId?{...t,shares:e??t.shares+1}:t))}catch(e){console.error("Error syncing share count:",e),b(e=>e.map(e=>e.id===N.userpostId?{...e,shares:e.shares+1}:e))}finally{C(!1),S(null)}}},I=(0,es.useCallback)(async e=>{let t=j[e.id],r=!t?.isOpen,s=t?.hasLoaded??!1;if(k(t=>{let n=t[e.id],i=n?{...n,isOpen:!n.isOpen,isLoading:r&&!s,error:null}:{isOpen:!0,isLoading:!0,isSubmitting:!1,hasLoaded:!1,comments:[],input:"",error:null};return{...t,[e.id]:i}}),r&&!s)try{let t=await n(e.userId,e.id);k(r=>{let s=r[e.id];return s?{...r,[e.id]:{...s,isLoading:!1,hasLoaded:!0,comments:t}}:r})}catch(t){console.error("Error loading comments:",t),k(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,isLoading:!1,hasLoaded:!0,error:"Unable to load comments right now."}}:t})}},[j,n]),M=(0,es.useCallback)(async(e,r)=>{if(!t)return void i5.info("Sign in to save posts.");let s=`${e.userId}:${e.id}`;R(s);try{await o(e.userId,e.id)?i5.success(`Saved ${r}'s post.`):i5.success("Removed from saved posts.")}catch(t){console.error("Error updating bookmark state:",t);let e=t instanceof Error&&t.message?t.message:"Unable to update saved posts right now.";i5.error(e)}finally{R(e=>e===s?null:e)}},[t,o]),P=async e=>{let r=j[e.id];if(!r||r.isSubmitting)return;if(!t)return void i5.info("Sign in to join the conversation.");let s=r.input.trim();if(!s)return void k(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,error:"Please enter a comment before posting."}}:t});k(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,isSubmitting:!0,error:null}}:t});let n=await i(e.userId,e.id,s);n?(k(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,isSubmitting:!1,hasLoaded:!0,comments:[...r.comments,n.comment],input:"",error:null}}:t}),b(t=>t.map(t=>t.id===e.id?{...t,comments:n.totalComments}:t))):k(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,isSubmitting:!1,error:"Unable to post your comment right now."}}:t})},D=async e=>{if(!t)return void i5.info("Sign in to like posts.");let r=e.likedBy.includes(t.id);b(s=>s.map(s=>s.id===e.id?{...s,likes:r?Math.max(s.likes-1,0):s.likes+1,likedBy:r?s.likedBy.filter(e=>e!==t.id):[...s.likedBy,t.id]}:s));try{await fetch(`${lL}/posts/${e.userId}/${e.id}/like`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sz}`},body:JSON.stringify({likerUserId:t.id})})}catch(e){console.error("Error updating like:",e),i5.error("Unable to update like right now."),b(g)}};return(0,er.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,er.jsx)(ak,{className:"p-6 backdrop-blur-xl bg-white/10 border-white/20",children:(0,er.jsxs)("div",{className:"flex gap-4",children:[(0,er.jsxs)(s8,{className:"w-12 h-12 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:t?.avatar??l$(t?.id??"guest")}),(0,er.jsx)(s9,{children:t?.name?.[0]??"U"})]}),(0,er.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,er.jsx)(aN,{placeholder:"What's on your mind? Share with your squad...",value:l,onChange:e=>c(e.target.value),className:"bg-white/5 border-white/20 text-white placeholder:text-white/50 resize-none min-h-[100px]"}),h.length>0&&(0,er.jsx)("div",{className:"grid grid-cols-2 gap-2",children:h.map(e=>(0,er.jsxs)("div",{className:"relative group",children:["image"===e.type?(0,er.jsx)(ty,{src:e.url,alt:"Upload preview",className:"w-full h-40 object-cover rounded-lg"}):(0,er.jsx)("video",{src:e.url,className:"w-full h-40 object-cover rounded-lg",controls:!0}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:()=>{var t;return t=e.id,void p(e=>e.filter(e=>e.id!==t))},className:"absolute top-2 right-2 bg-black/50 hover:bg-black/70 text-white opacity-0 group-hover:opacity-100 transition-opacity",children:(0,er.jsx)(iH,{className:"w-4 h-4"})})]},e.id))}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex gap-2",children:[(0,er.jsx)("input",{ref:f,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=e.target.files;t&&Array.from(t).forEach(e=>{let t=new FileReader;t.onload=t=>{let r=t.target?.result;r&&p(t=>[...t,{id:`${e.name}-${Date.now()}`,type:"image",url:r}])},t.readAsDataURL(e)})},className:"hidden"}),(0,er.jsx)("input",{ref:m,type:"file",accept:"video/*",onChange:e=>{let t=e.target.files;t&&Array.from(t).forEach(e=>{let t=new FileReader;t.onload=t=>{let r=t.target?.result;r&&p(t=>[...t,{id:`${e.name}-${Date.now()}`,type:"video",url:r}])},t.readAsDataURL(e)})},className:"hidden"}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:()=>f.current?.click(),className:"text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(a_,{className:"w-5 h-5 mr-2"}),"Photo"]}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:()=>m.current?.click(),className:"text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(tu,{className:"w-5 h-5 mr-2"}),"Video"]}),(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:()=>u(!d),className:"text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(aC,{className:"w-5 h-5 mr-2"}),"Emoji"]}),d&&(0,er.jsx)("div",{className:"absolute bottom-full left-0 mb-2 z-50",children:(0,er.jsx)(aO,{onSelect:e=>{c(t=>t+e),u(!1)}})})]})]}),(0,er.jsx)(tn,{onClick:O,disabled:w||!l.trim()&&0===h.length,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 disabled:opacity-50 disabled:cursor-not-allowed",children:w?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(iV,{className:"w-4 h-4 mr-2 animate-spin"}),"Posting"]}):(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(aE,{className:"w-4 h-4 mr-2"}),"Post"]})})]})]})]})}),x&&(0,er.jsx)(ak,{className:"p-6 backdrop-blur-xl bg-white/10 border-white/20",children:(0,er.jsxs)("div",{className:"flex items-center gap-3 text-white/80 text-sm",children:[(0,er.jsx)(iV,{className:"w-5 h-5 animate-spin"}),(0,er.jsx)("span",{children:"Loading feed..."})]})}),!x&&0===g.length&&(0,er.jsx)(ak,{className:"p-6 backdrop-blur-xl bg-white/10 border-white/20 text-center",children:(0,er.jsx)("p",{className:"text-white/70",children:"No posts yet. Share something to get the conversation started!"})}),g.map(e=>{let s=r.get(e.userId),n=s?.name??"MoveSplash user",i=s?.username??"",a=i?i.startsWith("@")?i:`@${i}`:"@movesplash-user",o=s?.avatar??l$(e.userId),l=!!t&&e.likedBy.includes(t.id),c=j[e.id],d=`${e.userId}:${e.id}`,u=!!t?.savedPostIds?.includes(d),h=E===d;return(0,er.jsxs)(ak,{className:"overflow-hidden backdrop-blur-xl bg-white/10 border-white/20",children:[(0,er.jsx)("div",{className:"p-6 pb-4",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsxs)(s8,{className:"w-12 h-12 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:o}),(0,er.jsx)(s9,{children:n[0]??"U"})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-white",children:n}),(0,er.jsxs)("div",{className:"text-white/50 text-sm",children:[a,"  ",(e=>{let t=new Date(e);if(Number.isNaN(t.getTime()))return"";let r=Math.floor((Date.now()-t.getTime())/6e4);if(r<1)return"Just now";if(r<60)return`${r}m ago`;let s=Math.floor(r/60);if(s<24)return`${s}h ago`;let n=Math.floor(s/24);return n<7?`${n}d ago`:t.toLocaleDateString()})(e.timestamp)]})]})]}),(0,er.jsx)(tn,{variant:"ghost",size:"sm",className:"text-white/70 hover:text-white hover:bg-white/10",children:(0,er.jsx)(aS,{className:"w-5 h-5"})})]})}),(0,er.jsx)("div",{className:"px-6 pb-4",children:(0,er.jsx)("p",{className:"text-white/90 whitespace-pre-line",children:e.text})}),e.media.length>0&&(0,er.jsx)("div",{className:`grid gap-2 px-6 pb-4 ${1===e.media.length?"grid-cols-1":"grid-cols-2"}`,children:e.media.map(t=>(0,er.jsx)("div",{className:"rounded-lg overflow-hidden",children:"image"===t.type?(0,er.jsx)(ty,{src:t.url,alt:"Post media",className:`w-full ${1===e.media.length?"max-h-96":"h-64"} object-cover`}):(0,er.jsx)("video",{src:t.url,className:`w-full ${1===e.media.length?"max-h-96":"h-64"} object-cover`,controls:!0})},t.id))}),(0,er.jsxs)("div",{className:"p-6 pt-4",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,er.jsxs)("div",{className:"flex items-center gap-6 text-white/60 text-sm",children:[(0,er.jsxs)("span",{children:[e.likes," likes"]}),(0,er.jsxs)("span",{children:[e.comments," comments"]}),(0,er.jsxs)("span",{children:[e.shares," shares"]})]}),(0,er.jsx)(tn,{variant:"ghost",size:"sm",className:`text-white/70 hover:bg-white/10 ${u?"text-amber-300 hover:text-amber-200":"hover:text-white"}`,onClick:()=>M(e,n),disabled:h,"aria-pressed":u,"aria-label":u?"Remove from saved posts":"Save post",children:h?(0,er.jsx)(iV,{className:"w-4 h-4 animate-spin"}):(0,er.jsx)(aR,{className:`w-4 h-4 transition-colors ${u?"fill-current":""}`})})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2 pt-4 border-t border-white/10",children:[(0,er.jsxs)(tn,{variant:"ghost",className:`flex-1 ${l?"text-pink-400":"text-white/70"} hover:text-pink-400 hover:bg-white/10`,onClick:()=>D(e),children:[(0,er.jsx)(tm,{className:`w-5 h-5 mr-2 ${l?"fill-current":""}`}),"Like"]}),(0,er.jsxs)(tn,{variant:"ghost",className:"flex-1 text-white/70 hover:text-blue-400 hover:bg-white/10",onClick:()=>I(e),children:[(0,er.jsx)(td,{className:"w-5 h-5 mr-2"}),"Comment"]}),(0,er.jsxs)(tn,{variant:"ghost",className:"flex-1 text-white/70 hover:text-green-400 hover:bg-white/10 disabled:opacity-50",disabled:_&&N?.userpostId===e.id,onClick:()=>{S({userpostId:e.id,memberId:e.userId,authorName:n,authorUsername:a,authorAvatar:o,text:e.text})},children:[(0,er.jsx)(tf,{className:"w-5 h-5 mr-2"}),"Share"]})]}),c?.isOpen&&(0,er.jsxs)("div",{className:"mt-4 pt-4 border-t border-white/10 space-y-4",children:[c.isLoading?(0,er.jsxs)("div",{className:"flex items-center gap-3 text-white/70 text-sm",children:[(0,er.jsx)(iV,{className:"w-4 h-4 animate-spin"}),(0,er.jsx)("span",{children:"Loading comments..."})]}):(0,er.jsxs)(er.Fragment,{children:[0===c.comments.length&&!c.error&&(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Be the first to comment."}),c.comments.map(e=>(0,er.jsxs)("div",{className:"flex gap-3",children:[(0,er.jsxs)(s8,{className:"w-9 h-9 border border-white/10",children:[(0,er.jsx)(s7,{src:e.authorAvatar||l$(e.authorId)}),(0,er.jsx)(s9,{children:e.authorName[0]??"U"})]}),(0,er.jsxs)("div",{className:"flex-1",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-white text-sm",children:e.authorName}),(0,er.jsx)("span",{className:"text-white/40 text-xs",children:(e=>{let t=Math.floor((Date.now()-e.getTime())/6e4);if(t<1)return"Just now";if(t<60)return`${t}m ago`;let r=Math.floor(t/60);if(r<24)return`${r}h ago`;let s=Math.floor(r/24);return s<7?`${s}d ago`:e.toLocaleDateString()})(e.createdAt)})]}),(0,er.jsx)("p",{className:"text-white/80 text-sm whitespace-pre-line",children:e.content})]})]},e.id)),c.error&&(0,er.jsx)("p",{className:"text-red-300 text-sm",children:c.error})]}),(0,er.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,er.jsx)(aN,{value:c.input,onChange:t=>{var r,s;return r=e.id,s=t.target.value,void k(e=>{let t=e[r];return t?{...e,[r]:{...t,input:s,error:null}}:e})},placeholder:"Write a comment...",rows:2,className:"flex-1 bg-white/5 border-white/20 text-white placeholder:text-white/50"}),(0,er.jsx)(tn,{onClick:()=>void P(e),disabled:c.isSubmitting||0===c.input.trim().length,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 self-center disabled:opacity-50",children:c.isSubmitting?(0,er.jsx)(iV,{className:"w-4 h-4 animate-spin"}):(0,er.jsx)(aE,{className:"w-4 h-4"})})]})]})]})]},e.id)}),(0,er.jsx)(lI,{open:!!N,post:N,onClose:()=>{_||S(null)},onSelect:e=>{T(e)}})]})}var lB=e.i(5190),lz=((s=lz||{}).Trace="trace",s.Debug="debug",s.Info="info",s.Warn="warn",s.Error="error",s.Silent="silent",s);let lq=(e,t,r)=>{let s=r?`, context: ${JSON.stringify(r)}`:"",n=`[${new Date().toISOString()}] ${t.valueOf().toUpperCase()} ably-chat: ${e}${s}`;switch(t){case"trace":case"debug":console.log(n);break;case"info":console.info(n);break;case"warn":console.warn(n);break;case"error":console.error(n)}},lF=new Map([["trace",0],["debug",1],["info",2],["warn",3],["error",4],["silent",5]]);class lH{constructor(e,t,r){this._handler=e,this._context=r;const s=lF.get(t);if(void 0===s)throw new lB.ErrorInfo(`Invalid log level: ${t}`,5e4,500);this._levelNumber=s}trace(e,t){this._write(e,"trace",0,t)}debug(e,t){this._write(e,"debug",1,t)}info(e,t){this._write(e,"info",2,t)}warn(e,t){this._write(e,"warn",3,t)}error(e,t){this._write(e,"error",4,t)}withContext(e){let t=[...lF.entries()].find(([,e])=>e===this._levelNumber)?.[0]??"error";return new lH(this._handler,t,this._mergeContext(e))}_write(e,t,r,s){r>=this._levelNumber&&this._handler(e,t,this._mergeContext(s))}_mergeContext(e){return this._context?e?{...this._context,...e}:this._context:e??void 0}}let lW={logLevel:lz.Error};function lG(e,t,r){if((Array.isArray(t)||"string"==typeof t)&&r)return e.on(t,r),()=>{e.off(r)};if("function"==typeof t)return e.on(t),()=>{e.off(t)};throw TypeError("Invalid arguments passed to on()")}function lV(e,t,r){if((Array.isArray(t)||"string"==typeof t)&&r){let s=e.subscribe(t,r);return()=>{s.then(()=>{e.unsubscribe(r)}).catch(e=>{console.error("Error subscribing to events:",e)})}}if("function"==typeof t){let r=e.subscribe(t);return()=>{r.then(()=>{e.unsubscribe(t)}).catch(e=>{console.error("Error subscribing to events:",e)})}}throw TypeError("Invalid arguments passed to subscribe()")}let lK=lB.Realtime.EventEmitter;class lJ extends lK{}let lY=e=>(...t)=>e(...t),lX=e=>{let t=Object.values(e.events).flat().length+e.any.length+Object.values(e.eventsOnce).flat().length+e.anyOnce.length;return!!t&&t>0};var lQ=((n=lQ||{}).Initialized="initialized",n.Connecting="connecting",n.Connected="connected",n.Disconnected="disconnected",n.Suspended="suspended",n.Failed="failed",n);class lZ{constructor(e,t){this._status="initialized",this._emitter=new lJ,this._logger=t,this._status=this._mapAblyStatusToChat(e.connection.state),this._error=e.connection.errorReason;const r=e=>{let t=this._mapAblyStatusToChat(e.current);if(t===this._status)return;let r={current:t,previous:this._status,error:e.reason,retryIn:e.retryIn};this._applyStatusChange(r)};this._clearAblyConnectionListener=lG(e.connection,r)}get status(){return this._status}get error(){return this._error}onStatusChange(e){let t=lY(e);return this._emitter.on(t),{off:()=>{this._emitter.off(t)}}}dispose(){this._logger.trace("DefaultConnection.dispose();"),this._clearAblyConnectionListener(),this._emitter.off()}hasListeners(){return lX(this._emitter)}_applyStatusChange(e){this._status=e.current,this._error=e.error,this._logger.info("Connection state changed",e),this._emitter.emit(e.current,e)}_mapAblyStatusToChat(e){switch(e){case"closing":case"closed":return"failed";default:return e}}}let l0=()=>Math.random().toString(36).slice(2);var l1=Object.prototype.hasOwnProperty;function l2(e,t,r){for(r of e.keys())if(l4(r,t))return r}function l4(e,t){var r,s,n;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((s=e.length)===t.length)for(;s--&&l4(e[s],t[s]););return -1===s}if(r===Set){if(e.size!==t.size)return!1;for(s of e)if((n=s)&&"object"==typeof n&&!(n=l2(t,n))||!t.has(n))return!1;return!0}if(r===Map){if(e.size!==t.size)return!1;for(s of e)if((n=s[0])&&"object"==typeof n&&!(n=l2(t,n))||!l4(s[1],t.get(n)))return!1;return!0}if(r===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(r===DataView){if((s=e.byteLength)===t.byteLength)for(;s--&&e.getInt8(s)===t.getInt8(s););return -1===s}if(ArrayBuffer.isView(e)){if((s=e.byteLength)===t.byteLength)for(;s--&&e[s]===t[s];);return -1===s}if(!r||"object"==typeof e){for(r in s=0,e)if(l1.call(e,r)&&++s&&!l1.call(t,r)||!(r in t)||!l4(e[r],t[r]))return!1;return Object.keys(t).length===s}}return e!=e&&t!=t}var l5=((i=l5||{}).Created="message.created",i.Updated="message.updated",i.Deleted="message.deleted",i),l3=((a=l3||{}).ChatMessage="chat.message",a),l6=((o=l6||{}).Occupancy="[meta]occupancy",o),l8=((l=l8||{}).MessageCreate="message.create",l.MessageUpdate="message.update",l.MessageDelete="message.delete",l.MessageAnnotationSummary="message.summary",l.MessageMetaOccupancy="meta.occupancy",l),l7=((c=l7||{}).Enter="enter",c.Leave="leave",c.Update="update",c.Present="present",c),l9=((d=l9||{}).Started="typing.started",d.Stopped="typing.stopped",d),ce=((u=ce||{}).SetChanged="typing.set.changed",u),ct=((h=ct||{}).Reaction="roomReaction",h),cr=((p=cr||{}).Reaction="reaction",p),cs=((f=cs||{}).Unique="unique",f.Distinct="distinct",f.Multiple="multiple",f),cn=((m=cn||{}).Unique="reaction:unique.v1",m.Distinct="reaction:distinct.v1",m.Multiple="reaction:multiple.v1",m);let ci={"reaction:unique.v1":"unique","reaction:distinct.v1":"distinct","reaction:multiple.v1":"multiple"};var ca=((g=ca||{}).Create="reaction.create",g.Delete="reaction.delete",g.Summary="reaction.summary",g),co=((b=co||{}).Updated="occupancy.updated",b),cl=((x=cl||{}).Discontinuity="room.discontinuity",x),cc="u">typeof globalThis?globalThis:"u">typeof window?window:e.g,cd={exports:{}};cd.exports;let cu=(et||(et=1,function(e,t){var r,s="__lodash_hash_undefined__",n="[object Arguments]",i="[object Boolean]",a="[object Date]",o="[object Function]",l="[object GeneratorFunction]",c="[object Map]",d="[object Number]",u="[object Object]",h="[object Promise]",p="[object RegExp]",f="[object Set]",m="[object String]",g="[object Symbol]",b="[object WeakMap]",x="[object ArrayBuffer]",y="[object DataView]",w="[object Float32Array]",v="[object Float64Array]",j="[object Int8Array]",k="[object Int16Array]",N="[object Int32Array]",S="[object Uint8Array]",_="[object Uint8ClampedArray]",C="[object Uint16Array]",E="[object Uint32Array]",R=/\w*$/,A=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,T={};T[n]=T["[object Array]"]=T[x]=T[y]=T[i]=T[a]=T[w]=T[v]=T[j]=T[k]=T[N]=T[c]=T[d]=T[u]=T[p]=T[f]=T[m]=T[g]=T[S]=T[_]=T[C]=T[E]=!0,T["[object Error]"]=T[o]=T[b]=!1;var I="object"==typeof cc&&cc&&cc.Object===Object&&cc,M="object"==typeof self&&self&&self.Object===Object&&self,P=I||M||Function("return this")(),D=t&&!t.nodeType&&t,L=D&&e&&!e.nodeType&&e,$=L&&L.exports===D;function U(e,t){return e.set(t[0],t[1]),e}function B(e,t){return e.add(t),e}function z(e,t,r,s){for(var n=-1,i=e?e.length:0;++n<i;)r=t(r,e[n],n,e);return r}function q(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch{}return t}function F(e){var t=-1,r=Array(e.size);return e.forEach(function(e,s){r[++t]=[s,e]}),r}function H(e,t){return function(r){return e(t(r))}}function W(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var G=Array.prototype,V=Function.prototype,K=Object.prototype,J=P["__core-js_shared__"],Y=(r=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",X=V.toString,Q=K.hasOwnProperty,Z=K.toString,ee=RegExp("^"+X.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=$?P.Buffer:void 0,er=P.Symbol,es=P.Uint8Array,en=H(Object.getPrototypeOf,Object),ei=Object.create,ea=K.propertyIsEnumerable,eo=G.splice,el=Object.getOwnPropertySymbols,ec=et?et.isBuffer:void 0,ed=H(Object.keys,Object),eu=eI(P,"DataView"),eh=eI(P,"Map"),ep=eI(P,"Promise"),ef=eI(P,"Set"),em=eI(P,"WeakMap"),eg=eI(Object,"create"),eb=eL(eu),ex=eL(eh),ey=eL(ep),ew=eL(ef),ev=eL(em),ej=er?er.prototype:void 0,ek=ej?ej.valueOf:void 0;function eN(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function eS(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function e_(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function eC(e){this.__data__=new eS(e)}function eE(e,t,r){var s=e[t];Q.call(e,t)&&e$(s,r)&&(void 0!==r||t in e)||(e[t]=r)}function eR(e,t){for(var r=e.length;r--;)if(e$(e[r][0],t))return r;return -1}function eA(e){var t=new e.constructor(e.byteLength);return new es(t).set(new es(e)),t}function eO(e,t,r,s){r||(r={});for(var n=-1,i=t.length;++n<i;){var a=t[n];eE(r,a,e[a])}return r}function eT(e,t){var r,s,n=e.__data__;return("string"==(s=typeof(r=t))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function eI(e,t){var r,s=e?.[t];return!(!eF(s)||(r=s,Y&&Y in r))&&(eq(s)||q(s)?ee:A).test(eL(s))?s:void 0}eN.prototype.clear=function(){this.__data__=eg?eg(null):{}},eN.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},eN.prototype.get=function(e){var t=this.__data__;if(eg){var r=t[e];return r===s?void 0:r}return Q.call(t,e)?t[e]:void 0},eN.prototype.has=function(e){var t=this.__data__;return eg?void 0!==t[e]:Q.call(t,e)},eN.prototype.set=function(e,t){return this.__data__[e]=eg&&void 0===t?s:t,this},eS.prototype.clear=function(){this.__data__=[]},eS.prototype.delete=function(e){var t=this.__data__,r=eR(t,e);return!(r<0)&&(r==t.length-1?t.pop():eo.call(t,r,1),!0)},eS.prototype.get=function(e){var t=this.__data__,r=eR(t,e);return r<0?void 0:t[r][1]},eS.prototype.has=function(e){return eR(this.__data__,e)>-1},eS.prototype.set=function(e,t){var r=this.__data__,s=eR(r,e);return s<0?r.push([e,t]):r[s][1]=t,this},e_.prototype.clear=function(){this.__data__={hash:new eN,map:new(eh||eS),string:new eN}},e_.prototype.delete=function(e){return eT(this,e).delete(e)},e_.prototype.get=function(e){return eT(this,e).get(e)},e_.prototype.has=function(e){return eT(this,e).has(e)},e_.prototype.set=function(e,t){return eT(this,e).set(e,t),this},eC.prototype.clear=function(){this.__data__=new eS},eC.prototype.delete=function(e){return this.__data__.delete(e)},eC.prototype.get=function(e){return this.__data__.get(e)},eC.prototype.has=function(e){return this.__data__.has(e)},eC.prototype.set=function(e,t){var r=this.__data__;if(r instanceof eS){var s=r.__data__;if(!eh||s.length<199)return s.push([e,t]),this;r=this.__data__=new e_(s)}return r.set(e,t),this};var eM=el?H(el,Object):function(){return[]},eP=function(e){return Z.call(e)};function eD(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||K)}function eL(e){if(null!=e){try{return X.call(e)}catch{}try{return e+""}catch{}}return""}function e$(e,t){return e===t||e!=e&&t!=t}(eu&&eP(new eu(new ArrayBuffer(1)))!=y||eh&&eP(new eh)!=c||ep&&eP(ep.resolve())!=h||ef&&eP(new ef)!=f||em&&eP(new em)!=b)&&(eP=function(e){var t=Z.call(e),r=t==u?e.constructor:void 0,s=r?eL(r):void 0;if(s)switch(s){case eb:return y;case ex:return c;case ey:return h;case ew:return f;case ev:return b}return t});var eU=Array.isArray;function eB(e){var t;return null!=e&&"number"==typeof(t=e.length)&&t>-1&&t%1==0&&t<=0x1fffffffffffff&&!eq(e)}var ez=ec||function(){return!1};function eq(e){var t=eF(e)?Z.call(e):"";return t==o||t==l}function eF(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function eH(e){return eB(e)?function(e,t){var r,s,i,a,o,l=eU(e)||(i=s=r=e)&&"object"==typeof i&&eB(s)&&Q.call(r,"callee")&&(!ea.call(r,"callee")||Z.call(r)==n)?function(e,t){for(var r=-1,s=Array(e);++r<e;)s[r]=t(r);return s}(e.length,String):[],c=l.length,d=!!c;for(var u in e){Q.call(e,u)&&!(d&&("length"==u||(a=u,(o=(o=c)??0x1fffffffffffff)&&("number"==typeof a||O.test(a))&&a>-1&&a%1==0&&a<o)))&&l.push(u)}return l}(e):function(e){if(!eD(e))return ed(e);var t=[];for(var r in Object(e))Q.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return function e(t,r,s,h,b,A,O){if(h&&(I=A?h(t,b,A,O):h(t)),void 0!==I)return I;if(!eF(t))return t;var I,M=eU(t);if(M){if(D=(P=t).length,L=P.constructor(D),D&&"string"==typeof P[0]&&Q.call(P,"index")&&(L.index=P.index,L.input=P.input),I=L,!r){var P,D,L,$=t,H=I,G=-1,V=$.length;for(H||(H=Array(V));++G<V;)H[G]=$[G];return H}}else{var K,J,Y,X,Z,ee=eP(t),et=ee==o||ee==l;if(ez(t)){var er=t,es=r;if(es)return er.slice();var ea=new er.constructor(er.length);return er.copy(ea),ea}if(ee==u||ee==n||et&&!A){if(q(t))return A?t:{};if(I="function"!=typeof(K=et?{}:t).constructor||eD(K)?{}:eF(J=en(K))?ei(J):{},!r){return Y=t,X=(Z=I)&&eO(t,eH(t),Z),eO(Y,eM(Y),X)}}else{if(!T[ee])return A?t:{};I=function(e,t,r,s){var n,o,l,u=e.constructor;switch(t){case x:return eA(e);case i:case a:return new u(+e);case y:return n=s?eA(e.buffer):e.buffer,new e.constructor(n,e.byteOffset,e.byteLength);case w:case v:case j:case k:case N:case S:case _:case C:case E:return o=s?eA(e.buffer):e.buffer,new e.constructor(o,e.byteOffset,e.length);case c:return z(s?r(F(e),!0):F(e),U,new e.constructor);case d:case m:return new u(e);case p:return(l=new e.constructor(e.source,R.exec(e))).lastIndex=e.lastIndex,l;case f:return z(s?r(W(e),!0):W(e),B,new e.constructor);case g:return ek?Object(ek.call(e)):{}}}(t,ee,e,r)}}O||(O=new eC);var eo=O.get(t);if(eo)return eo;if(O.set(t,I),!M)var el=s?function(e){var t;return t=eH(e),eU(e)?t:function(e,t){for(var r=-1,s=t.length,n=e.length;++r<s;)e[n+r]=t[r];return e}(t,eM(e))}(t):eH(t);return function(e,t){for(var r=-1,s=e?e.length:0;++r<s&&!1!==t(e[r],r,e););}(el||t,function(n,i){el&&(n=t[i=n]),eE(I,i,e(n,r,s,h,i,t,O))}),I}(e,!0,!0)}}(cd,cd.exports)),(B=cd.exports)&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default"))?B.default:B;class ch{constructor({serial:e,clientId:t,text:r,metadata:s,headers:n,action:i,version:a,timestamp:o,reactions:l}){this.serial=e,this.clientId=t,this.text=r,this.metadata=s,this.headers=n,this.action=i,this.version=a,this.timestamp=o,this.reactions=l,Object.freeze(this.version),Object.freeze(this.reactions),Object.freeze(this.reactions.multiple),Object.freeze(this.reactions.distinct),Object.freeze(this.reactions.unique),Object.freeze(this)}get isUpdated(){return this.action===l8.MessageUpdate}get isDeleted(){return this.action===l8.MessageDelete}get updatedBy(){return this.isUpdated?this.version.clientId:void 0}get deletedBy(){return this.isDeleted?this.version.clientId:void 0}get updatedAt(){return this.isUpdated?this.version.timestamp:void 0}get deletedAt(){return this.isDeleted?this.version.timestamp:void 0}isOlderVersionOf(e){return this._compareVersions(this,e,(e,t)=>e.serial<t.serial)}isNewerVersionOf(e){return this._compareVersions(this,e,(e,t)=>e.serial>t.serial)}isSameVersionAs(e){return this._compareVersions(this,e,(e,t)=>e.serial===t.serial)}_isNewerOrSameVersionOf(e){return this._compareVersions(this,e,(e,t)=>e.serial>=t.serial)}before(e){return this.serial<e.serial}after(e){return this.serial>e.serial}equal(e){return this.serial===e.serial}isSameAs(e){return this.equal(e)}with(e){if("serial"in e)return this._getLatestMessageVersion(e);if(e.type===l5.Created)throw new lB.ErrorInfo("cannot apply a created event to a message",4e4,400);if(e.type===ca.Summary){if(e.summary.messageSerial!==this.serial)throw new lB.ErrorInfo("cannot apply event for a different message",4e4,400);let t={unique:cu(e.summary.unique),distinct:cu(e.summary.distinct),multiple:cu(e.summary.multiple)};return ch._clone(this,{reactions:t})}return this._getLatestMessageVersion(e.message)}_compareVersions(e,t,r){return!!e.equal(t)&&e.equal(t)&&r(e.version,t.version)}_getLatestMessageVersion(e){if(e.serial!==this.serial)throw new lB.ErrorInfo("cannot apply event for a different message",4e4,400);return this._isNewerOrSameVersionOf(e)?this:ch._clone(e,{reactions:this.reactions})}static _clone(e,t){return new ch({serial:t?.serial??e.serial,clientId:t?.clientId??e.clientId,text:t?.text??e.text,metadata:t?.metadata??cu(e.metadata),headers:t?.headers??cu(e.headers),action:t?.action??e.action,version:t?.version??cu(e.version),timestamp:t?.timestamp??e.timestamp,reactions:t?.reactions??cu(e.reactions)})}copy(e={}){return ch._clone(this,e)}}let cp=()=>({unique:{},distinct:{},multiple:{}}),cf=e=>{let t="";if("string"==typeof e)t=e;else try{"serial"in e&&(t=e.serial)}catch{}if(""===t)throw new lB.ErrorInfo("invalid serial; must be string or object with serial property",4e4,400);return t},cm={"annotation.create":ca.Create,"annotation.delete":ca.Delete};class cg{constructor(e,t,r,s,n){this._logger=e,this._options=t,this._api=r,this._roomName=s,this._channel=n,this._emitter=new lJ,this._unsubscribeMessageEvents=lV(n,this._processMessageEvent.bind(this)),this._options?.rawMessageReactions&&(this._unsubscribeAnnotationEvents=lV(n.annotations,this._processAnnotationEvent.bind(this))),this._defaultType=this._options?.defaultMessageReactionType??cs.Distinct}_processAnnotationEvent(e){this._logger.trace("MessagesReactions._processAnnotationEvent();",{event:e});let t=ci[e.type];if(!t)return void this._logger.info("MessagesReactions._processAnnotationEvent(); ignoring unknown reaction type",{event:e});let r=cm[e.action];if(!r)return void this._logger.info("MessagesReactions._processAnnotationEvent(); ignoring unknown reaction event type",{event:e});let s=e.name??"",n={type:r,timestamp:new Date(e.timestamp),reaction:{messageSerial:e.messageSerial,type:t,name:s,clientId:e.clientId??""}};e.count?n.reaction.count=e.count:r===ca.Create&&t===cs.Multiple&&(n.reaction.count=1),this._emitter.emit(r,n)}_processMessageEvent(e){if(this._logger.trace("MessagesReactions._processMessageEvent();",{event:e}),e.action!==l8.MessageAnnotationSummary.valueOf())return;let t=e.serial,r=e.annotations.summary,s=r[cn.Unique]??{},n=r[cn.Distinct]??{},i=r[cn.Multiple]??{};this._emitter.emit(ca.Summary,{type:ca.Summary,summary:{messageSerial:t,unique:s,distinct:n,multiple:i}})}send(e,t){this._logger.trace("MessagesReactions.send();",{messageSerial:e,params:t});let r=cf(e),{type:s,count:n}=t;s||(s=this._defaultType),s!==cs.Multiple||n||(n=1);let i={type:s,name:t.name};return n&&(i.count=n),this._api.sendMessageReaction(this._roomName,r,i)}delete(e,t){this._logger.trace("MessagesReactions.delete();",{messageSerial:e,params:t});let r=cf(e),s=t?.type;if(s||(s=this._defaultType),s!==cs.Unique&&!t?.name)throw new lB.ErrorInfo(`cannot delete reaction of type ${s} without a name`,40001,400);let n={type:s};return s!==cs.Unique&&(n.name=t?.name),this._api.deleteMessageReaction(this._roomName,r,n)}subscribe(e){this._logger.trace("MessagesReactions.subscribe();");let t=lY(e);return this._emitter.on(ca.Summary,t),{unsubscribe:()=>{this._emitter.off(t)}}}subscribeRaw(e){if(this._logger.trace("MessagesReactions.subscribeRaw();"),!this._options?.rawMessageReactions)throw new lB.ErrorInfo("Raw message reactions are not enabled",40001,400);let t=lY(e);return this._emitter.on([ca.Create,ca.Delete],t),{unsubscribe:()=>{this._emitter.off(t)}}}static channelOptionMerger(e){return t=>(t.modes.includes("ANNOTATION_PUBLISH")||t.modes.push("ANNOTATION_PUBLISH"),e.messages.rawMessageReactions&&!t.modes.includes("ANNOTATION_SUBSCRIBE")&&t.modes.push("ANNOTATION_SUBSCRIBE"),t)}clientReactions(e,t){this._logger.trace("MessagesReactions.clientReactions();",{messageSerial:e,clientId:t});let r=cf(e);return this._api.getClientReactions(this._roomName,r,t)}dispose(){this._logger.trace("DefaultMessageReactions.dispose();"),this._emitter.off(),this._unsubscribeMessageEvents(),this._unsubscribeAnnotationEvents?.(),this._logger.debug("DefaultMessageReactions.dispose(); disposed successfully")}hasListeners(){return lX(this._emitter)}}let cb=e=>{let t={...cp(),...e.reactions},r=Object.values(l8).includes(e.action)?e.action:l8.MessageCreate,s={serial:e.version.serial,timestamp:new Date(e.version.timestamp),clientId:e.version.clientId,description:e.version.description,metadata:e.version.metadata};return new ch({serial:e.serial,clientId:e.clientId,text:e.text,metadata:e.metadata,headers:e.headers,action:r,version:s,timestamp:new Date(e.timestamp),reactions:t})},cx=new Map([[l8.MessageCreate,l5.Created],[l8.MessageUpdate,l5.Updated],[l8.MessageDelete,l5.Deleted]]);var cy=((y=cy||{}).OldestFirst="oldestFirst",y.NewestFirst="newestFirst",y);class cw{constructor(e,t,r,s,n,i){this._pendingPromiseRejecters=new Set,this._pendingAttachListeners=new Set,this._emitter=new lJ,this._roomName=e,this._options=t,this._channel=r,this._chatApi=s,this._clientId=n,this._logger=i,this._listenerSubscriptionPoints=new Map,this._reactions=new cg(this._logger,t,this._chatApi,this._roomName,this._channel);const a=this._processEvent.bind(this),o=e=>{this._handleAttach(e.resumed)},l=e=>{"attached"===e.current&&"attached"===e.previous&&this._handleAttach(e.resumed)};this._unsubscribeMessageEvents=lV(this._channel,[l3.ChatMessage],a),this._offChannelAttached=lG(this._channel,"attached",o),this._offChannelUpdate=lG(this._channel,"update",l)}get reactions(){return this._reactions}async _getBeforeSubscriptionStart(e,t){this._logger.trace("DefaultSubscriptionManager.getBeforeSubscriptionStart();");let r=this._listenerSubscriptionPoints.get(e);if(void 0===r)throw this._logger.error("DefaultSubscriptionManager.getBeforeSubscriptionStart(); listener has not been subscribed yet"),new lB.ErrorInfo("cannot query history; listener has not been subscribed yet",4e4,400);let s=await r;return this._chatApi.history(this._roomName,{...t,orderBy:"newestFirst",...s})}_handleAttach(e){if(this._logger.trace("DefaultSubscriptionManager.handleAttach();"),e)return;let t=this._subscribeAtChannelAttach();for(let[e]of this._listenerSubscriptionPoints.entries())this._listenerSubscriptionPoints.set(e,t)}async _resolveSubscriptionStart(){let e=this._getChannelProperties();if("attached"===e.state){if(e.properties.channelSerial)return{fromSerial:e.properties.channelSerial};throw this._logger.error("DefaultSubscriptionManager.handleAttach(); channelSerial is undefined"),new lB.ErrorInfo("channel is attached, but channelSerial is not defined",4e4,400)}return this._subscribeAtChannelAttach()}_getChannelProperties(){return this._channel}async _subscribeAtChannelAttach(){let e=this._getChannelProperties();return new Promise((t,r)=>{this._pendingPromiseRejecters.add(r);let s=()=>{this._pendingPromiseRejecters.delete(r)};if("attached"===e.state){this._logger.debug("Messages._subscribeAtChannelAttach(); channel is attached already, using attachSerial",{attachSerial:e.properties.attachSerial}),s(),e.properties.attachSerial?t({fromSerial:e.properties.attachSerial}):(this._logger.error("DefaultSubscriptionManager.handleAttach(); attachSerial is undefined"),s(),r(new lB.ErrorInfo("channel is attached, but attachSerial is not defined",4e4,400)));return}let n=function(e,t,r){if(r)return e.once(t,r),()=>{e.off(r)};throw TypeError("Invalid arguments passed to once()")}(e,"attached",()=>{this._logger.debug("Messages._subscribeAtChannelAttach(); channel is now attached, using attachSerial",{attachSerial:e.properties.attachSerial}),s(),this._pendingAttachListeners.delete(n),e.properties.attachSerial?t({fromSerial:e.properties.attachSerial}):(this._logger.error("DefaultSubscriptionManager.handleAttach(); attachSerial is undefined"),r(new lB.ErrorInfo("channel is attached, but attachSerial is not defined",4e4,400)))});this._pendingAttachListeners.add(n)})}async history(e){return this._logger.trace("Messages.query();"),this._chatApi.history(this._roomName,e)}get(e){return this._logger.trace("Messages.get();",{serial:e}),this._chatApi.getMessage(this._roomName,cf(e))}async send(e){this._logger.trace("Messages.send();",{params:e});let{text:t,metadata:r,headers:s}=e,n=await this._chatApi.sendMessage(this._roomName,{text:t,headers:s,metadata:r}),i=new Date(n.timestamp);return new ch({serial:n.serial,clientId:this._clientId,text:t,metadata:r??{},headers:s??{},action:l8.MessageCreate,version:{serial:n.serial,timestamp:i},timestamp:i,reactions:cp()})}async delete(e,t){return this._logger.trace("Messages.delete();",{params:t}),e=cf(e),this._logger.debug("Messages.delete(); serial",{serial:e}),cb(await this._chatApi.deleteMessage(this._roomName,e,t))}async update(e,t,r){this._logger.trace("Messages.update();",{updateParams:t,details:r}),e=cf(e),this._logger.debug("Messages.update(); serial",{serial:e});let s=await this._chatApi.updateMessage(this._roomName,e,{message:{text:t.text,metadata:t.metadata,headers:t.headers},...r});return this._logger.debug("Messages.update(); message update successfully",{updateParams:t}),cb(s)}subscribe(e){this._logger.trace("Messages.subscribe();");let t=lY(e);this._emitter.on([l5.Created,l5.Updated,l5.Deleted],t);let r=this._resolveSubscriptionStart();return r.catch(()=>{this._logger.debug("Messages.subscribe(); subscription point was not resolved before the room was released")}),this._listenerSubscriptionPoints.set(t,r),{unsubscribe:()=>{this._listenerSubscriptionPoints.delete(t),this._logger.trace("Messages.unsubscribe();"),this._emitter.off(t)},historyBeforeSubscribe:e=>this._getBeforeSubscriptionStart(t,e)}}_processEvent(e){let t,r,s,n,i,a,o,l,c;this._logger.trace("Messages._processEvent();",{channelEventMessage:e});let{action:d}=e,u=cx.get(d);if(!u)return void this._logger.debug("Messages._processEvent(); received unknown message action",{action:d});let h=(t=e.data&&"object"==typeof e.data?e.data:{},r=e.extras&&"object"==typeof e.extras?e.extras:{},s=e.clientId||"",n=t.text||"",i=new Date(e.timestamp||0),a=e.serial||"",o=t.metadata&&"object"==typeof t.metadata?t.metadata:{},l=r.headers||{},c={...e.version,serial:e.version.serial||a,timestamp:new Date(e.version.timestamp||i)},new ch({serial:a,clientId:s,text:n,metadata:o,headers:l,action:Object.values(l8).includes(e.action)?e.action:l8.MessageCreate,version:c,timestamp:i,reactions:cp()}));this._emitter.emit(u,{type:u,message:h})}dispose(){this._logger.trace("DefaultMessages.dispose();"),this._emitter.off();let e=new lB.ErrorInfo("room has been disposed",4e4,400);for(let t of this._pendingPromiseRejecters)try{t(e)}catch{}for(let e of(this._pendingPromiseRejecters.clear(),this._listenerSubscriptionPoints.clear(),this._pendingAttachListeners))e();this._pendingAttachListeners.clear(),this._unsubscribeMessageEvents(),this._offChannelAttached(),this._offChannelUpdate(),this._reactions.dispose(),this._logger.debug("DefaultMessages.dispose(); disposed successfully")}hasListeners(){return lX(this._emitter)}}class cv{constructor(e,t){this._apiProtocolVersion=4,this._realtime=e,this._logger=t}async history(e,t){let r={...t};if(t.orderBy)switch(t.orderBy){case cy.NewestFirst:r.direction="backwards";break;case cy.OldestFirst:r.direction="forwards";break;default:throw new lB.ErrorInfo(`invalid orderBy value: ${t.orderBy}`,4e4,400)}let s=await this._makeAuthorizedPaginatedRequest(this._roomUrl(e,"/messages"),r);return this._recursivePaginateMessages(s)}_recursivePaginateMessages(e){let t={};return t.items=e.items.map(e=>cb(e)),t.next=()=>e.next().then(e=>e?this._recursivePaginateMessages(e):null),t.first=()=>e.first().then(e=>this._recursivePaginateMessages(e)),t.current=()=>e.current().then(e=>this._recursivePaginateMessages(e)),t.hasNext=()=>e.hasNext(),t.isLast=()=>e.isLast(),{...e,...t}}async getMessage(e,t){return cb(await this._makeAuthorizedRequest(this._messageUrl(e,t),"GET"))}deleteMessage(e,t,r){let s={...r?.description&&{description:r.description},...r?.metadata&&{metadata:r.metadata}};return this._makeAuthorizedRequest(this._messageUrl(e,t,"/delete"),"POST",s,{})}sendMessage(e,t){let r={text:t.text,...t.metadata&&{metadata:t.metadata},...t.headers&&{headers:t.headers}};return this._makeAuthorizedRequest(this._roomUrl(e,"/messages"),"POST",r)}updateMessage(e,t,r){return this._makeAuthorizedRequest(this._messageUrl(e,t),"PUT",r)}sendMessageReaction(e,t,r){return this._makeAuthorizedRequest(this._messageUrl(e,t,"/reactions"),"POST",r)}deleteMessageReaction(e,t,r){return this._makeAuthorizedRequest(this._messageUrl(e,t,"/reactions"),"DELETE",void 0,r)}getClientReactions(e,t,r){return this._makeAuthorizedRequest(this._messageUrl(e,t,"/client-reactions"),"GET",void 0,r?{forClientId:r}:{})}getOccupancy(e){return this._makeAuthorizedRequest(this._roomUrl(e,"/occupancy"),"GET")}async _makeAuthorizedRequest(e,t,r,s){return(await this._doRequest(e,t,s,r)).items[0]}async _makeAuthorizedPaginatedRequest(e,t,r){return this._doRequest(e,"GET",t,r)}async _doRequest(e,t,r,s){let n=await this._realtime.request(t,e,this._apiProtocolVersion,r,s);if(!n.success)throw this._logger.error("ChatApi._doRequest(); failed to make request",{url:e,method:t,statusCode:n.statusCode,errorCode:n.errorCode,errorMessage:n.errorMessage}),new lB.ErrorInfo(n.errorMessage,n.errorCode,n.statusCode);return n}_roomUrl(e,t=""){return`/chat/v4/rooms/${encodeURIComponent(e)}${t}`}_messageUrl(e,t,r=""){return`${this._roomUrl(e,"/messages")}/${encodeURIComponent(t)}${r}`}}var cj=((w=cj||{})[w.BadRequest=4e4]="BadRequest",w[w.MessageRejectedByBeforePublishRule=42211]="MessageRejectedByBeforePublishRule",w[w.MessageRejectedByModeration=42213]="MessageRejectedByModeration",w[w.PresenceAutoReentryFailed=91004]="PresenceAutoReentryFailed",w[w.RoomDiscontinuity=102100]="RoomDiscontinuity",w[w.RoomInFailedState=102101]="RoomInFailedState",w[w.RoomIsReleasing=102102]="RoomIsReleasing",w[w.RoomIsReleased=102103]="RoomIsReleased",w[w.RoomReleasedBeforeOperationCompleted=102106]="RoomReleasedBeforeOperationCompleted",w);let ck="0.14.1",cN=`chat-js/${ck}`,cS=`chat-react/${ck}`,c_=["PUBLISH","SUBSCRIBE"],cC={params:{agent:cN},attachOnSubscribe:!1,modes:c_},cE={params:{agent:`${cN} ${cS}`},attachOnSubscribe:!1,modes:c_};class cR{constructor(e,t,r,s){r.trace("ChannelManager();",{isReact:s}),this._realtime=t,this._logger=r,this._isReact=s,this._registeredOptions=this._defaultChannelOptions(),this._channelId=`${e}::$chat`}mergeOptions(e){if(this._logger.trace("ChannelManager.mergeOptions();"),this._resolvedChannel)throw this._logger.error("channel options cannot be modified after the channel has been requested"),new lB.ErrorInfo("channel options cannot be modified after the channel has been requested",4e4,400);this._registeredOptions=e(this._registeredOptions)}get(){return this._logger.trace("ChannelManager.get();"),this._resolvedChannel??=this._realtime.channels.get(this._channelId,this._registeredOptions),this._resolvedChannel}release(){this._logger.trace("ChannelManager.release();",{channelId:this._channelId}),this._resolvedChannel&&this._realtime.channels.release(this._channelId)}_defaultChannelOptions(){this._logger.trace("ChannelManager._defaultChannelOptions();");let e=this._isReact?cE:cC;return this._logger.trace(this._isReact?"using react channel options":"using default channel options"),{...e,modes:[...e.modes??[]]}}}class cA{constructor(e,t,r,s,n){this._emitter=new lJ,this._roomName=e,this._channel=t,this._chatApi=r,this._logger=s,this._roomOptions=n;const i=this._internalOccupancyListener.bind(this);this._roomOptions.occupancy.enableEvents?(this._logger.debug("DefaultOccupancy(); subscribing to occupancy events"),this._unsubscribeOccupancyEvents=lV(this._channel,[l6.Occupancy],i)):this._unsubscribeOccupancyEvents=()=>{}}subscribe(e){if(this._logger.trace("Occupancy.subscribe();"),!this._roomOptions.occupancy.enableEvents)throw new lB.ErrorInfo("cannot subscribe to occupancy; occupancy events are not enabled in room options",4e4,400);let t=lY(e);return this._emitter.on(t),{unsubscribe:()=>{this._logger.trace("Occupancy.unsubscribe();"),this._emitter.off(t)}}}async get(){return this._logger.trace("Occupancy.get();"),this._chatApi.getOccupancy(this._roomName)}current(){if(this._logger.trace("Occupancy.current();"),!this._roomOptions.occupancy.enableEvents)throw new lB.ErrorInfo("cannot get current occupancy; occupancy events are not enabled in room options",4e4,400);return this._latestOccupancyData}_internalOccupancyListener(e){this._logger.trace("Occupancy._internalOccupancyListener();",e),this._latestOccupancyData=(e=>{let t=0,r=0;if(!e.data||"object"!=typeof e.data)return{connections:t,presenceMembers:r};let{metrics:s}=e.data;return s&&"object"==typeof s&&("number"==typeof s.connections&&Number.isInteger(s.connections)&&(t=s.connections),"number"==typeof s.presenceMembers&&Number.isInteger(s.presenceMembers)&&(r=s.presenceMembers)),{connections:t,presenceMembers:r}})(e),this._emitter.emit(co.Updated,{type:co.Updated,occupancy:this._latestOccupancyData})}static channelOptionMerger(e){return t=>e.occupancy.enableEvents?{...t,params:{...t.params,occupancy:"metrics"}}:t}dispose(){this._logger.trace("DefaultOccupancy.dispose();"),this._unsubscribeOccupancyEvents(),this._emitter.off(),this._logger.debug("DefaultOccupancy.dispose(); disposed successfully")}hasListeners(){return lX(this._emitter)}}class cO{constructor(e,t,r,s){this._emitter=new lJ,this._stateEmitter=new lJ,this._presenceState={present:!1},this.subscribeToEvents=e=>{this._emitter.emit(e.action,{type:e.action,member:this._realtimeMemberToPresenceMember(e)})},this._channel=e,this._clientId=t,this._logger=r,this._options=s;const n=this.subscribeToEvents.bind(this),i=e=>{if(e.reason?.code===91004){this._logger.debug("Presence auto-reentry failed",{reason:e.reason}),this._emitPresenceStateChange(!1,e.reason);return}if("detached"===e.current)return void this._emitPresenceStateChange(!1)},a=e=>{this._emitPresenceStateChange(!1,e.reason)};this._offChannelUpdate=lG(this._channel,"update",i),this._offChannelDetach=lG(this._channel,["detached","failed"],a),this._unsubscribePresenceEvents=lV(this._channel.presence,n)}async get(e){return this._logger.trace("Presence.get()",{params:e}),this._assertChannelState(),(await this._channel.presence.get(e)).map(e=>this._realtimeMemberToPresenceMember(e))}async isUserPresent(e){return this._logger.trace("Presence.isUserPresent()",{clientId:e}),this._assertChannelState(),(await this._channel.presence.get({clientId:e})).length>0}async enter(e){this._logger.trace("Presence.enter()",{data:e}),this._assertChannelState();try{await this._channel.presence.enterClient(this._clientId,e),this._emitPresenceStateChange(!0)}catch(e){throw this._emitPresenceStateChange(!1,e),e}}async update(e){this._logger.trace("Presence.update()",{data:e}),this._assertChannelState();try{await this._channel.presence.updateClient(this._clientId,e),this._emitPresenceStateChange(!0)}catch(e){throw this._emitPresenceStateChange(!1,e),e}}async leave(e){this._logger.trace("Presence.leave()",{data:e}),this._assertChannelState();try{await this._channel.presence.leaveClient(this._clientId,e),this._emitPresenceStateChange(!1)}catch(e){throw this._emitPresenceStateChange(!1,e),e}}subscribe(e,t){if(this._logger.trace("Presence.subscribe(); listenerOrEvents",{listenerOrEvents:e}),!this._options.presence.enableEvents)throw this._logger.error("could not subscribe to presence; presence events are not enabled"),new lB.ErrorInfo("could not subscribe to presence; presence events are not enabled",4e4,400);if(!e&&!t)throw this._logger.error("could not subscribe to presence; invalid arguments"),new lB.ErrorInfo("could not subscribe listener: invalid arguments",4e4,400);if(t){let r=lY(t);return this._emitter.on(e,r),{unsubscribe:()=>{this._logger.trace("Presence.unsubscribe();",{events:e}),this._emitter.off(r)}}}{let t=lY(e);return this._emitter.on(t),{unsubscribe:()=>{this._logger.trace("Presence.unsubscribe();"),this._emitter.off(t)}}}}static channelOptionMerger(e){return t=>(t.modes.includes("PRESENCE")||t.modes.push("PRESENCE"),e.presence.enableEvents&&!t.modes.includes("PRESENCE_SUBSCRIBE")&&t.modes.push("PRESENCE_SUBSCRIBE"),t)}dispose(){this._logger.trace("DefaultPresence.dispose();"),this._emitter.off(),this._unsubscribePresenceEvents(),this._offChannelUpdate(),this._offChannelDetach(),this._logger.debug("DefaultPresence.dispose(); disposed successfully")}hasListeners(){return lX(this._emitter)}_realtimeMemberToPresenceMember(e){return{...e,data:e.data,updatedAt:new Date(e.timestamp)}}_assertChannelState(){if("attaching"!==this._channel.state&&"attached"!==this._channel.state)throw this._logger.error("could not perform presence operation; room is not attached"),new lB.ErrorInfo("could not perform presence operation; room is not attached",4e4,400)}_emitPresenceStateChange(e,t){this._logger.trace("Presence._emitPresenceStateChange()",{present:e,error:t});let r={...this._presenceState};this._presenceState={present:e};let s={previous:r,current:this._presenceState,error:t};this._stateEmitter.emit("presence.state.change",s)}onPresenceStateChange(e){this._logger.trace("Presence.onPresenceStateChange()");let t=lY(e);return this._stateEmitter.on("presence.state.change",t),{unsubscribe:()=>{this._logger.trace("Presence.unsubscribeFromPresenceStateChanges()"),this._stateEmitter.off(t)}}}}let cT=Error("request for lock canceled");class cI{constructor(e,t=cT){this._value=e,this._cancelError=t,this._queue=[],this._weightedWaiters=[]}acquire(e=1,t=0){if(e<=0)throw Error(`invalid weight ${e}: must be positive`);return new Promise((r,s)=>{let n={resolve:r,reject:s,weight:e,priority:t},i=cM(this._queue,e=>t<=e.priority);-1===i&&e<=this._value?this._dispatchItem(n):this._queue.splice(i+1,0,n)})}runExclusive(e){var t,r,s,n;return t=this,r=arguments,s=void 0,n=function*(e,t=1,r=0){let[s,n]=yield this.acquire(t,r);try{return yield e(s)}finally{n()}},new(s||(s=Promise))(function(e,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof s?r:new s(function(e){e(r)})).then(a,o)}l((n=n.apply(t,r||[])).next())})}waitForUnlock(e=1,t=0){if(e<=0)throw Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,t)?Promise.resolve():new Promise(r=>{var s,n;let i;this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),s=this._weightedWaiters[e-1],n={resolve:r,priority:t},i=cM(s,e=>n.priority<=e.priority),s.splice(i+1,0,n)})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){let t=this._value;this._value-=e.weight,e.resolve([t,this._newReleaser(e.weight)])}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){if(0===this._queue.length)for(let e=this._value;e>0;e--){let t=this._weightedWaiters[e-1];t&&(t.forEach(e=>e.resolve()),this._weightedWaiters[e-1]=[])}else{let e=this._queue[0].priority;for(let t=this._value;t>0;t--){let r=this._weightedWaiters[t-1];if(!r)continue;let s=r.findIndex(t=>t.priority<=e);(-1===s?r:r.splice(0,s)).forEach(e=>e.resolve())}}}_couldLockImmediately(e,t){return(0===this._queue.length||this._queue[0].priority<t)&&e<=this._value}}function cM(e,t){for(let r=e.length-1;r>=0;r--)if(t(e[r]))return r;return -1}class cP{constructor(e){this._semaphore=new cI(1,e)}acquire(){var e,t,r,s;return e=this,t=arguments,r=void 0,s=function*(e=0){let[,t]=yield this._semaphore.acquire(1,e);return t},new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})}runExclusive(e,t=0){return this._semaphore.runExclusive(()=>e(),1,t)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(e=0){return this._semaphore.waitForUnlock(1,e)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}var cD=((v=cD||{}).Initializing="initializing",v.Initialized="initialized",v.Attaching="attaching",v.Attached="attached",v.Detaching="detaching",v.Detached="detached",v.Suspended="suspended",v.Failed="failed",v.Releasing="releasing",v.Released="released",v);class cL{constructor(e){this._status="initialized",this._emitter=new lJ,this._logger=e}get status(){return this._status}get error(){return this._error}onChange(e){let t=lY(e);return this._emitter.on(t),{off:()=>{this._emitter.off(t)}}}setStatus(e){let t={current:e.status,error:e.error,previous:this._status};this._status=t.current,this._error=t.error,this._logger.info("room status changed",{...t}),this._emitter.emit(t.current,t)}dispose(){this._logger.trace("DefaultRoomLifecycle.dispose();"),this._emitter.off(),this._logger.debug("DefaultRoomLifecycle.dispose(); disposed successfully")}hasListeners(){return lX(this._emitter)}}class c${constructor(e,t,r){this._channelManager=e,this._roomLifecycle=t,this._logger=r,this._eventEmitter=new lJ,this._hasAttachedOnce=!1,this._isExplicitlyDetached=!1,this._mutex=new cP;const s=this._channelStateListener.bind(this),n=this._discontinuityOnAttachedListener.bind(this),i=this._discontinuityOnUpdateListener.bind(this),a=this._channelManager.get();this._unsubscribeChannelStateListener=lG(a,s),this._offDiscontinuityAttached=lG(a,"attached",n),this._offDiscontinuityUpdate=lG(a,"update",i)}onDiscontinuity(e){this._logger.trace("RoomLifecycleManager.onDiscontinuity()");let t=lY(e);return this._eventEmitter.on(cl.Discontinuity,t),{off:()=>{this._eventEmitter.off(cl.Discontinuity,t)}}}async attach(){await this._mutex.runExclusive(async()=>{if(this._logger.trace("RoomLifecycleManager.attach();"),this._checkRoomNotReleasing("attach"),this._roomStatusIs(cD.Attached))return void this._logger.debug("RoomLifecycleManager.attach(); room already attached, no-op");let e=this._channelManager.get();this._logger.debug("RoomLifecycleManager.attach(); attaching room",{channelState:e.state});try{this._setStatus(cD.Attaching),await e.attach(),this._setStatus(cD.Attached),this._isExplicitlyDetached=!1,this._hasAttachedOnce=!0,this._logger.debug("RoomLifecycleManager.attach(); room attached successfully")}catch(s){let t=new lB.ErrorInfo(`failed to attach room: ${s.message}`,s.code,s.statusCode,s),r=this._mapChannelStateToRoomStatus(e.state);throw this._setStatus(r,t),t}},1)}async detach(){await this._mutex.runExclusive(async()=>{if(this._logger.trace("RoomLifecycleManager.detach();"),this._roomStatusIs(cD.Failed))throw new lB.ErrorInfo("cannot detach room, room is in failed state",cj.RoomInFailedState,400);if(this._checkRoomNotReleasing("detach"),this._roomStatusIs(cD.Detached))return void this._logger.debug("RoomLifecycleManager.detach(); room already detached, no-op");let e=this._channelManager.get();this._logger.debug("RoomLifecycleManager.detach(); detaching room",{channelState:e.state});try{this._setStatus(cD.Detaching),await e.detach(),this._isExplicitlyDetached=!0,this._setStatus(cD.Detached),this._logger.debug("RoomLifecycleManager.detach(); room detached successfully")}catch(s){let t=new lB.ErrorInfo(`failed to detach room: ${s.message}`,s.code,s.statusCode,s),r=this._mapChannelStateToRoomStatus(e.state);throw this._setStatus(r,t),t}},1)}async release(){await this._mutex.runExclusive(async()=>{if(this._logger.trace("RoomLifecycleManager.release();"),this._roomStatusIs(cD.Released))return void this._logger.debug("RoomLifecycleManager.release(); room already released, no-op");if(this._roomStatusIs(cD.Initialized)||this._roomStatusIs(cD.Detached)){this._logger.debug("RoomLifecycleManager.release(); room is initialized or detached, releasing immediately",{status:this._roomLifecycle.status}),this._releaseChannel();return}this._setStatus(cD.Releasing);let e=this._channelManager.get();this._logger.debug("RoomLifecycleManager.release(); attempting channel detach before release",{channelState:e.state}),await this._channelDetachLoop(e),this._releaseChannel()},0)}_mapChannelStateToRoomStatus(e){switch(e){case"initialized":return cD.Initialized;case"attaching":return cD.Attaching;case"attached":return cD.Attached;case"detaching":return cD.Detaching;case"detached":return cD.Detached;case"suspended":return cD.Suspended;case"failed":return cD.Failed;default:return this._logger.error("RoomLifecycleManager._mapChannelStateToRoomStatus(); unknown channel state",{channelState:e}),cD.Failed}}_checkRoomNotReleasing(e){switch(this._roomLifecycle.status){case cD.Released:throw new lB.ErrorInfo(`cannot ${e} room, room is released`,cj.RoomIsReleased,400);case cD.Releasing:throw new lB.ErrorInfo(`cannot ${e} room, room is currently releasing`,cj.RoomIsReleasing,400)}}_roomStatusIs(e){return this._roomLifecycle.status===e}dispose(){this._unsubscribeChannelStateListener(),this._offDiscontinuityAttached(),this._offDiscontinuityUpdate(),this._eventEmitter.off()}hasListeners(){return lX(this._eventEmitter)}_channelStateListener(e){if(this._logger.debug("RoomLifecycleManager.channel state changed",{oldState:e.previous,newState:e.current,reason:e.reason,resumed:e.resumed}),this._operationInProgress())return void this._logger.debug("RoomLifecycleManager._startMonitoringChannelState(); ignoring channel state change - operation in progress",{status:this._roomLifecycle.status});let t=this._mapChannelStateToRoomStatus(e.current);this._setStatus(t,e.reason)}_discontinuityOnAttachedListener(e){if(!e.resumed&&this._hasAttachedOnce&&!this._isExplicitlyDetached){let t=new lB.ErrorInfo("discontinuity detected",cj.RoomDiscontinuity,e.reason?.statusCode??0,e.reason);this._logger.warn("RoomLifecycleManager._startMonitoringDiscontinuity(); discontinuity detected",{error:t}),this._eventEmitter.emit(cl.Discontinuity,t)}}_discontinuityOnUpdateListener(e){if(!e.resumed&&this._hasAttachedOnce&&!this._isExplicitlyDetached&&"attached"===e.current&&"attached"===e.previous){let t=new lB.ErrorInfo("discontinuity detected",cj.RoomDiscontinuity,e.reason?.statusCode??0,e.reason);this._logger.warn("RoomLifecycleManager._startMonitoringDiscontinuity(); discontinuity detected",{error:t}),this._eventEmitter.emit(cl.Discontinuity,t)}}async _channelDetachLoop(e){for(;;){if("failed"===e.state){this._logger.debug("RoomLifecycleManager._channelDetachLoop(); channel is failed, skipping detach");break}try{await e.detach();break}catch(e){this._logger.error("RoomLifecycleManager._channelDetachLoop(); failed to detach channel during release",{error:e}),await new Promise(e=>setTimeout(e,250))}}}_setStatus(e,t){this._logger.debug("RoomLifecycleManager._setStatus(); updating room status",{oldStatus:this._roomLifecycle.status,newStatus:e,hasError:!!t}),this._roomLifecycle.setStatus({status:e,error:t})}_releaseChannel(){this._channelManager.release(),this._setStatus(cD.Released),this._logger.debug("RoomLifecycleManager._releaseChannel(); room released successfully")}_operationInProgress(){return this._mutex.isLocked()}testForceHasAttachedOnce(e){this._logger.trace("RoomLifecycleManager.testForceHasAttachedOnce();",{firstAttach:e}),this._hasAttachedOnce=e}}let cU={typing:{heartbeatThrottleMs:1e4},occupancy:{enableEvents:!1},presence:{enableEvents:!0},messages:{rawMessageReactions:!1,defaultMessageReactionType:cs.Distinct}},cB=(e,t)=>({name:e,data:t,extras:{ephemeral:!0}});class cz{constructor(e,t,r,s,n,i){this.name=e,this.clientId=t,this.createdAt=r,this.isSelf=s,this.metadata=n,this.headers=i,Object.freeze(this)}}class cq{constructor(e,t,r,s){this._emitter=new lJ,this._forwarder=e=>{var t;let r,s,n=(t=this._clientId,r=e.data?.name&&"string"==typeof e.data.name?e.data.name:"",new cz(r,s=e.clientId??"",e.timestamp?new Date(e.timestamp):new Date,!!t&&t===s,e.data?.metadata??{},e.extras?.headers??{}));this._emitter.emit(cr.Reaction,{type:cr.Reaction,reaction:n})},this._channel=e,this._connection=t,this._clientId=r,this._logger=s;const n=this._forwarder.bind(this);this._unsubscribeRoomReactionEvents=lV(this._channel,[ct.Reaction],n)}send(e){let t;this._logger.trace("RoomReactions.send();",e);let{name:r,metadata:s,headers:n}=e;if(!r)return Promise.reject(new lB.ErrorInfo("unable to send reaction; name not set and it is required",40001,400));if("connected"!==this._connection.state)return Promise.reject(new lB.ErrorInfo("unable to send reaction; not connected to Ably",4e4,400));let i={name:ct.Reaction,data:{name:r,metadata:s??{}},extras:{headers:n??{}}};return this._channel.publish((t=i.extras?i.extras:{},{...i,extras:{...t,ephemeral:!0}}))}subscribe(e){this._logger.trace("RoomReactions.subscribe();");let t=lY(e);return this._emitter.on(t),{unsubscribe:()=>{this._logger.trace("RoomReactions.unsubscribe();"),this._emitter.off(t)}}}dispose(){this._unsubscribeRoomReactionEvents(),this._emitter.off()}hasListeners(){return lX(this._emitter)}}class cF extends lJ{constructor(e,t,r,s,n){super(),this._timeoutMs=2e3,this._mutex=new cP,this._internalSubscribeToEvents=e=>{let{name:t,clientId:r}=e;(this._logger.trace("DefaultTyping._internalSubscribeToEvents(); received event",{name:t,clientId:r}),r)?t===l9.Started||t===l9.Stopped?this._updateCurrentlyTyping(r,t):this._logger.warn("DefaultTyping._internalSubscribeToEvents(); unrecognized event",{name:t}):this._logger.error("DefaultTyping._internalSubscribeToEvents(); invalid clientId in received event",{inbound:e})},this._clientId=s,this._channel=r,this._connection=t,this._heartbeatThrottleMs=e.heartbeatThrottleMs,this._currentlyTyping=new Map,this._logger=n,this._unsubscribeTypingEvents=lV(this._channel,[l9.Started,l9.Stopped],this._internalSubscribeToEvents.bind(this))}_clearAllTypingStates(){this._logger.debug("DefaultTyping._clearAllTypingStates(); clearing all typing states"),this._clearHeartbeatTimer(),this._clearCurrentlyTyping()}_clearHeartbeatTimer(){this._logger.trace("DefaultTyping._clearHeartbeatTimer(); clearing heartbeat timer"),this._heartbeatTimerId&&(clearTimeout(this._heartbeatTimerId),this._heartbeatTimerId=void 0)}_clearCurrentlyTyping(){for(let[,e]of(this._logger.trace("DefaultTyping._clearCurrentlyTyping(); clearing current store and timeouts"),this._currentlyTyping.entries()))clearTimeout(e);this._currentlyTyping.clear()}current(){return this._logger.trace("DefaultTyping.current();"),new Set(this._currentlyTyping.keys())}get channel(){return this._channel}_startHeartbeatTimer(){if(!this._heartbeatTimerId){this._logger.trace("DefaultTyping.startHeartbeatTimer();");let e=this._heartbeatTimerId=setTimeout(()=>{this._logger.debug("DefaultTyping.startHeartbeatTimer(); heartbeat timer expired"),e===this._heartbeatTimerId&&(this._heartbeatTimerId=void 0)},this._heartbeatThrottleMs)}}async keystroke(){this._logger.trace("DefaultTyping.keystroke();"),this._mutex.cancel();try{await this._mutex.acquire()}catch(e){if(e===cT)return void this._logger.debug("DefaultTyping.keystroke(); mutex was canceled by a later operation");throw new lB.ErrorInfo("mutex acquisition failed",5e4,500)}try{if("connected"!==this._connection.state)throw this._logger.error("DefaultTyping.keystroke(); connection is not connected",{status:this._connection.state}),new lB.ErrorInfo("cannot type, connection is not connected",4e4,400);if(this._heartbeatTimerId)return void this._logger.debug("DefaultTyping.keystroke(); no-op, already typing and heartbeat timer has not expired");await this._channel.publish(cB(l9.Started)),this._startHeartbeatTimer(),this._logger.trace("DefaultTyping.keystroke(); starting timers")}finally{this._logger.trace("DefaultTyping.keystroke(); releasing mutex"),this._mutex.release()}}async stop(){this._logger.trace("DefaultTyping.stop();"),this._mutex.cancel();try{await this._mutex.acquire()}catch(e){if(e===cT)return void this._logger.debug("DefaultTyping.stop(); mutex was canceled by a later operation");throw new lB.ErrorInfo("mutex acquisition failed",5e4,500)}try{if("connected"!==this._connection.state)throw this._logger.error("DefaultTyping.stop(); connection is not connected",{status:this._connection.state}),new lB.ErrorInfo("cannot stop typing, connection is not connected",4e4,400);if(!this._heartbeatTimerId)return void this._logger.debug("DefaultTyping.stop(); no-op, not currently typing");await this._channel.publish(cB(l9.Stopped)),this._logger.trace("DefaultTyping.stop(); clearing timers"),clearTimeout(this._heartbeatTimerId),this._heartbeatTimerId=void 0}finally{this._logger.trace("DefaultTyping.stop(); releasing mutex"),this._mutex.release()}}subscribe(e){this._logger.trace("DefaultTyping.subscribe();");let t=lY(e);return this.on(t),{unsubscribe:()=>{this._logger.trace("DefaultTyping.unsubscribe();"),this.off(t)}}}async dispose(){for(this._logger.trace("DefaultTyping.dispose();");;)try{this._mutex.cancel(),await this._mutex.acquire();break}catch(e){if(e!==cT)return void this._logger.error("DefaultTyping.dispose(); failed to acquire mutex; could not complete resource disposal",{error:e});this._logger.debug("DefaultTyping.dispose(); mutex was canceled"),await new Promise(e=>setTimeout(e,200)),this._logger.debug("DefaultTyping.dispose(); retrying mutex acquisition")}this._clearAllTypingStates(),this._unsubscribeTypingEvents(),this.off(),this._mutex.release()}_updateCurrentlyTyping(e,t){this._logger.trace("DefaultTyping._updateCurrentlyTyping();",{clientId:e,event:t}),t===l9.Started?this._handleTypingStart(e):this._handleTypingStop(e)}_startNewClientInactivityTimer(e){this._logger.trace("DefaultTyping._startNewClientInactivityTimer(); starting new inactivity timer",{clientId:e});let t=setTimeout(()=>{(this._logger.trace("DefaultTyping._startNewClientInactivityTimer(); client typing timeout expired",{clientId:e}),this._currentlyTyping.get(e)!==t)?this._logger.debug("DefaultTyping._startNewClientInactivityTimer(); timeout already cleared; ignoring",{clientId:e}):(this._currentlyTyping.delete(e),this.emit(ce.SetChanged,{type:ce.SetChanged,currentlyTyping:new Set(this._currentlyTyping.keys()),change:{clientId:e,type:l9.Stopped}}))},this._heartbeatThrottleMs+this._timeoutMs);return t}_handleTypingStart(e){this._logger.debug("DefaultTyping._handleTypingStart();",{clientId:e});let t=this._startNewClientInactivityTimer(e),r=this._currentlyTyping.get(e);this._currentlyTyping.set(e,t),r?(this._logger.debug("DefaultTyping._handleTypingStart(); received heartbeat for currently typing client",{clientId:e}),clearTimeout(r)):(this._logger.debug("DefaultTyping._handleTypingStart(); new client started typing",{clientId:e}),this.emit(ce.SetChanged,{type:ce.SetChanged,currentlyTyping:new Set(this._currentlyTyping.keys()),change:{clientId:e,type:l9.Started}}))}_handleTypingStop(e){let t=this._currentlyTyping.get(e);t?(this._logger.debug("DefaultTyping._handleTypingStop(); client stopped typing",{clientId:e}),clearTimeout(t),this._currentlyTyping.delete(e),this.emit(ce.SetChanged,{type:ce.SetChanged,currentlyTyping:new Set(this._currentlyTyping.keys()),change:{clientId:e,type:l9.Stopped}})):this._logger.trace('DefaultTyping._handleTypingStop(); received "Stop" event for client not in currentlyTyping list',{clientId:e})}get heartbeatThrottleMs(){return this._heartbeatThrottleMs}get hasHeartbeatTimer(){return!!this._heartbeatTimerId}}class cH{constructor(e,t,r,s,n,i){(e=>{if(e.heartbeatThrottleMs<=0)throw new lB.ErrorInfo("invalid room configuration: typing heartbeat interval must be greater than 0",40001,400)})(r.typing),this._nonce=t,this._logger=i.withContext({roomName:e,roomNonce:t}),this._logger.debug("Room();",{options:r}),this._name=e,this._options=r,this._chatApi=n,this._lifecycle=new cL(this._logger);const a=this._channelManager=this._getChannelManager(r,s,this._logger),o=a.get();this._messages=new cw(e,r.messages,o,this._chatApi,s.auth.clientId,this._logger),this._presence=new cO(o,s.auth.clientId,this._logger,r),this._typing=new cF(r.typing,s.connection,o,s.auth.clientId,this._logger),this._reactions=new cq(o,s.connection,s.auth.clientId,this._logger),this._occupancy=new cA(e,o,this._chatApi,this._logger,r),this._lifecycleManager=new c$(a,this._lifecycle,this._logger);let l=!1;this._finalizer=async()=>{l?this._logger.debug("Room.finalizer(); already finalized"):(await this._lifecycleManager.release(),this._lifecycleManager.dispose(),this._messages.dispose(),this._presence.dispose(),this._reactions.dispose(),this._occupancy.dispose(),await this._typing.dispose(),this._lifecycle.dispose(),l=!0)}}_getChannelManager(e,t,r){let s=new cR(this._name,t,r,e.isReactClient);return s.mergeOptions(cA.channelOptionMerger(e)),s.mergeOptions(cO.channelOptionMerger(e)),s.mergeOptions(cg.channelOptionMerger(e)),s}get name(){return this._name}options(){return cu(this._options)}get messages(){return this._messages}get presence(){return this._presence}get reactions(){return this._reactions}get typing(){return this._typing}get occupancy(){return this._occupancy}get status(){return this._lifecycle.status}get error(){return this._lifecycle.error}onStatusChange(e){return this._lifecycle.onChange(e)}async attach(){return this._logger.trace("Room.attach();"),this._lifecycleManager.attach()}async detach(){return this._logger.trace("Room.detach();"),this._lifecycleManager.detach()}release(){return this._logger.trace("Room.release();"),this._finalizer()}get nonce(){return this._nonce}get lifecycle(){return this._lifecycle}get lifecycleManager(){return this._lifecycleManager}onDiscontinuity(e){return this._logger.trace("Room.onDiscontinuity();"),this._lifecycleManager.onDiscontinuity(e)}get channel(){return this._channelManager.get()}}class cW{constructor(e,t,r){this._rooms=new Map,this._releasing=new Map,this._isReact=!1,this._disposed=!1,this._realtime=e,this._chatApi=new cv(e,r),this._clientOptions=t,this._logger=r}async get(e,t){this._logger.trace("Rooms.get();",{roomName:e}),this._ensureNotDisposed();let r=this._rooms.get(e);if(r)return this._handleExistingRoom(r,e,t);let s=this._releasing.get(e),n=l0();return s?this._waitForReleaseAndCreateRoom(e,n,t,s):this._createNewRoom(e,n,t)}async release(e){this._logger.trace("Rooms.release();",{roomName:e});let t=this._rooms.get(e),r=this._releasing.get(e);return t?r?this._handleConcurrentRelease(e,t,r):this._performRoomRelease(e,t):this._handleNonExistentRoomRelease(e,r)}async dispose(){this._logger.trace("Rooms.dispose();"),this._disposed=!0;let e=[...this._rooms.keys()];if(0===e.length)return void this._logger.debug("Rooms.dispose(); no rooms to release");let t=[...e.map(e=>this.release(e)),...this._releasing.values()];this._logger.debug("Rooms.dispose(); releasing rooms",{roomCount:e.length,roomNames:e}),await Promise.all(t),this._logger.debug("Rooms.dispose(); all rooms released successfully")}get clientOptions(){return this._clientOptions}get count(){return this._rooms.size}_ensureNotDisposed(){if(this._disposed)throw new lB.ErrorInfo("cannot get room, rooms instance has been disposed",4e4,400)}async _handleExistingRoom(e,t,r){if(!l4(e.options,r))throw new lB.ErrorInfo("room already exists with different options",4e4,400);return this._logger.debug("Rooms.get(); returning existing room",{roomName:t,nonce:e.nonce,options:r}),await e.promise}_createNewRoom(e,t,r){let s=this._makeRoom(e,t,r),n={promise:Promise.resolve(s),nonce:t,options:r};return this._rooms.set(e,n),this._logger.debug("Rooms.get(); returning new room",{roomName:e,nonce:s.nonce}),s}async _waitForReleaseAndCreateRoom(e,t,r,s){let n=new AbortController,i=this._createAbortableRoomPromise(e,t,r,s,n);return this._rooms.set(e,{promise:i,options:r,nonce:t,abort:n}),this._logger.debug("Rooms.get(); creating new promise dependent on previous release",{roomName:e}),await i}_createAbortableRoomPromise(e,t,r,s,n){return new Promise((i,a)=>{let o=()=>{this._logger.debug("Rooms.get(); aborted before init",{roomName:e}),a(new lB.ErrorInfo("room released before get operation could complete",cj.RoomReleasedBeforeOperationCompleted,400))};n.signal.addEventListener("abort",o),s.then(()=>{if(n.signal.aborted)return void this._logger.debug("Rooms.get(); aborted before releasing promise resolved",{roomName:e});this._logger.debug("Rooms.get(); releasing finished",{roomName:e});let s=this._makeRoom(e,t,r);n.signal.removeEventListener("abort",o),i(s)}).catch(e=>{n.signal.removeEventListener("abort",o),a(e)})})}async _handleNonExistentRoomRelease(e,t){if(t){this._logger.debug("Rooms.release(); waiting for previous release call",{roomName:e}),await t;return}this._logger.debug("Rooms.release(); room does not exist",{roomName:e})}async _handleConcurrentRelease(e,t,r){t.abort&&(this._logger.debug("Rooms.release(); aborting get call",{roomName:e,existingNonce:t.nonce}),t.abort.abort(),this._rooms.delete(e)),await r}async _performRoomRelease(e,t){this._rooms.delete(e);let r=this._executeRoomRelease(e,t);this._releasing.set(e,r),this._logger.debug("Rooms.release(); creating new release promise",{roomName:e,nonce:t.nonce}),await r}async _executeRoomRelease(e,t){let r=await t.promise;this._logger.debug("Rooms.release(); releasing room",{roomName:e,nonce:t.nonce}),await r.release(),this._logger.debug("Rooms.release(); room released",{roomName:e,nonce:t.nonce}),this._releasing.delete(e)}_makeRoom(e,t,r){var s;return new cH(e,t,(s=this._isReact,{typing:{...cU.typing,...r?.typing},occupancy:{...cU.occupancy,...r?.occupancy},presence:{...cU.presence,...r?.presence},messages:{...cU.messages,...r?.messages},isReactClient:s}),this._realtime,this._chatApi,this._logger)}useReact(){this._logger.trace("Rooms.useReact();"),this._isReact=!0}}class cG{constructor(e,t){this._realtime=e,this._clientOptions=(e=>({...e=e??{},logLevel:e.logLevel??lW.logLevel}))(t),this._nonce=l0(),this._logger=(e=>new lH(e.logHandler??lq,e.logLevel))(this._clientOptions).withContext({chatClientNonce:this._nonce}),this._connection=new lZ(e,this._logger),this._rooms=new cW(e,this._clientOptions,this._logger),this._addAgent("chat-js"),this._logger.trace(`ably chat client version ${ck}; initialized`)}get rooms(){return this._rooms}get connection(){return this._connection}get clientId(){return this._realtime.auth.clientId}get realtime(){return this._realtime}get clientOptions(){return this._clientOptions}get logger(){return this._logger}addReactAgent(){this._addAgent("chat-react"),this._rooms.useReact()}addAgentWithVersion(e,t){this._addAgent(e,t),this._logger.trace(`Added agent ${e} with version ${t}`)}async dispose(){this._logger.trace("ChatClient.dispose();"),await this._rooms.dispose(),this._connection.dispose(),this._logger.debug("ChatClient.dispose(); client disposed successfully")}_addAgent(e,t){let r=this._realtime;r.options.agents={...r.options.agents??r.options.agents,[e]:t??ck}}}function cV({className:e,type:t,...r}){return(0,er.jsx)("input",{type:t,"data-slot":"input",className:tr("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}function cK(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function cJ(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function cY(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=cJ(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():cJ(e[t],null)}}}}(...e),e)}"undefined"!=typeof window&&window.document&&window.document.createElement;let cX=["top","right","bottom","left"],cQ=Math.min,cZ=Math.max,c0=Math.round,c1=Math.floor,c2=e=>({x:e,y:e}),c4={left:"right",right:"left",bottom:"top",top:"bottom"},c5={start:"end",end:"start"};function c3(e,t){return"function"==typeof e?e(t):e}function c6(e){return e.split("-")[0]}function c8(e){return e.split("-")[1]}function c7(e){return"x"===e?"y":"x"}function c9(e){return"y"===e?"height":"width"}let de=new Set(["top","bottom"]);function dt(e){return de.has(c6(e))?"y":"x"}function dr(e){return e.replace(/start|end/g,e=>c5[e])}let ds=["left","right"],dn=["right","left"],di=["top","bottom"],da=["bottom","top"];function dl(e){return e.replace(/left|right|bottom|top/g,e=>c4[e])}function dc(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function dd(e){let{x:t,y:r,width:s,height:n}=e;return{width:s,height:n,top:r,left:t,right:t+s,bottom:r+n,x:t,y:r}}function du(e,t,r){let s,{reference:n,floating:i}=e,a=dt(t),o=c7(dt(t)),l=c9(o),c=c6(t),d="y"===a,u=n.x+n.width/2-i.width/2,h=n.y+n.height/2-i.height/2,p=n[l]/2-i[l]/2;switch(c){case"top":s={x:u,y:n.y-i.height};break;case"bottom":s={x:u,y:n.y+n.height};break;case"right":s={x:n.x+n.width,y:h};break;case"left":s={x:n.x-i.width,y:h};break;default:s={x:n.x,y:n.y}}switch(c8(t)){case"start":s[o]-=p*(r&&d?-1:1);break;case"end":s[o]+=p*(r&&d?-1:1)}return s}let dh=async(e,t,r)=>{let{placement:s="bottom",strategy:n="absolute",middleware:i=[],platform:a}=r,o=i.filter(Boolean),l=await (null==a.isRTL?void 0:a.isRTL(t)),c=await a.getElementRects({reference:e,floating:t,strategy:n}),{x:d,y:u}=du(c,s,l),h=s,p={},f=0;for(let r=0;r<o.length;r++){let{name:i,fn:m}=o[r],{x:g,y:b,data:x,reset:y}=await m({x:d,y:u,initialPlacement:s,placement:h,strategy:n,middlewareData:p,rects:c,platform:a,elements:{reference:e,floating:t}});d=null!=g?g:d,u=null!=b?b:u,p={...p,[i]:{...p[i],...x}},y&&f<=50&&(f++,"object"==typeof y&&(y.placement&&(h=y.placement),y.rects&&(c=!0===y.rects?await a.getElementRects({reference:e,floating:t,strategy:n}):y.rects),{x:d,y:u}=du(c,h,l)),r=-1)}return{x:d,y:u,placement:h,strategy:n,middlewareData:p}};async function dp(e,t){var r;void 0===t&&(t={});let{x:s,y:n,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=c3(t,e),f=dc(p),m=o[h?"floating"===u?"reference":"floating":u],g=dd(await i.getClippingRect({element:null==(r=await (null==i.isElement?void 0:i.isElement(m)))||r?m:m.contextElement||await (null==i.getDocumentElement?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:d,strategy:l})),b="floating"===u?{x:s,y:n,width:a.floating.width,height:a.floating.height}:a.reference,x=await (null==i.getOffsetParent?void 0:i.getOffsetParent(o.floating)),y=await (null==i.isElement?void 0:i.isElement(x))&&await (null==i.getScale?void 0:i.getScale(x))||{x:1,y:1},w=dd(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:b,offsetParent:x,strategy:l}):b);return{top:(g.top-w.top+f.top)/y.y,bottom:(w.bottom-g.bottom+f.bottom)/y.y,left:(g.left-w.left+f.left)/y.x,right:(w.right-g.right+f.right)/y.x}}function df(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function dm(e){return cX.some(t=>e[t]>=0)}let dg=new Set(["left","top"]);async function db(e,t){let{placement:r,platform:s,elements:n}=e,i=await (null==s.isRTL?void 0:s.isRTL(n.floating)),a=c6(r),o=c8(r),l="y"===dt(r),c=dg.has(a)?-1:1,d=i&&l?-1:1,u=c3(t,e),{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return o&&"number"==typeof f&&(p="end"===o?-1*f:f),l?{x:p*d,y:h*c}:{x:h*c,y:p*d}}function dx(){return"undefined"!=typeof window}function dy(e){return dj(e)?(e.nodeName||"").toLowerCase():"#document"}function dw(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function dv(e){var t;return null==(t=(dj(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function dj(e){return!!dx()&&(e instanceof Node||e instanceof dw(e).Node)}function dk(e){return!!dx()&&(e instanceof Element||e instanceof dw(e).Element)}function dN(e){return!!dx()&&(e instanceof HTMLElement||e instanceof dw(e).HTMLElement)}function dS(e){return!!dx()&&"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof dw(e).ShadowRoot)}let d_=new Set(["inline","contents"]);function dC(e){let{overflow:t,overflowX:r,overflowY:s,display:n}=d$(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+r)&&!d_.has(n)}let dE=new Set(["table","td","th"]),dR=[":popover-open",":modal"];function dA(e){return dR.some(t=>{try{return e.matches(t)}catch(e){return!1}})}let dO=["transform","translate","scale","rotate","perspective"],dT=["transform","translate","scale","rotate","perspective","filter"],dI=["paint","layout","strict","content"];function dM(e){let t=dP(),r=dk(e)?d$(e):e;return dO.some(e=>!!r[e]&&"none"!==r[e])||!!r.containerType&&"normal"!==r.containerType||!t&&!!r.backdropFilter&&"none"!==r.backdropFilter||!t&&!!r.filter&&"none"!==r.filter||dT.some(e=>(r.willChange||"").includes(e))||dI.some(e=>(r.contain||"").includes(e))}function dP(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}let dD=new Set(["html","body","#document"]);function dL(e){return dD.has(dy(e))}function d$(e){return dw(e).getComputedStyle(e)}function dU(e){return dk(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function dB(e){if("html"===dy(e))return e;let t=e.assignedSlot||e.parentNode||dS(e)&&e.host||dv(e);return dS(t)?t.host:t}function dz(e,t,r){var s;void 0===t&&(t=[]),void 0===r&&(r=!0);let n=function e(t){let r=dB(t);return dL(r)?t.ownerDocument?t.ownerDocument.body:t.body:dN(r)&&dC(r)?r:e(r)}(e),i=n===(null==(s=e.ownerDocument)?void 0:s.body),a=dw(n);if(i){let e=dq(a);return t.concat(a,a.visualViewport||[],dC(n)?n:[],e&&r?dz(e):[])}return t.concat(n,dz(n,[],r))}function dq(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function dF(e){let t=d$(e),r=parseFloat(t.width)||0,s=parseFloat(t.height)||0,n=dN(e),i=n?e.offsetWidth:r,a=n?e.offsetHeight:s,o=c0(r)!==i||c0(s)!==a;return o&&(r=i,s=a),{width:r,height:s,$:o}}function dH(e){return dk(e)?e:e.contextElement}function dW(e){let t=dH(e);if(!dN(t))return c2(1);let r=t.getBoundingClientRect(),{width:s,height:n,$:i}=dF(t),a=(i?c0(r.width):r.width)/s,o=(i?c0(r.height):r.height)/n;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}let dG=c2(0);function dV(e){let t=dw(e);return dP()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:dG}function dK(e,t,r,s){var n;void 0===t&&(t=!1),void 0===r&&(r=!1);let i=e.getBoundingClientRect(),a=dH(e),o=c2(1);t&&(s?dk(s)&&(o=dW(s)):o=dW(e));let l=(void 0===(n=r)&&(n=!1),s&&(!n||s===dw(a))&&n)?dV(a):c2(0),c=(i.left+l.x)/o.x,d=(i.top+l.y)/o.y,u=i.width/o.x,h=i.height/o.y;if(a){let e=dw(a),t=s&&dk(s)?dw(s):s,r=e,n=dq(r);for(;n&&s&&t!==r;){let e=dW(n),t=n.getBoundingClientRect(),s=d$(n),i=t.left+(n.clientLeft+parseFloat(s.paddingLeft))*e.x,a=t.top+(n.clientTop+parseFloat(s.paddingTop))*e.y;c*=e.x,d*=e.y,u*=e.x,h*=e.y,c+=i,d+=a,n=dq(r=dw(n))}}return dd({width:u,height:h,x:c,y:d})}function dJ(e,t){let r=dU(e).scrollLeft;return t?t.left+r:dK(dv(e)).left+r}function dY(e,t){let r=e.getBoundingClientRect();return{x:r.left+t.scrollLeft-dJ(e,r),y:r.top+t.scrollTop}}let dX=new Set(["absolute","fixed"]);function dQ(e,t,r){var s;let n;if("viewport"===t)n=function(e,t){let r=dw(e),s=dv(e),n=r.visualViewport,i=s.clientWidth,a=s.clientHeight,o=0,l=0;if(n){i=n.width,a=n.height;let e=dP();(!e||e&&"fixed"===t)&&(o=n.offsetLeft,l=n.offsetTop)}let c=dJ(s);if(c<=0){let e=s.ownerDocument,t=e.body,r=getComputedStyle(t),n="CSS1Compat"===e.compatMode&&parseFloat(r.marginLeft)+parseFloat(r.marginRight)||0,a=Math.abs(s.clientWidth-t.clientWidth-n);a<=25&&(i-=a)}else c<=25&&(i+=c);return{width:i,height:a,x:o,y:l}}(e,r);else if("document"===t){let t,r,i,a,o,l,c;s=dv(e),t=dv(s),r=dU(s),i=s.ownerDocument.body,a=cZ(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),o=cZ(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight),l=-r.scrollLeft+dJ(s),c=-r.scrollTop,"rtl"===d$(i).direction&&(l+=cZ(t.clientWidth,i.clientWidth)-a),n={width:a,height:o,x:l,y:c}}else if(dk(t)){let e,s,i,a,o,l;s=(e=dK(t,!0,"fixed"===r)).top+t.clientTop,i=e.left+t.clientLeft,a=dN(t)?dW(t):c2(1),o=t.clientWidth*a.x,l=t.clientHeight*a.y,n={width:o,height:l,x:i*a.x,y:s*a.y}}else{let r=dV(e);n={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return dd(n)}function dZ(e){return"static"===d$(e).position}function d0(e,t){if(!dN(e)||"fixed"===d$(e).position)return null;if(t)return t(e);let r=e.offsetParent;return dv(e)===r&&(r=r.ownerDocument.body),r}function d1(e,t){var r;let s=dw(e);if(dA(e))return s;if(!dN(e)){let t=dB(e);for(;t&&!dL(t);){if(dk(t)&&!dZ(t))return t;t=dB(t)}return s}let n=d0(e,t);for(;n&&(r=n,dE.has(dy(r)))&&dZ(n);)n=d0(n,t);return n&&dL(n)&&dZ(n)&&!dM(n)?s:n||function(e){let t=dB(e);for(;dN(t)&&!dL(t);){if(dM(t))return t;if(dA(t))break;t=dB(t)}return null}(e)||s}let d2=async function(e){let t=this.getOffsetParent||d1,r=this.getDimensions,s=await r(e.floating);return{reference:function(e,t,r){let s=dN(t),n=dv(t),i="fixed"===r,a=dK(e,!0,i,t),o={scrollLeft:0,scrollTop:0},l=c2(0);if(s||!s&&!i)if(("body"!==dy(t)||dC(n))&&(o=dU(t)),s){let e=dK(t,!0,i,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else n&&(l.x=dJ(n));i&&!s&&n&&(l.x=dJ(n));let c=!n||s||i?c2(0):dY(n,o);return{x:a.left+o.scrollLeft-l.x-c.x,y:a.top+o.scrollTop-l.y-c.y,width:a.width,height:a.height}}(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}},d4={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:r,offsetParent:s,strategy:n}=e,i="fixed"===n,a=dv(s),o=!!t&&dA(t.floating);if(s===a||o&&i)return r;let l={scrollLeft:0,scrollTop:0},c=c2(1),d=c2(0),u=dN(s);if((u||!u&&!i)&&(("body"!==dy(s)||dC(a))&&(l=dU(s)),dN(s))){let e=dK(s);c=dW(s),d.x=e.x+s.clientLeft,d.y=e.y+s.clientTop}let h=!a||u||i?c2(0):dY(a,l);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+d.x+h.x,y:r.y*c.y-l.scrollTop*c.y+d.y+h.y}},getDocumentElement:dv,getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:s,strategy:n}=e,i=[..."clippingAncestors"===r?dA(t)?[]:function(e,t){let r=t.get(e);if(r)return r;let s=dz(e,[],!1).filter(e=>dk(e)&&"body"!==dy(e)),n=null,i="fixed"===d$(e).position,a=i?dB(e):e;for(;dk(a)&&!dL(a);){let t=d$(a),r=dM(a);r||"fixed"!==t.position||(n=null),(i?!r&&!n:!r&&"static"===t.position&&!!n&&dX.has(n.position)||dC(a)&&!r&&function e(t,r){let s=dB(t);return!(s===r||!dk(s)||dL(s))&&("fixed"===d$(s).position||e(s,r))}(e,a))?s=s.filter(e=>e!==a):n=t,a=dB(a)}return t.set(e,s),s}(t,this._c):[].concat(r),s],a=i[0],o=i.reduce((e,r)=>{let s=dQ(t,r,n);return e.top=cZ(s.top,e.top),e.right=cQ(s.right,e.right),e.bottom=cQ(s.bottom,e.bottom),e.left=cZ(s.left,e.left),e},dQ(t,a,n));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:d1,getElementRects:d2,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){let{width:t,height:r}=dF(e);return{width:t,height:r}},getScale:dW,isElement:dk,isRTL:function(e){return"rtl"===d$(e).direction}};function d5(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}let d3=e=>({name:"arrow",options:e,async fn(t){let{x:r,y:s,placement:n,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:d=0}=c3(e,t)||{};if(null==c)return{};let u=dc(d),h={x:r,y:s},p=c7(dt(n)),f=c9(p),m=await a.getDimensions(c),g="y"===p,b=g?"clientHeight":"clientWidth",x=i.reference[f]+i.reference[p]-h[p]-i.floating[f],y=h[p]-i.reference[p],w=await (null==a.getOffsetParent?void 0:a.getOffsetParent(c)),v=w?w[b]:0;v&&await (null==a.isElement?void 0:a.isElement(w))||(v=o.floating[b]||i.floating[f]);let j=v/2-m[f]/2-1,k=cQ(u[g?"top":"left"],j),N=cQ(u[g?"bottom":"right"],j),S=v-m[f]-N,_=v/2-m[f]/2+(x/2-y/2),C=cZ(k,cQ(_,S)),E=!l.arrow&&null!=c8(n)&&_!==C&&i.reference[f]/2-(_<k?k:N)-m[f]/2<0,R=E?_<k?_-k:_-S:0;return{[p]:h[p]+R,data:{[p]:C,centerOffset:_-C-R,...E&&{alignmentOffset:R}},reset:E}}});var d6="undefined"!=typeof document?es.useLayoutEffect:function(){};function d8(e,t){let r,s,n;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((r=e.length)!==t.length)return!1;for(s=r;0!=s--;)if(!d8(e[s],t[s]))return!1;return!0}if((r=(n=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(s=r;0!=s--;)if(!({}).hasOwnProperty.call(t,n[s]))return!1;for(s=r;0!=s--;){let r=n[s];if(("_owner"!==r||!e.$$typeof)&&!d8(e[r],t[r]))return!1}return!0}return e!=e&&t!=t}function d7(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function d9(e,t){let r=d7(e);return Math.round(t*r)/r}function ue(e){let t=es.useRef(e);return d6(()=>{t.current=e}),t}var ut=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),ur=es.forwardRef((e,t)=>{let{children:r,width:s=10,height:n=5,...i}=e;return(0,er.jsx)(ut.svg,{...i,ref:t,width:s,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:(0,er.jsx)("polygon",{points:"0,0 30,0 15,10"})})});function us(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function un(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=us(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():us(e[t],null)}}}}(...e),e)}ur.displayName="Arrow";var ui=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),ua=globalThis?.document?es.useLayoutEffect:()=>{},uo="Popper",[ul,uc]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(uo),[ud,uu]=ul(uo),uh=e=>{let{__scopePopper:t,children:r}=e,[s,n]=es.useState(null);return(0,er.jsx)(ud,{scope:t,anchor:s,onAnchorChange:n,children:r})};uh.displayName=uo;var up="PopperAnchor",uf=es.forwardRef((e,t)=>{let{__scopePopper:r,virtualRef:s,...n}=e,i=uu(up,r),a=es.useRef(null),o=un(t,a),l=es.useRef(null);return es.useEffect(()=>{let e=l.current;l.current=s?.current||a.current,e!==l.current&&i.onAnchorChange(l.current)}),s?null:(0,er.jsx)(ui.div,{...n,ref:o})});uf.displayName=up;var um="PopperContent",[ug,ub]=ul(um),ux=es.forwardRef((e,t)=>{var r,s,n,i,a,o,l,c,d,u,h,p,f,m,g,b,x,y,w,v,j;let k,{__scopePopper:N,side:S="bottom",sideOffset:_=0,align:C="center",alignOffset:E=0,arrowPadding:R=0,avoidCollisions:A=!0,collisionBoundary:O=[],collisionPadding:T=0,sticky:I="partial",hideWhenDetached:M=!1,updatePositionStrategy:P="optimized",onPlaced:D,...L}=e,$=uu(um,N),[U,B]=es.useState(null),z=un(t,e=>B(e)),[q,F]=es.useState(null),H=function(e){let[t,r]=es.useState(void 0);return ua(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,n;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,n=t.blockSize}else s=e.offsetWidth,n=e.offsetHeight;r({width:s,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}(q),W=H?.width??0,G=H?.height??0,V="number"==typeof T?T:{top:0,right:0,bottom:0,left:0,...T},K=Array.isArray(O)?O:[O],J=K.length>0,Y={padding:V,boundary:K.filter(uj),altBoundary:J},{refs:X,floatingStyles:Q,placement:Z,isPositioned:ee,middlewareData:et}=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:r="absolute",middleware:s=[],platform:n,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[d,u]=es.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=es.useState(s);d8(h,s)||p(s);let[f,m]=es.useState(null),[g,b]=es.useState(null),x=es.useCallback(e=>{e!==j.current&&(j.current=e,m(e))},[]),y=es.useCallback(e=>{e!==k.current&&(k.current=e,b(e))},[]),w=i||f,v=a||g,j=es.useRef(null),k=es.useRef(null),N=es.useRef(d),S=null!=l,_=ue(l),C=ue(n),E=ue(c),R=es.useCallback(()=>{var e,s;let n,i,a;if(!j.current||!k.current)return;let o={placement:t,strategy:r,middleware:h};C.current&&(o.platform=C.current),(e=j.current,s=k.current,n=new Map,a={...(i={platform:d4,...o}).platform,_c:n},dh(e,s,{...i,platform:a})).then(e=>{let t={...e,isPositioned:!1!==E.current};A.current&&!d8(N.current,t)&&(N.current=t,sG.flushSync(()=>{u(t)}))})},[h,t,r,C,E]);d6(()=>{!1===c&&N.current.isPositioned&&(N.current.isPositioned=!1,u(e=>({...e,isPositioned:!1})))},[c]);let A=es.useRef(!1);d6(()=>(A.current=!0,()=>{A.current=!1}),[]),d6(()=>{if(w&&(j.current=w),v&&(k.current=v),w&&v){if(_.current)return _.current(w,v,R);R()}},[w,v,R,_,S]);let O=es.useMemo(()=>({reference:j,floating:k,setReference:x,setFloating:y}),[x,y]),T=es.useMemo(()=>({reference:w,floating:v}),[w,v]),I=es.useMemo(()=>{let e={position:r,left:0,top:0};if(!T.floating)return e;let t=d9(T.floating,d.x),s=d9(T.floating,d.y);return o?{...e,transform:"translate("+t+"px, "+s+"px)",...d7(T.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:s}},[r,o,T.floating,d.x,d.y]);return es.useMemo(()=>({...d,update:R,refs:O,elements:T,floatingStyles:I}),[d,R,O,T,I])}({strategy:"fixed",placement:S+("center"!==C?"-"+C:""),whileElementsMounted:(...e)=>(function(e,t,r,s){let n;void 0===s&&(s={});let{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:l="function"==typeof IntersectionObserver,animationFrame:c=!1}=s,d=dH(e),u=i||a?[...d?dz(d):[],...dz(t)]:[];u.forEach(e=>{i&&e.addEventListener("scroll",r,{passive:!0}),a&&e.addEventListener("resize",r)});let h=d&&l?function(e,t){let r,s=null,n=dv(e);function i(){var e;clearTimeout(r),null==(e=s)||e.disconnect(),s=null}return!function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),i();let c=e.getBoundingClientRect(),{left:d,top:u,width:h,height:p}=c;if(o||t(),!h||!p)return;let f={rootMargin:-c1(u)+"px "+-c1(n.clientWidth-(d+h))+"px "+-c1(n.clientHeight-(u+p))+"px "+-c1(d)+"px",threshold:cZ(0,cQ(1,l))||1},m=!0;function g(t){let s=t[0].intersectionRatio;if(s!==l){if(!m)return a();s?a(!1,s):r=setTimeout(()=>{a(!1,1e-7)},1e3)}1!==s||d5(c,e.getBoundingClientRect())||a(),m=!1}try{s=new IntersectionObserver(g,{...f,root:n.ownerDocument})}catch(e){s=new IntersectionObserver(g,f)}s.observe(e)}(!0),i}(d,r):null,p=-1,f=null;o&&(f=new ResizeObserver(e=>{let[s]=e;s&&s.target===d&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var e;null==(e=f)||e.observe(t)})),r()}),d&&!c&&f.observe(d),f.observe(t));let m=c?dK(e):null;return c&&function t(){let s=dK(e);m&&!d5(m,s)&&r(),m=s,n=requestAnimationFrame(t)}(),r(),()=>{var e;u.forEach(e=>{i&&e.removeEventListener("scroll",r),a&&e.removeEventListener("resize",r)}),null==h||h(),null==(e=f)||e.disconnect(),f=null,c&&cancelAnimationFrame(n)}})(...e,{animationFrame:"always"===P}),elements:{reference:$.anchor},middleware:[{...{name:"offset",options:n=r={mainAxis:_+G,alignmentAxis:E},async fn(e){var t,r;let{x:s,y:i,placement:a,middlewareData:o}=e,l=await db(e,n);return a===(null==(t=o.offset)?void 0:t.placement)&&null!=(r=o.arrow)&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}},options:[r,s]},A&&{...{name:"shift",options:d=l={mainAxis:!0,crossAxis:!1,limiter:"partial"===I?{...(void 0===(o=i)&&(o={}),{options:o,fn(e){let{x:t,y:r,placement:s,rects:n,middlewareData:i}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=c3(o,e),d={x:t,y:r},u=dt(s),h=c7(u),p=d[h],f=d[u],m=c3(a,e),g="number"==typeof m?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){let e="y"===h?"height":"width",t=n.reference[h]-n.floating[e]+g.mainAxis,r=n.reference[h]+n.reference[e]-g.mainAxis;p<t?p=t:p>r&&(p=r)}if(c){var b,x;let e="y"===h?"width":"height",t=dg.has(c6(s)),r=n.reference[u]-n.floating[e]+(t&&(null==(b=i.offset)?void 0:b[u])||0)+(t?0:g.crossAxis),a=n.reference[u]+n.reference[e]+(t?0:(null==(x=i.offset)?void 0:x[u])||0)-(t?g.crossAxis:0);f<r?f=r:f>a&&(f=a)}return{[h]:p,[u]:f}}}),options:[i,a]}:void 0,...Y},async fn(e){let{x:t,y:r,placement:s}=e,{mainAxis:n=!0,crossAxis:i=!1,limiter:a={fn:e=>{let{x:t,y:r}=e;return{x:t,y:r}}},...o}=c3(d,e),l={x:t,y:r},c=await dp(e,o),u=dt(c6(s)),h=c7(u),p=l[h],f=l[u];if(n){let e="y"===h?"top":"left",t="y"===h?"bottom":"right",r=p+c[e],s=p-c[t];p=cZ(r,cQ(p,s))}if(i){let e="y"===u?"top":"left",t="y"===u?"bottom":"right",r=f+c[e],s=f-c[t];f=cZ(r,cQ(f,s))}let m=a.fn({...e,[h]:p,[u]:f});return{...m,data:{x:m.x-t,y:m.y-r,enabled:{[h]:n,[u]:i}}}}},options:[l,c]},A&&{...{name:"flip",options:p=u={...Y},async fn(e){var t,r,s,n,i,a,o,l;let c,d,u,{placement:h,middlewareData:f,rects:m,initialPlacement:g,platform:b,elements:x}=e,{mainAxis:y=!0,crossAxis:w=!0,fallbackPlacements:v,fallbackStrategy:j="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:N=!0,...S}=c3(p,e);if(null!=(t=f.arrow)&&t.alignmentOffset)return{};let _=c6(h),C=dt(g),E=c6(g)===g,R=await (null==b.isRTL?void 0:b.isRTL(x.floating)),A=v||(E||!N?[dl(g)]:(c=dl(g),[dr(g),c,dr(c)])),O="none"!==k;!v&&O&&A.push(...(d=c8(g),u=function(e,t,r){switch(e){case"top":case"bottom":if(r)return t?dn:ds;return t?ds:dn;case"left":case"right":return t?di:da;default:return[]}}(c6(g),"start"===k,R),d&&(u=u.map(e=>e+"-"+d),N&&(u=u.concat(u.map(dr)))),u));let T=[g,...A],I=await dp(e,S),M=[],P=(null==(r=f.flip)?void 0:r.overflows)||[];if(y&&M.push(I[_]),w){let e,t,r,s,n=(a=h,o=m,void 0===(l=R)&&(l=!1),e=c8(a),r=c9(t=c7(dt(a))),s="x"===t?e===(l?"end":"start")?"right":"left":"start"===e?"bottom":"top",o.reference[r]>o.floating[r]&&(s=dl(s)),[s,dl(s)]);M.push(I[n[0]],I[n[1]])}if(P=[...P,{placement:h,overflows:M}],!M.every(e=>e<=0)){let e=((null==(s=f.flip)?void 0:s.index)||0)+1,t=T[e];if(t&&("alignment"!==w||C===dt(t)||P.every(e=>dt(e.placement)!==C||e.overflows[0]>0)))return{data:{index:e,overflows:P},reset:{placement:t}};let r=null==(n=P.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:n.placement;if(!r)switch(j){case"bestFit":{let e=null==(i=P.filter(e=>{if(O){let t=dt(e.placement);return t===C||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:i[0];e&&(r=e);break}case"initialPlacement":r=g}if(h!==r)return{reset:{placement:r}}}return{}}},options:[u,h]},{...{name:"size",options:g=f={...Y,apply:({elements:e,rects:t,availableWidth:r,availableHeight:s})=>{let{width:n,height:i}=t.reference,a=e.floating.style;a.setProperty("--radix-popper-available-width",`${r}px`),a.setProperty("--radix-popper-available-height",`${s}px`),a.setProperty("--radix-popper-anchor-width",`${n}px`),a.setProperty("--radix-popper-anchor-height",`${i}px`)}},async fn(e){var t,r;let s,n,{placement:i,rects:a,platform:o,elements:l}=e,{apply:c=()=>{},...d}=c3(g,e),u=await dp(e,d),h=c6(i),p=c8(i),f="y"===dt(i),{width:m,height:b}=a.floating;"top"===h||"bottom"===h?(s=h,n=p===(await (null==o.isRTL?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(n=h,s="end"===p?"top":"bottom");let x=b-u.top-u.bottom,y=m-u.left-u.right,w=cQ(b-u[s],x),v=cQ(m-u[n],y),j=!e.middlewareData.shift,k=w,N=v;if(null!=(t=e.middlewareData.shift)&&t.enabled.x&&(N=y),null!=(r=e.middlewareData.shift)&&r.enabled.y&&(k=x),j&&!p){let e=cZ(u.left,0),t=cZ(u.right,0),r=cZ(u.top,0),s=cZ(u.bottom,0);f?N=m-2*(0!==e||0!==t?e+t:cZ(u.left,u.right)):k=b-2*(0!==r||0!==s?r+s:cZ(u.top,u.bottom))}await c({...e,availableWidth:N,availableHeight:k});let S=await o.getDimensions(l.floating);return m!==S.width||b!==S.height?{reset:{rects:!0}}:{}}},options:[f,m]},q&&{...{name:"arrow",options:y=b={element:q,padding:R},fn(e){let{element:t,padding:r}="function"==typeof y?y(e):y;return t&&({}).hasOwnProperty.call(t,"current")?null!=t.current?d3({element:t.current,padding:r}).fn(e):{}:t?d3({element:t,padding:r}).fn(e):{}}},options:[b,x]},uk({arrowWidth:W,arrowHeight:G}),M&&{...{name:"hide",options:j=w={strategy:"referenceHidden",...Y},async fn(e){let{rects:t}=e,{strategy:r="referenceHidden",...s}=c3(j,e);switch(r){case"referenceHidden":{let r=df(await dp(e,{...s,elementContext:"reference"}),t.reference);return{data:{referenceHiddenOffsets:r,referenceHidden:dm(r)}}}case"escaped":{let r=df(await dp(e,{...s,altBoundary:!0}),t.floating);return{data:{escapedOffsets:r,escaped:dm(r)}}}default:return{}}}},options:[w,v]}]}),[en,ei]=uN(Z),ea=(k=es.useRef(D),es.useEffect(()=>{k.current=D}),es.useMemo(()=>(...e)=>k.current?.(...e),[]));ua(()=>{ee&&ea?.()},[ee,ea]);let eo=et.arrow?.x,el=et.arrow?.y,ec=et.arrow?.centerOffset!==0,[ed,eu]=es.useState();return ua(()=>{U&&eu(window.getComputedStyle(U).zIndex)},[U]),(0,er.jsx)("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...Q,transform:ee?Q.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ed,"--radix-popper-transform-origin":[et.transformOrigin?.x,et.transformOrigin?.y].join(" "),...et.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:(0,er.jsx)(ug,{scope:N,placedSide:en,onArrowChange:F,arrowX:eo,arrowY:el,shouldHideArrow:ec,children:(0,er.jsx)(ui.div,{"data-side":en,"data-align":ei,...L,ref:z,style:{...L.style,animation:ee?void 0:"none"}})})})});ux.displayName=um;var uy="PopperArrow",uw={top:"bottom",right:"left",bottom:"top",left:"right"},uv=es.forwardRef(function(e,t){let{__scopePopper:r,...s}=e,n=ub(uy,r),i=uw[n.placedSide];return(0,er.jsx)("span",{ref:n.onArrowChange,style:{position:"absolute",left:n.arrowX,top:n.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[n.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[n.placedSide],visibility:n.shouldHideArrow?"hidden":void 0},children:(0,er.jsx)(ur,{...s,ref:t,style:{...s.style,display:"block"}})})});function uj(e){return null!==e}uv.displayName=uy;var uk=e=>({name:"transformOrigin",options:e,fn(t){let{placement:r,rects:s,middlewareData:n}=t,i=n.arrow?.centerOffset!==0,a=i?0:e.arrowWidth,o=i?0:e.arrowHeight,[l,c]=uN(r),d={start:"0%",center:"50%",end:"100%"}[c],u=(n.arrow?.x??0)+a/2,h=(n.arrow?.y??0)+o/2,p="",f="";return"bottom"===l?(p=i?d:`${u}px`,f=`${-o}px`):"top"===l?(p=i?d:`${u}px`,f=`${s.floating.height+o}px`):"right"===l?(p=`${-o}px`,f=i?d:`${h}px`):"left"===l&&(p=`${s.floating.width+o}px`,f=i?d:`${h}px`),{data:{x:p,y:f}}}});function uN(e){let[t,r="center"]=e.split("-");return[t,r]}var uS=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),u_=globalThis?.document?es.useLayoutEffect:()=>{},uC=es[" useInsertionEffect ".trim().toString()]||u_;Symbol("RADIX:SYNC_STATE");var uE="Popover",[uR,uA]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(uE,[uc]),uO=uc(),[uT,uI]=uR(uE),uM=e=>{let{__scopePopover:t,children:r,open:s,defaultOpen:n,onOpenChange:i,modal:a=!1}=e,o=uO(t),l=es.useRef(null),[c,d]=es.useState(!1),[u,h]=function({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return uC(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}({prop:s,defaultProp:n??!1,onChange:i,caller:uE});return(0,er.jsx)(uh,{...o,children:(0,er.jsx)(uT,{scope:t,contentId:n6(),triggerRef:l,open:u,onOpenChange:h,onOpenToggle:es.useCallback(()=>h(e=>!e),[h]),hasCustomAnchor:c,onCustomAnchorAdd:es.useCallback(()=>d(!0),[]),onCustomAnchorRemove:es.useCallback(()=>d(!1),[]),modal:a,children:r})})};uM.displayName=uE;var uP="PopoverAnchor";es.forwardRef((e,t)=>{let{__scopePopover:r,...s}=e,n=uI(uP,r),i=uO(r),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=n;return es.useEffect(()=>(a(),()=>o()),[a,o]),(0,er.jsx)(uf,{...i,...s,ref:t})}).displayName=uP;var uD="PopoverTrigger",uL=es.forwardRef((e,t)=>{let{__scopePopover:r,...s}=e,n=uI(uD,r),i=uO(r),a=cY(t,n.triggerRef),o=(0,er.jsx)(uS.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":uJ(n.open),...s,ref:a,onClick:cK(e.onClick,n.onOpenToggle)});return n.hasCustomAnchor?o:(0,er.jsx)(uf,{asChild:!0,...i,children:o})});uL.displayName=uD;var u$="PopoverPortal",[uU,uB]=uR(u$,{forceMount:void 0}),uz=e=>{let{__scopePopover:t,forceMount:r,children:s,container:n}=e,i=uI(u$,t);return(0,er.jsx)(uU,{scope:t,forceMount:r,children:(0,er.jsx)(ns,{present:r||i.open,children:(0,er.jsx)(a8,{asChild:!0,container:n,children:s})})})};uz.displayName=u$;var uq="PopoverContent",uF=es.forwardRef((e,t)=>{let r=uB(uq,e.__scopePopover),{forceMount:s=r.forceMount,...n}=e,i=uI(uq,e.__scopePopover);return(0,er.jsx)(ns,{present:s||i.open,children:i.modal?(0,er.jsx)(uW,{...n,ref:t}):(0,er.jsx)(uG,{...n,ref:t})})});uF.displayName=uq;var uH=eo("PopoverContent.RemoveScroll"),uW=es.forwardRef((e,t)=>{let r=uI(uq,e.__scopePopover),s=es.useRef(null),n=cY(t,s),i=es.useRef(!1);return es.useEffect(()=>{let e=s.current;if(e)return oV(e)},[]),(0,er.jsx)(oB,{as:uH,allowPinchZoom:!0,children:(0,er.jsx)(uV,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:cK(e.onCloseAutoFocus,e=>{e.preventDefault(),i.current||r.triggerRef.current?.focus()}),onPointerDownOutside:cK(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;i.current=2===t.button||r},{checkForDefaultPrevented:!1}),onFocusOutside:cK(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),uG=es.forwardRef((e,t)=>{let r=uI(uq,e.__scopePopover),s=es.useRef(!1),n=es.useRef(!1);return(0,er.jsx)(uV,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(s.current||r.triggerRef.current?.focus(),t.preventDefault()),s.current=!1,n.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(n.current=!0));let i=t.target;r.triggerRef.current?.contains(i)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&n.current&&t.preventDefault()}})}),uV=es.forwardRef((e,t)=>{let{__scopePopover:r,trapFocus:s,onOpenAutoFocus:n,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:d,...u}=e,h=uI(uq,r),p=uO(r);return oe(),(0,er.jsx)(aZ,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:n,onUnmountAutoFocus:i,children:(0,er.jsx)(aH,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:d,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:(0,er.jsx)(ux,{"data-state":uJ(h.open),role:"dialog",id:h.contentId,...p,...u,ref:t,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),uK="PopoverClose";function uJ(e){return e?"open":"closed"}function uY({...e}){return(0,er.jsx)(uM,{"data-slot":"popover",...e})}function uX({...e}){return(0,er.jsx)(uL,{"data-slot":"popover-trigger",...e})}function uQ({className:e,align:t="center",sideOffset:r=4,...s}){return(0,er.jsx)(uz,{children:(0,er.jsx)(uF,{"data-slot":"popover-content",align:t,sideOffset:r,className:tr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...s})})}es.forwardRef((e,t)=>{let{__scopePopover:r,...s}=e,n=uI(uK,r);return(0,er.jsx)(uS.button,{type:"button",...s,ref:t,onClick:cK(e.onClick,()=>n.onOpenChange(!1))})}).displayName=uK,es.forwardRef((e,t)=>{let{__scopePopover:r,...s}=e,n=uO(r);return(0,er.jsx)(uv,{...n,...s,ref:t})}).displayName="PopoverArrow";let uZ=tc("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),u0=tc("phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),u1=tc("search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),u2=tc("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),u4=tc("paperclip",[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]]),u5=tc("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),u3=tc("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),u6=tc("file",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),u8=tc("download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),u7=tc("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),u9=tc("pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),he=tc("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),ht=tc("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),hr=tc("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function hs({onInsertMessage:e}){let[t,r]=(0,es.useState)(!1),[s,n]=(0,es.useState)(""),[i,a]=(0,es.useState)(""),[o,l]=(0,es.useState)(!1),[c,d]=(0,es.useState)(!1),u=async()=>{if(!s.trim())return void i5.error("Please enter a prompt");l(!0),await new Promise(e=>setTimeout(e,1500));let e=s.toLowerCase();a(e.includes("congratulate")||e.includes("congrats")?`Congratulations!  That's absolutely amazing news! I'm so proud of you and all the hard work you've put in. You totally deserve this!`:e.includes("apologize")||e.includes("sorry")?"Hey, I wanted to reach out and sincerely apologize for what happened. I really didn't mean for things to go that way, and I feel terrible about it. Can we talk about this?":e.includes("thank")?`Thank you so much!  I really appreciate your help and support. It means the world to me, and I couldn't have done it without you!`:e.includes("invite")||e.includes("hang out")?`Hey! I was wondering if you'd like to hang out this weekend? We could grab coffee, catch a movie, or just chill. Let me know what works for you! `:e.includes("busy")||e.includes("can't make it")?"Hey, I'm really sorry but I won't be able to make it today. Something came up that I need to take care of. Can we reschedule for another time? I promise I'll make it up to you!":e.includes("birthday")||e.includes("bday")?`Happy Birthday!  Hope you have the most amazing day filled with joy, laughter, and all your favorite things. You deserve the best! `:e.includes("good morning")||e.includes("morning")?`Good morning!  Hope you slept well and are ready to crush this day! Let me know if you want to grab breakfast or coffee later. Have an awesome day! `:e.includes("good night")||e.includes("night")?`Good night!  Sleep well and sweet dreams! Tomorrow's going to be another great day. Rest up! `:e.includes("meeting")||e.includes("schedule")?"Hi! I wanted to check if we could schedule a meeting to discuss this further. I'm available most of this week. What time works best for you? Looking forward to connecting!":e.includes("miss you")?`I miss you too!  It's been way too long since we last hung out. We definitely need to catch up soon. When are you free?`:e.includes("love")?`You mean the world to me!  I'm so grateful to have you in my life. Thank you for always being there and being amazing!`:e.includes("funny")||e.includes("joke")?`Haha, you won't believe what just happened!  I was literally just thinking about that and it happened again. The universe has a weird sense of humor lol`:e.includes("excited")?`OMG I'm SO excited!  This is literally the best thing ever! I can't wait to tell you all about it! When can we meet up?`:e.includes("help")||e.includes("support")?`I'm here for you!  Whatever you need, just let me know. We'll figure this out together. You're not alone in this!`:e.includes("work")||e.includes("project")?"Hey! Just wanted to check in on the project. How's everything going on your end? Let me know if you need any help or if there's anything I can do to support you!":`Hey! ${s} I'd love to hear your thoughts on this. What do you think? Let's chat about it soon! `),l(!1),i5.success("Message generated! ")};return(0,er.jsxs)(uY,{open:t,onOpenChange:r,children:[(0,er.jsx)(uX,{asChild:!0,children:(0,er.jsxs)(tn,{size:"sm",variant:"ghost",className:"text-white/70 hover:text-white hover:bg-white/10 relative group",children:[(0,er.jsx)(tb,{className:"w-5 h-5"}),(0,er.jsx)("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full animate-pulse"})]})}),(0,er.jsx)(uQ,{className:"w-[500px] p-0 backdrop-blur-xl bg-gradient-to-br from-purple-900/95 to-pink-900/95 border-white/20",align:"end",side:"top",children:(0,er.jsxs)("div",{className:"p-4",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-xl flex items-center justify-center",children:(0,er.jsx)(he,{className:"w-5 h-5 text-white"})}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white",children:"Message Jumpstart"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Stuck on words? Try a quick suggestion."})]})]}),(0,er.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,er.jsxs)("div",{className:"flex gap-2",children:[(0,er.jsx)(cV,{placeholder:"Describe what you want to say...",value:s,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&u(),className:"flex-1 bg-white/5 border-white/20 text-white placeholder:text-white/50"}),(0,er.jsx)(tn,{onClick:u,disabled:o||!s.trim(),className:"bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white border-0",children:o?(0,er.jsx)(hr,{className:"w-4 h-4 animate-spin"}):(0,er.jsx)(tb,{className:"w-4 h-4"})})]}),(0,er.jsx)(nG,{className:"h-24",children:(0,er.jsx)("div",{className:"flex flex-wrap gap-2",children:["Congratulate someone on their achievement","Apologize for missing an event","Thank someone for their help","Invite friends to hang out","Say good morning cheerfully","Wish someone happy birthday","Ask to reschedule a meeting","Express that you miss someone"].map((e,t)=>(0,er.jsx)("button",{onClick:()=>n(e),className:"px-3 py-1.5 bg-white/10 hover:bg-white/20 text-white/70 hover:text-white rounded-full text-xs transition-all",children:e},t))})})]}),i&&(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-4 mb-4",children:[(0,er.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,er.jsx)(tb,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),(0,er.jsx)("div",{className:"flex-1",children:(0,er.jsx)("p",{className:"text-white text-sm leading-relaxed",children:i})})]}),(0,er.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:()=>{i&&(navigator.clipboard.writeText(i),d(!0),i5.success("Copied to clipboard! "),setTimeout(()=>d(!1),2e3))},className:"text-white/70 hover:text-white hover:bg-white/10",children:c?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(iW,{className:"w-4 h-4 mr-1"}),"Copied"]}):(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(ht,{className:"w-4 h-4 mr-1"}),"Copy"]})}),(0,er.jsxs)(tn,{size:"sm",variant:"ghost",onClick:()=>{u()},disabled:o,className:"text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(hr,{className:`w-4 h-4 mr-1 ${o?"animate-spin":""}`}),"Regenerate"]}),(0,er.jsxs)(tn,{size:"sm",onClick:()=>{i&&(e(i),r(!1),n(""),a(""),i5.success("Message inserted! "))},className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0",children:[(0,er.jsx)(aE,{className:"w-4 h-4 mr-1"}),"Insert"]})]})]}),o&&(0,er.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,er.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsx)("div",{className:"w-12 h-12 border-4 border-white/20 border-t-yellow-400 rounded-full animate-spin"}),(0,er.jsx)(tb,{className:"w-6 h-6 text-yellow-400 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})]}),(0,er.jsx)("p",{className:"text-white/70 text-sm",children:"Generating message..."})]})}),!i&&!o&&(0,er.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,er.jsx)("p",{className:"text-white/60 text-xs mb-2",children:" Tips:"}),(0,er.jsxs)("ul",{className:"text-white/50 text-xs space-y-1",children:[(0,er.jsx)("li",{children:" Be specific about the tone (friendly, formal, casual)"}),(0,er.jsx)("li",{children:" Mention the context (birthday, apology, invitation)"}),(0,er.jsx)("li",{children:" Include any specific details you want in the message"})]})]})]})})]})}let hn=tc("mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),hi=tc("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),ha=tc("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ho=tc("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function hl({onSendVoice:e}){let t,[r,s]=(0,es.useState)(!1),[n,i]=(0,es.useState)(!1),[a,o]=(0,es.useState)(!1),[l,c]=(0,es.useState)(!1),[d,u]=(0,es.useState)(0),[h,p]=(0,es.useState)(null),[f,m]=(0,es.useState)(null),[g,b]=(0,es.useState)(void 0),x=(0,es.useRef)(null),y=(0,es.useRef)([]),w=(0,es.useRef)(null),v=(0,es.useRef)(null);(0,es.useEffect)(()=>()=>{w.current&&clearInterval(w.current),f&&URL.revokeObjectURL(f)},[f]);let j=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=(()=>{if("undefined"!=typeof MediaRecorder){for(let e of["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/mp4;codecs=aac","audio/mpeg"])if(MediaRecorder.isTypeSupported(e))return e}})(),r=t?new MediaRecorder(e,{mimeType:t}):new MediaRecorder(e),s=r.mimeType||t;b(s),x.current=r,y.current=[],r.ondataavailable=e=>{e.data.size>0&&y.current.push(e.data)},r.onstop=()=>{let t=s||y.current[0]?.type||"audio/webm",r=new Blob(y.current,{type:t});p(r);let n=URL.createObjectURL(r);m(n),e.getTracks().forEach(e=>e.stop())},r.start(),i(!0),u(0),w.current=window.setInterval(()=>{u(e=>e+1)},1e3),i5.success("Recording started! ")}catch(e){console.error("Error accessing microphone:",e),i5.error("Could not access microphone")}},k=()=>{x.current&&n&&(x.current.stop(),i(!1),o(!1),w.current&&clearInterval(w.current),i5.success("Recording saved! "))},N=()=>{p(null),f&&URL.revokeObjectURL(f),m(null),u(0),c(!1),b(void 0),i5.success("Recording deleted")},S=async()=>{if(h){let t=new FileReader;t.onloadend=()=>{e(t.result,d,g||h.type),s(!1),N(),i5.success("Voice message sent! ")},t.readAsDataURL(h)}};return(0,er.jsxs)(er.Fragment,{children:[(0,er.jsxs)(uY,{open:r,onOpenChange:e=>{!e&&n&&k(),s(e)},children:[(0,er.jsx)(uX,{asChild:!0,children:(0,er.jsxs)(tn,{size:"sm",variant:"ghost",className:"text-white/70 hover:text-white hover:bg-white/10 h-9",children:[(0,er.jsx)(hn,{className:"w-5 h-5 mr-1"}),(0,er.jsx)("span",{className:"text-sm",children:"Voice"})]})}),(0,er.jsx)(uQ,{className:"w-80 p-0 backdrop-blur-xl bg-gradient-to-br from-purple-900/95 to-pink-900/95 border-white/20",align:"end",side:"top",children:(0,er.jsxs)("div",{className:"p-4",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-500 rounded-xl flex items-center justify-center",children:(0,er.jsx)(hn,{className:"w-5 h-5 text-white"})}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white",children:"Voice Message"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Record a voice note"})]})]}),(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6 mb-4",children:(0,er.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[n&&(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsx)("div",{className:`w-24 h-24 rounded-full bg-gradient-to-br from-pink-500 to-purple-500 flex items-center justify-center ${a?"":"animate-pulse"}`,children:(0,er.jsx)(ho,{className:`w-12 h-12 text-white ${a?"":"fill-current"}`})}),!a&&(0,er.jsx)("div",{className:"absolute -inset-2 rounded-full border-4 border-pink-500/50 animate-ping"})]}),!n&&f&&(0,er.jsx)("div",{className:"w-full h-24 flex items-center justify-center gap-1",children:Array.from({length:20}).map((e,t)=>(0,er.jsx)("div",{className:`w-1 bg-gradient-to-t from-pink-500 to-purple-500 rounded-full ${l?"animate-pulse":""}`,style:{height:`${60*Math.random()+20}%`,animationDelay:`${50*t}ms`}},t))}),!n&&!f&&(0,er.jsx)(tn,{size:"lg",onClick:j,className:"w-24 h-24 rounded-full bg-gradient-to-br from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 p-0",children:(0,er.jsx)(hn,{className:"w-10 h-10"})}),(0,er.jsx)("div",{className:"text-white text-2xl font-mono",children:(t=Math.floor(d/60),`${t}:${(d%60).toString().padStart(2,"0")}`)}),n&&(0,er.jsxs)("div",{className:"flex gap-3",children:[(0,er.jsx)(tn,{size:"sm",onClick:()=>{x.current&&n&&(a?(x.current.resume(),o(!1),w.current=window.setInterval(()=>{u(e=>e+1)},1e3)):(x.current.pause(),o(!0),w.current&&clearInterval(w.current)))},variant:"ghost",className:"text-white hover:bg-white/10",children:a?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(u7,{className:"w-4 h-4 mr-1"}),"Resume"]}):(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(u9,{className:"w-4 h-4 mr-1"}),"Pause"]})}),(0,er.jsxs)(tn,{size:"sm",onClick:k,className:"bg-red-500 hover:bg-red-600 text-white",children:[(0,er.jsx)(hi,{className:"w-4 h-4 mr-1"}),"Stop"]})]}),!n&&f&&(0,er.jsxs)("div",{className:"flex gap-3",children:[(0,er.jsx)(tn,{size:"sm",onClick:()=>{f&&v.current&&(l?(v.current.pause(),c(!1)):(v.current.play(),c(!0)))},variant:"ghost",className:"text-white hover:bg-white/10",children:l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(u9,{className:"w-4 h-4 mr-1"}),"Pause"]}):(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(u7,{className:"w-4 h-4 mr-1"}),"Play"]})}),(0,er.jsxs)(tn,{size:"sm",onClick:N,variant:"ghost",className:"text-red-400 hover:text-red-300 hover:bg-white/10",children:[(0,er.jsx)(ha,{className:"w-4 h-4 mr-1"}),"Delete"]}),(0,er.jsxs)(tn,{size:"sm",onClick:S,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white",children:[(0,er.jsx)(aE,{className:"w-4 h-4 mr-1"}),"Send"]})]})]})}),(0,er.jsx)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:(0,er.jsx)("p",{className:"text-white/60 text-xs",children:" Tip: Keep it short and sweet! Voice messages under 30 seconds work best."})})]})})]}),f&&(0,er.jsx)("audio",{ref:v,src:f,onEnded:()=>c(!1),className:"hidden"})]})}let hc="getting-started",hd=`https://${sB}.supabase.co/functions/v1/make-server-a14c7986`,hu=`Bearer ${sz}`,hh={"Content-Type":"application/json",Authorization:hu},hp=e=>`https://api.dicebear.com/7.x/avataaars/svg?seed=${encodeURIComponent(e||"user")}`,hf=e=>{let[t,r]=e.split(",");if(!r)throw Error("Error: cannot load data");let s=t.match(/^data:(.*?)(;base64)?$/),n=s?.[1]??"application/octet-stream",i=atob(r),a=new Uint8Array(i.length);for(let e=0;e<i.length;e+=1)a[e]=i.charCodeAt(e);return new Blob([a],{type:n})};function hm({onStartCall:e,shareDraft:t,onShareDraftConsumed:r,focusUserId:s=null,onFocusUserConsumed:n}){let{currentUser:i,allUsers:a}=ai(),o=(0,es.useRef)("");o.current||(o.current=`guest-${Math.random().toString(36).slice(2,10)}`);let l=o.current,c=i?.ablyClientId??l,d=i?.id??c,u=(0,es.useRef)(null),h=(0,es.useRef)(null),p=(0,es.useRef)(null),f=(0,es.useRef)(null),m=(0,es.useRef)(null),g=(0,es.useRef)(null),b=(0,es.useRef)(new Map),x=(0,es.useRef)(new Set),y=(0,es.useCallback)(()=>{b.current.forEach(e=>clearTimeout(e)),b.current.clear()},[]),w=(0,es.useCallback)(e=>{let t="object"==typeof e&&null!==e?e:{},r=t.id,s="string"==typeof r&&r.trim().length>0?r:hc,n=t.name,i=t.avatar,a=t.lastMessage,o=t.lastMessageTime,l=t.members,c=t.isGroup;return{identity:s,chatName:"string"==typeof n&&n.trim().length>0?n:"Chat",avatar:"string"==typeof i&&i.trim().length>0?i:hp(s),lastMessage:"string"==typeof a?a:"",lastMessageTime:"string"==typeof o?o:"",members:Array.isArray(l)?l.filter(e=>"string"==typeof e):[],isGroup:!!c}},[]),v=(0,es.useCallback)((e,t)=>{let r,s="object"==typeof e&&null!==e?e:{},n=s.identity,i=s.timestamp,a=s.senderId,o=s.senderName,l=s.senderAvatar,c=s.content,d=s.image,u=s.file,h=s.voice,p=s.isSnapStyle,f=s.expiresIn,m=s.isStarred,g="string"==typeof n&&n.trim().length>0?n:`${t}-${i??Date.now()}`;if("number"==typeof f)r=f;else if("string"==typeof f&&f.trim().length>0){let e=Number(f);Number.isNaN(e)||(r=e)}let b="string"==typeof i&&i?i:new Date().toISOString(),x="string"==typeof d&&d.trim().length>0?d:void 0,y=u&&"object"==typeof u&&null!==u?{name:"string"==typeof u.name?u.name:"file",url:"string"==typeof u.url?u.url:"",type:"string"==typeof u.type?u.type:"",size:Number(u.size??0)}:void 0,w=h&&"object"==typeof h&&null!==h?{url:"string"==typeof h.url?h.url:"",duration:Number(h.duration??0),mimeType:"string"==typeof h.mimeType?h.mimeType:void 0,id:"string"==typeof h.id?h.id:void 0}:void 0;return{id:g,chatId:t,senderId:"string"==typeof a&&a.trim().length>0?a:"unknown",senderName:"string"==typeof o&&o.trim().length>0?o:void 0,senderAvatar:"string"==typeof l&&l.trim().length>0?l:void 0,content:"string"==typeof c?c:"",timestamp:b,image:x,file:y,voice:w,isSnapStyle:!!p,expiresIn:r,isStarred:!!m}},[]),j=(0,es.useMemo)(()=>{let e=new Map;return a.forEach(t=>{let r=t.ablyClientId??t.id;e.set(r,t)}),e},[a]),k=(0,es.useMemo)(()=>({identity:hc,chatName:"Getting Started",avatar:hp(hc),lastMessage:"",lastMessageTime:"",members:[c],isGroup:!0}),[c]),N=(0,es.useCallback)(e=>e.content&&e.content.trim().length>0?e.content.trim():e.image?" Photo":e.file?` ${e.file.name}`:e.voice?" Voice message":"",[]),[S,_]=(0,es.useState)(k.identity),[C,E]=(0,es.useState)(""),[R,A]=(0,es.useState)(""),[O,T]=(0,es.useState)(!1),[I,M]=(0,es.useState)(!1),[P,D]=(0,es.useState)(10),[L,$]=(0,es.useState)(!1),[U,B]=(0,es.useState)(""),[z,q]=(0,es.useState)(""),[F,H]=(0,es.useState)(!1),W=(0,es.useRef)(null),G=(0,es.useRef)(null),V=(0,es.useRef)(null),K=(0,es.useRef)(null),J=(0,es.useRef)({}),[Y,X]=(0,es.useState)(null),[Q,Z]=(0,es.useState)(new Set),[ee,et]=(0,es.useState)([]),[en,ei]=(0,es.useState)([k]),ea=(0,es.useRef)(en);(0,es.useEffect)(()=>{ea.current=en},[en]);let[eo,el]=(0,es.useState)(!0),[ec,ed]=(0,es.useState)(!1),[eu,eh]=(0,es.useState)(null),[ep,ef]=(0,es.useState)(!1),[em,eg]=(0,es.useState)("connecting"),[eb,ex]=(0,es.useState)("idle"),ey=(0,es.useCallback)(async e=>{let t=a.get(e)??null,r=t?.ablyClientId??e;if(!r)return i5.error("Unable to open conversation for that user."),null;let s=Array.from(new Set([c,r].filter(Boolean))),n=ea.current.find(e=>!e.isGroup&&s.every(t=>e.members.includes(t)));if(n)return n.identity;let i=t?.name??t?.username??`Chat with ${e.slice(0,6)}`,o=null,l=!1;try{let e=await fetch(`${hd}/chats`,{method:"POST",headers:{...hh},body:JSON.stringify({name:i,members:s,isGroup:!1,createdBy:d??c})});if(e.ok){let t=(await e.json()).chat;t&&(o=w(t),l=!0)}else if(409!==e.status)throw Error(`Failed to persist chat (status ${e.status})`)}catch(e){console.warn("Unable to persist direct chat",e)}if(!o){let e=s.slice().sort().join("-");o={identity:ea.current.some(t=>t.identity===e)?`${e}-${Date.now().toString(36)}`:e,chatName:i,avatar:t?.avatar??hp(r),lastMessage:"",lastMessageTime:"",members:s,isGroup:!1}}ei(e=>{let t=new Map(e.map(e=>[e.identity,e]));t.set(o.identity,o);let r=Array.from(t.values());return r.sort((e,t)=>{let r=e.lastMessageTime?new Date(e.lastMessageTime).getTime():0;return(t.lastMessageTime?new Date(t.lastMessageTime).getTime():0)-r}),r});let u=h.current;return u&&u.rooms.get(o.identity).catch(e=>{console.warn("Unable to ensure Ably room exists",e)}),l&&i5.success(`Chat created with ${t?.name??"friend"}!`),o.identity},[a,c,d,w]),ew=(0,es.useRef)(ey);(0,es.useEffect)(()=>{ew.current=ey},[ey]),(0,es.useEffect)(()=>{if(!s||!ep)return;let e=!1;return(async()=>{try{let t=await ew.current?.(s);if(!t||e)return;_(t),n?.()}catch(e){console.error("Error:",e),i5.error("Unable to connect, try again later.")}})(),()=>{e=!0}},[s,ep,n]);let ev=(0,es.useCallback)(()=>({id:c??"guest",name:i?.name??i?.username??d??"Guest",username:i?.username,avatar:i?.avatar??(c?hp(c):void 0)}),[c,d,i?.name,i?.username,i?.avatar]),ej=(0,es.useCallback)((e={})=>{let t=ev(),r={...e,sender:{id:t.id,name:t.name,username:t.username,avatar:t.avatar}};return I&&(r.isSnapStyle=!0,r.expiresIn=P),r},[ev,I,P]),ek=(0,es.useCallback)(async(e,t,r)=>{try{let s=await fetch("/api/voice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:e,mimeType:t,duration:r})});if(!s.ok){let e=await s.text();throw Error(`Cannot upload audio: (${s.status}): ${e}`)}return await s.json()}catch(e){return console.error("Error uploading voice clip:",e),i5.error("Failed to upload voice message"),null}},[]);(0,es.useEffect)(()=>{t&&(E(t),T(!1),r?.(),V.current?.focus())},[t,r]),(0,es.useEffect)(()=>{ei(e=>e.some(e=>e.identity===k.identity)?e.map(e=>e.identity===k.identity?{...e,members:k.members}:e):[k,...e])},[k]),(0,es.useEffect)(()=>{let e=!1;return(async()=>{if(d)try{let t=await fetch(`${hd}/chats/${encodeURIComponent(d)}`,{headers:{Authorization:hu}});if(!t.ok)throw Error(`Failed to load chats (${t.status})`);let r=(await t.json()).chats;if(e)return;let s=Array.isArray(r)?r:[];if(0===s.length)return;ei(e=>{let t=new Map(e.map(e=>[e.identity,e]));return s.forEach(e=>{let r=w(e);t.set(r.identity,r)}),t.has(k.identity)||t.set(k.identity,k),Array.from(t.values()).sort((e,t)=>{let r=e.lastMessageTime?new Date(e.lastMessageTime).getTime():0;return(t.lastMessageTime?new Date(t.lastMessageTime).getTime():0)-r})})}catch(e){console.warn("Failed to load saved chats",e)}})(),()=>{e=!0}},[d,k,w]);let eN=(0,es.useCallback)((e,t)=>{let r=e.metadata??{},s=r.image,n=r.file,i=n&&"object"==typeof n?{name:"string"==typeof n.name?n.name:"file",url:"string"==typeof n.url?n.url:"",type:"string"==typeof n.type?n.type:"",size:Number(n.size??0)}:void 0,a=r.voice,o=a&&"object"==typeof a?{url:"string"==typeof a.url?a.url:"",duration:Number(a.duration??0),mimeType:"string"==typeof a.mimeType?a.mimeType:void 0,id:"string"==typeof a.id?a.id:void 0}:void 0,l=r.expiresIn,c="number"==typeof l?l:"string"==typeof l?Number(l):void 0,d=r.sender,u=d&&"object"==typeof d?d.name:void 0,h=d&&"object"==typeof d?d.avatar:void 0,p=j.get(e.clientId);return{id:e.serial,chatId:t,senderId:e.clientId,content:e.text,timestamp:e.timestamp.toISOString(),image:"string"==typeof s?s:void 0,file:i,voice:o,isSnapStyle:!!r.isSnapStyle,expiresIn:c&&Number.isFinite(c)?c:void 0,isStarred:!!r.isStarred,senderName:("string"==typeof u&&u.trim().length>0?u:p?.name??p?.username??e.clientId)??e.clientId,senderAvatar:("string"==typeof h&&h.trim().length>0?h:p?.avatar)??void 0}},[j]),eS=(0,es.useCallback)(async(e,t)=>{let r=e.id;if(r&&(!x.current.has(r)||t?.force)){x.current.add(r);try{await fetch(`${hd}/messages`,{method:"POST",headers:{...hh},body:JSON.stringify({id:r,chatId:e.chatId,senderId:e.senderId,senderName:e.senderName??null,senderAvatar:e.senderAvatar??null,content:e.content??"",image:e.image??null,file:e.file??null,voice:e.voice??null,timestamp:e.timestamp,isSnapStyle:e.isSnapStyle??!1,expiresIn:"number"==typeof e.expiresIn&&Number.isFinite(e.expiresIn)?e.expiresIn:null,isStarred:e.isStarred??!1})})}catch(e){console.warn("Failed to persist message",e),x.current.delete(r)}}},[]),e_=(0,es.useCallback)(async(e,t)=>{if(t)try{await fetch(`${hd}/messages/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,{method:"DELETE",headers:{Authorization:hu}})}catch(e){console.warn("Failed to delete persisted message",e)}finally{x.current.delete(t)}},[]),eC=(0,es.useCallback)((e,t)=>{if(e.type===l5.Deleted){let r=b.current.get(e.message.serial);r&&(clearTimeout(r),b.current.delete(e.message.serial)),et(t=>t.filter(t=>t.id!==e.message.serial)),e_(t,e.message.serial);return}let r=eN(e.message,t);if(r.isSnapStyle&&r.expiresIn){let t=b.current.get(r.id);t&&clearTimeout(t);let s=setTimeout(async()=>{let t=p.current;if(t)try{await t.messages.delete(e.message.serial)}catch(e){console.warn("Failed to auto-delete snap message",e)}finally{b.current.delete(r.id)}},1e3*r.expiresIn);b.current.set(r.id,s)}et(e=>{let t=[...e.filter(e=>e.id!==r.id),r];return t.sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime()),t});let s=N(r),n=s?(r.senderName?`${r.senderName}: `:"")+s:r.senderName??"";ei(r=>r.map(r=>r.identity===t?{...r,lastMessage:n,lastMessageTime:e.message.timestamp.toISOString()}:r)),eS(r)},[eN,N,eS,e_]);(0,es.useEffect)(()=>{ef(!1),eh(null);let e=new lB.Realtime({key:"TWe31g.j0F01A:-j8adkUcs-AeusvKPMgSFCJKlMb8zCh1pGbt5Zo3CxI",clientId:c});u.current=e;let t=new cG(e);h.current=t,ef(!0);let{off:r}=t.connection.onStatusChange(e=>{eg(e.current)});return m.current=r,()=>{m.current?.(),m.current=null,f.current?.(),f.current=null,g.current?.(),g.current=null,(async()=>{y();try{p.current&&(await t.rooms.release(p.current.name),p.current=null)}catch(e){console.warn("Failed to release Ably room",e)}try{await e.close()}catch(e){console.warn("Failed to close Ably Realtime client",e)}u.current===e&&(u.current=null),h.current===t&&(h.current=null)})()}},[c,y]),(0,es.useEffect)(()=>{if(!ep||!S)return;let e=!1;return(async()=>{let t=h.current;if(t){if(el(!0),eh(null),et([]),x.current=new Set,f.current?.(),f.current=null,g.current?.(),g.current=null,p.current&&p.current.name!==S){try{await t.rooms.release(p.current.name)}catch(e){console.warn("Failed to release previous Ably room",e)}p.current=null,y()}try{let r=await t.rooms.get(S);p.current=r,y();let{off:s}=r.onStatusChange(e=>{ex(e.current)});g.current=s;let n=new Map;try{let e=await fetch(`${hd}/messages/${encodeURIComponent(S)}`,{headers:{Authorization:hu}});if(e.ok){let t=(await e.json()).messages;(Array.isArray(t)?t:[]).map(e=>v(e,S)).forEach(e=>n.set(e.id,e))}}catch(e){console.warn("Failed to load stored messages",e)}let i=await r.messages.history({orderBy:cy.OldestFirst,limit:50}),a=[];i.items.filter(e=>!e.isDeleted).map(e=>eN(e,S)).forEach(e=>{let t=n.get(e.id);t?n.set(e.id,{...t,...e}):(n.set(e.id,e),a.push(e))});let o=Array.from(n.values()).sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime());if(x.current=new Set(n.keys()),!e&&(et(o),o.length>0)){let e=o[o.length-1],t=N(e),r=t?(e.senderName?`${e.senderName}: `:"")+t:e.senderName??"";ei(t=>t.map(t=>t.identity===S?{...t,lastMessage:r,lastMessageTime:e.timestamp}:t))}a.forEach(e=>{eS(e,{force:!0})});let{unsubscribe:l}=r.messages.subscribe(e=>{eC(e,S)});f.current=l,await r.attach(),e||el(!1)}catch(t){console.error("Failed to join Ably room",t),e||(eh("Failed to join chat room. Please try again."),el(!1))}}})(),()=>{e=!0}},[ep,S,eC,eN,N,y,v,eS]),(0,es.useEffect)(()=>()=>{Object.values(J.current).forEach(({audio:e,objectUrl:t})=>{e.pause(),t&&URL.revokeObjectURL(t)}),J.current={},y()},[y]),(0,es.useEffect)(()=>{K.current?.scrollIntoView({behavior:"smooth"})},[ee]),(0,es.useEffect)(()=>{eu&&i5.error(eu)},[eu]),(0,es.useEffect)(()=>{let e=!1;return(async()=>{let t=ee.filter(e=>e.voice?.url),r=new Set(t.map(e=>e.id));for(let s of(Object.entries(J.current).forEach(([e,t])=>{r.has(e)||(t.audio.pause(),t.audio.onended=null,t.audio.onerror=null,t.objectUrl&&URL.revokeObjectURL(t.objectUrl),delete J.current[e])}),t)){if(e||!s.voice?.url)continue;let t=J.current[s.id];if(!t||t.source!==s.voice.url){t&&(t.audio.pause(),t.audio.onended=null,t.audio.onerror=null,t.objectUrl&&URL.revokeObjectURL(t.objectUrl),delete J.current[s.id]);try{let t=null;if(s.voice.url.startsWith("data:"))t=hf(s.voice.url);else{let e=await fetch(s.voice.url);if(!e.ok)throw Error(`Failed to load voice audio (${e.status})`);if((e.headers.get("content-type")??"").includes("application/json")){let r=await e.json();if(r?.dataUrl)t=hf(r.dataUrl);else throw Error("Voice payload missing dataUrl")}else t=await e.blob()}if(!t)throw Error("Unable to resolve voice blob");if(e)return;let r=URL.createObjectURL(t);if(e)return void URL.revokeObjectURL(r);let n=new Audio(r);if(n.preload="auto",n.volume=1,n.onended=()=>{X(e=>e===s.id?null:e)},n.onerror=e=>{console.warn("Unable to play voice message",e)},J.current[s.id]={audio:n,source:s.voice.url,objectUrl:r},Y===s.id){n.currentTime=0;let e=n.play();e&&"function"==typeof e.catch&&e.catch(e=>{console.warn("Audio playback prevented:",e)})}}catch(t){if(e)continue;console.error("Failed to prepare voice message audio",t)}}}})(),()=>{e=!0}},[ee,Y]),(0,es.useEffect)(()=>{if(Object.entries(J.current).forEach(([e,t])=>{let{audio:r}=t;e!==Y&&(r.pause(),r.currentTime=0)}),!Y)return;let e=J.current[Y];if(!e)return;let{audio:t}=e;t.paused&&(t.currentTime=0);let r=()=>{let e=t.play();e&&"function"==typeof e.catch&&e.catch(e=>{console.warn("Audio playback prevented:",e)})};if(t.readyState>=2)r();else{let e=()=>{t.removeEventListener("canplay",e),r()};t.addEventListener("canplay",e,{once:!0}),t.load()}return()=>{t.pause()}},[Y]);let eE=async()=>{if(!C.trim()||!S||ec)return;let e=p.current;if(!e)return void i5.error("Chat is still connecting. Please try again.");ed(!0);try{let t=ej();await e.messages.send({text:C,metadata:t}),E(""),I?i5.success(`Snap sent! Disappears in ${P}s `):i5.success("Message sent! ")}catch(e){console.error("Error sending message via Ably:",e),i5.error("Failed to send message")}finally{ed(!1)}},eR=e=>{E(C+e)},eA=async e=>{if(!S||ec)return;let t=e.target.files?.[0],r=p.current;if(!t)return;if(!r)return void i5.error("Chat is still connecting. Please try again.");ed(!0);let s=new FileReader;s.onload=async e=>{try{let t=ej({image:e.target?.result});await r.messages.send({text:"",metadata:t}),i5.success("Photo sent! ")}catch(e){console.error("Error sending image via Ably:",e),i5.error("Failed to send image")}finally{ed(!1),W.current&&(W.current.value="")}},s.onerror=()=>{i5.error("Failed to read image file"),ed(!1)},s.readAsDataURL(t)},eO=async()=>{let e=U.trim();if(!e)return void i5.error("Please enter a chat name");try{let t=z.split(",").map(e=>e.trim()).filter(e=>e.length>0),r=Array.from(new Set([c,...t].filter(Boolean))),s=d??c,n=null,i=!1,a=!1;if(s)try{let t=await fetch(`${hd}/chats`,{method:"POST",headers:{...hh},body:JSON.stringify({name:e,members:r,isGroup:F||r.length>2,createdBy:s})});if(t.ok){let e=await t.json(),r=e.chat;void 0!==r&&(n=w(r),i=!!e.isDuplicate,a=!0)}else throw Error(`Failed to persist chat (${t.status})`)}catch(e){console.warn("Unable to persist chat, falling back to local state",e)}if(!n){let t=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),s=`${t||"chat"}-${Date.now().toString(36)}`,i=en.some(e=>e.identity===s)?`${s}-${Math.random().toString(36).slice(2,8)}`:s;n={identity:i,chatName:e,avatar:hp(i),lastMessage:"",lastMessageTime:"",members:r,isGroup:F||r.length>2}}ei(e=>{let t=new Map(e.map(e=>[e.identity,e]));return t.set(n.identity,n),Array.from(t.values()).sort((e,t)=>{let r=e.lastMessageTime?new Date(e.lastMessageTime).getTime():0;return(t.lastMessageTime?new Date(t.lastMessageTime).getTime():0)-r})}),_(n.identity),$(!1),B(""),q(""),H(!1),i?i5.success("Chat already exists. Opening it now!"):a?i5.success("Chat created and saved! "):i5.success("Chat created! ");let o=h.current;o&&o.rooms.get(n.identity).catch(e=>{console.warn("Unable to start chat room",e)})}catch(e){console.error("Error creating chat:",e),i5.error("Chat has not been created")}},eT=t=>{let r=en.find(e=>e.identity===S);i5.success(`Starting ${t} call with ${r?.chatName}...`),e&&e(t)},eI=async e=>{if(!S||ec)return;let t=e.target.files?.[0],r=p.current;if(!t)return;if(!r)return void i5.error("Chat is still connecting. Please try again.");ed(!0);let s=new FileReader;s.onload=async e=>{try{let s=ej({file:{name:t.name,url:e.target?.result,type:t.type,size:t.size}});await r.messages.send({text:"",metadata:s}),i5.success("File sent! ")}catch(e){console.error("Error sending file via Ably:",e),i5.error("Failed to send file")}finally{ed(!1),G.current&&(G.current.value="")}},s.onerror=()=>{i5.error("Failed to read file"),ed(!1)},s.readAsDataURL(t)},eM=async(e,t,r)=>{if(!S||ec)return;let s=p.current;if(!s)return void i5.error("Chat is still connecting. Please try again.");ed(!0);try{let n=await ek(e,r,t);if(!n)return;let i={url:n.url,duration:t};(n.mimeType||r)&&(i.mimeType=n.mimeType??r),n.id&&(i.id=n.id);let a=ej({voice:i});await s.messages.send({text:"",metadata:a}),i5.success("Voice message sent! ")}catch(e){console.error("Error sending voice message via Ably:",e),i5.error("Failed to send voice message")}finally{ed(!1)}},eP=async e=>{let t=ee.find(t=>t.id===e);if(!t)return;let r=new Set(Q),s=!r.has(e);s?(r.add(e),i5.success("Message starred! ")):(r.delete(e),i5.success("Message unstarred")),Z(r),et(t=>t.map(t=>t.id===e?{...t,isStarred:s}:t));try{await fetch(`${hd}/messages/${encodeURIComponent(t.chatId)}/${encodeURIComponent(e)}/star`,{method:"PUT",headers:{...hh},body:JSON.stringify({isStarred:s})})}catch(e){console.warn("Failed to persist starring change",e)}},eD="connected"===em&&"attached"===eb,eL=eD?"Live":`Status: ${em} / ${eb}`,e$=en.find(e=>e.identity===S),eU=en.filter(e=>e.chatName.toLowerCase().includes(R.toLowerCase()));return eo?(0,er.jsx)("div",{className:"h-[calc(100vh-80px)] flex items-center justify-center",children:(0,er.jsx)("div",{className:"text-white text-xl",children:"Loading messages... "})}):(0,er.jsxs)("div",{className:"h-[calc(100vh-80px)] min-h-0 flex gap-6 max-w-7xl mx-auto",children:[(0,er.jsxs)(ak,{className:"w-96 min-h-0 backdrop-blur-xl bg-white/10 border-white/20 flex flex-col overflow-hidden",children:[(0,er.jsxs)("div",{className:"p-4 border-b border-white/10",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,er.jsx)("h2",{className:"text-white text-xl",children:"Messages"}),(0,er.jsx)(tn,{size:"sm",onClick:()=>$(!L),className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0",children:(0,er.jsx)(u2,{className:"w-4 h-4"})})]}),L&&(0,er.jsxs)("div",{className:"mb-4 p-4 bg-white/10 rounded-lg space-y-3",children:[(0,er.jsx)(cV,{placeholder:"Chat name...",value:U,onChange:e=>B(e.target.value),className:"bg-white/5 border-white/20 text-white placeholder:text-white/50"}),(0,er.jsx)(cV,{placeholder:"Member IDs (comma separated)...",value:z,onChange:e=>q(e.target.value),className:"bg-white/5 border-white/20 text-white placeholder:text-white/50"}),(0,er.jsxs)("div",{className:"flex gap-2",children:[(0,er.jsx)(tn,{size:"sm",onClick:eO,className:"flex-1 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0",children:"Create"}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:()=>$(!1),className:"text-white/70 hover:text-white hover:bg-white/10",children:"Cancel"})]})]}),(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsx)(u1,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/50"}),(0,er.jsx)(cV,{placeholder:"Search messages...",value:R,onChange:e=>A(e.target.value),className:"pl-10 bg-white/5 border-white/20 text-white placeholder:text-white/50"})]})]}),(0,er.jsx)(nG,{className:"flex-1 h-full overflow-y-auto",children:0===eU.length?(0,er.jsxs)("div",{className:"p-8 text-center text-white/50",children:[(0,er.jsx)("p",{className:"mb-2",children:"No chats yet"}),(0,er.jsx)("p",{className:"text-sm",children:"Click + to start a new conversation"})]}):(0,er.jsx)("div",{className:"p-2",children:eU.map(e=>(0,er.jsx)("button",{onClick:()=>_(e.identity),className:`w-full p-3 rounded-xl mb-2 transition-all ${S===e.identity?"bg-gradient-to-r from-pink-500/30 to-purple-500/30 backdrop-blur-xl":"hover:bg-white/10"}`,children:(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsxs)(s8,{className:"w-12 h-12 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.chatName[0]})]}),(0,er.jsxs)("div",{className:"flex-1 text-left overflow-hidden",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsx)("h3",{className:"text-white truncate",children:e.chatName}),(0,er.jsx)("span",{className:"text-white/40 text-xs",children:e.lastMessageTime?new Date(e.lastMessageTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"})]}),(0,er.jsx)("p",{className:"text-white/60 text-sm truncate",children:e.lastMessage||"No messages yet"})]})]})},e.identity))})})]}),(0,er.jsx)(ak,{className:"flex-1 min-h-0 backdrop-blur-xl bg-white/10 border-white/20 flex flex-col overflow-hidden",children:S&&e$?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsxs)("div",{className:"p-4 border-b border-white/10 flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsxs)(s8,{className:"w-10 h-10 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:e$.avatar}),(0,er.jsx)(s9,{children:e$.chatName[0]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white",children:e$.chatName}),e$.isGroup&&(0,er.jsxs)("p",{className:"text-white/60 text-sm",children:[e$.members.length," members"]}),(0,er.jsx)("p",{className:`text-sm ${eD?"text-emerald-300":"text-white/60"}`,children:eL})]})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:()=>eT("audio"),className:"text-white/70 hover:text-white hover:bg-white/10",children:(0,er.jsx)(u0,{className:"w-5 h-5"})}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:()=>eT("video"),className:"text-white/70 hover:text-white hover:bg-white/10",children:(0,er.jsx)(tu,{className:"w-5 h-5"})}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",className:"text-white/70 hover:text-white hover:bg-white/10",children:(0,er.jsx)(uZ,{className:"w-5 h-5"})})]})]}),(0,er.jsx)(nG,{className:"flex-1 h-full overflow-y-auto p-6",children:(0,er.jsxs)("div",{className:"space-y-4",children:[0===ee.length?(0,er.jsx)("div",{className:"text-center text-white/50 py-8",children:(0,er.jsx)("p",{children:"No messages yet. Start the conversation! "})}):ee.map(e=>{let t=e.senderId===c,r=Q.has(e.id)||e.isStarred;return(0,er.jsxs)("div",{className:`flex gap-3 ${t?"flex-row-reverse":"flex-row"} group`,children:[!t&&(0,er.jsxs)(s8,{className:"w-8 h-8 border-2 border-white/20 flex-shrink-0",children:[(0,er.jsx)(s7,{src:e.senderAvatar??hp(e.senderId)}),(0,er.jsx)(s9,{children:(e.senderName??e.senderId??"U")[0]??"U"})]}),(0,er.jsxs)("div",{className:`flex-1 max-w-[70%] ${t?"flex flex-col items-end":""}`,children:[!t&&e.senderName&&(0,er.jsx)("p",{className:"text-xs text-white/50 mb-1",children:e.senderName}),e.image&&(0,er.jsxs)("div",{className:`rounded-2xl overflow-hidden mb-2 relative ${e.isSnapStyle?"border-4 border-yellow-400":""}`,children:[(0,er.jsx)(ty,{src:e.image,alt:"Shared image",className:"w-full max-w-md rounded-xl"}),e.isSnapStyle&&e.expiresIn&&(0,er.jsxs)("div",{className:"absolute -top-2 -right-2 bg-yellow-400 text-black px-2 py-0.5 rounded-full text-xs flex items-center gap-1",children:[(0,er.jsx)(u5,{className:"w-3 h-3"}),e.expiresIn,"s"]})]}),e.file&&(0,er.jsx)("div",{className:`rounded-2xl px-4 py-3 mb-2 ${t?"bg-gradient-to-r from-pink-500 to-purple-500 text-white":"bg-white/10 backdrop-blur-xl text-white"}`,children:(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:(0,er.jsx)(u6,{className:"w-5 h-5"})}),(0,er.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,er.jsx)("p",{className:"truncate",children:e.file.name}),(0,er.jsxs)("p",{className:"text-xs opacity-70",children:[(e.file.size/1024).toFixed(2)," KB"]})]}),(0,er.jsx)("a",{href:e.file.url,download:e.file.name,className:"w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center transition-colors",children:(0,er.jsx)(u8,{className:"w-4 h-4"})})]})}),e.voice&&(0,er.jsx)("div",{className:`rounded-2xl px-4 py-3 mb-2 min-w-[200px] ${t?"bg-gradient-to-r from-pink-500 to-purple-500 text-white":"bg-white/10 backdrop-blur-xl text-white"}`,children:(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("button",{onClick:()=>(e=>{if(Y===e)return void X(null);let t=J.current[e];if(!t)return void X(e);Object.entries(J.current).forEach(([t,r])=>{t!==e&&(r.audio.pause(),r.audio.currentTime=0)}),t.audio.currentTime=0;let r=t.audio.play();r&&"function"==typeof r.catch&&r.catch(e=>{console.warn("Audio playback prevented:",e)}),X(e)})(e.id),className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-full flex items-center justify-center transition-colors",children:Y===e.id?(0,er.jsx)(u9,{className:"w-5 h-5"}):(0,er.jsx)(u7,{className:"w-5 h-5 ml-0.5"})}),(0,er.jsxs)("div",{className:"flex-1",children:[(0,er.jsx)("div",{className:"flex items-center gap-1 h-6",children:Array.from({length:20}).map((t,r)=>(0,er.jsx)("div",{className:`w-1 bg-white/50 rounded-full ${Y===e.id?"animate-pulse":""}`,style:{height:`${60*Math.random()+40}%`,animationDelay:`${50*r}ms`}},r))}),(0,er.jsxs)("p",{className:"text-xs opacity-70 mt-1",children:[Math.floor(e.voice.duration/60),":",(e.voice.duration%60).toString().padStart(2,"0")]})]})]})}),e.content&&(0,er.jsxs)("div",{className:`rounded-2xl px-4 py-3 relative ${t?e.isSnapStyle?"bg-yellow-400 text-black":"bg-gradient-to-r from-pink-500 to-purple-500 text-white":"bg-white/10 backdrop-blur-xl text-white"} ${e.isSnapStyle?"border-2 border-yellow-400":""}`,children:[(0,er.jsx)("p",{className:"break-words",children:e.content}),e.isSnapStyle&&e.expiresIn&&(0,er.jsxs)("div",{className:"absolute -top-2 -right-2 bg-yellow-400 text-black px-2 py-0.5 rounded-full text-xs flex items-center gap-1",children:[(0,er.jsx)(u5,{className:"w-3 h-3"}),e.expiresIn,"s"]})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,er.jsx)("div",{className:"text-white/40 text-xs",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),(0,er.jsx)("button",{onClick:()=>eP(e.id),className:`opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:scale-125 ${r?"opacity-100":""}`,children:(0,er.jsx)(u3,{className:`w-4 h-4 ${r?"fill-yellow-400 text-yellow-400":"text-white/40 hover:text-white/60"}`})})]})]})]},e.id)}),(0,er.jsx)("div",{ref:K})]})}),(0,er.jsx)("div",{className:"px-6 py-2 border-t border-white/10",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsxs)("button",{onClick:()=>M(!I),className:`flex items-center gap-2 px-3 py-1.5 rounded-full transition-all ${I?"bg-yellow-400 text-black":"bg-white/10 text-white/70 hover:bg-white/20"}`,children:[(0,er.jsx)(tg,{className:"w-4 h-4"}),(0,er.jsx)("span",{className:"text-sm",children:"Snap Mode"}),I&&(0,er.jsx)(u5,{className:"w-4 h-4"})]}),I&&(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-white/70 text-sm",children:"Timer:"}),[5,10,15,30].map(e=>(0,er.jsxs)("button",{onClick:()=>D(e),className:`px-2 py-1 rounded-lg text-xs ${P===e?"bg-yellow-400 text-black":"bg-white/10 text-white/70 hover:bg-white/20"}`,children:[e,"s"]},e))]})]}),(0,er.jsx)("div",{className:"flex gap-2",children:["","","","","","","",""].map((e,t)=>(0,er.jsx)("button",{onClick:()=>eR(e),className:"text-xl hover:scale-125 transition-transform",children:e},t))})]})}),(0,er.jsx)("div",{className:"p-4",children:(0,er.jsxs)("div",{className:"backdrop-blur-xl bg-white/10 border-2 border-white/20 rounded-2xl p-3",children:[(0,er.jsx)("input",{ref:W,type:"file",accept:"image/*",onChange:eA,className:"hidden"}),(0,er.jsx)("input",{ref:G,type:"file",accept:".pdf,.doc,.docx,.txt,.zip,.rar",onChange:eI,className:"hidden"}),(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,er.jsx)(cV,{ref:V,placeholder:I?"Send a disappearing message...":"Type a message...",value:C,onChange:e=>E(e.target.value),onKeyPress:e=>"Enter"===e.key&&eE(),disabled:ec,className:`flex-1 bg-white/5 border-white/20 text-white placeholder:text-white/50 h-12 text-base ${I?"border-yellow-400 border-2":""}`}),(0,er.jsx)(tn,{onClick:eE,disabled:ec||!C.trim(),className:`h-12 px-6 ${I?"bg-yellow-400 hover:bg-yellow-500 text-black":"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white"} border-0`,children:(0,er.jsx)(aE,{className:"w-5 h-5"})})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsxs)(tn,{size:"sm",variant:"ghost",onClick:()=>W.current?.click(),disabled:ec,className:"text-white/70 hover:text-white hover:bg-white/10 h-9",children:[(0,er.jsx)(a_,{className:"w-5 h-5 mr-1"}),(0,er.jsx)("span",{className:"text-sm",children:"Photo"})]}),(0,er.jsxs)(tn,{size:"sm",variant:"ghost",onClick:()=>G.current?.click(),disabled:ec,className:"text-white/70 hover:text-white hover:bg-white/10 h-9",children:[(0,er.jsx)(u4,{className:"w-5 h-5 mr-1"}),(0,er.jsx)("span",{className:"text-sm",children:"File"})]}),(0,er.jsxs)(uY,{open:O,onOpenChange:T,children:[(0,er.jsx)(uX,{asChild:!0,children:(0,er.jsxs)(tn,{size:"sm",variant:"ghost",className:"text-white/70 hover:text-white hover:bg-white/10 h-9",children:[(0,er.jsx)(aC,{className:"w-5 h-5 mr-1"}),(0,er.jsx)("span",{className:"text-sm",children:"Emoji"})]})}),(0,er.jsx)(uQ,{className:"w-80 backdrop-blur-xl bg-white/10 border-white/20 p-0",children:(0,er.jsx)(nG,{className:"h-80",children:(0,er.jsx)("div",{className:"p-4",children:Object.entries({Smileys:["","","","","","","","","","","","","","","","","","","",""],Gestures:["","","","","","","","","","","","","","","","","","","",""],Hearts:["","","","","","","","","","","","","","","","","","","",""],Celebration:["","","","","","","","","","","","","","","","","","","",""],Activities:["","","","","","","","","","","","","","","","","","","",""]}).map(([e,t])=>(0,er.jsxs)("div",{className:"mb-4",children:[(0,er.jsx)("div",{className:"text-white/70 text-sm mb-2",children:e}),(0,er.jsx)("div",{className:"grid grid-cols-8 gap-2",children:t.map((e,t)=>(0,er.jsx)("button",{onClick:()=>{eR(e),T(!1)},className:"text-2xl hover:scale-125 transition-transform p-1 hover:bg-white/10 rounded",children:e},t))})]},e))})})})]}),(0,er.jsx)(hl,{onSendVoice:eM})]}),(0,er.jsx)(hs,{onInsertMessage:e=>E(e)})]})]})})]}):(0,er.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,er.jsxs)("div",{className:"text-center",children:[(0,er.jsx)("h3",{className:"text-white text-2xl mb-2",children:"Select a chat to start messaging"}),(0,er.jsx)("p",{className:"text-white/60",children:"Choose a conversation or create a new one"})]})})})]})}var hg=e.i(57688);function hb(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function hx(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}"undefined"!=typeof window&&window.document&&window.document.createElement;var hy=globalThis?.document?es.useLayoutEffect:()=>{},hw=es[" useInsertionEffect ".trim().toString()]||hy;Symbol("RADIX:SYNC_STATE");var hv=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function hj(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function hk(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function hN(...e){return t=>{let r=!1,s=e.map(e=>{let s=hk(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():hk(e[t],null)}}}}function hS(...e){return es.useCallback(hN(...e),e)}"undefined"!=typeof window&&window.document&&window.document.createElement;var h_=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function hC(e){let t=es.useRef(e);return es.useEffect(()=>{t.current=e}),es.useMemo(()=>(...e)=>t.current?.(...e),[])}var hE=["Enter"," "],hR=["ArrowUp","PageDown","End"],hA=["ArrowDown","PageUp","Home",...hR],hO={ltr:[...hE,"ArrowRight"],rtl:[...hE,"ArrowLeft"]},hT={ltr:["ArrowLeft"],rtl:["ArrowRight"]},hI="Menu",[hM,hP,hD]=nQ(hI),[hL,h$]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(hI,[hD,uc,il]),hU=uc(),hB=il(),[hz,hq]=hL(hI),[hF,hH]=hL(hI),hW=e=>{let{__scopeMenu:t,open:r=!1,children:s,dir:n,onOpenChange:i,modal:a=!0}=e,o=hU(t),[l,c]=es.useState(null),d=es.useRef(!1),u=hC(i),h=nc(n);return es.useEffect(()=>{let e=()=>{d.current=!0,document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})},t=()=>d.current=!1;return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0})}},[]),(0,er.jsx)(uh,{...o,children:(0,er.jsx)(hz,{scope:t,open:r,onOpenChange:u,content:l,onContentChange:c,children:(0,er.jsx)(hF,{scope:t,onClose:es.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:d,dir:h,modal:a,children:s})})})};hW.displayName=hI;var hG=es.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e,n=hU(r);return(0,er.jsx)(uf,{...n,...s,ref:t})});hG.displayName="MenuAnchor";var hV="MenuPortal",[hK,hJ]=hL(hV,{forceMount:void 0}),hY=e=>{let{__scopeMenu:t,forceMount:r,children:s,container:n}=e,i=hq(hV,t);return(0,er.jsx)(hK,{scope:t,forceMount:r,children:(0,er.jsx)(ns,{present:r||i.open,children:(0,er.jsx)(a8,{asChild:!0,container:n,children:s})})})};hY.displayName=hV;var hX="MenuContent",[hQ,hZ]=hL(hX),h0=es.forwardRef((e,t)=>{let r=hJ(hX,e.__scopeMenu),{forceMount:s=r.forceMount,...n}=e,i=hq(hX,e.__scopeMenu),a=hH(hX,e.__scopeMenu);return(0,er.jsx)(hM.Provider,{scope:e.__scopeMenu,children:(0,er.jsx)(ns,{present:s||i.open,children:(0,er.jsx)(hM.Slot,{scope:e.__scopeMenu,children:a.modal?(0,er.jsx)(h1,{...n,ref:t}):(0,er.jsx)(h2,{...n,ref:t})})})})}),h1=es.forwardRef((e,t)=>{let r=hq(hX,e.__scopeMenu),s=es.useRef(null),n=hS(t,s);return es.useEffect(()=>{let e=s.current;if(e)return oV(e)},[]),(0,er.jsx)(h5,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:hj(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),h2=es.forwardRef((e,t)=>{let r=hq(hX,e.__scopeMenu);return(0,er.jsx)(h5,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),h4=eo("MenuContent.ScrollLock"),h5=es.forwardRef((e,t)=>{let{__scopeMenu:r,loop:s=!1,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:h,onDismiss:p,disableOutsideScroll:f,...m}=e,g=hq(hX,r),b=hH(hX,r),x=hU(r),y=hB(r),w=hP(r),[v,j]=es.useState(null),k=es.useRef(null),N=hS(t,k,g.onContentChange),S=es.useRef(0),_=es.useRef(""),C=es.useRef(0),E=es.useRef(null),R=es.useRef("right"),A=es.useRef(0),O=f?oB:es.Fragment;es.useEffect(()=>()=>window.clearTimeout(S.current),[]),oe();let T=es.useCallback(e=>{var t,r;return R.current===E.current?.side&&(t=e,!!(r=E.current?.area)&&function(e,t){let{x:r,y:s}=e,n=!1;for(let e=0,i=t.length-1;e<t.length;i=e++){let a=t[e],o=t[i],l=a.x,c=a.y,d=o.x,u=o.y;c>s!=u>s&&r<(d-l)*(s-c)/(u-c)+l&&(n=!n)}return n}({x:t.clientX,y:t.clientY},r))},[]);return(0,er.jsx)(hQ,{scope:r,searchRef:_,onItemEnter:es.useCallback(e=>{T(e)&&e.preventDefault()},[T]),onItemLeave:es.useCallback(e=>{T(e)||(k.current?.focus(),j(null))},[T]),onTriggerLeave:es.useCallback(e=>{T(e)&&e.preventDefault()},[T]),pointerGraceTimerRef:C,onPointerGraceIntentChange:es.useCallback(e=>{E.current=e},[]),children:(0,er.jsx)(O,{...f?{as:h4,allowPinchZoom:!0}:void 0,children:(0,er.jsx)(aZ,{asChild:!0,trapped:n,onMountAutoFocus:hj(i,e=>{e.preventDefault(),k.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:(0,er.jsx)(aH,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:h,onDismiss:p,children:(0,er.jsx)(iu,{asChild:!0,...y,dir:b.dir,orientation:"vertical",loop:s,currentTabStopId:v,onCurrentTabStopIdChange:j,onEntryFocus:hj(l,e=>{b.isUsingKeyboardRef.current||e.preventDefault()}),preventScrollOnEntryFocus:!0,children:(0,er.jsx)(ux,{role:"menu","aria-orientation":"vertical","data-state":pw(g.open),"data-radix-menu-content":"",dir:b.dir,...x,...m,ref:N,style:{outline:"none",...m.style},onKeyDown:hj(m.onKeyDown,e=>{let t=e.target.closest("[data-radix-menu-content]")===e.currentTarget,r=e.ctrlKey||e.altKey||e.metaKey,s=1===e.key.length;if(t){var n;let t,i,a,o,l,c;"Tab"===e.key&&e.preventDefault(),!r&&s&&(n=e.key,t=_.current+n,i=w().filter(e=>!e.disabled),a=document.activeElement,o=i.find(e=>e.ref.current===a)?.textValue,l=function(e,t,r){var s;let n=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,i=r?e.indexOf(r):-1,a=(s=Math.max(i,0),e.map((t,r)=>e[(s+r)%e.length]));1===n.length&&(a=a.filter(e=>e!==r));let o=a.find(e=>e.toLowerCase().startsWith(n.toLowerCase()));return o!==r?o:void 0}(i.map(e=>e.textValue),t,o),c=i.find(e=>e.textValue===l)?.ref.current,function e(t){_.current=t,window.clearTimeout(S.current),""!==t&&(S.current=window.setTimeout(()=>e(""),1e3))}(t),c&&setTimeout(()=>c.focus()))}let i=k.current;if(e.target!==i||!hA.includes(e.key))return;e.preventDefault();let a=w().filter(e=>!e.disabled).map(e=>e.ref.current);hR.includes(e.key)&&a.reverse(),function(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}(a)}),onBlur:hj(e.onBlur,e=>{e.currentTarget.contains(e.target)||(window.clearTimeout(S.current),_.current="")}),onPointerMove:hj(e.onPointerMove,pk(e=>{let t=e.target,r=A.current!==e.clientX;e.currentTarget.contains(t)&&r&&(R.current=e.clientX>A.current?"right":"left",A.current=e.clientX)}))})})})})})})});h0.displayName=hX;var h3=es.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e;return(0,er.jsx)(h_.div,{role:"group",...s,ref:t})});h3.displayName="MenuGroup";var h6=es.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e;return(0,er.jsx)(h_.div,{...s,ref:t})});h6.displayName="MenuLabel";var h8="MenuItem",h7="menu.itemSelect",h9=es.forwardRef((e,t)=>{let{disabled:r=!1,onSelect:s,...n}=e,i=es.useRef(null),a=hH(h8,e.__scopeMenu),o=hZ(h8,e.__scopeMenu),l=hS(t,i),c=es.useRef(!1);return(0,er.jsx)(pe,{...n,ref:l,disabled:r,onClick:hj(e.onClick,()=>{let e=i.current;if(!r&&e){let t=new CustomEvent(h7,{bubbles:!0,cancelable:!0});e.addEventListener(h7,e=>s?.(e),{once:!0}),e&&sG.flushSync(()=>e.dispatchEvent(t)),t.defaultPrevented?c.current=!1:a.onClose()}}),onPointerDown:t=>{e.onPointerDown?.(t),c.current=!0},onPointerUp:hj(e.onPointerUp,e=>{c.current||e.currentTarget?.click()}),onKeyDown:hj(e.onKeyDown,e=>{let t=""!==o.searchRef.current;r||t&&" "===e.key||hE.includes(e.key)&&(e.currentTarget.click(),e.preventDefault())})})});h9.displayName=h8;var pe=es.forwardRef((e,t)=>{let{__scopeMenu:r,disabled:s=!1,textValue:n,...i}=e,a=hZ(h8,r),o=hB(r),l=es.useRef(null),c=hS(t,l),[d,u]=es.useState(!1),[h,p]=es.useState("");return es.useEffect(()=>{let e=l.current;e&&p((e.textContent??"").trim())},[i.children]),(0,er.jsx)(hM.ItemSlot,{scope:r,disabled:s,textValue:n??h,children:(0,er.jsx)(im,{asChild:!0,...o,focusable:!s,children:(0,er.jsx)(h_.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:c,onPointerMove:hj(e.onPointerMove,pk(e=>{s?a.onItemLeave(e):(a.onItemEnter(e),e.defaultPrevented||e.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:hj(e.onPointerLeave,pk(e=>a.onItemLeave(e))),onFocus:hj(e.onFocus,()=>u(!0)),onBlur:hj(e.onBlur,()=>u(!1))})})})}),pt=es.forwardRef((e,t)=>{let{checked:r=!1,onCheckedChange:s,...n}=e;return(0,er.jsx)(pc,{scope:e.__scopeMenu,checked:r,children:(0,er.jsx)(h9,{role:"menuitemcheckbox","aria-checked":pv(r)?"mixed":r,...n,ref:t,"data-state":pj(r),onSelect:hj(n.onSelect,()=>s?.(!!pv(r)||!r),{checkForDefaultPrevented:!1})})})});pt.displayName="MenuCheckboxItem";var pr="MenuRadioGroup",[ps,pn]=hL(pr,{value:void 0,onValueChange:()=>{}}),pi=es.forwardRef((e,t)=>{let{value:r,onValueChange:s,...n}=e,i=hC(s);return(0,er.jsx)(ps,{scope:e.__scopeMenu,value:r,onValueChange:i,children:(0,er.jsx)(h3,{...n,ref:t})})});pi.displayName=pr;var pa="MenuRadioItem",po=es.forwardRef((e,t)=>{let{value:r,...s}=e,n=pn(pa,e.__scopeMenu),i=r===n.value;return(0,er.jsx)(pc,{scope:e.__scopeMenu,checked:i,children:(0,er.jsx)(h9,{role:"menuitemradio","aria-checked":i,...s,ref:t,"data-state":pj(i),onSelect:hj(s.onSelect,()=>n.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});po.displayName=pa;var pl="MenuItemIndicator",[pc,pd]=hL(pl,{checked:!1}),pu=es.forwardRef((e,t)=>{let{__scopeMenu:r,forceMount:s,...n}=e,i=pd(pl,r);return(0,er.jsx)(ns,{present:s||pv(i.checked)||!0===i.checked,children:(0,er.jsx)(h_.span,{...n,ref:t,"data-state":pj(i.checked)})})});pu.displayName=pl;var ph=es.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e;return(0,er.jsx)(h_.div,{role:"separator","aria-orientation":"horizontal",...s,ref:t})});ph.displayName="MenuSeparator";var pp=es.forwardRef((e,t)=>{let{__scopeMenu:r,...s}=e,n=hU(r);return(0,er.jsx)(uv,{...n,...s,ref:t})});pp.displayName="MenuArrow";var[pf,pm]=hL("MenuSub"),pg="MenuSubTrigger",pb=es.forwardRef((e,t)=>{let r=hq(pg,e.__scopeMenu),s=hH(pg,e.__scopeMenu),n=pm(pg,e.__scopeMenu),i=hZ(pg,e.__scopeMenu),a=es.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},d=es.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return es.useEffect(()=>d,[d]),es.useEffect(()=>{let e=o.current;return()=>{window.clearTimeout(e),l(null)}},[o,l]),(0,er.jsx)(hG,{asChild:!0,...c,children:(0,er.jsx)(pe,{id:n.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":n.contentId,"data-state":pw(r.open),...e,ref:hN(t,n.onTriggerChange),onClick:t=>{e.onClick?.(t),e.disabled||t.defaultPrevented||(t.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:hj(e.onPointerMove,pk(t=>{i.onItemEnter(t),!t.defaultPrevented&&(e.disabled||r.open||a.current||(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{r.onOpenChange(!0),d()},100)))})),onPointerLeave:hj(e.onPointerLeave,pk(e=>{d();let t=r.content?.getBoundingClientRect();if(t){let s=r.content?.dataset.side,n="right"===s,a=t[n?"left":"right"],l=t[n?"right":"left"];i.onPointerGraceIntentChange({area:[{x:e.clientX+(n?-5:5),y:e.clientY},{x:a,y:t.top},{x:l,y:t.top},{x:l,y:t.bottom},{x:a,y:t.bottom}],side:s}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(e),e.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:hj(e.onKeyDown,t=>{let n=""!==i.searchRef.current;e.disabled||n&&" "===t.key||hO[s.dir].includes(t.key)&&(r.onOpenChange(!0),r.content?.focus(),t.preventDefault())})})})});pb.displayName=pg;var px="MenuSubContent",py=es.forwardRef((e,t)=>{let r=hJ(hX,e.__scopeMenu),{forceMount:s=r.forceMount,...n}=e,i=hq(hX,e.__scopeMenu),a=hH(hX,e.__scopeMenu),o=pm(px,e.__scopeMenu),l=es.useRef(null),c=hS(t,l);return(0,er.jsx)(hM.Provider,{scope:e.__scopeMenu,children:(0,er.jsx)(ns,{present:s||i.open,children:(0,er.jsx)(hM.Slot,{scope:e.__scopeMenu,children:(0,er.jsx)(h5,{id:o.contentId,"aria-labelledby":o.triggerId,...n,ref:c,align:"start",side:"rtl"===a.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:e=>{a.isUsingKeyboardRef.current&&l.current?.focus(),e.preventDefault()},onCloseAutoFocus:e=>e.preventDefault(),onFocusOutside:hj(e.onFocusOutside,e=>{e.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:hj(e.onEscapeKeyDown,e=>{a.onClose(),e.preventDefault()}),onKeyDown:hj(e.onKeyDown,e=>{let t=e.currentTarget.contains(e.target),r=hT[a.dir].includes(e.key);t&&r&&(i.onOpenChange(!1),o.trigger?.focus(),e.preventDefault())})})})})})});function pw(e){return e?"open":"closed"}function pv(e){return"indeterminate"===e}function pj(e){return pv(e)?"indeterminate":e?"checked":"unchecked"}function pk(e){return t=>"mouse"===t.pointerType?e(t):void 0}py.displayName=px;var pN="DropdownMenu",[pS,p_]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(pN,[h$]),pC=h$(),[pE,pR]=pS(pN),pA=e=>{let{__scopeDropdownMenu:t,children:r,dir:s,open:n,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=pC(t),c=es.useRef(null),[d,u]=function({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return hw(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}({prop:n,defaultProp:i??!1,onChange:a,caller:pN});return(0,er.jsx)(pE,{scope:t,triggerId:n6(),triggerRef:c,contentId:n6(),open:d,onOpenChange:u,onOpenToggle:es.useCallback(()=>u(e=>!e),[u]),modal:o,children:(0,er.jsx)(hW,{...l,open:d,onOpenChange:u,dir:s,modal:o,children:r})})};pA.displayName=pN;var pO="DropdownMenuTrigger",pT=es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,disabled:s=!1,...n}=e,i=pR(pO,r),a=pC(r);return(0,er.jsx)(hG,{asChild:!0,...a,children:(0,er.jsx)(hv.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...n,ref:function(...e){return t=>{let r=!1,s=e.map(e=>{let s=hx(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():hx(e[t],null)}}}}(t,i.triggerRef),onPointerDown:hb(e.onPointerDown,e=>{!s&&0===e.button&&!1===e.ctrlKey&&(i.onOpenToggle(),i.open||e.preventDefault())}),onKeyDown:hb(e.onKeyDown,e=>{!s&&(["Enter"," "].includes(e.key)&&i.onOpenToggle(),"ArrowDown"===e.key&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(e.key)&&e.preventDefault())})})})});pT.displayName=pO;var pI=e=>{let{__scopeDropdownMenu:t,...r}=e,s=pC(t);return(0,er.jsx)(hY,{...s,...r})};pI.displayName="DropdownMenuPortal";var pM="DropdownMenuContent",pP=es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pR(pM,r),i=pC(r),a=es.useRef(!1);return(0,er.jsx)(h0,{id:n.contentId,"aria-labelledby":n.triggerId,...i,...s,ref:t,onCloseAutoFocus:hb(e.onCloseAutoFocus,e=>{a.current||n.triggerRef.current?.focus(),a.current=!1,e.preventDefault()}),onInteractOutside:hb(e.onInteractOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey,s=2===t.button||r;(!n.modal||s)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});pP.displayName=pM,es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(h3,{...n,...s,ref:t})}).displayName="DropdownMenuGroup",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(h6,{...n,...s,ref:t})}).displayName="DropdownMenuLabel";var pD=es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(h9,{...n,...s,ref:t})});pD.displayName="DropdownMenuItem",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(pt,{...n,...s,ref:t})}).displayName="DropdownMenuCheckboxItem",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(pi,{...n,...s,ref:t})}).displayName="DropdownMenuRadioGroup",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(po,{...n,...s,ref:t})}).displayName="DropdownMenuRadioItem",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(pu,{...n,...s,ref:t})}).displayName="DropdownMenuItemIndicator",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(ph,{...n,...s,ref:t})}).displayName="DropdownMenuSeparator",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(pp,{...n,...s,ref:t})}).displayName="DropdownMenuArrow",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(pb,{...n,...s,ref:t})}).displayName="DropdownMenuSubTrigger",es.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...s}=e,n=pC(r);return(0,er.jsx)(py,{...n,...s,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})}).displayName="DropdownMenuSubContent";let pL=tc("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function p$({...e}){return(0,er.jsx)(pA,{"data-slot":"dropdown-menu",...e})}function pU({...e}){return(0,er.jsx)(pT,{"data-slot":"dropdown-menu-trigger",...e})}function pB({className:e,sideOffset:t=4,...r}){return(0,er.jsx)(pI,{children:(0,er.jsx)(pP,{"data-slot":"dropdown-menu-content",sideOffset:t,className:tr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...r})})}function pz({className:e,inset:t,variant:r="default",...s}){return(0,er.jsx)(pD,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":r,className:tr("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s})}let pq=tc("video-off",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),pF=tc("mic-off",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),pH=tc("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),pW=tc("monitor-off",[["path",{d:"M17 17H4a2 2 0 0 1-2-2V5c0-1.5 1-2 1-2",key:"k0q8oc"}],["path",{d:"M22 15V5a2 2 0 0 0-2-2H9",key:"cp1ac0"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),pG=tc("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),pV=tc("phone-off",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]),pK=tc("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),pJ=e=>e instanceof Error?{name:e.name,message:e.message}:"object"==typeof e&&null!==e?{name:"string"==typeof e.name?e.name:"",message:"string"==typeof e.message?e.message:""}:{name:"",message:""},pY={echoCancellation:{ideal:!0},noiseSuppression:{ideal:!0},autoGainControl:{ideal:!0}},pX=[{label:"4K UHD",constraints:{width:{ideal:3840},height:{ideal:2160},frameRate:{ideal:30}}},{label:"Full HD",constraints:{width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30}}},{label:"HD",constraints:{width:{ideal:1280},height:{ideal:720},frameRate:{ideal:30}}},{label:"SD",constraints:{width:{ideal:960},height:{ideal:540},frameRate:{ideal:24}}},{label:"Compatibility",constraints:!0}],pQ=e=>{let{name:t,message:r}=pJ(e),s=t.toLowerCase(),n=r.toLowerCase();return"notreadableerror"===s||"aborterror"===s||n.includes("already in use")||n.includes("busy")||n.includes("could not start video source")},pZ=async()=>{if("undefined"==typeof navigator||!navigator.mediaDevices?.getUserMedia)throw Error("Media devices are not supported in this environment");let e=null,t=!1;for(let r=0;r<pX.length;r+=1){let s=pX[r];try{let e=!0===s.constraints?s.constraints:{facingMode:{ideal:"user"},...s.constraints};return{stream:await navigator.mediaDevices.getUserMedia({video:e,audio:pY}),profileLabel:s.label,profileIndex:r,sharedCameraDetected:t}}catch(a){e=a;let{name:r,message:s}=pJ(a),n=r.toLowerCase(),i=s.toLowerCase();if("notallowederror"===n||"securityerror"===n||i.includes("permission denied")||"notfounderror"===n)throw a;if(pQ(a)){t=!0;continue}if("overconstrainederror"===n)continue;throw a}}if(e&&pQ(e)){let e=Error("Camera already in use by another app");throw e.name="CameraConflictError",e}throw e??Error("Unable to access camera")},p0=e=>`https://api.dicebear.com/7.x/avataaars/svg?seed=${encodeURIComponent(e||"video")}`,p1="movesplash:cameraSafeStart",p2=`https://${sB}.supabase.co/functions/v1/make-server-a14c7986/video/rooms`,p4={"Content-Type":"application/json",Authorization:`Bearer ${sz}`},p5={Authorization:`Bearer ${sz}`};function p3({callType:e="video",onEndCall:t,isIncoming:r=!1,callerName:s="The Squad ",demoMode:n=!1}){let i,[{initialDemoState:a,initialSafeStart:o,autoSafeReason:l}]=(0,es.useState)(()=>{let e=window.location.hostname,t="localhost"===e||"127.0.0.1"===e||e.startsWith("192.168.")||e.endsWith(".local"),r=null;try{r=window.localStorage.getItem(p1)}catch{r=null}let s="true"===r||"false"!==r&&null,i=s??t;return{initialDemoState:n||i,initialSafeStart:i,autoSafeReason:null===s&&i?t?"local":"unknown":null}}),[c,d]=(0,es.useState)(o),[u,h]=(0,es.useState)(!1),[p,f]=(0,es.useState)("audio"===e),[m,g]=(0,es.useState)(!1),[b,x]=(0,es.useState)("grid"),[y,w]=(0,es.useState)(r?"ringing":"connecting"),[v,j]=(0,es.useState)(0),[k,N]=(0,es.useState)(null),S=(0,es.useRef)(null),_=(0,es.useRef)(null),C=(0,es.useRef)(null),E=(0,es.useRef)(null),R=(0,es.useRef)(null),[A,O]=(0,es.useState)(null),[T,I]=(0,es.useState)(a),[M,P]=(0,es.useState)(a),[D,L]=(0,es.useState)(null),[$,U]=(0,es.useState)(null),[B,z]=(0,es.useState)([]),[q,F]=(0,es.useState)("auto"),[H,W]=(0,es.useState)(null),[G,V]=(0,es.useState)(!1),[K,J]=(0,es.useState)(!1),[Y,X]=(0,es.useState)(!1),[Q,Z]=(0,es.useState)(null),[ee,et]=(0,es.useState)(!0),[en,ei]=(0,es.useState)(!1),ea=(0,es.useRef)(null),[eo,el]=(0,es.useState)(0),ec=(0,es.useRef)(!1),ed=(0,es.useRef)(null),eu=(0,es.useRef)(!1),eh=(0,es.useRef)(null),{currentUser:ep,allUsers:ef}=ai(),em=ep?.id??null,[eg,eb]=(0,es.useState)([]),ex="global-stage",ey=(0,es.useRef)(null),ew=(0,es.useRef)(null),ev=(0,es.useRef)(em),ej=(0,es.useRef)(u),ek=(0,es.useRef)(p),eN=(0,es.useRef)(G),[eS,e_]=(0,es.useState)(!1),[eC,eE]=(0,es.useState)(!1),[eR,eA]=(0,es.useState)(!1),[eO,eT]=(0,es.useState)(!1),[eI,eM]=(0,es.useState)(""),[eP,eD]=(0,es.useState)(()=>{let e=ep?.name&&ep.name.trim()||ep?.username&&ep.username.trim()||"You";return[{id:"welcome",author:"Host",text:"Welcome to the room! Use chat to coordinate or share links.",isSelf:!1,timestamp:new Date().toISOString()},{id:"self-intro",author:e,text:"Hey team, I just joined the call.",isSelf:!0,timestamp:new Date().toISOString()}]}),eL=(0,es.useRef)(null);(0,es.useEffect)(()=>{ej.current=u},[u]),(0,es.useEffect)(()=>{ek.current=p},[p]),(0,es.useEffect)(()=>{eN.current=G},[G]);let e$=e=>{eE("participants"===e&&(e=>!e)),eA("chat"===e&&(e=>!e)),eT("settings"===e&&(e=>!e))};(0,es.useEffect)(()=>{eR&&eL.current&&(eL.current.scrollTop=eL.current.scrollHeight)},[eP,eR]),(0,es.useEffect)(()=>{let e,t=!0,r=null,s=()=>{if(!t)return;let e=window.screen?.width??0,r=window.screen?.height??0;z([{id:"primary",label:"Primary Monitor",isPrimary:!0,size:e&&r?`${e}\xd7${r}`:"Primary"}])},n=e=>{if(!t||!e)return;let r=Array.from(e).map((e,t)=>{let r=e.id??`monitor-${t}`,s=e.label?.trim(),n=s&&s.length>0?s:`Monitor ${t+1}${e.isPrimary?" (Primary)":""}`,i=e.width??window.screen?.width??void 0,a=e.height??window.screen?.height??void 0;return{id:r,label:n,isPrimary:!!e.isPrimary||0===t,size:i&&a?`${i}\xd7${a}`:"Unknown"}});0===r.length?s():z(r)};return(async()=>{if("undefined"==typeof navigator||"function"!=typeof navigator.getScreenDetails)return s();try{r=await navigator.getScreenDetails(),n(r.screens);let t=()=>n(r?.screens);r?.addEventListener?.("screenschange",t),r?.addEventListener?.("currentscreenchange",t),e=()=>{r?.removeEventListener?.("screenschange",t),r?.removeEventListener?.("currentscreenchange",t)}}catch(e){console.warn("Unable to access multi-monitor details:",e),s()}})(),()=>{t=!1,e?.()}},[]);let eU=(0,es.useMemo)(()=>"auto"===q||"all-monitors"===q?null:B.find(e=>e.id===q)??null,[B,q]),eB=B.length>1,ez=(0,es.useMemo)(()=>"all-monitors"===q?"All Monitors":eU?eU.label:eB?"Auto-select Monitor":"Primary Monitor",[eB,eU,q]);(0,es.useEffect)(()=>{"auto"===q||"all-monitors"===q||B.some(e=>e.id===q)||F("auto")},[B,q]);let eq=m?$:null,eF=m?H:null;(0,es.useEffect)(()=>{let e=eh.current,t=ed.current;if(e){if(!G||M||!t){e.srcObject&&(e.srcObject=null);return}return e.srcObject=t,(async()=>{try{await e.play()}catch(e){console.warn("Unable to start screen share preview",e)}})(),()=>{e.srcObject===t&&(e.srcObject=null)}}},[G,M]);let eH=(0,es.useCallback)(async()=>{try{let e=await fetch(`${p2}/${encodeURIComponent(ex)}/presence`,{headers:p5});if(!e.ok)throw Error(`status ${e.status}`);let t=await e.json().catch(()=>null),r=Array.isArray(t?.participants)?t.participants:[];eb(r.map(e=>({...e,displayName:e.displayName??null,avatar:e.avatar??null})))}catch(e){console.warn("Failed to refresh video presence",e)}},[ex]),eW=(0,es.useCallback)(async(e={})=>{if(!em)return;let t=e.isMuted??ej.current,r=e.isVideoOff??ek.current,s=e.isScreenSharing??eN.current,n=ep?.name&&ep.name.trim()||ep?.username&&ep.username.trim()||`Guest ${em.slice(0,6)}`,i=ep?.avatar||(ep?.ablyClientId?p0(ep.ablyClientId):p0(em));try{let e=await fetch(`${p2}/${encodeURIComponent(ex)}/presence`,{method:"POST",headers:p4,body:JSON.stringify({userId:em,displayName:n,avatar:i,isMuted:t,isVideoOff:r,isScreenSharing:s})});if(!e.ok)throw Error(`status ${e.status}`);let a=await e.json().catch(()=>null);if(a?.participant){let e=a.participant;eb(t=>{let r=new Map(t.map(e=>[e.userId,e]));return r.set(e.userId,{...e,displayName:e.displayName??null,avatar:e.avatar??null}),Array.from(r.values())})}}catch(e){console.warn("Failed to update video presence",e)}},[ep?.ablyClientId,ep?.avatar,ep?.name,ep?.username,em,ex]),eG=(0,es.useCallback)(async e=>{if(e)try{await fetch(`${p2}/${encodeURIComponent(ex)}/presence/${encodeURIComponent(e)}`,{method:"DELETE",headers:p5})}catch(e){console.warn("Failed to remove video presence",e)}},[ex]);(0,es.useEffect)(()=>{em?eW({isMuted:u,isVideoOff:p,isScreenSharing:G}):eb([])},[eW,em,u,p,G]),(0,es.useEffect)(()=>(eH(),ey.current&&clearInterval(ey.current),ey.current=setInterval(()=>{eH()},7e3),()=>{ey.current&&(clearInterval(ey.current),ey.current=null)}),[eH]),(0,es.useEffect)(()=>{if(!em){ew.current&&(clearInterval(ew.current),ew.current=null);return}return eW(),ew.current&&clearInterval(ew.current),ew.current=setInterval(()=>{eW()},2e4),()=>{ew.current&&(clearInterval(ew.current),ew.current=null)}},[eW,em]),(0,es.useEffect)(()=>{let e=ev.current;return e&&e!==em&&eG(e),ev.current=em,()=>{eG(ev.current??em)}},[em,eG]);let eV=(0,es.useCallback)(()=>{N(null),ei(!1),X(!0),J(!0),et(!1),ec.current=!1,ea.current&&(clearTimeout(ea.current),ea.current=null),S.current&&(S.current.getTracks().forEach(e=>e.stop()),S.current=null),T?i5.info(" Camera still controlled by another app. Keeping the demo preview active."):(I(!0),i5.success(" Camera is already in use (Google Meet / Zoom). Showing demo preview so their call stays live."))},[T]),eK=(0,es.useCallback)(()=>{!ee||ea.current||(ea.current=setTimeout(()=>{el(e=>e+1),ea.current=null},5e3))},[ee]);(0,es.useEffect)(()=>()=>{ea.current&&(clearTimeout(ea.current),ea.current=null)},[]),(0,es.useEffect)(()=>{l&&i5.info("Camera demo mode auto-enabled for presentations (safe start).",{duration:5e3})},[l]),(0,es.useEffect)(()=>{try{window.localStorage.setItem(p1,c?"true":"false")}catch(e){console.warn("Unable to persist camera safe start preference",e)}},[c]);let eJ=(0,es.useMemo)(()=>{let e=new Date().toISOString(),t=ep?.id??ep?.ablyClientId??em??"guest",r=eg.find(e=>e.userId===t)??null,s=ep?.name&&ep.name.trim()||ep?.username&&ep.username.trim()||"You",n=ep?.avatar||(ep?.ablyClientId?p0(ep.ablyClientId):p0(t)),i=r?.joinedAt??e,a=r?.lastSeenAt??e,o=eg.filter(e=>e.userId!==t).map(e=>{let t=ef.get(e.userId)??null,r=e.displayName&&e.displayName.trim()||t?.name||t?.username||`Friend ${e.userId.slice(0,6)}`,s=e.avatar||t?.avatar||p0(t?.ablyClientId??e.userId);return{userId:e.userId,name:r,avatar:s,isMuted:e.isMuted,isVideoOff:e.isVideoOff,isSpeaking:!e.isMuted&&!e.isVideoOff,isScreenSharing:e.isScreenSharing,isSelf:!1,joinedAt:e.joinedAt,lastSeenAt:e.lastSeenAt}});return[{userId:t,name:s,avatar:n,isMuted:u,isVideoOff:p,isSpeaking:!u&&!p&&!T,isScreenSharing:m,isSelf:!0,joinedAt:i,lastSeenAt:a},...o].sort((e,t)=>new Date(e.joinedAt).getTime()-new Date(t.joinedAt).getTime())},[ef,ep?.ablyClientId,ep?.avatar,ep?.id,ep?.name,ep?.username,em,T,u,m,p,eg]),eY=(0,es.useMemo)(()=>{if(m&&em)return em;let e=eg.find(e=>e.isScreenSharing);return e?.userId??null},[em,m,eg]);(0,es.useEffect)(()=>{eY?"speaker"!==b&&(e_(!0),x("speaker")):(eS&&"grid"!==b&&x("grid"),eS&&e_(!1))},[eY,eS,b]);let eX=(0,es.useMemo)(()=>eY?eJ.find(e=>e.userId===eY)??null:null,[eJ,eY]),eQ=(0,es.useMemo)(()=>eX?eJ.filter(e=>e.userId!==eX.userId||eX.isSelf):eJ,[eJ,eX]),eZ=eJ.length,e0=1===eQ.length&&eQ[0]?.isSelf;(0,es.useEffect)(()=>{let e;if(!T||!C.current)return;let t=C.current,r=t.getContext("2d");if(!r)return;let s=0,n=()=>{let i=r.createLinearGradient(0,0,t.width,t.height);i.addColorStop(0,`hsl(${s}, 70%, 50%)`),i.addColorStop(.5,`hsl(${(s+60)%360}, 70%, 60%)`),i.addColorStop(1,`hsl(${(s+120)%360}, 70%, 50%)`),r.fillStyle=i,r.fillRect(0,0,t.width,t.height);let a=Date.now()/1e3;for(let e=0;e<5;e++){let s=t.width/2+100*Math.sin(a+e),n=t.height/2+80*Math.cos(a+1.5*e),i=20+10*Math.sin(2*a+e);r.beginPath(),r.arc(s,n,i,0,2*Math.PI),r.fillStyle=`rgba(255, 255, 255, ${.1+.1*Math.sin(a+e)})`,r.fill()}r.font="bold 24px system-ui",r.textAlign="center",r.textBaseline="middle",r.fillStyle="rgba(255, 255, 255, 0.9)",r.fillText(" DEMO MODE",t.width/2,t.height/2),r.font="14px system-ui",r.fillStyle="rgba(255, 255, 255, 0.7)",r.fillText("Simulated Camera Feed",t.width/2,t.height/2+35),s=(s+.5)%360,e=requestAnimationFrame(n)};return n(),()=>{cancelAnimationFrame(e)}},[T]),(0,es.useEffect)(()=>{let e;if(!M||!m)return;let t=E.current;if(!t)return;let r=t.getContext("2d");if(!r)return;t.width=1920,t.height=1080;let s=120,n=()=>{let i=r.createLinearGradient(0,0,t.width,t.height);i.addColorStop(0,`hsl(${s}, 60%, 40%)`),i.addColorStop(.5,`hsl(${(s+40)%360}, 60%, 50%)`),i.addColorStop(1,`hsl(${(s+80)%360}, 60%, 40%)`),r.fillStyle=i,r.fillRect(0,0,t.width,t.height),r.strokeStyle="rgba(255, 255, 255, 0.1)",r.lineWidth=2;for(let e=0;e<t.width;e+=100)r.beginPath(),r.moveTo(e,0),r.lineTo(e,t.height),r.stroke();for(let e=0;e<t.height;e+=100)r.beginPath(),r.moveTo(0,e),r.lineTo(t.width,e),r.stroke();let a=Date.now()/1e3;for(let e=0;e<8;e++){let s=t.width/4+200*Math.sin(.5*a+e),n=t.height/4+150*Math.cos(.3*a+1.5*e),i=40+20*Math.sin(2*a+e);r.save(),r.translate(s,n),r.rotate(a+e),r.fillStyle=`rgba(255, 255, 255, ${.1+.05*Math.sin(a+e)})`,r.fillRect(-i/2,-i/2,i,i),r.restore()}r.font="bold 48px system-ui",r.textAlign="center",r.textBaseline="middle",r.fillStyle="rgba(255, 255, 255, 0.95)",r.fillText(" DEMO SCREEN SHARE",t.width/2,t.height/2-30),r.font="24px system-ui",r.fillStyle="rgba(255, 255, 255, 0.8)",r.fillText("Simulated Screen - Safe for Presentations",t.width/2,t.height/2+30),r.font="18px system-ui",r.fillStyle="rgba(255, 255, 255, 0.6)",r.fillText("No conflicts with Zoom, Google Meet, Teams, or FaceTime",t.width/2,t.height/2+70),s=(s+.3)%360,e=requestAnimationFrame(n)};return n(),()=>{cancelAnimationFrame(e)}},[M,m]),(0,es.useEffect)(()=>{let e=!0;return(async()=>{if(T){console.log("Demo mode enabled - skipping camera access"),ei(!1);return}if("connected"!==y||p)p&&S.current&&(ei(!1),ec.current=!0,S.current.getVideoTracks().forEach(e=>e.stop()));else try{var t;let{stream:r,sharedCameraDetected:s}=await pZ();if(!e)return void r.getTracks().forEach(e=>e.stop());let[n]=r.getVideoTracks();if(!n)throw r.getTracks().forEach(e=>e.stop()),Error("Camera stream did not include a video track");let i=n.getSettings(),a=(t=i.width)?t>=3800?"4K UHD":t>=1900?"Full HD":t>=1200?"HD":"SD":null;console.log(`Camera resolution: ${i.width}x${i.height} @ ${i.frameRate}fps`),ec.current=!1,ea.current&&(clearTimeout(ea.current),ea.current=null),X(!1),J(!1),et(!0),ei(s),L(a),N(r),i5.success((e=>{switch(e){case"4K UHD":return"4K UHD Camera connected! ";case"Full HD":return"Full HD Camera connected! ";case"HD":return"HD Camera connected! ";case"SD":return"Camera connected in SD! ";default:return"Camera connected! "}})(a)),s&&i5.info("Compatibility camera mode enabled so Google Meet, Zoom, or Teams keep your video connected."),_.current&&(_.current.srcObject=r,_.current.play().catch(e=>{console.error("Error playing video:",e)})),n.onended=()=>{if(ec.current){ec.current=!1;return}console.log("Camera track ended unexpectedly  likely taken by another app."),eV()}}catch(e){if(e instanceof Error&&"CameraConflictError"===e.name)return void eV();console.error("Error accessing media devices:",e),O("Unable to access camera/microphone"),i5.error("Unable to access camera/microphone. Please check permissions.")}})(),()=>{e=!1,S.current&&(ec.current=!0,S.current.getTracks().forEach(e=>e.stop()),N(null),ei(!1)),ed.current&&(ed.current.getTracks().forEach(e=>e.stop()),ed.current=null,V(!1),g(!1),U(null),W(null))}},[y,p,T,eV,eo]),(0,es.useEffect)(()=>{S.current=k,k||ei(!1)},[k]),(0,es.useEffect)(()=>{Y&&eK()},[Y,eK]),(0,es.useEffect)(()=>{if(!k||p||T)return;let e=_.current,t=R.current;if(!e||!t)return;let r=()=>{if(!e||!t||e.readyState<2)return;let r=t.getContext("2d");if(!r)return;let{videoWidth:s,videoHeight:n}=e;s&&n&&(t.width=s,t.height=n,r.drawImage(e,0,0,s,n),Z(t.toDataURL("image/jpeg",.7)))},s=setInterval(r,2e3);return r(),()=>{clearInterval(s)}},[k,p,T]),(0,es.useEffect)(()=>{_.current&&k&&(_.current.srcObject=k,_.current.play().catch(e=>{console.error("Error playing video:",e)}))},[k]),(0,es.useEffect)(()=>{k&&k.getAudioTracks().forEach(e=>{e.enabled=!u})},[u,k]),(0,es.useEffect)(()=>{k&&k.getVideoTracks().forEach(e=>{e.enabled=!p})},[p,k]),(0,es.useEffect)(()=>{if("connecting"===y){let e=setTimeout(()=>{w("connected"),i5.success("Call connected! ")},2e3);return()=>clearTimeout(e)}},[y]),(0,es.useEffect)(()=>{if("connected"===y){let e=setInterval(()=>{j(e=>e+1)},1e3);return()=>clearInterval(e)}},[y]);let e1=()=>{k&&(ec.current=!0,k.getTracks().forEach(e=>e.stop()),ei(!1)),ed.current&&(eu.current=!0,ed.current.getTracks().forEach(e=>e.stop()),ed.current=null),V(!1),g(!1),U(null),W(null),i5.success("Call ended"),t&&t()},e2=(0,es.useCallback)((e=!1)=>{if(T){e||i5.info("Camera Demo Mode is already enabled.");return}k&&(ec.current=!0,k.getTracks().forEach(e=>e.stop()),N(null)),ei(!1),X(!1),ea.current&&(clearTimeout(ea.current),ea.current=null),et(!1),I(!0),e||i5.success("Camera Demo Mode enabled - safe for presentations! ")},[T,k]),e4=(0,es.useCallback)((e=!1)=>{ea.current&&(clearTimeout(ea.current),ea.current=null),et(!0),X(!1),J(!1),O(null),I(!1),ei(!1),el(e=>e+1),e||i5.success("Attempting to reconnect your camera... ")},[]);(0,es.useEffect)(()=>{"connected"===y&&T&&e4(!0)},[y,T,e4]);let e5=(0,es.useCallback)((e=!1)=>{if(!T){e||i5.info("Camera Demo Mode is already off.");return}I(!1),e4(!0),e||i5.success("Camera Demo Mode disabled - will use real camera ")},[T,e4]),e3=(0,es.useCallback)(e=>{if(F(e),"all-monitors"===e)i5.info("Next screen share will prompt you to share every monitor on your workspace.");else{let t=B.find(t=>t.id===e);t&&i5.info(`Next screen share will request "${t.label}" in the browser prompt.`)}m&&!M&&i5.info("Stop screen share and start again to switch monitors.")},[B,m,M]),e6=async()=>{if(M){m?(V(!1),g(!1),U(null),W(null)):(V(!1),g(!0),U("Demo"),W("Demo Display")),m?i5.success("Demo screen share stopped"):i5.success(" Demo screen sharing started - safe for presentations!");return}if(m)ed.current&&(eu.current=!0,ed.current.getTracks().forEach(e=>e.stop()),ed.current=null),V(!1),g(!1),U(null),W(null);else try{"all-monitors"===q?i5.info('Select the "Entire screen" option to capture every monitor.'):eU?i5.info(`When prompted, choose "${eU.label}" to share that monitor.`):eB&&i5.info("Pick the monitor you want to share in the browser prompt."),console.log("Requesting screen share with multi-monitor support enabled...");let e={displaySurface:"monitor",width:{ideal:7680},height:{ideal:4320},frameRate:{ideal:30},cursor:"always",preferCurrentTab:!1,surfaceSwitching:"include",selfBrowserSurface:"exclude"};"all-monitors"===q?(e.logicalSurface=!0,e.monitorTypeSurfaces=["monitor"]):eU?e.monitorTypeSurfaces=["monitor"]:e.monitorTypeSurfaces=["monitor","window","browser"];let t=await navigator.mediaDevices.getDisplayMedia({video:e,audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),[r]=t.getVideoTracks();if(!r)throw Error("Screen share stream did not include a video track");let s=r.getSettings();console.log(`Screen share resolution: ${s.width}x${s.height} @ ${s.frameRate}fps`),s.width&&s.height?s.width>=7680?(U("8K UHD"),i5.success(" 8K UHD Screen sharing started!")):s.width>=5120?(U("5K UHD"),i5.success(" 5K UHD Screen sharing started!")):s.width>=3840?(U("4K UHD"),i5.success(" 4K UHD Screen sharing started!")):s.width>=2560?(U("QHD"),i5.success(" QHD Screen sharing started!")):s.width>=1920?(U("Full HD"),i5.success(" Full HD Screen sharing started!")):(U("HD"),i5.success(" Screen sharing started!")):i5.success("Screen sharing started"),W(r.label||eU?.label||("all-monitors"===q?"All Monitors":null)),ed.current&&ed.current.getTracks().forEach(e=>e.stop()),eu.current=!1,ed.current=t,V(!0),g(!0),eh.current&&(eh.current.srcObject=t,eh.current.play().catch(e=>console.error("Error playing screen share video:",e))),r.onended=()=>{if(ed.current=null,eu.current){eu.current=!1,V(!1),g(!1),U(null),W(null),i5.success("Screen share stopped");return}console.log("Screen share ended unexpectedly - enabling demo mode fallback"),J(!0),P(!0),V(!1),g(!0),U("Demo"),W("Demo Display"),i5.success(" Screen Share Demo Mode auto-enabled - another app took over your screen")}}catch(n){console.error("Error sharing screen:",n),W(null);let{name:e,message:t}=pJ(n),r=t.toLowerCase(),s=e.toLowerCase();"notallowederror"===s||"notreadableerror"===s||r.includes("permission denied")||r.includes("user cancelled")?r.includes("already in use")||"notreadableerror"===s?(console.log("Screen share conflict detected - another app may be sharing"),console.log("Auto-enabling screen share demo mode..."),P(!0),J(!0),i5.success(" Screen Share Demo Mode auto-enabled - screen in use by another app!"),V(!1),g(!0),U("Demo"),W("Demo Display")):i5.error("Screen sharing cancelled"):i5.error("Unable to share screen. Please grant screen sharing permissions.")}},e8=()=>{T?e5():e2()},e7=()=>{let e=!M;P(e),e?(m&&(V(!1),g(!1),U(null),W(null)),ed.current&&(eu.current=!0,ed.current.getTracks().forEach(e=>e.stop()),ed.current=null),i5.success("Screen Share Demo Mode enabled - safe for presentations! "),eh.current&&(eh.current.srcObject=null)):i5.success("Screen Share Demo Mode disabled - will use real screen ")},e9=()=>{d(e=>{let t=!e;return t?(e2(!0),i5.success("Safe Start enabled - MoveSplash will stay in demo mode when you open it.")):i5.success("Safe Start disabled - MoveSplash can auto-connect your camera again."),t})},te=()=>{let e=eI.trim();if(!e)return;let t=ep?.name&&ep.name.trim()||ep?.username&&ep.username.trim()||"You";eD(r=>[...r,{id:`msg-${Date.now()}`,author:t,text:e,isSelf:!0,timestamp:new Date().toISOString()}]),eM("")};return"ringing"===y&&r?(0,er.jsx)("div",{className:"h-[calc(100vh-80px)] flex items-center justify-center",children:(0,er.jsx)(ak,{className:"w-96 backdrop-blur-xl bg-white/10 border-white/20 p-8",children:(0,er.jsxs)("div",{className:"text-center space-y-6",children:[(0,er.jsxs)("div",{className:"relative inline-block",children:[(0,er.jsxs)(s8,{className:"w-32 h-32 border-4 border-white/20",children:[(0,er.jsx)(s7,{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=Squad"}),(0,er.jsx)(s9,{children:"SQ"})]}),(0,er.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-green-400 animate-ping"})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-2",children:s}),(0,er.jsxs)("p",{className:"text-white/70",children:["video"===e?"Video":"Voice"," call incoming..."]})]}),(0,er.jsxs)("div",{className:"flex gap-4 justify-center pt-4",children:[(0,er.jsx)(tn,{onClick:()=>{i5.success("Call declined"),t&&t()},className:"w-16 h-16 rounded-full bg-red-500 hover:bg-red-600 text-white border-0",children:(0,er.jsx)(pV,{className:"w-6 h-6"})}),(0,er.jsx)(tn,{onClick:()=>{w("connecting")},className:"w-16 h-16 rounded-full bg-green-500 hover:bg-green-600 text-white border-0",children:(0,er.jsx)(u0,{className:"w-6 h-6"})})]})]})})}):"connecting"===y?(0,er.jsx)("div",{className:"h-[calc(100vh-80px)] flex items-center justify-center",children:(0,er.jsx)(ak,{className:"w-96 backdrop-blur-xl bg-white/10 border-white/20 p-8",children:(0,er.jsxs)("div",{className:"text-center space-y-6",children:[(0,er.jsxs)("div",{className:"relative inline-block",children:[(0,er.jsxs)(s8,{className:"w-32 h-32 border-4 border-white/20",children:[(0,er.jsx)(s7,{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=Squad"}),(0,er.jsx)(s9,{children:"SQ"})]}),(0,er.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-blue-400 animate-spin",style:{animationDuration:"2s"}})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-2",children:"Connecting..."}),(0,er.jsx)("p",{className:"text-white/70",children:"Please wait"})]}),(0,er.jsx)(tn,{onClick:e1,className:"w-16 h-16 rounded-full bg-red-500 hover:bg-red-600 text-white border-0",children:(0,er.jsx)(iH,{className:"w-6 h-6"})})]})})}):(0,er.jsxs)("div",{className:"h-[calc(100vh-80px)] flex flex-col max-w-7xl mx-auto gap-4",children:[(0,er.jsx)("canvas",{ref:R,className:"hidden"}),K&&(Y||M)&&(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-gradient-to-r from-yellow-500/90 to-orange-500/90 border-yellow-400 px-6 py-3",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:(0,er.jsx)("span",{className:"text-2xl",children:""})}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white font-medium",children:"Camera or Screen in use elsewhere"}),(0,er.jsx)("p",{className:"text-white/80 text-sm",children:"We switched to the simulated preview while Zoom, Meet, or Teams has your hardware. Resume the real feed once the other app releases it."})]})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[!ee&&Y&&(0,er.jsx)(tn,{onClick:()=>e4(),className:"bg-white/20 text-white hover:bg-white/30 border-0",children:"Resume real camera"}),(0,er.jsx)(tn,{onClick:()=>J(!1),variant:"ghost",className:"text-white hover:bg-white/20",children:"Dismiss"})]})]})}),T&&!K&&(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-gradient-to-r from-purple-500/90 to-pink-500/90 border-purple-400 px-6 py-3",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:(0,er.jsx)("span",{className:"text-2xl",children:""})}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white font-medium",children:"Camera Demo Mode Active"}),(0,er.jsx)("p",{className:"text-white/80 text-sm",children:"Simulated camera - safe for presentations! Your real camera is not in use."})]})]}),(0,er.jsx)(tn,{onClick:e8,variant:"ghost",className:"text-white hover:bg-white/20",children:"Disable Camera Demo"})]})}),M&&!K&&(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-gradient-to-r from-green-500/90 to-teal-500/90 border-green-400 px-6 py-3",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:(0,er.jsx)("span",{className:"text-2xl",children:""})}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white font-medium",children:"Screen Share Demo Mode Active"}),(0,er.jsx)("p",{className:"text-white/80 text-sm",children:"Simulated screen share - safe for presentations! Won't conflict with Zoom/Meet/Teams."})]})]}),(0,er.jsx)(tn,{onClick:e7,variant:"ghost",className:"text-white hover:bg-white/20",children:"Disable Screen Demo"})]})}),(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 px-6 py-3",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,er.jsxs)("span",{className:"text-white",children:[s,"  ",(i=Math.floor(v/60),`${i}:${(v%60).toString().padStart(2,"0")}`)]}),Y?(0,er.jsx)("span",{className:"text-xs text-yellow-200",children:" Cached camera preview"}):T?(0,er.jsx)("span",{className:"text-xs text-purple-400",children:" Demo Mode"}):k&&D?(0,er.jsxs)("span",{className:"text-xs text-green-400",children:[" ",D]}):k?(0,er.jsx)("span",{className:"text-xs text-green-400",children:" Camera Active"}):null,en&&!Y&&!T&&(0,er.jsx)("span",{className:"text-xs text-yellow-200 flex items-center gap-1",children:" Shared cam mode"}),eq&&(0,er.jsxs)("span",{className:`text-xs px-2 py-0.5 rounded ${"8K UHD"===eq?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"5K UHD"===eq||"4K UHD"===eq?"bg-blue-500/80 text-white":"bg-green-500/80 text-white"}`,children:[" ",eq," Screen Share",eF&&(0,er.jsx)("span",{className:"block text-[10px] text-white/80 mt-0.5",children:eF})]})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2 text-white/70 text-sm",children:[(0,er.jsx)(pH,{className:"w-4 h-4"}),(0,er.jsxs)("span",{children:[eq??D??"HD"," Quality"]}),eF&&(0,er.jsxs)("span",{className:"text-xs text-white/60",children:["(",eF,")"]})]})]})}),eX&&(0,er.jsxs)(ak,{className:"relative overflow-hidden backdrop-blur-xl bg-black/40 border-white/30 min-h-[320px]",children:[eX.isSelf?M?(0,er.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-br from-purple-600/40 to-pink-600/40 text-center px-6",children:(0,er.jsxs)("div",{className:"text-white space-y-2",children:[(0,er.jsx)("div",{className:"text-4xl",children:""}),(0,er.jsx)("p",{className:"font-semibold",children:"Screen Share Demo Mode Active"}),(0,er.jsx)("p",{className:"text-white/80 text-sm",children:"Your teammates see the simulated share while other apps use your screen."})]})}):(0,er.jsx)("video",{ref:eh,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute inset-0 w-full h-full object-contain bg-black"}):(0,er.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-br from-slate-900/80 to-purple-900/60",children:(0,er.jsxs)("div",{className:"text-center space-y-3 text-white px-6",children:[(0,er.jsx)("div",{className:"text-4xl",children:""}),(0,er.jsxs)("p",{className:"text-lg font-semibold",children:[eX.name," is sharing their screen"]}),(0,er.jsx)("p",{className:"text-sm text-white/70",children:"We switched everyone to speaker view automatically."})]})}),(0,er.jsxs)("div",{className:"absolute top-3 left-3 flex flex-wrap items-center gap-2",children:[(0,er.jsxs)("div",{className:"bg-black/60 text-white text-xs px-3 py-1 rounded-full flex items-center gap-2",children:[(0,er.jsx)(pH,{className:"w-4 h-4"}),(0,er.jsx)("span",{children:eX.isSelf?"You":eX.name})]}),eX.isSelf&&$&&(0,er.jsxs)("div",{className:`text-xs px-3 py-1 rounded-full ${"8K UHD"===$?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"5K UHD"===$||"4K UHD"===$?"bg-blue-500/80 text-white":"bg-green-500/80 text-white"}`,children:[$," Quality"]})]})]}),(0,er.jsx)("div",{className:`flex-1 grid gap-4 ${eQ.length>=4?"grid-cols-2 lg:grid-cols-3":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"}`,children:eQ.map(e=>(0,er.jsxs)(ak,{className:`relative overflow-hidden backdrop-blur-xl bg-gradient-to-br from-purple-900/50 to-pink-900/50 border-2 transition-all min-h-[200px] ${e.isSpeaking?"border-green-400 shadow-lg shadow-green-400/50":"border-white/20"}`,children:[e.isSelf?e.isVideoOff?(0,er.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,er.jsxs)(s8,{className:"w-24 h-24 border-4 border-white/20",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.name[0]??"Y"})]})}):Y&&Q?(0,er.jsxs)("div",{className:"relative w-full h-full",children:[(0,er.jsx)(hg.default,{src:Q,alt:"Camera preview",fill:!0,unoptimized:!0,className:"object-cover"}),(0,er.jsxs)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm flex flex-col items-center justify-center text-center px-6",children:[(0,er.jsx)("div",{className:"text-white font-semibold mb-2",children:"Camera temporarily in use by another app"}),(0,er.jsx)("p",{className:"text-white/80 text-sm",children:"Keeping your last frame visible while Zoom/Meet/Teams is running. We'll switch back automatically."})]})]}):Y?(0,er.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center text-center px-6 bg-gradient-to-br from-purple-600/40 to-pink-600/40 text-white",children:[(0,er.jsx)("div",{className:"text-3xl mb-2",children:""}),(0,er.jsx)("p",{className:"font-semibold",children:"Camera temporarily unavailable"}),(0,er.jsx)("p",{className:"text-white/80 text-sm mt-1",children:"We're retrying while another app is using your webcam."})]}):T?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)("canvas",{ref:C,width:640,height:480,className:"absolute inset-0 w-full h-full object-cover"}),(0,er.jsx)("div",{className:"absolute top-2 left-2 bg-purple-500/80 text-white text-xs px-2 py-1 rounded",children:" DEMO"})]}):k?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)("video",{ref:_,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute inset-0 w-full h-full object-cover scale-x-[-1]"}),(0,er.jsxs)("div",{className:"absolute top-2 left-2 flex gap-2",children:[(0,er.jsxs)("div",{className:"bg-black/50 text-white text-xs px-2 py-1 rounded flex items-center gap-1",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"LIVE"]}),D&&(0,er.jsx)("div",{className:`text-white text-xs px-2 py-1 rounded ${"4K UHD"===D?"bg-gradient-to-r from-purple-500 to-pink-500":"Full HD"===D?"bg-blue-500/80":"bg-green-500/80"}`,children:D})]})]}):(0,er.jsx)("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-br from-blue-900/30 to-purple-900/30 flex items-center justify-center",children:(0,er.jsxs)("div",{className:"text-white/70 text-center space-y-2",children:[(0,er.jsx)("div",{className:"w-12 h-12 bg-white/10 rounded-full animate-pulse mx-auto"}),(0,er.jsx)("p",{className:"text-sm",children:"Starting camera..."}),A&&(0,er.jsx)("p",{className:"text-xs text-red-400",children:A})]})}):(0,er.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-slate-900/40 to-purple-900/40 text-center px-4",children:[(0,er.jsxs)(s8,{className:"w-20 h-20 border-4 border-white/20 mb-3",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.name[0]??"?"})]}),(0,er.jsx)("p",{className:"text-white text-sm font-semibold",children:e.name}),(0,er.jsx)("p",{className:"text-white/60 text-xs mt-1",children:e.isVideoOff?"Camera off":"Streaming"})]}),e.isSelf&&e0&&(0,er.jsx)("div",{className:"absolute bottom-3 left-3 bg-black/60 text-white/80 text-xs px-3 py-1 rounded-full",children:"You're the first in the room"}),(0,er.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-3",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-white text-sm",children:e.name}),e.isSpeaking&&(0,er.jsxs)("div",{className:"flex gap-0.5",children:[(0,er.jsx)("div",{className:"w-1 h-3 bg-green-400 rounded-full animate-pulse"}),(0,er.jsx)("div",{className:"w-1 h-4 bg-green-400 rounded-full animate-pulse animation-delay-150"}),(0,er.jsx)("div",{className:"w-1 h-3 bg-green-400 rounded-full animate-pulse animation-delay-300"})]})]}),(0,er.jsxs)("div",{className:"flex items-center gap-1",children:[e.isMuted&&(0,er.jsx)("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:(0,er.jsx)(pF,{className:"w-3 h-3 text-white"})}),e.isVideoOff&&(0,er.jsx)("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:(0,er.jsx)(pq,{className:"w-3 h-3 text-white"})})]})]})}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",className:"absolute top-2 right-2 text-white/70 hover:text-white hover:bg-black/30 backdrop-blur-md",children:(0,er.jsx)(uZ,{className:"w-4 h-4"})})]},e.userId))}),M&&m&&(0,er.jsx)("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4",children:(0,er.jsxs)("div",{className:"relative w-full max-w-6xl aspect-video",children:[(0,er.jsx)("canvas",{ref:E,width:1920,height:1080,className:"w-full h-full object-contain rounded-lg border-2 border-green-400 shadow-2xl"}),(0,er.jsxs)("div",{className:"absolute top-4 right-4 flex gap-2",children:[(0,er.jsx)("div",{className:"bg-green-500/90 text-white px-4 py-2 rounded-lg backdrop-blur-md",children:" Demo Screen Share Active"}),(0,er.jsx)(tn,{onClick:e6,className:"bg-red-500 hover:bg-red-600 text-white",children:"Stop Sharing"})]})]})}),(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-4",children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsx)("div",{className:"flex items-center gap-2",children:(0,er.jsxs)("div",{className:"text-white/70 text-sm",children:[(0,er.jsx)("span",{className:"text-white",children:s}),"  ",eZ," participants"]})}),(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(tn,{onClick:()=>{h(!u),i5.success(u?"Microphone on":"Microphone muted")},className:`rounded-full w-12 h-12 ${u?"bg-red-500 hover:bg-red-600":"bg-white/10 hover:bg-white/20"} text-white border-0`,children:u?(0,er.jsx)(pF,{className:"w-5 h-5"}):(0,er.jsx)(hn,{className:"w-5 h-5"})}),"video"===e&&(0,er.jsx)(tn,{onClick:()=>{f(!p),i5.success(p?"Camera on":"Camera off")},className:`rounded-full w-12 h-12 ${p?"bg-red-500 hover:bg-red-600":"bg-white/10 hover:bg-white/20"} text-white border-0`,children:p?(0,er.jsx)(pq,{className:"w-5 h-5"}):(0,er.jsx)(tu,{className:"w-5 h-5"})}),(0,er.jsx)(tn,{onClick:e6,className:`rounded-full w-12 h-12 ${m?"bg-green-500 hover:bg-green-600":"bg-white/10 hover:bg-white/20"} text-white border-0`,children:m?(0,er.jsx)(pW,{className:"w-5 h-5"}):(0,er.jsx)(pH,{className:"w-5 h-5"})}),(0,er.jsx)(tn,{onClick:e1,className:"rounded-full w-12 h-12 bg-red-500 hover:bg-red-600 text-white border-0",children:(0,er.jsx)(u0,{className:"w-5 h-5 rotate-135"})})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[!ee&&(0,er.jsx)(tn,{variant:"ghost",size:"sm",onClick:()=>e4(),className:"text-yellow-200 hover:text-yellow-100 hover:bg-yellow-500/20",title:"Try to reconnect the real camera feed",children:" Resume Cam"}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:e8,className:`${T?"text-purple-400 hover:text-purple-300 bg-purple-500/20 hover:bg-purple-500/30":"text-white/70 hover:text-white hover:bg-white/10"}`,title:"Toggle Camera Demo Mode (prevents camera conflicts with Zoom/Meet/Teams)",children:[" ",T?"Cam Demo ON":"Cam Demo"]}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:e9,className:`${c?"text-amber-300 hover:text-amber-200 bg-amber-500/20 hover:bg-amber-500/30":"text-white/70 hover:text-white hover:bg-white/10"}`,title:"Always start MoveSplash in presentation-safe demo mode so other meeting apps keep your webcam",children:[" ",c?"Safe Start ON":"Safe Start"]}),eB&&(0,er.jsxs)(p$,{children:[(0,er.jsx)(pU,{asChild:!0,children:(0,er.jsxs)(tn,{variant:"ghost",size:"sm",className:"text-white/70 hover:text-white hover:bg-white/10",title:"Choose which monitor or workspace to share by default",children:[(0,er.jsx)(pH,{className:"w-5 h-5 mr-2"}),ez]})}),(0,er.jsxs)(pB,{className:"bg-gradient-to-br from-purple-900 to-pink-900 border border-white/20 text-white",children:[B.map(e=>(0,er.jsxs)(pz,{onClick:()=>e3(e.id),className:"flex items-center justify-between gap-4 focus:bg-white/10 focus:text-white",children:[(0,er.jsx)("span",{children:e.label}),(0,er.jsx)("span",{className:"text-xs text-white/60",children:e.size})]},e.id)),(0,er.jsxs)(pz,{onClick:()=>e3("all-monitors"),className:"flex items-center justify-between gap-4 focus:bg-white/10 focus:text-white",children:[(0,er.jsx)("span",{children:"All Monitors"}),(0,er.jsx)("span",{className:"text-xs text-white/60",children:"Entire workspace"})]})]})]}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:e7,className:`${M?"text-green-400 hover:text-green-300 bg-green-500/20 hover:bg-green-500/30":"text-white/70 hover:text-white hover:bg-white/10"}`,title:"Toggle Screen Share Demo Mode (prevents screen share conflicts)",children:[" ",M?"Screen Demo ON":"Screen Demo"]}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:()=>x("grid"===b?"speaker":"grid"),className:`${"grid"===b?"text-white/90 bg-white/15":"text-white/70 hover:text-white hover:bg-white/10"}`,children:[(0,er.jsx)(pK,{className:"w-5 h-5 mr-2"}),"grid"===b?"Grid":"Speaker"]}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:()=>e$("participants"),className:`${eC?"text-white/90 bg-white/15":"text-white/70 hover:text-white hover:bg-white/10"}`,children:[(0,er.jsx)(th,{className:"w-5 h-5 mr-2"}),"Participants"]}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:()=>e$("chat"),className:`${eR?"text-white/90 bg-white/15":"text-white/70 hover:text-white hover:bg-white/10"}`,children:[(0,er.jsx)(pG,{className:"w-5 h-5 mr-2"}),"Chat"]}),(0,er.jsx)(tn,{variant:"ghost",size:"sm",onClick:()=>e$("settings"),className:`${eO?"text-white/90 bg-white/15":"text-white/70 hover:text-white hover:bg-white/10"}`,children:(0,er.jsx)(aw,{className:"w-5 h-5"})})]})]})}),eC&&(0,er.jsxs)(ak,{className:"fixed right-4 bottom-28 w-80 max-h-[420px] z-40 backdrop-blur-xl bg-slate-950/80 border-white/20 text-white shadow-2xl",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 px-4 py-3",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm text-white/70",children:"In the room"}),(0,er.jsxs)("p",{className:"text-lg font-semibold",children:[eZ," participant",1!==eZ?"s":""]})]}),(0,er.jsx)(tn,{size:"icon",variant:"ghost",onClick:()=>eE(!1),className:"text-white/70 hover:text-white",children:(0,er.jsx)(iH,{className:"w-4 h-4"})})]}),(0,er.jsx)("div",{className:"px-4 py-3 space-y-3 overflow-y-auto max-h-[340px]",children:eJ.map(e=>(0,er.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-white/5 px-3 py-2 border border-white/10",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsxs)(s8,{className:"w-10 h-10",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.name[0]??"?"})]}),(0,er.jsxs)("div",{className:"space-y-0.5",children:[(0,er.jsxs)("p",{className:"text-sm font-medium",children:[e.name," ",e.isSelf?"(You)":""]}),(0,er.jsxs)("div",{className:"flex items-center gap-2 text-xs text-white/60",children:[e.isMuted?(0,er.jsxs)("span",{className:"flex items-center gap-1",children:[(0,er.jsx)(pF,{className:"w-3 h-3"})," Muted"]}):(0,er.jsxs)("span",{className:"flex items-center gap-1",children:[(0,er.jsx)(hn,{className:"w-3 h-3"})," Live"]}),e.isVideoOff&&(0,er.jsxs)("span",{className:"flex items-center gap-1",children:[(0,er.jsx)(pq,{className:"w-3 h-3"})," Cam off"]}),e.isScreenSharing&&(0,er.jsxs)("span",{className:"flex items-center gap-1",children:[(0,er.jsx)(pH,{className:"w-3 h-3"})," Sharing"]})]})]})]}),(0,er.jsxs)("span",{className:"text-[10px] text-white/50",children:["Joined"," ",new Date(e.joinedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]},e.userId))})]}),eR&&(0,er.jsxs)(ak,{className:"fixed right-4 bottom-28 w-[26rem] max-h-[460px] z-40 backdrop-blur-xl bg-slate-950/85 border-white/20 text-white shadow-2xl",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 px-4 py-3",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm text-white/70",children:"Meeting chat"}),(0,er.jsx)("p",{className:"text-lg font-semibold",children:"Share quick notes & links"})]}),(0,er.jsx)(tn,{size:"icon",variant:"ghost",onClick:()=>eA(!1),className:"text-white/70 hover:text-white",children:(0,er.jsx)(iH,{className:"w-4 h-4"})})]}),(0,er.jsx)("div",{ref:eL,className:"px-4 py-3 space-y-3 overflow-y-auto max-h-[320px]",children:eP.map(e=>(0,er.jsxs)("div",{className:`flex flex-col gap-1 rounded-lg px-3 py-2 border ${e.isSelf?"bg-purple-600/20 border-purple-400/30":"bg-white/5 border-white/10"}`,children:[(0,er.jsxs)("div",{className:"flex items-center justify-between text-xs text-white/60",children:[(0,er.jsx)("span",{className:"font-semibold text-white/80",children:e.author}),(0,er.jsx)("span",{children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,er.jsx)("p",{className:"text-sm text-white/90 whitespace-pre-wrap",children:e.text})]},e.id))}),(0,er.jsx)("div",{className:"border-t border-white/10 px-4 py-3",children:(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(cV,{value:eI,onChange:e=>eM(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),te())},placeholder:"Type a message to everyone",className:"bg-white/5 border-white/10 text-white placeholder:text-white/50"}),(0,er.jsx)(tn,{onClick:te,className:"bg-purple-500 hover:bg-purple-600 text-white",children:"Send"})]})})]}),eO&&(0,er.jsxs)(ak,{className:"fixed right-4 bottom-28 w-80 max-h-[460px] z-40 backdrop-blur-xl bg-slate-950/85 border-white/20 text-white shadow-2xl",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 px-4 py-3",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm text-white/70",children:"Quick settings"}),(0,er.jsx)("p",{className:"text-lg font-semibold",children:"Tune your call"})]}),(0,er.jsx)(tn,{size:"icon",variant:"ghost",onClick:()=>eT(!1),className:"text-white/70 hover:text-white",children:(0,er.jsx)(iH,{className:"w-4 h-4"})})]}),(0,er.jsxs)("div",{className:"px-4 py-3 space-y-3",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm font-semibold",children:"Camera Demo Mode"}),(0,er.jsx)("p",{className:"text-xs text-white/60",children:"Use a safe simulated camera"})]}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:e8,className:T?"text-purple-300 bg-purple-500/20":"text-white/70 hover:text-white hover:bg-white/10",children:T?"On":"Off"})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm font-semibold",children:"Screen Share Demo"}),(0,er.jsx)("p",{className:"text-xs text-white/60",children:"Share a safe placeholder feed"})]}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:e7,className:M?"text-green-300 bg-green-500/20":"text-white/70 hover:text-white hover:bg-white/10",children:M?"On":"Off"})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm font-semibold",children:"Safe Start"}),(0,er.jsx)("p",{className:"text-xs text-white/60",children:"Stay in demo when opening the app"})]}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:e9,className:c?"text-amber-200 bg-amber-500/20":"text-white/70 hover:text-white hover:bg-white/10",children:c?"On":"Off"})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm font-semibold",children:"Layout"}),(0,er.jsx)("p",{className:"text-xs text-white/60",children:"Switch between grid and speaker"})]}),(0,er.jsxs)("div",{className:"flex gap-2",children:[(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:()=>x("grid"),className:"grid"===b?"text-white bg-white/20":"text-white/70 hover:text-white hover:bg-white/10",children:"Grid"}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:()=>x("speaker"),className:"speaker"===b?"text-white bg-white/20":"text-white/70 hover:text-white hover:bg-white/10",children:"Speaker"})]})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm font-semibold",children:"Camera Health"}),(0,er.jsx)("p",{className:"text-xs text-white/60",children:"Retry the real camera feed"})]}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:()=>e4(),className:"text-white/80 hover:text-white hover:bg-white/10",children:"Resume cam"})]})]})]}),m&&(0,er.jsx)(ak,{className:"absolute top-4 left-1/2 -translate-x-1/2 backdrop-blur-xl bg-green-500/90 border-green-400 px-4 py-2 z-50",children:(0,er.jsxs)("div",{className:"flex items-center gap-2 text-white",children:[(0,er.jsx)(pH,{className:"w-4 h-4"}),(0,er.jsx)("span",{className:"text-sm",children:"You are sharing your screen"})]})}),(0,er.jsx)("style",{children:`
        .rotate-135 {
          transform: rotate(135deg);
        }
        .animation-delay-150 {
          animation-delay: 150ms;
        }
        .animation-delay-300 {
          animation-delay: 300ms;
        }
      `})]})}let p6=tc("user-check",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),p8=tc("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),p7=tc("user-minus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),p9=tc("ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),fe=(e,t)=>{var r;let s,n=t?.friendIds??[],i=e.friendIds.filter(t=>n.includes(t)&&t!==e.id).length;return{id:e.id,name:e.name,username:e.username.startsWith("@")?e.username:`@${e.username}`,avatar:e.avatar,status:(r=e.id,(s=["online","away","offline"])[Array.from(r).reduce((e,t)=>e+t.charCodeAt(0),0)%s.length]),mutualFriends:i}};function ft({onOpenProfile:e,onOpenMessage:t}={}){let{currentUser:r,allUsers:s,addFriend:n,removeFriend:i,blockUser:a,unblockUser:o,refreshAllUsers:l}=ai(),[c,d]=(0,es.useState)(""),[u,h]=(0,es.useState)(new Set),[p,f]=(0,es.useState)(new Set),m=(0,es.useCallback)((e,t)=>{h(r=>{let s=new Set(r);return t?s.add(e):s.delete(e),s})},[]),g=(0,es.useCallback)(e=>u.has(e),[u]);(0,es.useEffect)(()=>{l()},[l]);let b=(0,es.useCallback)(t=>{e&&e(t)},[e]),x=(0,es.useCallback)((e,t)=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),b(t))},[b]),y=(0,es.useCallback)(e=>{t?.(e)},[t]),w=(0,es.useMemo)(()=>Array.from(s.values()),[s]),v=(0,es.useMemo)(()=>r?.blockedIds??[],[r?.blockedIds]),j=(0,es.useMemo)(()=>new Set(v),[v]),k=(0,es.useMemo)(()=>r?r.friendIds.filter(e=>!j.has(e)).map(e=>s.get(e)).filter(e=>!!e).map(e=>fe(e,r)).sort((e,t)=>e.name.localeCompare(t.name)):[],[s,j,r]),N=(0,es.useMemo)(()=>r?w.filter(e=>{if(e.id===r.id||p.has(e.id)||j.has(e.id)||Array.isArray(e.blockedIds)&&e.blockedIds.includes(r.id))return!1;let t=e.friendIds.includes(r.id),s=r.friendIds.includes(e.id);return t&&!s}).map(e=>fe(e,r)):[],[w,j,r,p]),S=(0,es.useMemo)(()=>{if(!r)return[];let e=new Set([r.id,...r.friendIds,...r.blockedIds,...N.map(e=>e.id)]);return w.filter(t=>!e.has(t.id)).filter(e=>!p.has(e.id)).filter(e=>!j.has(e.id)).filter(e=>!(Array.isArray(e.blockedIds)&&e.blockedIds.includes(r.id))).map(e=>fe(e,r)).sort((e,t)=>e.mutualFriends===t.mutualFriends?e.name.localeCompare(t.name):t.mutualFriends-e.mutualFriends).slice(0,8)},[w,j,r,p,N]),_=c.trim().toLowerCase(),C=(0,es.useCallback)(e=>!_||e.name.toLowerCase().includes(_)||e.username.toLowerCase().includes(_),[_]),E=k.filter(C),R=N.filter(C),A=S.filter(C),O=(0,es.useMemo)(()=>r?r.blockedIds.map(e=>s.get(e)).filter(e=>!!e).map(e=>fe(e,r)).sort((e,t)=>e.name.localeCompare(t.name)):[],[s,r]),T=O.filter(C),I=(0,es.useCallback)(async e=>{if(!r)return i5.info("Sign in to connect."),!1;m(e,!0);try{let t=await n(e);return t?i5.success("Friend request sent!"):i5.error("Unable to send friend request right now."),t}finally{m(e,!1)}},[n,r,m]),M=(0,es.useCallback)(async e=>{if(!r)return void i5.info("Sign in to manage your friends.");m(e,!0);try{await i(e)?i5.success("Friend removed."):i5.error("Unable to remove friend right now.")}finally{m(e,!1)}},[r,i,m]),P=(0,es.useCallback)(e=>{f(t=>{if(t.has(e))return t;let r=new Set(t);return r.add(e),r})},[]),D=(0,es.useCallback)(e=>{f(t=>{if(!t.has(e))return t;let r=new Set(t);return r.delete(e),r})},[]),L=(0,es.useCallback)(async e=>{if(!r)return void i5.info("Sign in to manage connections.");m(e,!0);try{await a(e)?(i5.success("User blocked."),P(e)):i5.error("Unable to block user right now.")}finally{m(e,!1)}},[a,r,P,m]),$=(0,es.useCallback)(async e=>{if(r){m(e,!0);try{await o(e)?i5.success("User unblocked."):i5.error("Unable to unblock user right now.")}finally{m(e,!1)}}},[r,m,o]),U=(0,es.useCallback)(async e=>{await I(e)&&D(e)},[I,D]),B=(0,es.useCallback)(async e=>{if(!r)return void i5.info("Sign in to manage connections.");m(e,!0);try{await i(e)?(P(e),i5.info("Request declined.",{description:"We removed the pending request for you."})):i5.error("Unable to decline request right now.")}finally{m(e,!1)}},[r,P,i,m]),z=(0,es.useCallback)(e=>{P(e),i5.info("Suggestion hidden",{description:"We will show different people next time."})},[P]);return r?(0,er.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,er.jsxs)(iD,{defaultValue:"all",className:"w-full",children:[(0,er.jsxs)("div",{className:"flex flex-col gap-4 mb-4 md:flex-row md:items-center md:justify-between",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("h2",{className:"text-2xl font-semibold text-white",children:"Connections"}),(0,er.jsx)("p",{className:"text-white/70",children:"Manage your friends, requests, and discover new connections pulled live from Supabase."})]}),(0,er.jsxs)("div",{className:"relative w-full md:w-72",children:[(0,er.jsx)(u1,{className:"w-4 h-4 text-white/60 absolute left-3 top-1/2 -translate-y-1/2"}),(0,er.jsx)(cV,{value:c,onChange:e=>d(e.target.value),placeholder:"Search friends...",className:"pl-9 bg-white/5 border-white/20 text-white placeholder:text-white/50"})]})]}),(0,er.jsxs)(iL,{className:"grid grid-cols-4 bg-white/10",children:[(0,er.jsxs)(i$,{value:"all",children:["All Friends (",k.length,")"]}),(0,er.jsxs)(i$,{value:"requests",children:["Requests (",N.length,")"]}),(0,er.jsxs)(i$,{value:"suggestions",children:["Discover (",S.length,")"]}),(0,er.jsxs)(i$,{value:"blocked",children:["Blocked (",O.length,")"]})]}),(0,er.jsx)(iU,{value:"all",children:0===E.length?(0,er.jsx)(ak,{className:"p-8 backdrop-blur-xl bg-white/5 border-white/20 text-white/70 text-center",children:0===k.length?"Add your first friend to see them here.":"No friends match your search."}):(0,er.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:E.map(e=>(0,er.jsx)(ak,{className:"p-6 backdrop-blur-xl bg-white/10 border-white/20 hover:bg-white/15 transition-colors focus:outline-none focus:ring-2 focus:ring-white/40",role:"button",tabIndex:0,onClick:()=>b(e.id),onKeyDown:t=>x(t,e.id),children:(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-4",children:[(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsxs)(s8,{className:"w-14 h-14 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.name[0]})]}),(0,er.jsx)("div",{className:`absolute bottom-0 right-0 w-4 h-4 ${(e=>{switch(e){case"online":return"bg-green-400";case"away":return"bg-yellow-400";default:return"bg-gray-400"}})(e.status)} rounded-full border-2 border-purple-900`})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-white",children:e.name}),(0,er.jsx)("div",{className:"text-white/60 text-sm",children:e.username}),(0,er.jsxs)("div",{className:"text-white/40 text-xs mt-1",children:[e.mutualFriends," mutual friends"]})]})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[(0,er.jsx)(tn,{size:"sm",variant:"ghost",className:"text-white/70 hover:text-white hover:bg-white/10",onClick:t=>{t.stopPropagation(),y(e.id)},children:(0,er.jsx)(td,{className:"w-4 h-4"})}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",className:"text-white/70 hover:text-white hover:bg-white/10",onClick:e=>{e.stopPropagation()},children:(0,er.jsx)(tu,{className:"w-4 h-4"})}),(0,er.jsxs)(tn,{size:"sm",variant:"ghost",disabled:g(e.id),onClick:t=>{t.stopPropagation(),M(e.id)},className:"text-white/70 hover:text-red-300 hover:bg-white/10 disabled:opacity-50",children:[(0,er.jsx)(p7,{className:"w-4 h-4 mr-1"}),(0,er.jsx)("span",{className:"hidden sm:inline",children:"Remove"})]}),(0,er.jsxs)(tn,{size:"sm",variant:"ghost",disabled:g(e.id),onClick:t=>{t.stopPropagation(),L(e.id)},className:"text-white/70 hover:text-red-400 hover:bg-white/10 disabled:opacity-50",children:[(0,er.jsx)(p9,{className:"w-4 h-4 mr-1"}),(0,er.jsx)("span",{className:"hidden sm:inline",children:"Block"})]})]})]})},e.id))})}),(0,er.jsx)(iU,{value:"requests",children:0===R.length?(0,er.jsx)(ak,{className:"p-8 backdrop-blur-xl bg-white/5 border-white/20 text-white/70 text-center",children:"No pending friend requests."}):(0,er.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:R.map(e=>(0,er.jsxs)(ak,{className:"p-6 backdrop-blur-xl bg-white/10 border-white/20 hover:bg-white/15 transition-colors focus:outline-none focus:ring-2 focus:ring-white/40",role:"button",tabIndex:0,onClick:()=>b(e.id),onKeyDown:t=>x(t,e.id),children:[(0,er.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,er.jsxs)(s8,{className:"w-14 h-14 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.name[0]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-white",children:e.name}),(0,er.jsx)("div",{className:"text-white/60 text-sm",children:e.username}),(0,er.jsxs)("div",{className:"text-white/40 text-xs mt-1",children:[e.mutualFriends," mutual friends"]})]})]}),(0,er.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,er.jsxs)(tn,{onClick:t=>{t.stopPropagation(),U(e.id)},disabled:g(e.id),className:"flex-1 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 disabled:opacity-50",children:[(0,er.jsx)(p6,{className:"w-4 h-4 mr-2"}),"Accept"]}),(0,er.jsxs)(tn,{variant:"outline",disabled:g(e.id),onClick:t=>{t.stopPropagation(),B(e.id)},className:"flex-1 bg-white/5 border-white/20 text-white hover:bg-white/10 disabled:opacity-50",children:[(0,er.jsx)(p8,{className:"w-4 h-4 mr-2"}),"Decline"]}),(0,er.jsxs)(tn,{variant:"outline",disabled:g(e.id),onClick:t=>{t.stopPropagation(),L(e.id)},className:"flex-1 bg-white/5 border-white/20 text-white hover:bg-white/10 disabled:opacity-50",children:[(0,er.jsx)(p9,{className:"w-4 h-4 mr-2"}),"Block"]})]})]},e.id))})}),(0,er.jsx)(iU,{value:"suggestions",children:0===A.length?(0,er.jsx)(ak,{className:"p-8 backdrop-blur-xl bg-white/5 border-white/20 text-white/70 text-center",children:"No suggestions right now."}):(0,er.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:A.map(e=>(0,er.jsxs)(ak,{className:"p-6 backdrop-blur-xl bg-white/10 border-white/20 hover:bg-white/15 transition-colors focus:outline-none focus:ring-2 focus:ring-white/40",role:"button",tabIndex:0,onClick:()=>b(e.id),onKeyDown:t=>x(t,e.id),children:[(0,er.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,er.jsxs)(s8,{className:"w-14 h-14 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.name[0]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-white",children:e.name}),(0,er.jsx)("div",{className:"text-white/60 text-sm",children:e.username}),(0,er.jsxs)("div",{className:"text-white/40 text-xs mt-1",children:[e.mutualFriends," mutual friends"]})]})]}),(0,er.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,er.jsxs)(tn,{onClick:t=>{t.stopPropagation(),I(e.id)},disabled:g(e.id),className:"flex-1 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 disabled:opacity-50",children:[(0,er.jsx)(iF,{className:"w-4 h-4 mr-2"}),"Add Friend"]}),(0,er.jsxs)(tn,{variant:"outline",className:"flex-1 bg-white/5 border-white/20 text-white hover:bg-white/10",onClick:t=>{t.stopPropagation(),z(e.id)},children:[(0,er.jsx)(p8,{className:"w-4 h-4 mr-2"}),"Hide"]}),(0,er.jsxs)(tn,{variant:"outline",disabled:g(e.id),onClick:t=>{t.stopPropagation(),L(e.id)},className:"flex-1 bg-white/5 border-white/20 text-white hover:bg-white/10 disabled:opacity-50",children:[(0,er.jsx)(p9,{className:"w-4 h-4 mr-2"}),"Block"]})]})]},e.id))})}),(0,er.jsx)(iU,{value:"blocked",children:0===T.length?(0,er.jsx)(ak,{className:"p-8 backdrop-blur-xl bg-white/5 border-white/20 text-white/70 text-center",children:"You have not blocked anyone."}):(0,er.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:T.map(e=>(0,er.jsxs)(ak,{className:"p-6 backdrop-blur-xl bg-white/10 border-white/20 hover:bg-white/15 transition-colors focus:outline-none focus:ring-2 focus:ring-white/40",role:"button",tabIndex:0,onClick:()=>b(e.id),onKeyDown:t=>x(t,e.id),children:[(0,er.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,er.jsxs)(s8,{className:"w-14 h-14 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.name[0]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-white",children:e.name}),(0,er.jsx)("div",{className:"text-white/60 text-sm",children:e.username}),(0,er.jsx)("div",{className:"text-white/40 text-xs mt-1",children:"Blocked connection"})]})]}),(0,er.jsxs)(tn,{variant:"outline",disabled:g(e.id),onClick:t=>{t.stopPropagation(),$(e.id)},className:"w-full bg-white/5 border-white/20 text-white hover:bg-white/10 disabled:opacity-50",children:[(0,er.jsx)(p6,{className:"w-4 h-4 mr-2"}),"Unblock"]})]},e.id))})})]})}):(0,er.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,er.jsx)(ak,{className:"p-8 backdrop-blur-xl bg-white/10 border-white/20 text-center text-white/80",children:"Sign in to see your friends and requests."})})}function fr({className:e,...t}){return(0,er.jsx)("div",{"data-slot":"skeleton",className:tr("bg-accent animate-pulse rounded-md",e),...t})}let fs=tc("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),fn=tc("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),fi=tc("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),fa=tc("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);function fo(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function fl(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function fc(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=fl(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():fl(e[t],null)}}}}(...e),e)}"undefined"!=typeof window&&window.document&&window.document.createElement;var fd=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),fu=globalThis?.document?es.useLayoutEffect:()=>{},fh=es[" useInsertionEffect ".trim().toString()]||fu;function fp({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return fh(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}Symbol("RADIX:SYNC_STATE");var ff=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),fm=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"});es.forwardRef((e,t)=>(0,er.jsx)(ff.span,{...e,ref:t,style:{...fm,...e.style}})).displayName="VisuallyHidden";var fg=[" ","Enter","ArrowUp","ArrowDown"],fb=[" ","Enter"],fx="Select",[fy,fw,fv]=nQ(fx),[fj,fk]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(fx,[fv,uc]),fN=uc(),[fS,f_]=fj(fx),[fC,fE]=fj(fx),fR=e=>{let{__scopeSelect:t,children:r,open:s,defaultOpen:n,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:d,autoComplete:u,disabled:h,required:p,form:f}=e,m=fN(t),[g,b]=es.useState(null),[x,y]=es.useState(null),[w,v]=es.useState(!1),j=nc(c),[k,N]=fp({prop:s,defaultProp:n??!1,onChange:i,caller:fx}),[S,_]=fp({prop:a,defaultProp:o,onChange:l,caller:fx}),C=es.useRef(null),E=!g||f||!!g.closest("form"),[R,A]=es.useState(new Set),O=Array.from(R).map(e=>e.props.value).join(";");return(0,er.jsx)(uh,{...m,children:(0,er.jsxs)(fS,{required:p,scope:t,trigger:g,onTriggerChange:b,valueNode:x,onValueNodeChange:y,valueNodeHasChildren:w,onValueNodeHasChildrenChange:v,contentId:n6(),value:S,onValueChange:_,open:k,onOpenChange:N,dir:j,triggerPointerDownPosRef:C,disabled:h,children:[(0,er.jsx)(fy.Provider,{scope:t,children:(0,er.jsx)(fC,{scope:e.__scopeSelect,onNativeOptionAdd:es.useCallback(e=>{A(t=>new Set(t).add(e))},[]),onNativeOptionRemove:es.useCallback(e=>{A(t=>{let r=new Set(t);return r.delete(e),r})},[]),children:r})}),E?(0,er.jsxs)(mr,{"aria-hidden":!0,required:p,tabIndex:-1,name:d,autoComplete:u,value:S,onChange:e=>_(e.target.value),disabled:h,form:f,children:[void 0===S?(0,er.jsx)("option",{value:""}):null,Array.from(R)]},O):null]})})};fR.displayName=fx;var fA="SelectTrigger",fO=es.forwardRef((e,t)=>{let{__scopeSelect:r,disabled:s=!1,...n}=e,i=fN(r),a=f_(fA,r),o=a.disabled||s,l=fc(t,a.onTriggerChange),c=fw(r),d=es.useRef("touch"),[u,h,p]=mn(e=>{let t=c().filter(e=>!e.disabled),r=t.find(e=>e.value===a.value),s=mi(t,e,r);void 0!==s&&a.onValueChange(s.value)}),f=e=>{o||(a.onOpenChange(!0),p()),e&&(a.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return(0,er.jsx)(uf,{asChild:!0,...i,children:(0,er.jsx)(fd.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":ms(a.value)?"":void 0,...n,ref:l,onClick:fo(n.onClick,e=>{e.currentTarget.focus(),"mouse"!==d.current&&f(e)}),onPointerDown:fo(n.onPointerDown,e=>{d.current=e.pointerType;let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(f(e),e.preventDefault())}),onKeyDown:fo(n.onKeyDown,e=>{let t=""!==u.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||h(e.key),(!t||" "!==e.key)&&fg.includes(e.key)&&(f(),e.preventDefault())})})})});fO.displayName=fA;var fT="SelectValue",fI=es.forwardRef((e,t)=>{let{__scopeSelect:r,className:s,style:n,children:i,placeholder:a="",...o}=e,l=f_(fT,r),{onValueNodeHasChildrenChange:c}=l,d=void 0!==i,u=fc(t,l.onValueNodeChange);return fu(()=>{c(d)},[c,d]),(0,er.jsx)(fd.span,{...o,ref:u,style:{pointerEvents:"none"},children:ms(l.value)?(0,er.jsx)(er.Fragment,{children:a}):i})});fI.displayName=fT;var fM=es.forwardRef((e,t)=>{let{__scopeSelect:r,children:s,...n}=e;return(0,er.jsx)(fd.span,{"aria-hidden":!0,...n,ref:t,children:s||""})});fM.displayName="SelectIcon";var fP=e=>(0,er.jsx)(a8,{asChild:!0,...e});fP.displayName="SelectPortal";var fD="SelectContent",fL=es.forwardRef((e,t)=>{let r=f_(fD,e.__scopeSelect),[s,n]=es.useState();return(fu(()=>{n(new DocumentFragment)},[]),r.open)?(0,er.jsx)(fz,{...e,ref:t}):s?sG.createPortal((0,er.jsx)(f$,{scope:e.__scopeSelect,children:(0,er.jsx)(fy.Slot,{scope:e.__scopeSelect,children:(0,er.jsx)("div",{children:e.children})})}),s):null});fL.displayName=fD;var[f$,fU]=fj(fD),fB=eo("SelectContent.RemoveScroll"),fz=es.forwardRef((e,t)=>{let{__scopeSelect:r,position:s="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:d,arrowPadding:u,collisionBoundary:h,collisionPadding:p,sticky:f,hideWhenDetached:m,avoidCollisions:g,...b}=e,x=f_(fD,r),[y,w]=es.useState(null),[v,j]=es.useState(null),k=fc(t,e=>w(e)),[N,S]=es.useState(null),[_,C]=es.useState(null),E=fw(r),[R,A]=es.useState(!1),O=es.useRef(!1);es.useEffect(()=>{if(y)return oV(y)},[y]),oe();let T=es.useCallback(e=>{let[t,...r]=E().map(e=>e.ref.current),[s]=r.slice(-1),n=document.activeElement;for(let r of e)if(r===n||(r?.scrollIntoView({block:"nearest"}),r===t&&v&&(v.scrollTop=0),r===s&&v&&(v.scrollTop=v.scrollHeight),r?.focus(),document.activeElement!==n))return},[E,v]),I=es.useCallback(()=>T([N,y]),[T,N,y]);es.useEffect(()=>{R&&I()},[R,I]);let{onOpenChange:M,triggerPointerDownPosRef:P}=x;es.useEffect(()=>{if(y){let e={x:0,y:0},t=t=>{e={x:Math.abs(Math.round(t.pageX)-(P.current?.x??0)),y:Math.abs(Math.round(t.pageY)-(P.current?.y??0))}},r=r=>{e.x<=10&&e.y<=10?r.preventDefault():y.contains(r.target)||M(!1),document.removeEventListener("pointermove",t),P.current=null};return null!==P.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",r,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",r,{capture:!0})}}},[y,M,P]),es.useEffect(()=>{let e=()=>M(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[M]);let[D,L]=mn(e=>{let t=E().filter(e=>!e.disabled),r=t.find(e=>e.ref.current===document.activeElement),s=mi(t,e,r);s&&setTimeout(()=>s.ref.current.focus())}),$=es.useCallback((e,t,r)=>{let s=!O.current&&!r;(void 0!==x.value&&x.value===t||s)&&(S(e),s&&(O.current=!0))},[x.value]),U=es.useCallback(()=>y?.focus(),[y]),B=es.useCallback((e,t,r)=>{let s=!O.current&&!r;(void 0!==x.value&&x.value===t||s)&&C(e)},[x.value]),z="popper"===s?fF:fq,q=z===fF?{side:o,sideOffset:l,align:c,alignOffset:d,arrowPadding:u,collisionBoundary:h,collisionPadding:p,sticky:f,hideWhenDetached:m,avoidCollisions:g}:{};return(0,er.jsx)(f$,{scope:r,content:y,viewport:v,onViewportChange:j,itemRefCallback:$,selectedItem:N,onItemLeave:U,itemTextRefCallback:B,focusSelectedItem:I,selectedItemText:_,position:s,isPositioned:R,searchRef:D,children:(0,er.jsx)(oB,{as:fB,allowPinchZoom:!0,children:(0,er.jsx)(aZ,{asChild:!0,trapped:x.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:fo(n,e=>{x.trigger?.focus({preventScroll:!0}),e.preventDefault()}),children:(0,er.jsx)(aH,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:(0,er.jsx)(z,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:e=>e.preventDefault(),...b,...q,onPlaced:()=>A(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:fo(b.onKeyDown,e=>{let t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||L(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=E().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){let r=e.target,s=t.indexOf(r);t=t.slice(s+1)}setTimeout(()=>T(t)),e.preventDefault()}})})})})})})});fz.displayName="SelectContentImpl";var fq=es.forwardRef((e,t)=>{let{__scopeSelect:r,onPlaced:s,...n}=e,i=f_(fD,r),a=fU(fD,r),[o,l]=es.useState(null),[c,d]=es.useState(null),u=fc(t,e=>d(e)),h=fw(r),p=es.useRef(!1),f=es.useRef(!0),{viewport:m,selectedItem:g,selectedItemText:b,focusSelectedItem:x}=a,y=es.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&m&&g&&b){let e=i.trigger.getBoundingClientRect(),t=c.getBoundingClientRect(),r=i.valueNode.getBoundingClientRect(),n=b.getBoundingClientRect();if("rtl"!==i.dir){let s=n.left-t.left,i=r.left-s,a=e.left-i,l=e.width+a,c=Math.max(l,t.width),d=nu(i,[10,Math.max(10,window.innerWidth-10-c)]);o.style.minWidth=l+"px",o.style.left=d+"px"}else{let s=t.right-n.right,i=window.innerWidth-r.right-s,a=window.innerWidth-e.right-i,l=e.width+a,c=Math.max(l,t.width),d=nu(i,[10,Math.max(10,window.innerWidth-10-c)]);o.style.minWidth=l+"px",o.style.right=d+"px"}let a=h(),l=window.innerHeight-20,d=m.scrollHeight,u=window.getComputedStyle(c),f=parseInt(u.borderTopWidth,10),x=parseInt(u.paddingTop,10),y=parseInt(u.borderBottomWidth,10),w=f+x+d+parseInt(u.paddingBottom,10)+y,v=Math.min(5*g.offsetHeight,w),j=window.getComputedStyle(m),k=parseInt(j.paddingTop,10),N=parseInt(j.paddingBottom,10),S=e.top+e.height/2-10,_=g.offsetHeight/2,C=f+x+(g.offsetTop+_);if(C<=S){let e=a.length>0&&g===a[a.length-1].ref.current;o.style.bottom="0px";let t=Math.max(l-S,_+(e?N:0)+(c.clientHeight-m.offsetTop-m.offsetHeight)+y);o.style.height=C+t+"px"}else{let e=a.length>0&&g===a[0].ref.current;o.style.top="0px";let t=Math.max(S,f+m.offsetTop+(e?k:0)+_);o.style.height=t+(w-C)+"px",m.scrollTop=C-S+m.offsetTop}o.style.margin="10px 0",o.style.minHeight=v+"px",o.style.maxHeight=l+"px",s?.(),requestAnimationFrame(()=>p.current=!0)}},[h,i.trigger,i.valueNode,o,c,m,g,b,i.dir,s]);fu(()=>y(),[y]);let[w,v]=es.useState();fu(()=>{c&&v(window.getComputedStyle(c).zIndex)},[c]);let j=es.useCallback(e=>{e&&!0===f.current&&(y(),x?.(),f.current=!1)},[y,x]);return(0,er.jsx)(fH,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:j,children:(0,er.jsx)("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:(0,er.jsx)(fd.div,{...n,ref:u,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});fq.displayName="SelectItemAlignedPosition";var fF=es.forwardRef((e,t)=>{let{__scopeSelect:r,align:s="start",collisionPadding:n=10,...i}=e,a=fN(r);return(0,er.jsx)(ux,{...a,...i,ref:t,align:s,collisionPadding:n,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});fF.displayName="SelectPopperPosition";var[fH,fW]=fj(fD,{}),fG="SelectViewport",fV=es.forwardRef((e,t)=>{let{__scopeSelect:r,nonce:s,...n}=e,i=fU(fG,r),a=fW(fG,r),o=fc(t,i.onViewportChange),l=es.useRef(0);return(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),(0,er.jsx)(fy.Slot,{scope:r,children:(0,er.jsx)(fd.div,{"data-radix-select-viewport":"",role:"presentation",...n,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...n.style},onScroll:fo(n.onScroll,e=>{let t=e.currentTarget,{contentWrapper:r,shouldExpandOnScrollRef:s}=a;if(s?.current&&r){let e=Math.abs(l.current-t.scrollTop);if(e>0){let s=window.innerHeight-20,n=Math.max(parseFloat(r.style.minHeight),parseFloat(r.style.height));if(n<s){let i=n+e,a=Math.min(s,i),o=i-a;r.style.height=a+"px","0px"===r.style.bottom&&(t.scrollTop=o>0?o:0,r.style.justifyContent="flex-end")}}}l.current=t.scrollTop})})})]})});fV.displayName=fG;var fK="SelectGroup",[fJ,fY]=fj(fK);es.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e,n=n6();return(0,er.jsx)(fJ,{scope:r,id:n,children:(0,er.jsx)(fd.div,{role:"group","aria-labelledby":n,...s,ref:t})})}).displayName=fK;var fX="SelectLabel";es.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e,n=fY(fX,r);return(0,er.jsx)(fd.div,{id:n.id,...s,ref:t})}).displayName=fX;var fQ="SelectItem",[fZ,f0]=fj(fQ),f1=es.forwardRef((e,t)=>{let{__scopeSelect:r,value:s,disabled:n=!1,textValue:i,...a}=e,o=f_(fQ,r),l=fU(fQ,r),c=o.value===s,[d,u]=es.useState(i??""),[h,p]=es.useState(!1),f=fc(t,e=>l.itemRefCallback?.(e,s,n)),m=n6(),g=es.useRef("touch"),b=()=>{n||(o.onValueChange(s),o.onOpenChange(!1))};if(""===s)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,er.jsx)(fZ,{scope:r,value:s,disabled:n,textId:m,isSelected:c,onItemTextChange:es.useCallback(e=>{u(t=>t||(e?.textContent??"").trim())},[]),children:(0,er.jsx)(fy.ItemSlot,{scope:r,value:s,disabled:n,textValue:d,children:(0,er.jsx)(fd.div,{role:"option","aria-labelledby":m,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1,...a,ref:f,onFocus:fo(a.onFocus,()=>p(!0)),onBlur:fo(a.onBlur,()=>p(!1)),onClick:fo(a.onClick,()=>{"mouse"!==g.current&&b()}),onPointerUp:fo(a.onPointerUp,()=>{"mouse"===g.current&&b()}),onPointerDown:fo(a.onPointerDown,e=>{g.current=e.pointerType}),onPointerMove:fo(a.onPointerMove,e=>{g.current=e.pointerType,n?l.onItemLeave?.():"mouse"===g.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:fo(a.onPointerLeave,e=>{e.currentTarget===document.activeElement&&l.onItemLeave?.()}),onKeyDown:fo(a.onKeyDown,e=>{(l.searchRef?.current===""||" "!==e.key)&&(fb.includes(e.key)&&b()," "===e.key&&e.preventDefault())})})})})});f1.displayName=fQ;var f2="SelectItemText",f4=es.forwardRef((e,t)=>{let{__scopeSelect:r,className:s,style:n,...i}=e,a=f_(f2,r),o=fU(f2,r),l=f0(f2,r),c=fE(f2,r),[d,u]=es.useState(null),h=fc(t,e=>u(e),l.onItemTextChange,e=>o.itemTextRefCallback?.(e,l.value,l.disabled)),p=d?.textContent,f=es.useMemo(()=>(0,er.jsx)("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:m,onNativeOptionRemove:g}=c;return fu(()=>(m(f),()=>g(f)),[m,g,f]),(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(fd.span,{id:l.textId,...i,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?sG.createPortal(i.children,a.valueNode):null]})});f4.displayName=f2;var f5="SelectItemIndicator",f3=es.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e;return f0(f5,r).isSelected?(0,er.jsx)(fd.span,{"aria-hidden":!0,...s,ref:t}):null});f3.displayName=f5;var f6="SelectScrollUpButton",f8=es.forwardRef((e,t)=>{let r=fU(f6,e.__scopeSelect),s=fW(f6,e.__scopeSelect),[n,i]=es.useState(!1),a=fc(t,s.onScrollButtonChange);return fu(()=>{if(r.viewport&&r.isPositioned){let e=function(){i(t.scrollTop>0)},t=r.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[r.viewport,r.isPositioned]),n?(0,er.jsx)(me,{...e,ref:a,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=r;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null});f8.displayName=f6;var f7="SelectScrollDownButton",f9=es.forwardRef((e,t)=>{let r=fU(f7,e.__scopeSelect),s=fW(f7,e.__scopeSelect),[n,i]=es.useState(!1),a=fc(t,s.onScrollButtonChange);return fu(()=>{if(r.viewport&&r.isPositioned){let e=function(){let e=t.scrollHeight-t.clientHeight;i(Math.ceil(t.scrollTop)<e)},t=r.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[r.viewport,r.isPositioned]),n?(0,er.jsx)(me,{...e,ref:a,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=r;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null});f9.displayName=f7;var me=es.forwardRef((e,t)=>{let{__scopeSelect:r,onAutoScroll:s,...n}=e,i=fU("SelectScrollButton",r),a=es.useRef(null),o=fw(r),l=es.useCallback(()=>{null!==a.current&&(window.clearInterval(a.current),a.current=null)},[]);return es.useEffect(()=>()=>l(),[l]),fu(()=>{let e=o().find(e=>e.ref.current===document.activeElement);e?.ref.current?.scrollIntoView({block:"nearest"})},[o]),(0,er.jsx)(fd.div,{"aria-hidden":!0,...n,ref:t,style:{flexShrink:0,...n.style},onPointerDown:fo(n.onPointerDown,()=>{null===a.current&&(a.current=window.setInterval(s,50))}),onPointerMove:fo(n.onPointerMove,()=>{i.onItemLeave?.(),null===a.current&&(a.current=window.setInterval(s,50))}),onPointerLeave:fo(n.onPointerLeave,()=>{l()})})});es.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e;return(0,er.jsx)(fd.div,{"aria-hidden":!0,...s,ref:t})}).displayName="SelectSeparator";var mt="SelectArrow";es.forwardRef((e,t)=>{let{__scopeSelect:r,...s}=e,n=fN(r),i=f_(mt,r),a=fU(mt,r);return i.open&&"popper"===a.position?(0,er.jsx)(uv,{...n,...s,ref:t}):null}).displayName=mt;var mr=es.forwardRef(({__scopeSelect:e,value:t,...r},s)=>{let n,i=es.useRef(null),a=fc(s,i),o=(n=es.useRef({value:t,previous:t}),es.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t]));return es.useEffect(()=>{let e=i.current;if(!e)return;let r=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(o!==t&&r){let s=new Event("change",{bubbles:!0});r.call(e,t),e.dispatchEvent(s)}},[o,t]),(0,er.jsx)(fd.select,{...r,style:{...fm,...r.style},ref:a,defaultValue:t})});function ms(e){return""===e||void 0===e}function mn(e){let t,r=(t=es.useRef(e),es.useEffect(()=>{t.current=e}),es.useMemo(()=>(...e)=>t.current?.(...e),[])),s=es.useRef(""),n=es.useRef(0),i=es.useCallback(e=>{let t=s.current+e;r(t),function e(t){s.current=t,window.clearTimeout(n.current),""!==t&&(n.current=window.setTimeout(()=>e(""),1e3))}(t)},[r]),a=es.useCallback(()=>{s.current="",window.clearTimeout(n.current)},[]);return es.useEffect(()=>()=>window.clearTimeout(n.current),[]),[s,i,a]}function mi(e,t,r){var s,n;let i=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,a=r?e.indexOf(r):-1,o=(s=e,n=Math.max(a,0),s.map((e,t)=>s[(n+t)%s.length]));1===i.length&&(o=o.filter(e=>e!==r));let l=o.find(e=>e.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==r?l:void 0}mr.displayName="SelectBubbleInput";let ma=tc("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),mo=tc("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function ml({...e}){return(0,er.jsx)(fR,{"data-slot":"select",...e})}function mc({...e}){return(0,er.jsx)(fI,{"data-slot":"select-value",...e})}function md({className:e,size:t="default",children:r,...s}){return(0,er.jsxs)(fO,{"data-slot":"select-trigger","data-size":t,className:tr("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s,children:[r,(0,er.jsx)(fM,{asChild:!0,children:(0,er.jsx)(ma,{className:"size-4 opacity-50"})})]})}function mu({className:e,children:t,position:r="popper",...s}){return(0,er.jsx)(fP,{children:(0,er.jsxs)(fL,{"data-slot":"select-content",className:tr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...s,children:[(0,er.jsx)(mp,{}),(0,er.jsx)(fV,{className:tr("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,er.jsx)(mf,{})]})})}function mh({className:e,children:t,...r}){return(0,er.jsxs)(f1,{"data-slot":"select-item",className:tr("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...r,children:[(0,er.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,er.jsx)(f3,{children:(0,er.jsx)(iW,{className:"size-4"})})}),(0,er.jsx)(f4,{children:t})]})}function mp({className:e,...t}){return(0,er.jsx)(f8,{"data-slot":"select-scroll-up-button",className:tr("flex cursor-default items-center justify-center py-1",e),...t,children:(0,er.jsx)(mo,{className:"size-4"})})}function mf({className:e,...t}){return(0,er.jsx)(f9,{"data-slot":"select-scroll-down-button",className:tr("flex cursor-default items-center justify-center py-1",e),...t,children:(0,er.jsx)(ma,{className:"size-4"})})}let mm=`https://${sB}.supabase.co/functions/v1/make-server-a14c7986`,mg={Authorization:`Bearer ${sz}`},mb={...mg,"Content-Type":"application/json"},mx=e=>{let t=Math.floor(Math.max(0,e)),r=Math.floor(t/60);return`${r}:${(t%60).toString().padStart(2,"0")}`},my=[{label:"Public",value:"public",description:"Everyone on MoveSplash can view your story"},{label:"Friends",value:"friends",description:"Only your connections can view"},{label:"Close friends",value:"close_friends",description:"Share with your inner circle only"}],mw=e=>{let t=new Date(e);if(Number.isNaN(t.getTime()))return"";let r=Math.floor((Date.now()-t.getTime())/6e4);if(r<1)return"Just now";if(r<60)return`${r}m ago`;let s=Math.floor(r/60);if(s<24)return`${s}h ago`;let n=Math.floor(s/24);return n<7?`${n}d ago`:t.toLocaleDateString()},mv="https://api.dicebear.com/7.x/shapes/svg?seed=MoveSplashStory&backgroundColor=transparent",mj=e=>({id:e.id,userId:e.userId,user:e.user,items:e.items.map(e=>({...e,url:"string"==typeof e.url&&""!==e.url.trim()&&"__existing__"!==e.url?e.url:mv})),viewers:e.viewers,visibility:e.visibility,createdAt:e.createdAt,expiresAt:e.expiresAt,likes:e.likes,replies:e.replies.map(e=>({id:e.id,storyId:e.storyId,authorId:e.authorId,content:e.content,timestamp:e.timestamp,author:e.author??void 0}))});function mk(){let{currentUser:e}=ai(),[t,r]=(0,es.useState)([]),[s,n]=(0,es.useState)(null),[i,a]=(0,es.useState)(0),[o,l]=(0,es.useState)(""),[c,d]=(0,es.useState)(!0),[u,h]=(0,es.useState)(null),[p,f]=(0,es.useState)(!1),m=(0,es.useRef)(null),[g,b]=(0,es.useState)([]),[x,y]=(0,es.useState)("friends"),[w,v]=(0,es.useState)(!1),[j,k]=(0,es.useState)(null),[N,S]=(0,es.useState)(!1),_=(0,es.useRef)(null),[C,E]=(0,es.useState)(null),[R,A]=(0,es.useState)(!1),[O,T]=(0,es.useState)(!1),[I,M]=(0,es.useState)(null),[P,D]=(0,es.useState)(null),[L,$]=(0,es.useState)(!1),U=(0,es.useRef)(null),B=(0,es.useRef)(null),z=(0,es.useRef)([]),q=(0,es.useRef)(null),F=(0,es.useRef)(!1),H=(0,es.useRef)("video/webm"),W=(0,es.useRef)(0),[G,V]=(0,es.useState)(!1),[K,J]=(0,es.useState)(0),[Y,X]=(0,es.useState)(null),[Q,Z]=(0,es.useState)(!0),[ee,et]=(0,es.useState)(0),en=(0,es.useCallback)(e=>encodeURIComponent(e),[]),ei=(0,es.useCallback)(async e=>{try{e?.aborted||(d(!0),h(null));let t=await fetch(`${mm}/stories`,{headers:mg,signal:e});if(!t.ok)throw Error("Failed to fetch stories");let s=await t.json().catch(()=>({}));e?.aborted||r(Array.isArray(s?.stories)?s.stories:[])}catch(t){if("AbortError"===t.name)return;console.error("Error loading stories:",t),e?.aborted||h("Unable to load stories right now.")}finally{e?.aborted||d(!1)}},[]),ea=(0,es.useCallback)((e,t)=>{r(r=>{let s=(e,t)=>Array.isArray(e)?e.map((e,r)=>{let s=t?.[r],n="string"==typeof e.url&&""!==e.url.trim()&&"__existing__"!==e.url?e.url:"",i="string"==typeof s?.url&&""!==s.url.trim()&&"__existing__"!==s.url?s.url:"",a=n||i||mv;return{...e,url:a}}):e,n={...e,items:s(e.items)};return r.some(t=>t.id===e.id)?r.map(t=>t.id===e.id?{...t,...n,items:s(n.items,t.items)}:t):t?.prepend?[n,...r]:[...r,n]})},[]),eo=(0,es.useCallback)(e=>e?{id:e.id,name:e.name,username:e.username,avatar:e.avatar,ablyClientId:e.ablyClientId??e.id}:null,[]),el=(0,es.useCallback)(e=>({id:e.id,userId:e.userId,visibility:e.visibility,createdAt:e.createdAt,expiresAt:e.expiresAt,viewers:e.viewers,likes:e.likes,items:e.items.map(e=>({id:e.id,type:e.type,url:"string"==typeof e.url&&""!==e.url.trim()?e.url:mv,duration:e.duration,timestamp:e.timestamp??new Date().toISOString()})),user:{id:e.user.id,name:e.user.name,username:e.user.username,avatar:e.user.avatar,ablyClientId:e.user.ablyClientId},replies:e.replies.map(e=>({id:e.id,storyId:e.storyId,authorId:e.authorId,content:e.content,timestamp:e.timestamp,author:e.author?{id:e.author.id,name:e.author.name,username:e.author.username,avatar:e.author.avatar,ablyClientId:e.author.ablyClientId}:void 0}))}),[]),ec=(0,es.useCallback)(async e=>{try{let t=eo(e.user),r=await fetch(`${mm}/stories`,{method:"POST",headers:mb,body:JSON.stringify({...el(e),userSnapshot:t??void 0})});if(!r.ok)return!1;let s=await r.json().catch(()=>({}));return s?.story&&ea(s.story),!0}catch(e){return console.error("Failed to ensure story on server:",e),!1}},[el,eo,ea]),ed=(0,es.useCallback)(e=>{if(!e)return;let t=Array.from(e).filter(e=>e.type.startsWith("image/")||e.type.startsWith("video/"));if(0===t.length){k("Only image or video files are supported for stories."),i5.error("Only image or video files are supported for stories.");return}let r=Math.max(5-g.length,0);if(r<=0){k("You can add up to 5 story items."),i5.info("You can add up to 5 story items.");return}let s=t.slice(0,r),n=t.length>s.length;s.forEach(e=>{let t=new FileReader;t.onload=t=>{let r=t.target?.result;if(!r||"string"!=typeof r)return;let s=e.type.startsWith("video/");b(t=>[...t,{id:`${e.name}-${Date.now()}`,type:s?"video":"image",url:r,duration:s?15:6}])},t.readAsDataURL(e)}),s.length>0&&k(null),n&&i5.info(`Only the first ${r} files were added.`)},[g.length]),eu=(0,es.useCallback)(e=>{ed(e.target.files),e.target.value=""},[ed]),eh=(0,es.useCallback)(e=>{e.preventDefault(),S(!1),ed(e.dataTransfer.files)},[ed]),ep=(0,es.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy",N||S(!0)},[N]),ef=(0,es.useCallback)(e=>{e.preventDefault(),S(!1)},[]),em=(0,es.useCallback)(()=>{null!==q.current&&(window.clearInterval(q.current),q.current=null)},[]),eg=(0,es.useCallback)(async()=>{em();let e=F.current;F.current=!1;let t=z.current;z.current=[],B.current=null;let r=H.current||"video/webm",s=Math.max(W.current,0);if(W.current=0,V(!1),J(0),e||0===t.length){e&&t.length>0&&i5.info("Recording discarded.");return}try{let e=new Blob(t,{type:r}),n=await new Promise((t,r)=>{let s=new FileReader;s.onloadend=()=>{"string"==typeof s.result?t(s.result):r(Error("Unable to read recording data"))},s.onerror=r,s.readAsDataURL(e)});b(e=>{if(e.length>=5)return i5.info("You can add up to 5 story items."),e;let t=Math.min(15,Math.max(3,Math.round(s)||15));return[...e,{id:`recording-${Date.now()}`,type:"video",url:n,duration:t}]}),i5.success("Video added to your story.")}catch(e){console.error("Failed to save recording:",e),i5.error("Unable to save that recording.")}},[b,em]),eb=(0,es.useCallback)((e=!1)=>{if(!B.current){F.current=!1;return}F.current=e,"inactive"!==B.current.state&&B.current.stop()},[]),ex=(0,es.useCallback)(()=>{if(!O||!I)return void i5.info("Start the camera before recording.");if(G)return void i5.info("Recording already in progress.");if(void 0===window.MediaRecorder){X("Video recording is not supported in this browser."),i5.error("Recording is not supported on this device.");return}try{let e=(()=>{if(void 0===window.MediaRecorder)return"";let e=window.MediaRecorder;return["video/webm;codecs=vp9","video/webm;codecs=vp8","video/webm;codecs=avc1","video/webm","video/mp4"].find(t=>t&&e.isTypeSupported(t))??""})(),t=e?new MediaRecorder(I,{mimeType:e}):new MediaRecorder(I);H.current=e||t.mimeType||"video/webm",z.current=[],t.ondataavailable=e=>{e.data&&e.data.size>0&&z.current.push(e.data)},t.onerror=e=>{console.error("Recording error:",e),X("Recording error. Please try again."),i5.error("Recording error."),F.current=!0},t.onstop=()=>{eg().catch(e=>{console.error("Failed to finalize recording:",e)})},B.current=t,t.start(),V(!0),J(0),W.current=0,X(null),q.current=window.setInterval(()=>{J(e=>{let t=e+.2;return W.current=t,1e3*t>=15e3&&eb(),t})},200),i5.success("Recording started.")}catch(e){console.error("Unable to start recording:",e),X("Unable to start recording. Please try again."),i5.error("Unable to start recording.")}},[I,eg,O,G,eb]);(0,es.useEffect)(()=>()=>{em(),F.current=!0,B.current&&"inactive"!==B.current.state&&B.current.stop()},[em]);let ey=(0,es.useCallback)(()=>{G&&eb(!0),M(e=>(e&&e.getTracks().forEach(e=>{try{e.stop()}catch(e){console.error("Error stopping camera stream track:",e)}}),null)),T(!1),$(!1),J(0),W.current=0,X(null),D(null)},[G,eb]),ew=(0,es.useCallback)(async()=>{if("undefined"==typeof navigator||!navigator.mediaDevices?.getUserMedia)return void D("Camera is not supported on this device.");try{ey();let e=null;try{e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!0})}catch(t){console.warn("Falling back to video-only capture for stories:",t),e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}})}M(e),T(!0),D(null)}catch(e){console.error("Error accessing camera:",e),D("Unable to access camera. Check your permissions."),T(!1)}},[ey]),ev=(0,es.useCallback)(()=>{if(!O||!U.current)return void i5.info("Start the camera to capture a photo.");if(G)return void i5.info("Stop the recording before taking a photo.");let e=U.current;$(!0),b(t=>{if(t.length>=5)return i5.info("You can add up to 5 story items."),$(!1),t;let r=document.createElement("canvas"),s=e.videoWidth||720,n=e.videoHeight||1280;r.width=s,r.height=n;let i=r.getContext("2d");if(!i)return i5.error("Unable to capture photo."),$(!1),t;i.drawImage(e,0,0,s,n);let a=r.toDataURL("image/jpeg",.9);return a?(i5.success("Photo added to your story."),$(!1),[...t,{id:`camera-${Date.now()}`,type:"image",url:a,duration:6}]):(i5.error("Unable to capture photo."),$(!1),t)})},[O,G]),ej=(0,es.useCallback)(()=>{b([]),y("friends"),k(null),S(!1),v(!1),ey(),_.current&&(_.current.value="")},[ey]),ek=(0,es.useCallback)(e=>{b(t=>t.filter(t=>t.id!==e))},[]),eN=(0,es.useCallback)(e=>{f(e),e||ej()},[ej]),eS=(0,es.useCallback)(async()=>{if(!e)return void i5.info("Sign in to share a story.");if(0===g.length)return void k("Add at least one photo or video to your story.");v(!0),k(null);try{let t=g.map(e=>({id:e.id,type:e.type,url:e.url,duration:e.duration,timestamp:new Date().toISOString()})),r=await fetch(`${mm}/stories`,{method:"POST",headers:mb,body:JSON.stringify({userId:e.id,visibility:x,items:t})}),s=await r.json().catch(()=>({}));if(!r.ok||!s?.story){let e=s?.error??"Failed to publish story.";throw Error(e)}let i=s.story;ea(i,{prepend:!0});let o=i.id;eN(!1),i5.success("Your story is live!"),ei().catch(e=>{console.error("Error refreshing stories:",e)}),n(o),a(0)}catch(e){console.error("Error creating story:",e),k(e instanceof Error?e.message:"Unable to publish story right now."),i5.error("Unable to publish story right now.")}finally{v(!1)}},[e,g,x,ei,eN,ea]);(0,es.useEffect)(()=>{let e=new AbortController;return ei(e.signal),()=>e.abort()},[ei]),(0,es.useEffect)(()=>{let e=U.current;e&&(I?(e.srcObject=I,(async()=>{try{await e.play()}catch(e){console.error("Error starting camera preview:",e),D("Unable to start camera preview.")}})()):e.srcObject=null)},[I]),(0,es.useEffect)(()=>{p||ey()},[p,ey]);let e_=(0,es.useMemo)(()=>t.filter(e=>!!e?.user&&Array.isArray(e.items)&&e.items.length>0).map(t=>{let r=t.items.map(e=>({...e,type:"video"===e.type?"video":"image"})),s=t.user,n={id:s.id,name:s.name,username:s.username,avatar:s.avatar,ablyClientId:s.ablyClientId??s.id},i=t.createdAt&&!Number.isNaN(Date.parse(t.createdAt))?new Date(t.createdAt).toISOString():new Date().toISOString(),a=t.expiresAt&&!Number.isNaN(Date.parse(t.expiresAt))?new Date(t.expiresAt).toISOString():i,o=Array.from(new Set(Array.isArray(t.likes)?t.likes.filter(e=>"string"==typeof e):[])),l=Array.isArray(t.replies)?t.replies.map((e,r)=>{if(!e||"object"!=typeof e)return null;let s="string"==typeof e.authorId?e.authorId:"";if(!s)return null;let n=e.timestamp&&!Number.isNaN(Date.parse(e.timestamp))?new Date(e.timestamp).toISOString():new Date().toISOString(),i=e.author,a=i?{id:i.id,name:i.name,username:i.username,avatar:i.avatar,ablyClientId:i.ablyClientId??i.id}:null,o="string"==typeof e.content?e.content:"";return o?{id:e.id||`${t.id}-reply-${r}`,storyId:e.storyId??t.id,authorId:s,author:a,content:o,timestamp:n}:null}).filter(e=>!!e).sort((e,t)=>Date.parse(e.timestamp)-Date.parse(t.timestamp)):[];return{id:t.id,userId:t.userId,user:n,items:r,viewers:Array.isArray(t.viewers)?t.viewers:[],visibility:t.visibility??"friends",createdAt:i,expiresAt:a,viewed:!!e&&!!Array.isArray(t.viewers)&&t.viewers.includes(e.id),likes:o,likeCount:o.length,liked:!!e&&o.includes(e.id),replies:l}}).sort((e,t)=>Date.parse(t.createdAt)-Date.parse(e.createdAt)),[t,e]),eC=(0,es.useMemo)(()=>{if(!e||e_.some(t=>t.userId===e.id))return null;let t=new Date().toISOString();return{id:`create-story-${e.id}`,userId:e.id,user:{id:e.id,name:e.name,username:e.username,avatar:e.avatar,ablyClientId:e.ablyClientId??e.id},items:[],viewers:[],visibility:"friends",createdAt:t,expiresAt:t,viewed:!1,likes:[],likeCount:0,liked:!1,replies:[]}},[e,e_]),eE=(0,es.useMemo)(()=>e_.filter(e=>e.items.length>0),[e_]),eR=(0,es.useMemo)(()=>{let t=e_;return e&&(t=[...e_.filter(t=>t.userId===e.id),...e_.filter(t=>t.userId!==e.id)]),eC?[eC,...t]:t},[e,e_,eC]),eA=s?eE.find(e=>e.id===s)??null:null,eO=eA?.items[i];(0,es.useEffect)(()=>{!s||eE.some(e=>e.id===s)||(n(null),a(0))},[s,eE]),(0,es.useEffect)(()=>{l(""),et(0),Z(!0)},[s]),(0,es.useEffect)(()=>{if(!s||!e)return;let n=t.find(e=>e.id===s);if(!n||Array.isArray(n.viewers)&&n.viewers.includes(e.id))return;let i=new AbortController;return(async()=>{try{let t=en(n.id);await fetch(`${mm}/stories/${t}/view`,{method:"POST",headers:mb,body:JSON.stringify({viewerId:e.id}),signal:i.signal}),r(t=>t.map(t=>t.id===n.id?{...t,viewers:Array.from(new Set([...t.viewers??[],e.id]))}:t))}catch(e){"AbortError"!==e.name&&console.error("Failed to update story view state:",e)}})(),()=>i.abort()},[s,e,t,en]);let eT=(0,es.useCallback)(()=>{if(!eA)return;if(i<eA.items.length-1)return void a(e=>e+1);let e=eE.findIndex(e=>e.id===eA.id);e>=0&&e<eE.length-1?n(eE[e+1].id):n(null),a(0)},[eA,i,eE]),eI=(0,es.useCallback)(()=>{if(!eA)return;if(i>0)return void a(e=>e-1);let e=eE.findIndex(e=>e.id===eA.id);if(e>0){let t=eE[e-1];n(t.id),a(Math.max(t.items.length-1,0))}},[eA,i,eE]),eM=(0,es.useCallback)(async(t,r)=>{if(!e||t.userId===e.id)return;let s=e.ablyClientId??e.id,n=Array.from(new Set([s,t.user.ablyClientId??t.user.id].filter(e=>!!e)));if(n.length<2)return;let i=`Story chat with ${t.user.name}`,a=null;try{let t=await fetch(`${mm}/chats`,{method:"POST",headers:mb,body:JSON.stringify({name:i,members:n,isGroup:!1,createdBy:e.id})}),r=await t.json().catch(()=>({}));t.ok&&r?.chat&&"string"==typeof r.chat.id?a=r.chat.id:t.ok||console.warn("Failed to ensure chat for story reply",t.status)}catch(e){console.error("Error ensuring chat for story reply:",e)}if(a)try{let t=await fetch(`${mm}/messages`,{method:"POST",headers:mb,body:JSON.stringify({chatId:a,senderId:s,senderName:e.name,senderAvatar:e.avatar,content:`Reply to your story: ${r}`})});t.ok||console.warn("Failed to persist story reply message",t.status)}catch(e){console.error("Error sending story reply message:",e)}},[e]);(0,es.useEffect)(()=>{if(!eO||"video"!==eO.type){et(0);let e=m.current;e&&(e.pause(),e.currentTime=0);return}let e=m.current;if(!e)return;e.muted=Q;let t=()=>eT(),r=()=>{e.duration&&et(e.currentTime/e.duration)},s=()=>{et(0),e.muted=Q;let t=e.play();t&&t.catch(e=>console.warn("Unable to autoplay story video:",e))};e.addEventListener("ended",t),e.addEventListener("timeupdate",r),e.addEventListener("loadedmetadata",s);let n=e.play();return n&&n.catch(e=>console.warn("Unable to autoplay story video:",e)),()=>{e.removeEventListener("ended",t),e.removeEventListener("timeupdate",r),e.removeEventListener("loadedmetadata",s)}},[eO,eT,Q]);let eP=(0,es.useCallback)(()=>{Z(e=>{let t=!e;return m.current&&(m.current.muted=t),t})},[]),eD=(0,es.useCallback)(async t=>{if(!e)return void i5.info("Sign in to like stories.");if(!C||C===t.id){E(t.id);try{let r=async(s=0)=>{let n=en(t.id),i=await fetch(`${mm}/stories/${n}/like`,{method:"POST",headers:mb,body:JSON.stringify({userId:e.id,likerSnapshot:{id:e.id,name:e.name,username:e.username,avatar:e.avatar,ablyClientId:e.ablyClientId??e.id},...s>0?{storySnapshot:el(t)}:{}})});if(404===i.status&&0===s&&await ec(t))return r(s+1);let a=await i.json().catch(()=>({}));return!!i.ok&&!!a?.story&&(ea(a.story),!0)};if(!await r())throw Error("restore")}catch{if(e){let r=t.likes.includes(e.id),s=r?t.likes.filter(t=>t!==e.id):[...t.likes,e.id];ea(mj({...t,likes:s,likeCount:s.length,liked:!r})),i5.success(r?"Removed like.":"Liked story!")}else i5.success("Story like recorded!")}finally{E(null)}}},[e,C,ea,en,ec,el]),eL=(0,es.useCallback)(async()=>{if(!eA)return;let t=o.trim();if(t){if(!e)return void i5.info("Sign in to reply to stories.");A(!0);try{let r=async(s=0)=>{let n=en(eA.id),i=await fetch(`${mm}/stories/${n}/reply`,{method:"POST",headers:mb,body:JSON.stringify({authorId:e.id,content:t,authorSnapshot:{id:e.id,name:e.name,username:e.username,avatar:e.avatar,ablyClientId:e.ablyClientId??e.id},...s>0?{storySnapshot:el(eA)}:{}})});if(404===i.status&&0===s&&await ec(eA))return r(s+1);let a=await i.json().catch(()=>({}));return!!i.ok&&!!a?.story&&(ea(a.story),l(""),i5.success("Reply sent!"),eM(eA,t),!0)};if(!await r())throw Error("restore")}catch{if(eA&&e){let r={id:`offline-${Date.now().toString(36)}`,storyId:eA.id,authorId:e.id,content:t,timestamp:new Date().toISOString(),author:{id:e.id,name:e.name,username:e.username,avatar:e.avatar,ablyClientId:e.ablyClientId??e.id}};ea(mj({...eA,replies:[...eA.replies,r]})),l(""),i5.success("Reply sent!"),eM(eA,t)}else i5.success("Reply captured!")}finally{A(!1)}}},[eA,e,en,ec,ea,o,eM,el]),e$=c&&0===t.length;return(0,er.jsxs)("div",{className:"max-w-7xl mx-auto space-y-4",children:[u&&(0,er.jsxs)("div",{className:"p-4 rounded-2xl bg-white/10 border border-white/20 text-white/80 flex items-center justify-between gap-4",children:[(0,er.jsx)("p",{className:"text-sm",children:u}),(0,er.jsx)(tn,{size:"sm",variant:"outline",onClick:()=>void ei(),className:"bg-white/10 border-white/30 text-white hover:bg-white/20",children:"Try again"})]}),e$?(0,er.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-4 hide-scrollbar",children:Array.from({length:5}).map((e,t)=>(0,er.jsxs)("div",{className:"flex flex-col items-center gap-2 flex-shrink-0",children:[(0,er.jsx)(fr,{className:"w-20 h-20 rounded-full bg-white/10"}),(0,er.jsx)(fr,{className:"w-16 h-3 bg-white/10"})]},t))}):(0,er.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-4 hide-scrollbar",children:0!==eR.length||e?eR.map(t=>{let r=!!(e&&t.userId===e.id),s=r&&0===t.items.length,i=t.viewed&&!s?"from-white/30 via-white/20 to-white/30":"from-pink-500 via-purple-500 to-indigo-500",o=s?"Create a story":r?"View your story":`View ${t.user.name}'s story`;return(0,er.jsxs)("button",{type:"button",onClick:()=>{e&&t.userId===e.id&&0===t.items.length?eN(!0):0!==t.items.length&&(n(t.id),a(0))},className:"relative flex flex-col items-center gap-2 flex-shrink-0 group focus:outline-none transition-transform duration-300 hover:-translate-y-1","aria-label":o,children:[(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsxs)("div",{className:`relative p-[3px] rounded-full bg-gradient-to-tr ${i} transition-all duration-500 ease-out group-hover:shadow-[0_18px_35px_rgba(168,85,247,0.35)] group-hover:scale-[1.03]`,children:[(0,er.jsx)("div",{className:"absolute inset-0 rounded-full opacity-0 group-hover:opacity-100 group-hover:blur-lg bg-white/25 transition-all duration-500"}),(0,er.jsx)("div",{className:"relative p-0.5 rounded-full bg-gradient-to-br from-purple-950/80 via-purple-900/70 to-pink-900/80",children:(0,er.jsxs)(s8,{className:"w-16 h-16 border-2 border-white/20 transition-transform duration-500 group-hover:scale-[1.04]",children:[(0,er.jsx)(s7,{src:t.user.avatar}),(0,er.jsx)(s9,{children:t.user.name[0]})]})})]}),s&&(0,er.jsx)("div",{className:"absolute -bottom-1 -right-1 w-7 h-7 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 rounded-full flex items-center justify-center border-2 border-purple-950 shadow-[0_12px_35px_rgba(236,72,153,0.45)] transition-transform duration-300 group-hover:scale-110",children:(0,er.jsx)(u2,{className:"w-3.5 h-3.5 text-white"})}),r&&!s&&(0,er.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),eN(!0)},className:"absolute -bottom-1 -right-1 flex h-7 w-7 items-center justify-center rounded-full border-2 border-purple-950 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 text-white shadow-[0_12px_35px_rgba(236,72,153,0.45)] transition-transform duration-300 hover:scale-110 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/80","aria-label":"Add to your story",children:(0,er.jsx)(u2,{className:"w-3.5 h-3.5"})})]}),(0,er.jsx)("span",{className:"text-white/90 text-sm max-w-[90px] truncate text-center tracking-tight transition-colors duration-300 group-hover:text-white",children:r?"Your Story":t.user.name})]},t.id)}):(0,er.jsx)("div",{className:"text-white/70 text-sm",children:"No stories yet. Check back soon!"})}),(0,er.jsx)(lb,{open:null!==s,onOpenChange:e=>!e&&n(null),children:(0,er.jsx)(lj,{className:"max-w-md h-[90vh] p-0 bg-transparent border-0",children:eA&&eO&&(0,er.jsxs)("div",{className:"relative w-full h-full rounded-3xl overflow-hidden bg-black",children:[(0,er.jsx)("div",{className:"absolute inset-0",children:"video"===eO.type?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)("video",{ref:m,src:eO.url,className:"h-full w-full object-contain bg-black",playsInline:!0,autoPlay:!0,controls:!1,muted:Q},eO.id),(0,er.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-black/60"})]}):(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(ty,{src:eO.url,alt:"Story",className:"w-full h-full object-cover"}),(0,er.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-black/60"})]})}),(0,er.jsx)("div",{className:"absolute top-0 left-0 right-0 p-4 z-10",children:(0,er.jsx)("div",{className:"flex gap-1",children:eA.items.map((e,t)=>{let r=t===i,s=t<i,n=s||r&&"video"!==e.type?void 0:r&&"video"===e.type?100*Math.min(Math.max(ee,0),1):void 0,a=["h-full bg-white transition-all duration-300",s?"w-full":"",!r&&!s?"w-0":"",r&&"video"!==e.type?"w-full animate-progress":""].filter(Boolean).join(" ");return(0,er.jsx)("div",{className:"flex-1 h-1 bg-white/30 rounded-full overflow-hidden",children:(0,er.jsx)("div",{className:a,style:void 0!==n?{width:`${n}%`}:void 0})},t)})})}),(0,er.jsxs)("div",{className:"absolute top-4 right-4 z-20 flex gap-2",children:["video"===eO.type&&(0,er.jsx)(tn,{size:"icon",variant:"ghost",onClick:eP,className:"text-white hover:bg-white/20",children:Q?(0,er.jsx)(fa,{className:"w-5 h-5"}):(0,er.jsx)(fi,{className:"w-5 h-5"})}),(0,er.jsx)(tn,{size:"icon",variant:"ghost",onClick:()=>n(null),className:"text-white hover:bg-white/20",children:(0,er.jsx)(iH,{className:"w-5 h-5"})})]}),(0,er.jsx)("div",{className:"absolute top-6 left-0 right-0 px-4 z-10",children:(0,er.jsx)("div",{className:"flex items-center justify-between",children:(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsxs)(s8,{className:"w-10 h-10 border-2 border-white/50",children:[(0,er.jsx)(s7,{src:eA.user.avatar}),(0,er.jsx)(s9,{children:eA.user.name[0]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("div",{className:"text-white",children:eA.user.name}),(0,er.jsx)("div",{className:"text-white/70 text-sm",children:mw(eO.timestamp)})]})]})})}),(0,er.jsx)("button",{onClick:eI,className:"absolute left-0 top-0 bottom-0 w-1/3 z-10 cursor-pointer","aria-label":"Previous"}),(0,er.jsx)("button",{onClick:eT,className:"absolute right-0 top-0 bottom-0 w-1/3 z-10 cursor-pointer","aria-label":"Next"}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:eI,className:"absolute left-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-20",children:(0,er.jsx)(fs,{className:"w-6 h-6"})}),(0,er.jsx)(tn,{size:"sm",variant:"ghost",onClick:eT,className:"absolute right-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-20",children:(0,er.jsx)(pL,{className:"w-6 h-6"})}),(0,er.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 z-10",children:(0,er.jsxs)("div",{className:"space-y-3",children:[eA.replies.length>0&&(0,er.jsx)("div",{className:"max-h-40 overflow-y-auto rounded-2xl border border-white/10 bg-black/30 p-3 backdrop-blur",children:(0,er.jsx)("div",{className:"space-y-3",children:eA.replies.map(e=>(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsxs)(s8,{className:"h-8 w-8 border border-white/20",children:[(0,er.jsx)(s7,{src:e.author?.avatar}),(0,er.jsx)(s9,{children:(e.author?.name??e.author?.username??"?")[0]??"?"})]}),(0,er.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between text-xs text-white/60",children:[(0,er.jsx)("span",{className:"font-medium text-white/90",children:e.author?.name??e.author?.username??"MoveSplash user"}),(0,er.jsx)("span",{children:mw(e.timestamp)})]}),(0,er.jsx)("p",{className:"text-sm text-white/90",children:e.content})]})]},e.id))})}),(0,er.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,er.jsxs)(tn,{type:"button",variant:"ghost",onClick:()=>void eD(eA),disabled:C===eA.id,className:`flex items-center gap-2 rounded-full border border-white/25 bg-black/40 px-4 py-2 text-sm transition-all duration-200 ${eA.liked?"border-rose-400/60 text-rose-100 hover:bg-rose-500/20":"text-white hover:bg-white/15"} ${C===eA.id?"opacity-70 cursor-not-allowed":""}`,children:[C===eA.id?(0,er.jsx)(iV,{className:"h-4 w-4 animate-spin"}):(0,er.jsx)(tm,{className:`h-4 w-4 ${eA.liked?"fill-current":""}`}),(0,er.jsx)("span",{children:eA.likeCount})]}),(0,er.jsx)(cV,{placeholder:"Send a reply...",value:o,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),eL())},disabled:R,className:"flex-1 min-w-[140px] bg-white/10 backdrop-blur-md border-white/20 text-white placeholder:text-white/50"}),(0,er.jsxs)(tn,{type:"button",onClick:()=>void eL(),disabled:R||!o.trim(),className:"flex items-center justify-center gap-2 bg-gradient-to-r from-pink-500 to-purple-500 text-white shadow-[0_12px_30px_rgba(168,85,247,0.45)] transition-all duration-200 hover:from-pink-600 hover:to-purple-600 disabled:opacity-70",children:[R?(0,er.jsx)(iV,{className:"h-4 w-4 animate-spin"}):(0,er.jsx)(aE,{className:"h-4 w-4"}),(0,er.jsx)("span",{className:"text-sm font-medium",children:"Send"})]})]})]})})]})})}),(0,er.jsx)(lb,{open:p,onOpenChange:eN,children:(0,er.jsx)(lj,{className:"w-full max-w-[95vw] sm:max-w-2xl lg:max-w-3xl p-0 border-0 bg-transparent shadow-none",children:(0,er.jsxs)("div",{className:"relative flex max-h-[88vh] flex-col overflow-hidden rounded-3xl bg-gradient-to-br from-[#24103f] via-[#170d3e] to-[#0b1531] text-white shadow-[0_28px_70px_rgba(147,51,234,0.45)]",children:[(0,er.jsx)("div",{className:"pointer-events-none absolute inset-0 opacity-70",style:{background:"radial-gradient(circle at 20% 20%, rgba(236,72,153,0.3), transparent 60%), radial-gradient(circle at 80% 10%, rgba(96,165,250,0.25), transparent 55%), radial-gradient(circle at 50% 90%, rgba(168,85,247,0.25), transparent 60%)"}}),(0,er.jsxs)("div",{className:"relative flex-1 overflow-y-auto px-5 py-6 sm:px-8 sm:py-8 space-y-6",children:[(0,er.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,er.jsxs)("div",{className:"space-y-2 sm:space-y-1",children:[(0,er.jsx)("h2",{className:"text-lg font-semibold sm:text-xl",children:"Create a Story"}),(0,er.jsx)("p",{className:"text-sm text-white/70",children:"Add photos or short clips to share with your friends."})]}),(0,er.jsx)(tn,{type:"button",variant:"ghost",onClick:()=>eN(!1),className:"text-white/70 hover:text-white hover:bg-white/15",children:(0,er.jsx)(iH,{className:"w-5 h-5"})})]}),(0,er.jsxs)("div",{className:`relative rounded-2xl border border-dashed ${N?"border-white/60 bg-white/10":"border-white/20 bg-white/5"} transition-all duration-300 ease-out`,onDragOver:ep,onDragLeave:ef,onDrop:eh,children:[(0,er.jsx)("input",{ref:_,type:"file",accept:"image/*,video/*",multiple:!0,className:"hidden",onChange:eu}),(0,er.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 px-4 py-8 text-center sm:px-6 sm:py-10",children:[(0,er.jsx)("div",{className:"rounded-full bg-white/10 p-4 text-white shadow-[0_12px_35px_rgba(236,72,153,0.35)]",children:(0,er.jsx)(fn,{className:"w-7 h-7"})}),(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)("p",{className:"text-base font-medium",children:"Drag & drop to upload"}),(0,er.jsxs)("p",{className:"text-sm text-white/60",children:["You can add up to ",5," photos or videos."]})]}),(0,er.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3 text-xs text-white/60",children:[(0,er.jsx)("span",{children:"Supported: JPG, PNG, MP4"}),(0,er.jsx)("span",{className:"hidden sm:inline",children:"|"}),(0,er.jsxs)("span",{children:["Recommended length ~ ",15,"s"]})]}),(0,er.jsx)(tn,{type:"button",onClick:()=>_.current?.click(),className:"rounded-full bg-white px-5 py-2 text-sm font-semibold text-purple-900 shadow-[0_12px_30px_rgba(148,63,255,0.35)] hover:bg-white/90",children:"Browse files"})]})]}),(0,er.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 sm:p-5 backdrop-blur space-y-3",children:[(0,er.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[(0,er.jsxs)(tn,{type:"button",onClick:()=>void ew(),disabled:O,className:"flex items-center gap-2 rounded-full bg-white px-4 py-2 text-sm font-semibold text-purple-900 shadow-[0_12px_30px_rgba(148,63,255,0.35)] transition duration-200 hover:bg-white/90 disabled:cursor-not-allowed disabled:opacity-70",children:[(0,er.jsx)(tg,{className:"h-4 w-4"}),O?"Camera Ready":"Use Camera"]}),(0,er.jsxs)(tn,{type:"button",variant:"outline",onClick:()=>void ev(),disabled:!O||L,className:"flex items-center gap-2 rounded-full border-white/40 bg-purple-900/30 px-4 py-2 text-sm text-white hover:bg-purple-800/50 disabled:opacity-60",children:[L?(0,er.jsx)(iV,{className:"h-4 w-4 animate-spin"}):(0,er.jsx)(tg,{className:"h-4 w-4"}),"Capture photo"]}),(0,er.jsxs)(tn,{type:"button",variant:G?"destructive":"outline",onClick:()=>{G?eb():ex()},disabled:!O||L,className:`flex items-center gap-2 rounded-full border-white/40 px-4 py-2 text-sm ${G?"bg-rose-500/30 text-white hover:bg-rose-500/40":"bg-purple-900/30 text-white hover:bg-purple-800/50"} disabled:opacity-60`,children:[G?(0,er.jsx)(hi,{className:"h-4 w-4"}):(0,er.jsx)(tu,{className:"h-4 w-4"}),G?"Stop recording":"Record video"]}),(0,er.jsx)(tn,{type:"button",variant:"ghost",onClick:()=>ey(),disabled:!O,className:"rounded-full px-4 py-2 text-sm text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-60",children:"Stop camera"})]}),G&&(0,er.jsxs)("div",{className:"text-xs uppercase tracking-[0.2em] text-amber-200",children:["Recording ",mx(K)," / ",mx(15)]}),P&&(0,er.jsx)("p",{className:"text-sm text-rose-200",children:P}),Y&&(0,er.jsx)("p",{className:"text-sm text-rose-200",children:Y}),O&&(0,er.jsx)("div",{className:"overflow-hidden rounded-2xl border border-white/20 bg-black/30 shadow-[0_18px_40px_rgba(124,58,237,0.35)]",children:(0,er.jsx)("video",{ref:U,autoPlay:!0,playsInline:!0,muted:!0,className:"h-48 w-full object-cover sm:h-64"})})]}),g.length>0&&(0,er.jsx)("div",{className:"grid gap-4 sm:grid-cols-2",children:g.map(e=>(0,er.jsxs)("div",{className:"group relative overflow-hidden rounded-2xl border border-white/15 bg-white/5 backdrop-blur-sm shadow-[0_18px_40px_rgba(124,58,237,0.35)]",children:["image"===e.type?(0,er.jsx)(ty,{src:e.url,alt:"Story preview",className:"h-48 w-full object-cover sm:h-56"}):(0,er.jsx)("video",{src:e.url,className:"h-48 w-full object-cover sm:h-56",controls:!0,playsInline:!0,muted:!0}),(0,er.jsxs)("div",{className:"absolute inset-x-0 bottom-0 flex items-center justify-between gap-2 bg-gradient-to-t from-black/80 via-black/40 to-transparent px-4 py-3 text-sm",children:[(0,er.jsx)("span",{className:"text-white/80 capitalize",children:e.type}),(0,er.jsx)(tn,{type:"button",variant:"ghost",size:"sm",onClick:()=>ek(e.id),className:"text-white/80 transition-colors duration-200 hover:text-white hover:bg-white/15",children:(0,er.jsx)(ha,{className:"w-4 h-4"})})]})]},e.id))}),j&&(0,er.jsx)("p",{className:"text-sm text-rose-200",children:j}),(0,er.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,er.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:gap-6",children:[e&&(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsxs)(s8,{className:"h-10 w-10 border border-white/25",children:[(0,er.jsx)(s7,{src:e.avatar}),(0,er.jsx)(s9,{children:e.name[0]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-sm font-medium text-white",children:e.name}),(0,er.jsxs)("p",{className:"text-xs text-white/60",children:["@",e.username]})]})]}),(0,er.jsx)("div",{className:"h-px w-full bg-white/10 sm:hidden"}),(0,er.jsx)("div",{className:"hidden sm:block sm:h-14 sm:w-px bg-white/15"}),(0,er.jsxs)("div",{className:"min-w-[200px] space-y-1 sm:flex sm:flex-col sm:justify-center sm:space-y-2",children:[(0,er.jsx)("p",{className:"text-xs uppercase tracking-[0.25em] text-white/50",children:"Visibility"}),(0,er.jsxs)(ml,{value:x,onValueChange:e=>y(e),children:[(0,er.jsx)(md,{className:"w-full border-white/20 bg-white/10 text-white hover:bg-white/15",children:(0,er.jsx)(mc,{placeholder:"Choose who can view"})}),(0,er.jsx)(mu,{className:"border-white/20 bg-slate-950/95 text-white backdrop-blur",children:my.map(e=>(0,er.jsx)(mh,{value:e.value,children:(0,er.jsxs)("div",{className:"flex flex-col",children:[(0,er.jsx)("span",{className:"text-sm font-medium",children:e.label}),(0,er.jsx)("span",{className:"text-xs text-white/60",children:e.description})]})},e.value))})]})]})]}),(0,er.jsxs)("div",{className:"flex flex-col gap-3 sm:items-end",children:[(0,er.jsxs)("span",{className:"text-xs text-white/60",children:[g.length," / ",5," items selected"]}),(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(tn,{type:"button",variant:"ghost",onClick:()=>eN(!1),className:"text-white/70 hover:text-white hover:bg-white/10",disabled:w,children:"Cancel"}),(0,er.jsx)(tn,{type:"button",onClick:()=>void eS(),disabled:w||0===g.length,className:"bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 px-6 py-2 text-sm font-semibold text-white shadow-[0_15px_40px_rgba(168,85,247,0.45)] transition-all duration-300 hover:brightness-110 disabled:opacity-60",children:w?"Posting...":"Share Story"})]})]})]})]})]})})}),(0,er.jsx)("style",{children:`
        .hide-scrollbar {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
        .hide-scrollbar::-webkit-scrollbar {
          display: none;
        }
        @keyframes progress {
          from { width: 0%; }
          to { width: 100%; }
        }
        .animate-progress {
          animation: progress 5s linear forwards;
        }
      `})]})}var mN=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),mS=es.forwardRef((e,t)=>(0,er.jsx)(mN.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));function m_({className:e,...t}){return(0,er.jsx)(mS,{"data-slot":"label",className:tr("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}function mC(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function mE(...e){return t=>{let r=!1,s=e.map(e=>{let s=mC(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():mC(e[t],null)}}}}function mR(e){let t=es.useRef(e);return es.useEffect(()=>{t.current=e}),es.useMemo(()=>(...e)=>t.current?.(...e),[])}mS.displayName="Label";var mA=globalThis?.document?es.useLayoutEffect:()=>{},mO=es.forwardRef((e,t)=>{let{children:r,...s}=e,n=es.Children.toArray(r),i=n.find(mM);if(i){let e=i.props.children,r=n.map(t=>t!==i?t:es.Children.count(e)>1?es.Children.only(null):es.isValidElement(e)?e.props.children:null);return(0,er.jsx)(mT,{...s,ref:t,children:es.isValidElement(e)?es.cloneElement(e,void 0,r):null})}return(0,er.jsx)(mT,{...s,ref:t,children:r})});mO.displayName="Slot";var mT=es.forwardRef((e,t)=>{let{children:r,...s}=e;if(es.isValidElement(r)){var n;let e,i,a=(n=r,(i=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(i=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),o=function(e,t){let r={...t};for(let s in t){let n=e[s],i=t[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...e)=>{i(...e),n(...e)}:n&&(r[s]=n):"style"===s?r[s]={...n,...i}:"className"===s&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==es.Fragment&&(o.ref=t?mE(t,a):a),es.cloneElement(r,o)}return es.Children.count(r)>1?es.Children.only(null):null});mT.displayName="SlotClone";var mI=({children:e})=>(0,er.jsx)(er.Fragment,{children:e});function mM(e){return es.isValidElement(e)&&e.type===mI}var mP=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=es.forwardRef((e,r)=>{let{asChild:s,...n}=e,i=s?mO:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(i,{...n,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),mD="Switch",[mL,m$]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(mD),[mU,mB]=mL(mD),mz=es.forwardRef((e,t)=>{let{__scopeSwitch:r,name:s,checked:n,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:d,...u}=e,[h,p]=es.useState(null),f=function(...e){return es.useCallback(mE(...e),e)}(t,e=>p(e)),m=es.useRef(!1),g=!h||d||!!h.closest("form"),[b=!1,x]=function({prop:e,defaultProp:t,onChange:r=()=>{}}){let[s,n]=function({defaultProp:e,onChange:t}){let r=es.useState(e),[s]=r,n=es.useRef(s),i=mR(t);return es.useEffect(()=>{n.current!==s&&(i(s),n.current=s)},[s,n,i]),r}({defaultProp:t,onChange:r}),i=void 0!==e,a=i?e:s,o=mR(r);return[a,es.useCallback(t=>{if(i){let r="function"==typeof t?t(e):t;r!==e&&o(r)}else n(t)},[i,e,n,o])]}({prop:n,defaultProp:i,onChange:c});return(0,er.jsxs)(mU,{scope:r,checked:b,disabled:o,children:[(0,er.jsx)(mP.button,{type:"button",role:"switch","aria-checked":b,"aria-required":a,"data-state":mW(b),"data-disabled":o?"":void 0,disabled:o,value:l,...u,ref:f,onClick:function(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}(e.onClick,e=>{x(e=>!e),g&&(m.current=e.isPropagationStopped(),m.current||e.stopPropagation())})}),g&&(0,er.jsx)(mH,{control:h,bubbles:!m.current,name:s,value:l,checked:b,required:a,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});mz.displayName=mD;var mq="SwitchThumb",mF=es.forwardRef((e,t)=>{let{__scopeSwitch:r,...s}=e,n=mB(mq,r);return(0,er.jsx)(mP.span,{"data-state":mW(n.checked),"data-disabled":n.disabled?"":void 0,...s,ref:t})});mF.displayName=mq;var mH=e=>{let t,{control:r,checked:s,bubbles:n=!0,...i}=e,a=es.useRef(null),o=(t=es.useRef({value:s,previous:s}),es.useMemo(()=>(t.current.value!==s&&(t.current.previous=t.current.value,t.current.value=s),t.current.previous),[s])),l=function(e){let[t,r]=es.useState(void 0);return mA(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,n;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,n=t.blockSize}else s=e.offsetWidth,n=e.offsetHeight;r({width:s,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}(r);return es.useEffect(()=>{let e=a.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(o!==s&&t){let r=new Event("click",{bubbles:n});t.call(e,s),e.dispatchEvent(r)}},[o,s,n]),(0,er.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...i,tabIndex:-1,ref:a,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function mW(e){return e?"checked":"unchecked"}function mG({className:e,...t}){return(0,er.jsx)(mz,{"data-slot":"switch",className:tr("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,er.jsx)(mF,{"data-slot":"switch-thumb",className:tr("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var mV=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),mK="horizontal",mJ=["horizontal","vertical"],mY=es.forwardRef((e,t)=>{var r;let{decorative:s,orientation:n=mK,...i}=e,a=(r=n,mJ.includes(r))?n:mK;return(0,er.jsx)(mV.div,{"data-orientation":a,...s?{role:"none"}:{"aria-orientation":"vertical"===a?a:void 0,role:"separator"},...i,ref:t})});function mX({className:e,orientation:t="horizontal",decorative:r=!0,...s}){return(0,er.jsx)(mY,{"data-slot":"separator-root",decorative:r,orientation:t,className:tr("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...s})}function mQ(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function mZ(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function m0(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=mZ(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():mZ(e[t],null)}}}}(...e),e)}mY.displayName="Separator","undefined"!=typeof window&&window.document&&window.document.createElement;var m1=globalThis?.document?es.useLayoutEffect:()=>{},m2=es[" useInsertionEffect ".trim().toString()]||m1;Symbol("RADIX:SYNC_STATE");var m4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),m5=["PageUp","PageDown"],m3=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],m6={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},m8="Slider",[m7,m9,ge]=nQ(m8),[gt,gr]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(m8,[ge]),[gs,gn]=gt(m8),gi=es.forwardRef((e,t)=>{let{name:r,min:s=0,max:n=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[s],value:d,onValueChange:u=()=>{},onValueCommit:h=()=>{},inverted:p=!1,form:f,...m}=e,g=es.useRef(new Set),b=es.useRef(0),x="horizontal"===a,[y=[],w]=function({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return m2(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}({prop:d,defaultProp:c,onChange:e=>{let t=[...g.current];t[b.current]?.focus(),u(e)}}),v=es.useRef(y);function j(e,t,{commit:r}={commit:!1}){let a,o=(String(i).split(".")[1]||"").length,c=nu(Math.round((Math.round((e-s)/i)*i+s)*(a=Math.pow(10,o)))/a,[s,n]);w((e=[])=>{let s=function(e=[],t,r){let s=[...e];return s[r]=t,s.sort((e,t)=>e-t)}(e,c,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,r)=>e[r+1]-t))>=t;return!0}(s,l*i))return e;{b.current=s.indexOf(c);let t=String(s)!==String(e);return t&&r&&h(s),t?s:e}})}return(0,er.jsx)(gs,{scope:e.__scopeSlider,name:r,disabled:o,min:s,max:n,valueIndexToChangeRef:b,thumbs:g.current,values:y,orientation:a,form:f,children:(0,er.jsx)(m7.Provider,{scope:e.__scopeSlider,children:(0,er.jsx)(m7.Slot,{scope:e.__scopeSlider,children:(0,er.jsx)(x?gl:gc,{"aria-disabled":o,"data-disabled":o?"":void 0,...m,ref:t,onPointerDown:mQ(m.onPointerDown,()=>{o||(v.current=y)}),min:s,max:n,inverted:p,onSlideStart:o?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let r=e.map(e=>Math.abs(e-t)),s=Math.min(...r);return r.indexOf(s)}(y,e);j(e,t)},onSlideMove:o?void 0:function(e){j(e,b.current)},onSlideEnd:o?void 0:function(){let e=v.current[b.current];y[b.current]!==e&&h(y)},onHomeKeyDown:()=>!o&&j(s,0,{commit:!0}),onEndKeyDown:()=>!o&&j(n,y.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!o){let r=m5.includes(e.key)||e.shiftKey&&m3.includes(e.key),s=b.current;j(y[s]+i*(r?10:1)*t,s,{commit:!0})}}})})})})});gi.displayName=m8;var[ga,go]=gt(m8,{startEdge:"left",endEdge:"right",size:"width",direction:1}),gl=es.forwardRef((e,t)=>{let{min:r,max:s,dir:n,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...d}=e,[u,h]=es.useState(null),p=m0(t,e=>h(e)),f=es.useRef(void 0),m=nc(n),g="ltr"===m,b=g&&!i||!g&&i;function x(e){let t=f.current||u.getBoundingClientRect(),n=gw([0,t.width],b?[r,s]:[s,r]);return f.current=t,n(e-t.left)}return(0,er.jsx)(ga,{scope:e.__scopeSlider,startEdge:b?"left":"right",endEdge:b?"right":"left",direction:b?1:-1,size:"width",children:(0,er.jsx)(gd,{dir:m,"data-orientation":"horizontal",...d,ref:p,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=x(e.clientX);a?.(t)},onSlideMove:e=>{let t=x(e.clientX);o?.(t)},onSlideEnd:()=>{f.current=void 0,l?.()},onStepKeyDown:e=>{let t=m6[b?"from-left":"from-right"].includes(e.key);c?.({event:e,direction:t?-1:1})}})})}),gc=es.forwardRef((e,t)=>{let{min:r,max:s,inverted:n,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,d=es.useRef(null),u=m0(t,d),h=es.useRef(void 0),p=!n;function f(e){let t=h.current||d.current.getBoundingClientRect(),n=gw([0,t.height],p?[s,r]:[r,s]);return h.current=t,n(e-t.top)}return(0,er.jsx)(ga,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:(0,er.jsx)(gd,{"data-orientation":"vertical",...c,ref:u,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=f(e.clientY);i?.(t)},onSlideMove:e=>{let t=f(e.clientY);a?.(t)},onSlideEnd:()=>{h.current=void 0,o?.()},onStepKeyDown:e=>{let t=m6[p?"from-bottom":"from-top"].includes(e.key);l?.({event:e,direction:t?-1:1})}})})}),gd=es.forwardRef((e,t)=>{let{__scopeSlider:r,onSlideStart:s,onSlideMove:n,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,d=gn(m8,r);return(0,er.jsx)(m4.span,{...c,ref:t,onKeyDown:mQ(e.onKeyDown,e=>{"Home"===e.key?(a(e),e.preventDefault()):"End"===e.key?(o(e),e.preventDefault()):m5.concat(m3).includes(e.key)&&(l(e),e.preventDefault())}),onPointerDown:mQ(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),d.thumbs.has(t)?t.focus():s(e)}),onPointerMove:mQ(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&n(e)}),onPointerUp:mQ(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),i(e))})})}),gu="SliderTrack",gh=es.forwardRef((e,t)=>{let{__scopeSlider:r,...s}=e,n=gn(gu,r);return(0,er.jsx)(m4.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...s,ref:t})});gh.displayName=gu;var gp="SliderRange",gf=es.forwardRef((e,t)=>{let{__scopeSlider:r,...s}=e,n=gn(gp,r),i=go(gp,r),a=m0(t,es.useRef(null)),o=n.values.length,l=n.values.map(e=>gy(e,n.min,n.max)),c=o>1?Math.min(...l):0,d=100-Math.max(...l);return(0,er.jsx)(m4.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...s,ref:a,style:{...e.style,[i.startEdge]:c+"%",[i.endEdge]:d+"%"}})});gf.displayName=gp;var gm="SliderThumb",gg=es.forwardRef((e,t)=>{let r=m9(e.__scopeSlider),[s,n]=es.useState(null),i=m0(t,e=>n(e)),a=es.useMemo(()=>s?r().findIndex(e=>e.ref.current===s):-1,[r,s]);return(0,er.jsx)(gb,{...e,ref:i,index:a})}),gb=es.forwardRef((e,t)=>{var r,s,n,i,a;let o,l,{__scopeSlider:c,index:d,name:u,...h}=e,p=gn(gm,c),f=go(gm,c),[m,g]=es.useState(null),b=m0(t,e=>g(e)),x=!m||p.form||!!m.closest("form"),y=function(e){let[t,r]=es.useState(void 0);return m1(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,n;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,n=t.blockSize}else s=e.offsetWidth,n=e.offsetHeight;r({width:s,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}(m),w=p.values[d],v=void 0===w?0:gy(w,p.min,p.max),j=(r=d,(s=p.values.length)>2?`Value ${r+1} of ${s}`:2===s?["Minimum","Maximum"][r]:void 0),k=y?.[f.size],N=k?(n=k,i=v,a=f.direction,l=gw([0,50],[0,o=n/2]),(o-l(i)*a)*a):0;return es.useEffect(()=>{if(m)return p.thumbs.add(m),()=>{p.thumbs.delete(m)}},[m,p.thumbs]),(0,er.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[f.startEdge]:`calc(${v}% + ${N}px)`},children:[(0,er.jsx)(m7.ItemSlot,{scope:e.__scopeSlider,children:(0,er.jsx)(m4.span,{role:"slider","aria-label":e["aria-label"]||j,"aria-valuemin":p.min,"aria-valuenow":w,"aria-valuemax":p.max,"aria-orientation":p.orientation,"data-orientation":p.orientation,"data-disabled":p.disabled?"":void 0,tabIndex:p.disabled?void 0:0,...h,ref:b,style:void 0===w?{display:"none"}:e.style,onFocus:mQ(e.onFocus,()=>{p.valueIndexToChangeRef.current=d})})}),x&&(0,er.jsx)(gx,{name:u??(p.name?p.name+(p.values.length>1?"[]":""):void 0),form:p.form,value:w},d)]})});gg.displayName=gm;var gx=es.forwardRef(({__scopeSlider:e,value:t,...r},s)=>{let n,i=es.useRef(null),a=m0(i,s),o=(n=es.useRef({value:t,previous:t}),es.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t]));return es.useEffect(()=>{let e=i.current;if(!e)return;let r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(o!==t&&r){let s=new Event("input",{bubbles:!0});r.call(e,t),e.dispatchEvent(s)}},[o,t]),(0,er.jsx)(m4.input,{style:{display:"none"},...r,ref:a,defaultValue:t})});function gy(e,t,r){return nu(100/(r-t)*(e-t),[0,100])}function gw(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}function gv({className:e,defaultValue:t,value:r,min:s=0,max:n=100,...i}){let a=es.useMemo(()=>Array.isArray(r)?r:Array.isArray(t)?t:[s,n],[r,t,s,n]);return(0,er.jsxs)(gi,{"data-slot":"slider",defaultValue:t,value:r,min:s,max:n,className:tr("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[(0,er.jsx)(gh,{"data-slot":"slider-track",className:tr("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,er.jsx)(gf,{"data-slot":"slider-range",className:tr("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(e,t)=>(0,er.jsx)(gg,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},t))]})}gx.displayName="RadioBubbleInput";let gj=tc("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),gk=tc("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),gN=tc("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),gS=tc("circle-help",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),g_=tc("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),gC=tc("palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),gE=tc("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),gR=tc("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),gA=tc("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),gO=new class{permission="default";supported=!1;constructor(){const e=this.getNotificationAPI();this.supported=!!e,e&&(this.permission=e.permission)}getNotificationAPI(){return window.Notification}isSupported(){return this.supported}getPermission(){return this.permission}async requestPermission(){if(!this.supported)return console.warn("Notifications are not supported in this browser"),"denied";let e=this.getNotificationAPI();if(!e)return console.warn("Notification API is not available"),"denied";try{if("default"===e.permission){let t=await new Promise(t=>{0===e.requestPermission.length?e.requestPermission().then(t):e.requestPermission(t)});return this.permission=t,t}return this.permission=e.permission,e.permission}catch(e){return console.error("Error requesting notification permission:",e),"denied"}}async show(e){if(!this.supported)return console.warn("Notifications are not supported"),null;let t=this.getNotificationAPI();if(!t)return console.warn("Notification API is not available"),null;if("granted"!==this.permission&&"granted"!==await this.requestPermission())return console.warn("Notification permission denied"),null;try{let r=new t(e.title,{body:e.body,icon:e.icon||"/favicon.ico",tag:e.tag,requireInteraction:e.requireInteraction||!1,badge:e.icon,silent:!1});return e.onClick&&(r.onclick=t=>{t.preventDefault(),e.onClick?.(),r.close()}),r}catch(e){return console.error("Error showing notification:",e),null}}async showSimple(e,t,r){return this.show({title:e,body:t,onClick:r})}};function gT({onClose:e,onLogout:t,initialTab:r,onOpenHelpCenter:s,onOpenPrivacyPolicy:n,onOpenTermsOfService:i}){let{currentUser:a,updateUser:o,updateSettings:l,changePassword:c}=ai(),{setTheme:d}=(0,en.useTheme)(),[u,h]=(0,es.useState)({name:"",email:"",phoneNumber:"",location:"",bio:""}),[p,f]=(0,es.useState)(!1),[m,g]=(0,es.useState)(()=>({...aa})),[b,x]=(0,es.useState)(at(aa.theme)),[y,w]=(0,es.useState)(!1),[v,j]=(0,es.useState)("default"),[k,N]=(0,es.useState)(!1),S=(0,es.useRef)(null),[_,C]=(0,es.useState)(!1),[E,R]=(0,es.useState)(!1),[A,O]=(0,es.useState)({oldPassword:"",newPassword:"",confirmPassword:""});(0,es.useEffect)(()=>{gO.isSupported()&&j(gO.getPermission())},[]),(0,es.useEffect)(()=>{if(!a)return;let e={...aa,...a.settings??{}},t=at(a.settings?.theme),r=al(e.fontSize);e.theme=t,e.fontSize=r,e.language="en",g(e),x(t),p||h({name:a.name??"",email:a.email??"",phoneNumber:e.phoneNumber??"",location:a.location??"",bio:a.bio??""})},[a,p]),(0,es.useEffect)(()=>{let e=()=>{d(ar(b))};if(e(),"dynamic"===b){let t=setInterval(e,6e5);return()=>clearInterval(t)}},[b,d]),(0,es.useEffect)(()=>()=>{S.current&&clearTimeout(S.current)},[]),(0,es.useEffect)(()=>{_||(O({oldPassword:"",newPassword:"",confirmPassword:""}),R(!1))},[_]);let T=(0,es.useCallback)((e,t)=>{let r="fontSize"===e?al("string"==typeof t?t:void 0):"language"===e?"en":"theme"===e&&"string"==typeof t?at(t):t;return g(t=>({...t,[e]:r})),l({[e]:r})},[l]),I=(0,es.useCallback)(e=>{let t=at(e);x(t),g(e=>({...e,theme:t})),d(ar(t)),l({theme:t})},[d,l]),M=(0,es.useCallback)(e=>{let t=Math.max(0,Math.min(100,e[0]??0));g(e=>({...e,soundVolume:t})),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{l({soundVolume:t})},300)},[l]),P=(0,es.useCallback)(e=>t=>{let r=t.target.value;O(t=>({...t,[e]:r}))},[]),D=(0,es.useCallback)(async e=>{e.preventDefault();let{oldPassword:t,newPassword:r,confirmPassword:s}=A;if(!t||!r||!s)return void i5.error("Please complete every password field");if(r.length<8)return void i5.error("New password must be at least 8 characters long");if(r===t)return void i5.error("New password must be different from the old password");if(r!==s)return void i5.error("New password and confirmation do not match");R(!0);let n=await c(t,r);if(!n.success){i5.error(n.error??"Unable to change password right now"),R(!1);return}i5.success("Password updated successfully"),C(!1),R(!1)},[A,c]),L=e=>t=>{let r=t.target.value;f(!0),h(t=>({...t,[e]:r}))},$=async()=>{if(!a)return void i5.error("No user is signed in");w(!0);try{let e=await o({name:u.name,email:u.email,location:u.location,bio:u.bio});g(e=>({...e,phoneNumber:u.phoneNumber})),await l({phoneNumber:u.phoneNumber}),e?(f(!1),i5.success("Settings saved successfully! ")):i5.error("Unable to save account changes")}catch(e){console.error("Error saving account settings:",e),i5.error("Unable to save settings right now")}finally{w(!1)}},U=(0,es.useCallback)(async()=>{N(!0);try{let e=await gO.requestPermission();j(e),"granted"===e?(i5.success("Browser notifications enabled! "),await gO.showSimple("MoveSplash","You will now receive browser notifications!"),T("pushNotifications",!0)):"denied"===e&&(i5.error("Browser notifications blocked. Please enable them in your browser settings."),T("pushNotifications",!1))}catch(e){console.error("Error requesting notification permission:",e),i5.error("Unable to enable browser notifications")}finally{N(!1)}},[T]);return a?(0,er.jsx)("div",{className:"max-w-5xl mx-auto",children:(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 overflow-hidden",children:[(0,er.jsxs)("div",{className:"p-6 border-b border-white/20 flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-500 rounded-xl flex items-center justify-center",children:(0,er.jsx)(gj,{className:"w-5 h-5 text-white"})}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h1",{className:"text-white text-2xl",children:"Settings"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Manage your account and preferences"})]})]}),e&&(0,er.jsx)(tn,{variant:"ghost",size:"sm",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10",children:(0,er.jsx)(iH,{className:"w-5 h-5"})})]}),(0,er.jsxs)(iD,{defaultValue:r??"account",className:"w-full",children:[(0,er.jsx)("div",{className:"px-6 pt-4 border-b border-white/20",children:(0,er.jsxs)(iL,{className:"w-full bg-white/5 border-white/20 grid grid-cols-5",children:[(0,er.jsxs)(i$,{value:"account",className:"data-[state=active]:bg-white/20",children:[(0,er.jsx)(gj,{className:"w-4 h-4 mr-2"}),"Account"]}),(0,er.jsxs)(i$,{value:"privacy",className:"data-[state=active]:bg-white/20",children:[(0,er.jsx)(gk,{className:"w-4 h-4 mr-2"}),"Privacy"]}),(0,er.jsxs)(i$,{value:"notifications",className:"data-[state=active]:bg-white/20",children:[(0,er.jsx)(iq,{className:"w-4 h-4 mr-2"}),"Notifications"]}),(0,er.jsxs)(i$,{value:"appearance",className:"data-[state=active]:bg-white/20",children:[(0,er.jsx)(gC,{className:"w-4 h-4 mr-2"}),"Appearance"]}),(0,er.jsxs)(i$,{value:"about",className:"data-[state=active]:bg-white/20",children:[(0,er.jsx)(g_,{className:"w-4 h-4 mr-2"}),"About"]})]})}),(0,er.jsxs)(nG,{className:"h-[500px]",children:[(0,er.jsxs)(iU,{value:"account",className:"p-6 space-y-6",children:[(0,er.jsxs)("div",{className:"space-y-3",children:[(0,er.jsx)(m_,{className:"text-white",children:"Profile Picture"}),(0,er.jsxs)("div",{className:"flex items-center gap-4",children:[(0,er.jsxs)(s8,{className:"w-20 h-20 border-4 border-white/20",children:[(0,er.jsx)(s7,{src:a.avatar}),(0,er.jsx)(s9,{children:a.name?.slice(0,2).toUpperCase()||"MS"})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsxs)(tn,{className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0",children:[(0,er.jsx)(tg,{className:"w-4 h-4 mr-2"}),"Change Photo"]}),(0,er.jsx)("p",{className:"text-white/50 text-xs",children:"JPG, PNG or GIF. Max size 5MB"})]})]})]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Personal Information"}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{htmlFor:"name",className:"text-white/70",children:"Full Name"}),(0,er.jsx)(cV,{id:"name",value:u.name,onChange:L("name"),className:"bg-white/5 border-white/20 text-white"})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{htmlFor:"email",className:"text-white/70",children:"Email"}),(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsx)(lR,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/50"}),(0,er.jsx)(cV,{id:"email",type:"email",value:u.email,onChange:L("email"),className:"pl-10 bg-white/5 border-white/20 text-white"})]})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{htmlFor:"phone",className:"text-white/70",children:"Phone Number"}),(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsx)(u0,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/50"}),(0,er.jsx)(cV,{id:"phone",value:u.phoneNumber,onChange:L("phoneNumber"),className:"pl-10 bg-white/5 border-white/20 text-white"})]})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{htmlFor:"location",className:"text-white/70",children:"Location"}),(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsx)(gE,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/50"}),(0,er.jsx)(cV,{id:"location",value:u.location,onChange:L("location"),className:"pl-10 bg-white/5 border-white/20 text-white"})]})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{htmlFor:"bio",className:"text-white/70",children:"Bio"}),(0,er.jsx)(cV,{id:"bio",value:u.bio,onChange:L("bio"),className:"bg-white/5 border-white/20 text-white"})]})]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Password"}),(0,er.jsxs)(lb,{open:_,onOpenChange:C,children:[(0,er.jsx)(lx,{asChild:!0,children:(0,er.jsxs)(tn,{variant:"ghost",className:"text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(gk,{className:"w-4 h-4 mr-2"}),"Change Password"]})}),(0,er.jsxs)(lj,{className:"bg-background/95 text-foreground border border-border backdrop-blur",children:[(0,er.jsxs)(lk,{children:[(0,er.jsx)(lS,{children:"Change password"}),(0,er.jsx)(l_,{children:"Enter your current password and choose a new one. Pick something unique to keep your account secure."})]}),(0,er.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{htmlFor:"current-password",className:"text-sm font-medium text-foreground/80",children:"Current password"}),(0,er.jsx)(cV,{id:"current-password",type:"password",value:A.oldPassword,onChange:P("oldPassword"),autoComplete:"current-password",className:"bg-input-background border border-border text-foreground",required:!0})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{htmlFor:"new-password",className:"text-sm font-medium text-foreground/80",children:"New password"}),(0,er.jsx)(cV,{id:"new-password",type:"password",value:A.newPassword,onChange:P("newPassword"),autoComplete:"new-password",className:"bg-input-background border border-border text-foreground",required:!0,minLength:8})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{htmlFor:"confirm-password",className:"text-sm font-medium text-foreground/80",children:"Confirm new password"}),(0,er.jsx)(cV,{id:"confirm-password",type:"password",value:A.confirmPassword,onChange:P("confirmPassword"),autoComplete:"new-password",className:"bg-input-background border border-border text-foreground",required:!0,minLength:8}),(0,er.jsx)("p",{className:"text-foreground/60 text-xs",children:"Passwords must be at least 8 characters long."})]}),(0,er.jsxs)(lN,{children:[(0,er.jsx)(lw,{asChild:!0,children:(0,er.jsx)(tn,{type:"button",variant:"ghost",disabled:E,children:"Cancel"})}),(0,er.jsx)(tn,{type:"submit",disabled:E,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 disabled:opacity-60",children:E?"Updating...":"Update Password"})]})]})]})]})]}),(0,er.jsx)("div",{className:"flex gap-3 pt-4",children:(0,er.jsxs)(tn,{onClick:$,disabled:y,className:"flex-1 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 disabled:opacity-60",children:[(0,er.jsx)(gR,{className:"w-4 h-4 mr-2"}),y?"Saving...":"Save Changes"]})})]}),(0,er.jsxs)(iU,{value:"privacy",className:"p-6 space-y-6",children:[(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Profile Visibility"}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Who can see your profile?"}),(0,er.jsxs)(ml,{value:m.profileVisibility,onValueChange:e=>void T("profileVisibility",e),children:[(0,er.jsx)(md,{className:"bg-white/5 border-white/20 text-white",children:(0,er.jsx)(mc,{})}),(0,er.jsxs)(mu,{className:"bg-gradient-to-br from-purple-900 to-pink-900 border-white/20",children:[(0,er.jsx)(mh,{value:"public",children:"Everyone"}),(0,er.jsx)(mh,{value:"friends",children:"Friends Only"}),(0,er.jsx)(mh,{value:"private",children:"Only Me"})]})]})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Who can message you?"}),(0,er.jsxs)(ml,{value:m.whoCanMessage,onValueChange:e=>void T("whoCanMessage",e),children:[(0,er.jsx)(md,{className:"bg-white/5 border-white/20 text-white",children:(0,er.jsx)(mc,{})}),(0,er.jsxs)(mu,{className:"bg-gradient-to-br from-purple-900 to-pink-900 border-white/20",children:[(0,er.jsx)(mh,{value:"everyone",children:"Everyone"}),(0,er.jsx)(mh,{value:"friends",children:"Friends Only"}),(0,er.jsx)(mh,{value:"nobody",children:"Nobody"})]})]})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Who can call you?"}),(0,er.jsxs)(ml,{value:m.whoCanCall,onValueChange:e=>void T("whoCanCall",e),children:[(0,er.jsx)(md,{className:"bg-white/5 border-white/20 text-white",children:(0,er.jsx)(mc,{})}),(0,er.jsxs)(mu,{className:"bg-gradient-to-br from-purple-900 to-pink-900 border-white/20",children:[(0,er.jsx)(mh,{value:"everyone",children:"Everyone"}),(0,er.jsx)(mh,{value:"friends",children:"Friends Only"}),(0,er.jsx)(mh,{value:"nobody",children:"Nobody"})]})]})]})]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Activity Status"}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Show online status"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Let friends see when you're online"})]}),(0,er.jsx)(mG,{checked:m.showOnlineStatus,onCheckedChange:e=>void T("showOnlineStatus",e)})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Read receipts"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Show when you've read messages"})]}),(0,er.jsx)(mG,{checked:m.showReadReceipts,onCheckedChange:e=>void T("showReadReceipts",e)})]})]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Tagging & Mentions"}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Allow tagging"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Let friends tag you in posts and photos"})]}),(0,er.jsx)(mG,{checked:m.allowTagging,onCheckedChange:e=>void T("allowTagging",e)})]})]})]}),(0,er.jsxs)(iU,{value:"notifications",className:"p-6 space-y-6",children:[gO.isSupported()&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/5 border-white/20 p-4",children:(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-500 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,er.jsx)(iq,{className:"w-5 h-5 text-white"})}),(0,er.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,er.jsx)("h4",{className:"text-white",children:"Browser Notifications"}),"granted"===v&&(0,er.jsxs)(iz,{className:"bg-green-500/20 text-green-400 border-green-400/30",children:[(0,er.jsx)(iW,{className:"w-3 h-3 mr-1"}),"Enabled"]}),"denied"===v&&(0,er.jsxs)(iz,{className:"bg-red-500/20 text-red-400 border-red-400/30",children:[(0,er.jsx)(iH,{className:"w-3 h-3 mr-1"}),"Blocked"]}),"default"===v&&(0,er.jsxs)(iz,{className:"bg-yellow-500/20 text-yellow-400 border-yellow-400/30",children:[(0,er.jsx)(gA,{className:"w-3 h-3 mr-1"}),"Not Set"]})]}),(0,er.jsx)("p",{className:"text-white/60 text-sm mb-3",children:"granted"===v?"You will receive browser notifications for new messages, calls, and updates.":"denied"===v?"Browser notifications are blocked. Please enable them in your browser settings.":"Enable browser notifications to stay updated even when MoveSplash is not open."}),"granted"!==v&&(0,er.jsxs)(tn,{onClick:U,disabled:k||"denied"===v,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 text-sm disabled:opacity-50",children:[(0,er.jsx)(iq,{className:"w-4 h-4 mr-2"}),k?"Requesting...":"Enable Browser Notifications"]})]})]})}),(0,er.jsx)(mX,{className:"bg-white/10"})]}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Notification Channels"}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Push Notifications"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Receive notifications on your device"})]}),(0,er.jsx)(mG,{"data-testid":"toggle-push-notifications",checked:m.pushNotifications,onCheckedChange:e=>{e&&gO.isSupported()&&"granted"!==v?U():T("pushNotifications",e)}})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Email Notifications"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Receive updates via email"})]}),(0,er.jsx)(mG,{checked:m.emailNotifications,onCheckedChange:e=>void T("emailNotifications",e)})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"SMS Notifications"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Receive text message alerts"})]}),(0,er.jsx)(mG,{checked:m.smsNotifications,onCheckedChange:e=>void T("smsNotifications",e)})]})]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Activity Alerts"}),[["notifyLikes","Likes","Alerts when someone likes your posts"],["notifyComments","Comments","Stay updated on new comments"],["notifyMessages","Messages","Never miss a direct message"],["notifyFriendRequests","Friend Requests","Know when someone wants to connect"],["notifyStories","Stories","Updates when friends post new stories"]].map(([e,t,r])=>(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:t}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:r})]}),(0,er.jsx)(mG,{checked:m[e],onCheckedChange:t=>void T(e,t)})]},e))]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Sound & Alerts"}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Notification Sounds"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Play sounds for new notifications"})]}),(0,er.jsx)(mG,{checked:m.soundEnabled,onCheckedChange:e=>void T("soundEnabled",e)})]}),(0,er.jsxs)("div",{className:"space-y-3",children:[(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2 text-white/70",children:[(0,er.jsx)(fi,{className:"w-4 h-4"}),(0,er.jsx)("span",{children:"Volume"})]}),(0,er.jsxs)(iz,{className:"bg-white/10 text-white border-white/20",children:[m.soundVolume,"%"]})]}),(0,er.jsx)(gv,{value:[m.soundVolume],onValueChange:M})]})]})]}),(0,er.jsxs)(iU,{value:"appearance",className:"p-6 space-y-6",children:[(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Theme"}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Color Theme"}),(0,er.jsxs)(ml,{value:b,onValueChange:I,children:[(0,er.jsx)(md,{className:"bg-white/5 border-white/20 text-white",children:(0,er.jsx)(mc,{})}),(0,er.jsx)(mu,{className:"bg-gradient-to-br from-purple-900 to-pink-900 border-white/20",children:ae.map(e=>(0,er.jsx)(mh,{value:e.value,children:e.label},e.value))})]})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Font Size"}),(0,er.jsxs)(ml,{value:m.fontSize,onValueChange:e=>void T("fontSize",e),children:[(0,er.jsx)(md,{className:"bg-white/5 border-white/20 text-white",children:(0,er.jsx)(mc,{})}),(0,er.jsxs)(mu,{className:"bg-gradient-to-br from-purple-900 to-pink-900 border-white/20",children:[(0,er.jsx)(mh,{value:"small",children:"Small"}),(0,er.jsx)(mh,{value:"medium",children:"Medium"}),(0,er.jsx)(mh,{value:"large",children:"Large"})]})]})]}),(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Language"}),(0,er.jsxs)(ml,{value:"en",disabled:!0,children:[(0,er.jsx)(md,{className:"bg-white/5 border-white/20 text-white",disabled:!0,children:(0,er.jsx)(mc,{placeholder:"English"})}),(0,er.jsx)(mu,{className:"bg-gradient-to-br from-purple-900 to-pink-900 border-white/20",children:(0,er.jsx)(mh,{value:"en",children:"English"})})]}),(0,er.jsx)("p",{className:"text-white/50 text-xs",children:"English is the only available language right now."})]})]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"Accessibility"}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Auto-play videos"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Videos play automatically in feed"})]}),(0,er.jsx)(mG,{"data-testid":"toggle-auto-play",checked:m.autoPlayVideos,onCheckedChange:e=>void T("autoPlayVideos",e)})]}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"space-y-1",children:[(0,er.jsx)(m_,{className:"text-white/70",children:"Reduce animations"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"Minimize motion effects"})]}),(0,er.jsx)(mG,{"data-testid":"toggle-reduce-animations",checked:m.reduceAnimations,onCheckedChange:e=>void T("reduceAnimations",e)})]})]})]}),(0,er.jsxs)(iU,{value:"about",className:"p-6 space-y-6",children:[(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white",children:"MoveSplash"}),(0,er.jsx)("p",{className:"text-white/70",children:"Version 1.0.0"}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:"A Gen Z-focused social media platform with glassmorphism design, real-time messaging, video chat, and disappearing stories."})]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:s,className:"w-full justify-start text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-40",disabled:!s,children:[(0,er.jsx)(gS,{className:"w-4 h-4 mr-2"}),"Help Center"]}),(0,er.jsxs)(tn,{variant:"ghost",onClick:n,className:"w-full justify-start text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-40",disabled:!n,children:[(0,er.jsx)(gN,{className:"w-4 h-4 mr-2"}),"Privacy Policy"]}),(0,er.jsxs)(tn,{variant:"ghost",onClick:i,className:"w-full justify-start text-white/70 hover:text-white hover:bg-white/10 disabled:opacity-40",disabled:!i,children:[(0,er.jsx)(g_,{className:"w-4 h-4 mr-2"}),"Terms of Service"]})]}),(0,er.jsx)(mX,{className:"bg-white/10"}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)("h3",{className:"text-white text-red-400",children:"Danger Zone"}),t&&(0,er.jsxs)(tn,{variant:"ghost",onClick:t,className:"w-full justify-start text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(av,{className:"w-4 h-4 mr-2"}),"Log Out"]}),(0,er.jsxs)(tn,{variant:"ghost",onClick:()=>{i5.error("Account deletion requires confirmation")},className:"w-full justify-start text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[(0,er.jsx)(ha,{className:"w-4 h-4 mr-2"}),"Delete Account"]})]})]})]})]})]})}):(0,er.jsx)("div",{className:"max-w-5xl mx-auto",children:(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6 text-white",children:[(0,er.jsx)("h2",{className:"text-xl font-semibold",children:"Settings unavailable"}),(0,er.jsx)("p",{className:"text-white/70 text-sm mt-2",children:"Please sign in to manage your MoveSplash preferences."})]})})}let gI=tc("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),gM=tc("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),gP=tc("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),gD=tc("trending-up",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),gL={Award:gP,TrendingUp:gD,Camera:tg,Users:th,Star:u3,MessageCircle:td,Zap:tp,Calendar:gM};function g$({onShareToMessages:e,profileUserId:t=null,isLoading:r=!1,onBackToFriends:s}={}){let{currentUser:n,profileUser:i,profileUserId:a,allUsers:o,updateUser:l,addPost:c,deletePost:d,likePost:u,sharePost:h,getUserStats:p,getAchievements:f,loadUserData:m,loadProfileUser:g,fetchComments:b,addComment:x}=ai(),[y,w]=(0,es.useState)(!1),v=i??n,[j,k]=(0,es.useState)(v?.name||""),[N,S]=(0,es.useState)(v?.bio||""),[_,C]=(0,es.useState)(v?.location||""),[E,R]=(0,es.useState)(v?.website||""),[A,O]=(0,es.useState)(""),[T,I]=(0,es.useState)(!1),[M,P]=(0,es.useState)([]),D=n?.id??null,L=!!(v&&D&&v.id===D),[$,U]=(0,es.useState)({}),[B,z]=(0,es.useState)({}),[q,F]=(0,es.useState)(null),[H,W]=(0,es.useState)(!1),G=(0,es.useRef)(null),V=(0,es.useRef)(null);(0,es.useEffect)(()=>{t&&a!==t&&g(t)},[t,a,g]),(0,es.useEffect)(()=>{v&&!y&&(k(v.name||""),S(v.bio||""),C(v.location||""),R(v.website||""))},[v,y]),(0,es.useEffect)(()=>{v?U(e=>{let t={};v.posts.forEach(r=>{let s={likes:r.likes,liked:!!D&&r.likedBy.includes(D),dirty:!1},n=e[r.id];if(n?.dirty){let e=n.likes===s.likes&&n.liked===s.liked;t[r.id]=e?s:n}else n&&!n.dirty&&n.likes===s.likes&&n.liked===s.liked?t[r.id]=n:t[r.id]=s});let r=Object.keys(e),s=Object.keys(t);return r.length===s.length&&s.every(r=>e[r]===t[r])?e:t}):U({})},[v,D]),(0,es.useEffect)(()=>{v?z(e=>{let t={};return v.posts.forEach(r=>{let s=e[r.id];s&&(t[r.id]=s)}),t}):z({})},[v]);let K=(0,es.useMemo)(()=>v?v.posts.reduce((e,t)=>{let r=$[t.id];return r?e+(r.likes-t.likes):e},0):0,[v,$]),J=(0,es.useMemo)(()=>Array.from(o.values()),[o]),Y=(0,es.useMemo)(()=>{if(!v)return{totalPosts:0,totalFriends:0,totalLikes:0,rank:0};if(L)return p();let e=v.posts.length,t=v.friendIds.length,r=v.posts.reduce((e,t)=>e+t.likes,0),s=10*e+r+5*t,n=J.map(e=>{let t=e.posts.reduce((e,t)=>e+t.likes,0);return{id:e.id,score:10*e.posts.length+t+5*e.friendIds.length}}).sort((e,t)=>t.score-e.score),i=n.findIndex(e=>e.id===v.id);return{totalPosts:e,totalFriends:t,totalLikes:r,rank:i>=0?i+1:n.filter(e=>e.score>=s).length+1}},[J,v,p,L]);if(r||!v&&(t??a))return(0,er.jsx)("div",{className:"h-[calc(100vh-80px)] flex items-center justify-center",children:(0,er.jsxs)(ak,{className:"px-6 py-4 bg-white/10 border-white/20 text-white/80 flex items-center gap-3",children:[(0,er.jsx)(iV,{className:"w-5 h-5 animate-spin"}),(0,er.jsx)("span",{children:"Loading profile..."})]})});if(!v)return n?(0,er.jsx)("div",{className:"h-[calc(100vh-80px)] flex items-center justify-center",children:(0,er.jsxs)(ak,{className:"px-6 py-8 bg-white/10 border-white/20 text-center text-white/80 space-y-4",children:[(0,er.jsx)("p",{children:"We couldnt find that profile."}),s&&(0,er.jsx)(tn,{onClick:s,className:"bg-white/10 hover:bg-white/20 text-white border-white/20",children:"Back to Friends"})]})}):(0,er.jsx)("div",{className:"h-[calc(100vh-80px)] flex items-center justify-center",children:(0,er.jsx)("p",{className:"text-white",children:"Please log in to view your profile"})});let X=L?f():[],Q=Math.max(Y.totalLikes+K,0),Z=new Date(v.joinedAt).toLocaleDateString("en-US",{month:"long",year:"numeric"}),ee=[{label:"Posts",value:Y.totalPosts,icon:td},{label:"Friends",value:Y.totalFriends,icon:th},{label:"Likes",value:Q>=1e6?(Q/1e6).toFixed(1)+"M":Q>=1e3?(Q/1e3).toFixed(1)+"K":Q.toString(),icon:tm},{label:"Rank",value:`#${Y.rank}`,icon:gD}],et=async()=>{v&&L&&(await l({name:j,bio:N,location:_,website:E})?(await m(v.id)||console.warn("Profile refresh from Supabase failed; continuing with local state"),await g(v.id),w(!1),i5.success("Profile updated! ")):i5.error("Unable to update profile right now. Please try again."))},en=async t=>{if(!q||!v||H)return;if(!D)return void i5.info("Sign in to share posts.");let r=lM(q.memberId,q.userpostId),s=lP(q.authorName,q.text),n=`${s}

${r}`,i=lD(q),a=!1,o=e=>{window.open(e,"_blank","noopener,noreferrer")};switch(t){case"copy":try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(n);else{let e=document.createElement("textarea");e.value=n,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e)}i5.success("Post link copied!"),a=!0}catch(e){console.error("Unable to copy link:",e),i5.error("Unable to copy the link. Please try again.")}break;case"facebook":o(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(r)}`),i5.info("Opening Facebook share"),a=!0;break;case"twitter":o(`https://twitter.com/intent/tweet?text=${encodeURIComponent(`${s} ${r}`)}`),i5.info("Opening X (Twitter)"),a=!0;break;case"whatsapp":o(`https://wa.me/?text=${encodeURIComponent(n)}`),i5.info("Launching WhatsApp"),a=!0;break;case"telegram":o(`https://t.me/share/url?url=${encodeURIComponent(r)}&text=${encodeURIComponent(s)}`),i5.info("Opening Telegram"),a=!0;break;case"email":{let e=`mailto:?subject=${encodeURIComponent("Check this MoveYSplash post")}&body=${encodeURIComponent(n)}`;window.location.href=e,i5.info("Composing email"),a=!0;break}case"movesplash":e?.({message:i,postId:q.userpostId,postOwnerId:q.memberId}),i5.success("Draft ready in MoveYSplash Messages "),a=!0;break;case"web":if(navigator.share)try{await navigator.share({title:`${q.authorName} on MoveYSplash`,text:s,url:r}),i5.success("Shared successfully! "),a=!0}catch(e){e instanceof DOMException&&"AbortError"===e.name?i5.info("Share cancelled."):(console.error("Web share failed:",e),i5.error("Unable to share via your device."))}else i5.info("Device share sheet is not available.")}if(a){W(!0);try{await h(q.memberId,q.userpostId,{platform:t,sharerUserId:D,message:i})}catch(e){console.error("Error syncing share count:",e)}finally{W(!1),F(null)}}},ei=async e=>{let t=B[e.id],r=!t?.isOpen,s=t?.hasLoaded??!1;if(z(t=>{let n=t[e.id],i=n?{...n,isOpen:!n.isOpen,isLoading:r&&!s,error:null}:{isOpen:!0,isLoading:!0,isSubmitting:!1,hasLoaded:!1,comments:[],input:"",error:null};return{...t,[e.id]:i}}),r&&!s)try{let t=await b(e.userId,e.id);z(r=>{let s=r[e.id];return s?{...r,[e.id]:{...s,isLoading:!1,hasLoaded:!0,comments:t}}:r})}catch(t){console.error("Error loading comments:",t),z(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,isLoading:!1,hasLoaded:!0,error:"Unable to load comments right now."}}:t})}},ea=async e=>{let t=B[e.id];if(!t||t.isSubmitting)return;if(!D)return void i5.info("Please log in to comment.");let r=t.input.trim();if(!r)return void z(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,error:"Please enter a comment before posting."}}:t});z(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,isSubmitting:!0,error:null}}:t});let s=await x(e.userId,e.id,r);s?z(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,isSubmitting:!1,hasLoaded:!0,comments:[...r.comments,s.comment],input:"",error:null}}:t}):z(t=>{let r=t[e.id];return r?{...t,[e.id]:{...r,isSubmitting:!1,error:"Unable to post your comment right now."}}:t})};return(0,er.jsxs)("div",{className:"h-[calc(100vh-80px)] overflow-hidden",children:[(0,er.jsx)(nG,{className:"h-full",children:(0,er.jsxs)("div",{className:"max-w-5xl mx-auto space-y-6 pb-8",children:[!L&&s&&(0,er.jsx)("div",{className:"flex justify-end",children:(0,er.jsx)(tn,{onClick:s,variant:"outline",className:"bg-white/10 border-white/20 text-white hover:bg-white/20",children:"Back to Friends"})}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 overflow-hidden",children:[(0,er.jsx)("div",{className:"h-48 bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 relative",children:(0,er.jsx)("div",{className:"absolute inset-0 bg-black/20"})}),(0,er.jsxs)("div",{className:"p-6 relative",children:[(0,er.jsx)("div",{className:"absolute -top-20 left-6",children:(0,er.jsxs)("div",{className:"relative group",children:[(0,er.jsxs)(s8,{className:"w-32 h-32 border-4 border-white/20 backdrop-blur-xl bg-white/10",children:[(0,er.jsx)(s7,{src:v.avatar}),(0,er.jsx)(s9,{children:v.name[0]})]}),L&&(0,er.jsx)("button",{onClick:()=>{L?i5.success("Profile picture updated! "):i5.info("You can only change your own profile picture.")},className:"absolute bottom-0 right-0 w-10 h-10 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,er.jsx)(tg,{className:"w-5 h-5 text-white"})})]})}),!y&&L&&(0,er.jsx)("div",{className:"flex justify-end mb-4",children:(0,er.jsxs)(tn,{onClick:()=>{w(!0),k(v.name),S(v.bio),C(v.location),R(v.website)},className:"bg-white/10 hover:bg-white/20 text-white border border-white/20",children:[(0,er.jsx)(gI,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})}),y&&L&&(0,er.jsxs)("div",{className:"flex justify-end gap-2 mb-4",children:[(0,er.jsxs)(tn,{onClick:()=>{k(v.name),S(v.bio),C(v.location),R(v.website),w(!1)},variant:"ghost",className:"text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(iH,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,er.jsxs)(tn,{onClick:et,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0",children:[(0,er.jsx)(gR,{className:"w-4 h-4 mr-2"}),"Save"]})]}),(0,er.jsxs)("div",{className:"mt-16 space-y-4",children:[y?(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{className:"text-white",children:"Name"}),(0,er.jsx)(cV,{value:j,onChange:e=>k(e.target.value),className:"bg-white/5 border-white/20 text-white"})]}):(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)("h1",{className:"text-white text-3xl",children:v.name}),(0,er.jsx)("p",{className:"text-white/70",children:v.username})]}),y?(0,er.jsxs)("div",{className:"space-y-2",children:[(0,er.jsx)(m_,{className:"text-white",children:"Bio"}),(0,er.jsx)(aN,{value:N,onChange:e=>S(e.target.value),className:"bg-white/5 border-white/20 text-white min-h-[80px]",placeholder:"Tell us about yourself..."})]}):v.bio&&(0,er.jsx)("p",{className:"text-white/80",children:v.bio}),(0,er.jsx)("div",{className:"flex flex-wrap gap-4 text-white/70 text-sm",children:y?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsxs)("div",{className:"flex-1 min-w-[200px] space-y-2",children:[(0,er.jsx)(m_,{className:"text-white",children:"Location"}),(0,er.jsx)(cV,{value:_,onChange:e=>C(e.target.value),className:"bg-white/5 border-white/20 text-white",placeholder:"City, Country"})]}),(0,er.jsxs)("div",{className:"flex-1 min-w-[200px] space-y-2",children:[(0,er.jsx)(m_,{className:"text-white",children:"Website"}),(0,er.jsx)(cV,{value:E,onChange:e=>R(e.target.value),className:"bg-white/5 border-white/20 text-white",placeholder:"yourwebsite.com"})]})]}):(0,er.jsxs)(er.Fragment,{children:[(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(lR,{className:"w-4 h-4"}),(0,er.jsx)("span",{children:v.email})]}),v.location&&(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(gE,{className:"w-4 h-4"}),(0,er.jsx)("span",{children:v.location})]}),v.website&&(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(lE,{className:"w-4 h-4"}),(0,er.jsx)("a",{href:`https://${v.website}`,target:"_blank",rel:"noopener noreferrer",className:"hover:text-white transition-colors",children:v.website})]}),(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)(gM,{className:"w-4 h-4"}),(0,er.jsxs)("span",{children:["Joined ",Z]})]})]})})]})]})]}),(0,er.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:ee.map(e=>(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:(0,er.jsxs)("div",{className:"flex items-center gap-3",children:[(0,er.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500 to-purple-500 rounded-full flex items-center justify-center",children:(0,er.jsx)(e.icon,{className:"w-6 h-6 text-white"})}),(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-white text-2xl",children:e.value}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:e.label})]})]})},e.label))}),X.length>0&&(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("h2",{className:"text-white text-xl mb-4 flex items-center gap-2",children:[(0,er.jsx)(gP,{className:"w-5 h-5"}),"Achievements (",X.length,")"]}),(0,er.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:X.map(e=>{let t=gL[e.icon]||gP;return(0,er.jsxs)("div",{className:"group relative",children:[(0,er.jsxs)("div",{className:`bg-gradient-to-br ${e.color} p-4 rounded-xl text-center hover:scale-105 transition-transform cursor-pointer`,children:[(0,er.jsx)(t,{className:"w-8 h-8 text-white mx-auto mb-2"}),(0,er.jsx)("p",{className:"text-white text-sm",children:e.name})]}),(0,er.jsxs)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-black/90 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:[e.description,(0,er.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-black/90"})]})]},e.id)})})]}),(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20",children:(0,er.jsxs)(iD,{defaultValue:"posts",className:"w-full",children:[(0,er.jsxs)(iL,{className:"w-full bg-white/5 border-b border-white/20 rounded-none",children:[(0,er.jsxs)(i$,{value:"posts",className:"flex-1",children:["Posts (",v.posts.length,")"]}),(0,er.jsx)(i$,{value:"media",className:"flex-1",children:"Media"}),(0,er.jsx)(i$,{value:"likes",className:"flex-1",children:"Likes"})]}),(0,er.jsxs)(iU,{value:"posts",className:"p-6 space-y-6",children:[L&&(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/5 border-white/20 p-4",children:(0,er.jsxs)("div",{className:"flex gap-3",children:[(0,er.jsxs)(s8,{className:"w-10 h-10 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:v.avatar}),(0,er.jsx)(s9,{children:v.name[0]})]}),(0,er.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,er.jsx)(aN,{value:A,onChange:e=>O(e.target.value),placeholder:"What's on your mind?",className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 min-h-[100px]"}),M.length>0&&(0,er.jsx)("div",{className:"grid grid-cols-3 gap-2",children:M.map(e=>(0,er.jsxs)("div",{className:"relative group",children:["image"===e.type?(0,er.jsx)(ty,{src:e.url,alt:"Selected",className:"w-full h-32 object-cover rounded-lg"}):(0,er.jsx)("video",{src:e.url,className:"w-full h-32 object-cover rounded-lg"}),(0,er.jsx)("button",{onClick:()=>{var t;return t=e.id,void P(e=>e.filter(e=>e.id!==t))},className:"absolute top-2 right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,er.jsx)(iH,{className:"w-4 h-4 text-white"})})]},e.id))}),(0,er.jsxs)("div",{className:"flex items-center justify-between",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)("input",{ref:G,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=e.target.files;t&&Array.from(t).forEach(e=>{let t=new FileReader;t.onload=e=>{let t=e.target?.result;P(e=>[...e,{id:Math.random().toString(),type:"image",url:t}])},t.readAsDataURL(e)})},className:"hidden"}),(0,er.jsx)("input",{ref:V,type:"file",accept:"video/*",onChange:e=>{let t=e.target.files;t&&Array.from(t).forEach(e=>{let t=new FileReader;t.onload=e=>{let t=e.target?.result;P(e=>[...e,{id:Math.random().toString(),type:"video",url:t}])},t.readAsDataURL(e)})},className:"hidden"}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:()=>G.current?.click(),className:"text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(a_,{className:"w-5 h-5 mr-2"}),"Photo"]}),(0,er.jsxs)(tn,{variant:"ghost",size:"sm",onClick:()=>V.current?.click(),className:"text-white/70 hover:text-white hover:bg-white/10",children:[(0,er.jsx)(tu,{className:"w-5 h-5 mr-2"}),"Video"]}),(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsx)(tn,{variant:"ghost",size:"sm",onClick:()=>I(!T),className:"text-white/70 hover:text-white hover:bg-white/10",children:(0,er.jsx)(aC,{className:"w-5 h-5"})}),T&&(0,er.jsx)("div",{className:"absolute bottom-full left-0 mb-2 z-10",children:(0,er.jsx)(aO,{onSelect:e=>{O(t=>t+e),I(!1)}})})]})]}),(0,er.jsxs)(tn,{onClick:()=>{A.trim()||0!==M.length?(c({text:A,media:M.length>0?M.map(e=>({type:e.type,url:e.url})):void 0}),O(""),P([]),i5.success("Post created! ")):i5.error("Please add some content to your post")},disabled:!A.trim()&&0===M.length,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0",children:[(0,er.jsx)(aE,{className:"w-4 h-4 mr-2"}),"Post"]})]})]})]})}),(0,er.jsx)("div",{className:"space-y-4",children:0===v.posts.length?(0,er.jsxs)("div",{className:"text-center py-12",children:[(0,er.jsx)(td,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),(0,er.jsx)("p",{className:"text-white/60",children:"No posts yet. Share your first post!"})]}):v.posts.map(e=>{var t;let r,s,n,i,a=$[e.id],o=a?a.liked:!!D&&e.likedBy.includes(D),l=a?a.likes:e.likes,c=B[e.id],h=c?.isOpen;return(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/5 border-white/20 p-4",children:(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsxs)(s8,{className:"w-10 h-10 border-2 border-white/20",children:[(0,er.jsx)(s7,{src:v.avatar}),(0,er.jsx)(s9,{children:v.name[0]})]}),(0,er.jsxs)("div",{className:"flex-1",children:[(0,er.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("p",{className:"text-white",children:v.name}),(0,er.jsx)("p",{className:"text-white/50 text-sm",children:(t=e.timestamp,s=Math.floor((r=new Date().getTime()-t.getTime())/6e4),n=Math.floor(r/36e5),i=Math.floor(r/864e5),s<60?`${s}m ago`:n<24?`${n}h ago`:i<7?`${i}d ago`:t.toLocaleDateString())})]}),(0,er.jsx)(tn,{variant:"ghost",size:"sm",onClick:()=>{d(e.id),i5.success("Post deleted")},className:"text-white/50 hover:text-red-400 hover:bg-white/10",children:(0,er.jsx)(ha,{className:"w-4 h-4"})})]}),e.text&&(0,er.jsx)("p",{className:"text-white/90 mb-3",children:e.text}),e.media&&e.media.length>0&&(0,er.jsx)("div",{className:`grid gap-2 mb-3 ${1===e.media.length?"grid-cols-1":"grid-cols-2"}`,children:e.media.map((e,t)=>(0,er.jsx)("div",{className:"rounded-lg overflow-hidden",children:"image"===e.type?(0,er.jsx)(ty,{src:e.url,alt:"Post media",className:"w-full h-64 object-cover"}):(0,er.jsx)("video",{src:e.url,controls:!0,className:"w-full h-64 object-cover"})},t))}),(0,er.jsxs)("div",{className:"flex items-center gap-6 text-white/60 text-sm",children:[(0,er.jsxs)("button",{type:"button",onClick:()=>(e=>{if(!v)return;if(!D)return void i5.info("Sign in to react to posts.");let t=v.posts.find(t=>t.id===e);t&&(U(r=>{let s=r[e]??{likes:t.likes,liked:!!D&&t.likedBy.includes(D),dirty:!1},n=!s.liked,i=n?s.likes+1:Math.max(s.likes-1,0);return{...r,[e]:{likes:i,liked:n,dirty:!0}}}),u(e,D))})(e.id),"aria-label":o?`Unlike post (${l})`:`Like post (${l})`,className:`flex items-center gap-2 hover:text-pink-400 transition-colors ${o?"text-pink-400":""}`,children:[(0,er.jsx)(tm,{className:`w-5 h-5 ${o?"fill-current":""}`}),(0,er.jsx)("span",{children:l})]}),(0,er.jsxs)("button",{type:"button",onClick:()=>void ei(e),className:`flex items-center gap-2 hover:text-blue-400 transition-colors ${h?"text-blue-400":""}`,children:[(0,er.jsx)(td,{className:"w-5 h-5"}),(0,er.jsx)("span",{children:e.comments})]}),(0,er.jsxs)(tn,{type:"button",variant:"ghost",size:"sm",onClick:()=>(e=>{if(!v)return void i5.info("Please log in to share posts.");let t=v.username??"",r=t?t.startsWith("@")?t:`@${t}`:"@movesplash-user";F({userpostId:e.id,memberId:e.userId,authorName:v.name,authorUsername:r,authorAvatar:v.avatar,text:e.text??""})})(e),disabled:H&&q?.userpostId===e.id,className:"flex items-center gap-2 text-white/70 hover:text-green-400 hover:bg-white/10 disabled:opacity-50",children:[(0,er.jsx)(tf,{className:"w-5 h-5 mr-1"}),(0,er.jsx)("span",{children:e.shares})]})]}),c?.isOpen&&(0,er.jsxs)("div",{className:"mt-4 pt-4 border-t border-white/10 space-y-4",children:[c.isLoading?(0,er.jsxs)("div",{className:"flex items-center gap-3 text-white/70 text-sm",children:[(0,er.jsx)(iV,{className:"w-4 h-4 animate-spin"}),(0,er.jsx)("span",{children:"Loading comments..."})]}):(0,er.jsxs)(er.Fragment,{children:[0===c.comments.length&&!c.error&&(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Be the first to comment."}),c.comments.map(e=>{let t;return(0,er.jsxs)("div",{className:"flex gap-3",children:[(0,er.jsxs)(s8,{className:"w-9 h-9 border border-white/10",children:[(0,er.jsx)(s7,{src:e.authorAvatar||(t=e.authorId,`https://api.dicebear.com/7.x/avataaars/svg?seed=${encodeURIComponent(t||"user")}`)}),(0,er.jsx)(s9,{children:e.authorName[0]??"U"})]}),(0,er.jsxs)("div",{className:"flex-1",children:[(0,er.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-white text-sm",children:e.authorName}),(0,er.jsx)("span",{className:"text-white/40 text-xs",children:(e=>{let t=Math.floor((Date.now()-e.getTime())/6e4);if(t<1)return"Just now";if(t<60)return`${t}m ago`;let r=Math.floor(t/60);if(r<24)return`${r}h ago`;let s=Math.floor(r/24);return s<7?`${s}d ago`:e.toLocaleDateString()})(e.createdAt)})]}),(0,er.jsx)("p",{className:"text-white/80 text-sm whitespace-pre-line",children:e.content})]})]},e.id)}),c.error&&(0,er.jsx)("p",{className:"text-red-300 text-sm",children:c.error})]}),(0,er.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,er.jsx)(aN,{value:c.input,onChange:t=>{var r,s;return r=e.id,s=t.target.value,void z(e=>{let t=e[r];return t?{...e,[r]:{...t,input:s,error:null}}:e})},placeholder:"Write a comment...",rows:2,className:"flex-1 bg-white/5 border-white/20 text-white placeholder:text-white/50"}),(0,er.jsx)(tn,{type:"button",onClick:()=>void ea(e),disabled:c.isSubmitting||0===c.input.trim().length,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 self-center disabled:opacity-50",children:c.isSubmitting?(0,er.jsx)(iV,{className:"w-4 h-4 animate-spin"}):(0,er.jsx)(aE,{className:"w-4 h-4"})})]})]})]})]})},e.id)})})]}),(0,er.jsxs)(iU,{value:"media",className:"p-6",children:[(0,er.jsx)("div",{className:"grid grid-cols-3 gap-4",children:v.posts.filter(e=>e.media&&e.media.length>0).flatMap(e=>e.media||[]).map((e,t)=>(0,er.jsx)("div",{className:"aspect-square rounded-lg overflow-hidden group relative",children:"image"===e.type?(0,er.jsx)(ty,{src:e.url,alt:"Media",className:"w-full h-full object-cover group-hover:scale-110 transition-transform"}):(0,er.jsx)("video",{src:e.url,className:"w-full h-full object-cover group-hover:scale-110 transition-transform"})},t))}),0===v.posts.filter(e=>e.media&&e.media.length>0).length&&(0,er.jsxs)("div",{className:"text-center py-12",children:[(0,er.jsx)(a_,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),(0,er.jsx)("p",{className:"text-white/60",children:"No media posts yet"})]})]}),(0,er.jsx)(iU,{value:"likes",className:"p-6",children:(0,er.jsx)("div",{className:"space-y-4",children:(0,er.jsxs)("div",{className:"text-center py-12",children:[(0,er.jsx)(tm,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),(0,er.jsx)("p",{className:"text-white/60",children:"Posts you like will appear here"})]})})})]})})]})}),(0,er.jsx)(lI,{open:!!q,post:q,onClose:()=>{H||F(null)},onSelect:e=>{en(e)}})]})}function gU(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}"undefined"!=typeof window&&window.document&&window.document.createElement;var gB=globalThis?.document?es.useLayoutEffect:()=>{},gz=es[" useInsertionEffect ".trim().toString()]||gB;function gq({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return gz(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}Symbol("RADIX:SYNC_STATE");var gF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});"undefined"!=typeof window&&window.document&&window.document.createElement;var gH=globalThis?.document?es.useLayoutEffect:()=>{},gW=es[" useInsertionEffect ".trim().toString()]||gH;function gG(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}Symbol("RADIX:SYNC_STATE");var gV=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=eo(`Primitive.${t}`),s=es.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,er.jsx)(n?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),gK="Collapsible",[gJ,gY]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(gK),[gX,gQ]=gJ(gK),gZ=es.forwardRef((e,t)=>{let{__scopeCollapsible:r,open:s,defaultOpen:n,disabled:i,onOpenChange:a,...o}=e,[l,c]=function({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=es.useState(e),n=es.useRef(r),i=es.useRef(t);return gW(()=>{i.current=t},[t]),es.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),o=void 0!==e,l=o?e:n;{let t=es.useRef(void 0!==e);es.useEffect(()=>{let e=t.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=o},[o,s])}return[l,es.useCallback(t=>{if(o){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[o,e,i,a])]}({prop:s,defaultProp:n??!1,onChange:a,caller:gK});return(0,er.jsx)(gX,{scope:r,disabled:i,contentId:n6(),open:l,onOpenToggle:es.useCallback(()=>c(e=>!e),[c]),children:(0,er.jsx)(gV.div,{"data-state":g3(l),"data-disabled":i?"":void 0,...o,ref:t})})});gZ.displayName=gK;var g0="CollapsibleTrigger",g1=es.forwardRef((e,t)=>{let{__scopeCollapsible:r,...s}=e,n=gQ(g0,r);return(0,er.jsx)(gV.button,{type:"button","aria-controls":n.contentId,"aria-expanded":n.open||!1,"data-state":g3(n.open),"data-disabled":n.disabled?"":void 0,disabled:n.disabled,...s,ref:t,onClick:function(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}(e.onClick,n.onOpenToggle)})});g1.displayName=g0;var g2="CollapsibleContent",g4=es.forwardRef((e,t)=>{let{forceMount:r,...s}=e,n=gQ(g2,e.__scopeCollapsible);return(0,er.jsx)(ns,{present:r||n.open,children:({present:e})=>(0,er.jsx)(g5,{...s,ref:t,present:e})})});g4.displayName=g2;var g5=es.forwardRef((e,t)=>{let{__scopeCollapsible:r,present:s,children:n,...i}=e,a=gQ(g2,r),[o,l]=es.useState(s),c=es.useRef(null),d=function(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=gG(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():gG(e[t],null)}}}}(...e),e)}(t,c),u=es.useRef(0),h=u.current,p=es.useRef(0),f=p.current,m=a.open||o,g=es.useRef(m),b=es.useRef(void 0);return es.useEffect(()=>{let e=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(e)},[]),gH(()=>{let e=c.current;if(e){b.current=b.current||{transitionDuration:e.style.transitionDuration,animationName:e.style.animationName},e.style.transitionDuration="0s",e.style.animationName="none";let t=e.getBoundingClientRect();u.current=t.height,p.current=t.width,g.current||(e.style.transitionDuration=b.current.transitionDuration,e.style.animationName=b.current.animationName),l(s)}},[a.open,s]),(0,er.jsx)(gV.div,{"data-state":g3(a.open),"data-disabled":a.disabled?"":void 0,id:a.contentId,hidden:!m,...i,ref:d,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":f?`${f}px`:void 0,...e.style},children:m&&n})});function g3(e){return e?"open":"closed"}var g6="Accordion",g8=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[g7,g9,be]=nQ(g6),[bt,br]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>es.createContext(e));return function(r){let s=r?.[e]||t;return es.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=es.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,o=r?.[e]?.[i]||n,l=es.useMemo(()=>a,Object.values(a));return(0,er.jsx)(o.Provider,{value:l,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let o=a?.[e]?.[i]||n,l=es.useContext(o);if(l)return l;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return es.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}(g6,[be,gY]),bs=gY(),bn=es.default.forwardRef((e,t)=>{let{type:r,...s}=e;return(0,er.jsx)(g7.Provider,{scope:e.__scopeAccordion,children:"multiple"===r?(0,er.jsx)(bd,{...s,ref:t}):(0,er.jsx)(bc,{...s,ref:t})})});bn.displayName=g6;var[bi,ba]=bt(g6),[bo,bl]=bt(g6,{collapsible:!1}),bc=es.default.forwardRef((e,t)=>{let{value:r,defaultValue:s,onValueChange:n=()=>{},collapsible:i=!1,...a}=e,[o,l]=gq({prop:r,defaultProp:s??"",onChange:n,caller:g6});return(0,er.jsx)(bi,{scope:e.__scopeAccordion,value:es.default.useMemo(()=>o?[o]:[],[o]),onItemOpen:l,onItemClose:es.default.useCallback(()=>i&&l(""),[i,l]),children:(0,er.jsx)(bo,{scope:e.__scopeAccordion,collapsible:i,children:(0,er.jsx)(bp,{...a,ref:t})})})}),bd=es.default.forwardRef((e,t)=>{let{value:r,defaultValue:s,onValueChange:n=()=>{},...i}=e,[a,o]=gq({prop:r,defaultProp:s??[],onChange:n,caller:g6}),l=es.default.useCallback(e=>o((t=[])=>[...t,e]),[o]),c=es.default.useCallback(e=>o((t=[])=>t.filter(t=>t!==e)),[o]);return(0,er.jsx)(bi,{scope:e.__scopeAccordion,value:a,onItemOpen:l,onItemClose:c,children:(0,er.jsx)(bo,{scope:e.__scopeAccordion,collapsible:!0,children:(0,er.jsx)(bp,{...i,ref:t})})})}),[bu,bh]=bt(g6),bp=es.default.forwardRef((e,t)=>{let{__scopeAccordion:r,disabled:s,dir:n,orientation:i="vertical",...a}=e,o=function(...e){return es.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=gU(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():gU(e[t],null)}}}}(...e),e)}(es.default.useRef(null),t),l=g9(r),c="ltr"===nc(n),d=function(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}(e.onKeyDown,e=>{if(!g8.includes(e.key))return;let t=e.target,r=l().filter(e=>!e.ref.current?.disabled),s=r.findIndex(e=>e.ref.current===t),n=r.length;if(-1===s)return;e.preventDefault();let a=s,o=n-1,d=()=>{(a=s+1)>o&&(a=0)},u=()=>{(a=s-1)<0&&(a=o)};switch(e.key){case"Home":a=0;break;case"End":a=o;break;case"ArrowRight":"horizontal"===i&&(c?d():u());break;case"ArrowDown":"vertical"===i&&d();break;case"ArrowLeft":"horizontal"===i&&(c?u():d());break;case"ArrowUp":"vertical"===i&&u()}let h=a%n;r[h].ref.current?.focus()});return(0,er.jsx)(bu,{scope:r,disabled:s,direction:n,orientation:i,children:(0,er.jsx)(g7.Slot,{scope:r,children:(0,er.jsx)(gF.div,{...a,"data-orientation":i,ref:o,onKeyDown:s?void 0:d})})})}),bf="AccordionItem",[bm,bg]=bt(bf),bb=es.default.forwardRef((e,t)=>{let{__scopeAccordion:r,value:s,...n}=e,i=bh(bf,r),a=ba(bf,r),o=bs(r),l=n6(),c=s&&a.value.includes(s)||!1,d=i.disabled||e.disabled;return(0,er.jsx)(bm,{scope:r,open:c,disabled:d,triggerId:l,children:(0,er.jsx)(gZ,{"data-orientation":i.orientation,"data-state":bN(c),...o,...n,ref:t,disabled:d,open:c,onOpenChange:e=>{e?a.onItemOpen(s):a.onItemClose(s)}})})});bb.displayName=bf;var bx="AccordionHeader",by=es.default.forwardRef((e,t)=>{let{__scopeAccordion:r,...s}=e,n=bh(g6,r),i=bg(bx,r);return(0,er.jsx)(gF.h3,{"data-orientation":n.orientation,"data-state":bN(i.open),"data-disabled":i.disabled?"":void 0,...s,ref:t})});by.displayName=bx;var bw="AccordionTrigger",bv=es.default.forwardRef((e,t)=>{let{__scopeAccordion:r,...s}=e,n=bh(g6,r),i=bg(bw,r),a=bl(bw,r),o=bs(r);return(0,er.jsx)(g7.ItemSlot,{scope:r,children:(0,er.jsx)(g1,{"aria-disabled":i.open&&!a.collapsible||void 0,"data-orientation":n.orientation,id:i.triggerId,...o,...s,ref:t})})});bv.displayName=bw;var bj="AccordionContent",bk=es.default.forwardRef((e,t)=>{let{__scopeAccordion:r,...s}=e,n=bh(g6,r),i=bg(bj,r),a=bs(r);return(0,er.jsx)(g4,{role:"region","aria-labelledby":i.triggerId,"data-orientation":n.orientation,...a,...s,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});function bN(e){return e?"open":"closed"}function bS({...e}){return(0,er.jsx)(bn,{"data-slot":"accordion",...e})}function b_({className:e,...t}){return(0,er.jsx)(bb,{"data-slot":"accordion-item",className:tr("border-b last:border-b-0",e),...t})}function bC({className:e,children:t,...r}){return(0,er.jsx)(by,{className:"flex",children:(0,er.jsxs)(bv,{"data-slot":"accordion-trigger",className:tr("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",e),...r,children:[t,(0,er.jsx)(ma,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function bE({className:e,children:t,...r}){return(0,er.jsx)(bk,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...r,children:(0,er.jsx)("div",{className:tr("pt-0 pb-4",e),children:t})})}bk.displayName=bj;let bR=tc("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),bA=tc("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function bO({onBack:e}){let[t,r]=(0,es.useState)(""),s=[{id:"getting-started",title:"Getting Started",icon:bR,color:"from-blue-500 to-cyan-500",articles:[{question:"How do I sign up?",answer:"Tap 'Get Started,' add your name, email, and a password, then pick a birthday. We drop you into the app right away so you can finish setup later."},{question:"How do I find friends quickly?",answer:"Head to the Friends tab, search by name or @handle, or share your personal invite link. Accept requests from the same screen."},{question:"Why use MoveSplash instead of juggling other apps?",answer:"Group chat, calls, stories, and the feed live in one place with a mostly chronological timeline. No noisy ads or mystery ranking rules."}]},{id:"messaging",title:"Messaging & Chat",icon:pG,color:"from-purple-500 to-pink-500",articles:[{question:"How do I send a message?",answer:"Open Messages, pick a friend, type, and hit enter. Drop emojis, GIFs, or /giphy commands if you want to spice it up."},{question:"What about group chats?",answer:"Select 'New Group,' choose up to 20 friends, and name the thread. Everyone can share photos, polls, files, and reactions immediately."},{question:"How do I share media?",answer:"Click the paperclip or drag files right into the composer. Large videos compress automatically so they still send quickly."},{question:"Can I send voice notes?",answer:"Hold the mic icon to record, release to send, swipe left to cancel. Perfect when you are walking or just cannot type."}]},{id:"video-calls",title:"Video & Voice Calls",icon:tu,color:"from-green-500 to-emerald-500",articles:[{question:"How do I start a call?",answer:"Open any chat and tap the camera or phone icon. Group chats instantly turn into conference calls with up to 20 people."},{question:"What quality should I expect?",answer:"If your gear and connection can handle it we will push 4K video. Otherwise we gracefully fall back to 1080p or 720p so calls stay smooth."},{question:"How do I share my screen?",answer:"During a call, hit the monitor icon and choose your window, tab, or full desktop. A border shows what everyone can see."},{question:"What is demo mode?",answer:"When another app already owns your camera, demo mode fakes a video feed so you can keep presenting without replugging gear."}]},{id:"stories",title:"Stories & Moments",icon:a_,color:"from-orange-500 to-yellow-500",articles:[{question:"How do I post a story?",answer:"Tap your avatar with the plus sign, shoot something new or upload from the camera roll, add stickers or text, then post."},{question:"Who sees my story?",answer:"Friends by default, but you can switch to Close Friends or a custom list before publishing each story."},{question:"Can I see who watched it?",answer:"Open your own story and swipe up to see a viewer list with timestamps."},{question:"Do stories auto-save?",answer:"We stash a copy in your private Memories view and you can download it whenever you want."}]},{id:"feed",title:"Social Feed",icon:th,color:"from-pink-500 to-rose-500",articles:[{question:"How does the feed work?",answer:"It is mostly chronological from the people you follow with gentle bumps for posts you missed. No endless recommended junk."},{question:"How do I create a post?",answer:"Click 'What's on your mind?', type your update, add media if you want, choose the audience, and press Post."},{question:"What can I share?",answer:"Text, photos, videos, playlists, polls, and location tags all live side by side. Mix and match."},{question:"How do reactions work?",answer:"Tap the heart for a quick like or hold it to pick from the emoji stack - each one animates differently."}]},{id:"privacy",title:"Privacy & Security",icon:gN,color:"from-indigo-500 to-purple-500",articles:[{question:"Is my data safe?",answer:"Messages are encrypted in transit and at rest. We do not sell personal info. Details live in the Privacy Policy."},{question:"How do I control who sees my posts?",answer:"Every post has a visibility picker (Public, Friends, Close Friends, Custom). We remember your last choice."},{question:"How do I block or report someone?",answer:"From their profile, open the three-dot menu and choose Block or Report. We review reports quickly and keep you anonymous."},{question:"Can I deactivate or delete my account?",answer:"Go to Settings -> Account. Deactivate to take a break, or start a permanent deletion which finishes after 30 days."}]},{id:"settings",title:"Settings & Account",icon:aw,color:"from-teal-500 to-cyan-500",articles:[{question:"How do I change my profile photo?",answer:"Open your profile, tap the avatar, and upload a new shot or snap one on the spot."},{question:"Where do I manage notifications?",answer:"Settings -> Notifications lets you toggle DMs, calls, mentions, and set quiet hours so MoveSplash stays chill while you sleep."},{question:"Can I tweak the theme?",answer:"MoveSplash follows your system light or dark mode and lets you customize accent colors plus chat bubble gradients."},{question:"How do I change my password?",answer:"Settings -> Account -> Change Password. Enter the current password once and the new one twice to confirm."}]}],n=s.map(e=>({...e,articles:e.articles.filter(e=>""===t||e.question.toLowerCase().includes(t.toLowerCase())||e.answer.toLowerCase().includes(t.toLowerCase()))})).filter(e=>e.articles.length>0);return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-pink-900 relative overflow-hidden",children:[(0,er.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,er.jsx)("div",{className:"absolute top-0 -left-4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"}),(0,er.jsx)("div",{className:"absolute top-0 -right-4 w-96 h-96 bg-yellow-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"}),(0,er.jsx)("div",{className:"absolute -bottom-8 left-20 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"})]}),(0,er.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto p-6",children:[(0,er.jsxs)("div",{className:"mb-8",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center space-y-4 mb-8",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 mb-4",children:(0,er.jsx)(gS,{className:"w-10 h-10 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-5xl",children:"Help Center"}),(0,er.jsx)("p",{className:"text-white/70 text-lg",children:"Find answers to common questions and learn how to use MoveSplash"})]}),(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-4 mb-6",children:(0,er.jsxs)("div",{className:"relative",children:[(0,er.jsx)(u1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/50"}),(0,er.jsx)(cV,{placeholder:"Search for help...",value:t,onChange:e=>r(e.target.value),className:"pl-10 bg-white/5 border-white/20 text-white placeholder:text-white/50"})]})})]}),""===t&&(0,er.jsx)("div",{className:"grid md:grid-cols-3 gap-4 mb-8",children:s.map(e=>{let t=e.icon;return(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6 hover:bg-white/15 transition-all",children:[(0,er.jsx)("div",{className:`inline-flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br ${e.color} mb-4`,children:(0,er.jsx)(t,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-lg mb-2",children:e.title}),(0,er.jsxs)("p",{className:"text-white/60 text-sm",children:[e.articles.length," articles"]})]},e.id)})}),(0,er.jsx)("div",{className:"space-y-6",children:n.map(e=>{let t=e.icon;return(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full bg-gradient-to-br ${e.color}`,children:(0,er.jsx)(t,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:e.title})]}),(0,er.jsx)(bS,{type:"single",collapsible:!0,className:"space-y-2",children:e.articles.map((t,r)=>(0,er.jsxs)(b_,{value:`${e.id}-${r}`,className:"border-white/10 rounded-lg overflow-hidden",children:[(0,er.jsx)(bC,{className:"text-white hover:text-white/80 px-4 py-3 hover:bg-white/5",children:t.question}),(0,er.jsx)(bE,{className:"text-white/70 px-4 pb-3",children:t.answer})]},r))})]},e.id)})})]})]})}let bT=tc("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),bI=tc("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),bM=tc("cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);function bP({onBack:e}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-pink-900 relative overflow-hidden",children:[(0,er.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,er.jsx)("div",{className:"absolute top-0 -left-4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"}),(0,er.jsx)("div",{className:"absolute top-0 -right-4 w-96 h-96 bg-yellow-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"}),(0,er.jsx)("div",{className:"absolute -bottom-8 left-20 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"})]}),(0,er.jsxs)("div",{className:"relative z-10 max-w-4xl mx-auto p-6",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-8",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 mb-4",children:(0,er.jsx)(gN,{className:"w-10 h-10 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-5xl mb-4",children:"Privacy Policy"}),(0,er.jsx)("p",{className:"text-white/70",children:"Last Updated: October 17, 2025"})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-green-500/20 to-emerald-500/20 border-green-400/30 p-6 mb-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-4",children:" Your Privacy Matters"}),(0,er.jsx)("p",{className:"text-white/80 leading-relaxed",children:"Privacy shouldn't require a law degree. This page spells out what we collect, why we collect it, and the shortcuts you have to control it. No dark patternsjust the facts."})]}),(0,er.jsxs)("div",{className:"space-y-6",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center",children:(0,er.jsx)(bI,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"Information We Collect"})]}),(0,er.jsxs)("div",{className:"space-y-4 text-white/70",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white text-lg mb-2",children:"Account Information"}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[(0,er.jsx)("li",{children:"The name and email you typed in when creating your account."}),(0,er.jsx)("li",{children:"Any profile photo, pronouns, or bio you choose to share."}),(0,er.jsx)("li",{children:"Optional recovery info like a phone number so we can help if you get locked out."}),(0,er.jsx)("li",{children:"Birthday details so we can confirm you meet the minimum age."})]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white text-lg mb-2",children:"Content You Create"}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[(0,er.jsx)("li",{children:"Chats, comments, and stories you post or send to friends."}),(0,er.jsx)("li",{children:"Photos, videos, audio notes, and files you drop into the app."}),(0,er.jsx)("li",{children:"Optional call recordings when everyone on the call says yes."}),(0,er.jsx)("li",{children:"Reactions, likes, and any other in-app signals you create."})]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white text-lg mb-2",children:"Usage Information"}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[(0,er.jsx)("li",{children:"Which features you tap on and how often you use them."}),(0,er.jsx)("li",{children:"Rough session stats like how long you hang out in the app."}),(0,er.jsx)("li",{children:"Basic device details (model, OS, browser) so we can debug things."}),(0,er.jsx)("li",{children:"Your IP address and general location (city/countrynot your street)."})]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:(0,er.jsx)(bT,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"How We Use Your Information"})]}),(0,er.jsxs)("div",{className:"space-y-3 text-white/70",children:[(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full mt-2"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"Run the product:"})," We need certain data to power chats, calls, and feed features."]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full mt-2"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"Improve experience:"})," Usage trends help us fix bugs and surface better suggestions."]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full mt-2"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"Safety & security:"})," Logs help us flag spam, prevent abuse, and keep accounts secure."]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full mt-2"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"Communications:"})," We use contact info for product updates, receipts, and support replies."]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full mt-2"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"Analytics:"})," Aggregated stats tell us which features people love (or ignore)."]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center",children:(0,er.jsx)(gk,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"Data Security"})]}),(0,er.jsxs)("div",{className:"space-y-3 text-white/70",children:[(0,er.jsx)("p",{children:"Security is an ongoing job, so we layer multiple protections instead of relying on a single switch:"}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[(0,er.jsx)("li",{children:"Messages and calls are encrypted end-to-end by default."}),(0,er.jsx)("li",{children:"Everything travels over HTTPS while in transit."}),(0,er.jsx)("li",{children:"Independent partners run routine pen-tests and code reviews."}),(0,er.jsx)("li",{children:"Optional 2FA keeps strangers from hijacking your account."}),(0,er.jsx)("li",{children:"Production databases stay encrypted at rest with limited access."}),(0,er.jsx)("li",{children:"Only vetted employees can reach user data, and every query is logged."})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center",children:(0,er.jsx)(iq,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"When We Share Information"})]}),(0,er.jsxs)("div",{className:"space-y-3 text-white/70",children:[(0,er.jsx)("p",{className:"text-white",children:"We don't sell or rent your personal data. That's not our business model."}),(0,er.jsx)("p",{children:"We only share info when it's absolutely necessary:"}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[(0,er.jsxs)("li",{children:[(0,er.jsx)("span",{className:"text-white",children:"You tell us to:"})," Sharing publicly or inviting friends obviously sends them your content."]}),(0,er.jsxs)("li",{children:[(0,er.jsx)("span",{className:"text-white",children:"Vetted partners:"})," Hosting, analytics, and support providers under strict confidentiality clauses."]}),(0,er.jsxs)("li",{children:[(0,er.jsx)("span",{className:"text-white",children:"Law enforcement:"})," When a valid legal request arrives or there's an immediate risk of harm."]}),(0,er.jsxs)("li",{children:[(0,er.jsx)("span",{className:"text-white",children:"Company changes:"})," If we merge or get acquired, we'll let you know before data changes hands."]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-pink-500 to-rose-500 flex items-center justify-center",children:(0,er.jsx)(gN,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"Your Privacy Rights"})]}),(0,er.jsxs)("div",{className:"space-y-3 text-white/70",children:[(0,er.jsx)("p",{children:"Here are the switches you control at any time:"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,er.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" Access Your Data"}),(0,er.jsx)("p",{className:"text-sm",children:"Ask for a copy of the info we store about your account."})]}),(0,er.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" Correct Information"}),(0,er.jsx)("p",{className:"text-sm",children:"Fix typos or outdated details whenever you want."})]}),(0,er.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" Delete Your Account"}),(0,er.jsx)("p",{className:"text-sm",children:"Close your account and wipe most data within about 30 days."})]}),(0,er.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" Export Your Data"}),(0,er.jsx)("p",{className:"text-sm",children:"Grab your photos, chats, and other content in a portable format."})]}),(0,er.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" Control Visibility"}),(0,er.jsx)("p",{className:"text-sm",children:"Choose who can see your posts, stories, and profile details."})]}),(0,er.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" Opt-Out"}),(0,er.jsx)("p",{className:"text-sm",children:"Mute marketing emails and personalized suggestions."})]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:(0,er.jsx)(bM,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"Cookies & Tracking"})]}),(0,er.jsxs)("div",{className:"space-y-3 text-white/70",children:[(0,er.jsx)("p",{children:"Cookies keep you logged in, remember your theme, and let us know if a feature totally flops. Don't want them? Most browsers let you block or clear cookies in a couple of taps."}),(0,er.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg",children:[(0,er.jsx)("p",{className:"text-white mb-2",children:"Types of cookies we use:"}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-1 pl-4 text-sm",children:[(0,er.jsx)("li",{children:"Essential cookies that keep sessions active."}),(0,er.jsx)("li",{children:"Preference cookies for things like dark mode."}),(0,er.jsx)("li",{children:"Analytics cookies so we know which screens crash."}),(0,er.jsx)("li",{children:"Limited ad cookies when we run promos with partners."})]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"Children's Privacy"}),(0,er.jsxs)("p",{className:"text-white/70",children:["This community is for ages 13+. If we discover someone younger snuck in, we scrub their data and close the account. Parents or guardians can reach us at"," ",(0,er.jsx)("span",{className:"text-white",children:"privacy@movesplash.com"})," for help."]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"International Data Transfers"}),(0,er.jsx)("p",{className:"text-white/70",children:"Our servers live mainly in the United States. If you're somewhere else, your data may move across borders but always under GDPR/CCPA-style protections and approved transfer agreements."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"Changes to This Policy"}),(0,er.jsx)("p",{className:"text-white/70",children:"When we revise this policy, we'll highlight the update in the app and send an email summary. Keep using MoveSplash after the effective date and you're agreeing to the new language."})]}),(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 border-purple-400/30 p-8",children:(0,er.jsxs)("div",{className:"text-center space-y-4",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-white/10",children:(0,er.jsx)(lR,{className:"w-8 h-8 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-2xl",children:"Questions About Privacy?"}),(0,er.jsxs)("p",{className:"text-white/70",children:["Ping ",(0,er.jsx)("span",{className:"text-white",children:"privacy@movesplash.com"})," and someone from the privacy crew will reply within a few days."]}),(0,er.jsxs)("p",{className:"text-white/70 text-sm",children:["MoveSplash, Inc.",(0,er.jsx)("br",{}),"123 Social Street",(0,er.jsx)("br",{}),"San Francisco, CA 94103",(0,er.jsx)("br",{}),"United States"]})]})})]})]})]})}let bD=tc("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),bL=tc("scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);function b$({onBack:e}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-pink-900 relative overflow-hidden",children:[(0,er.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,er.jsx)("div",{className:"absolute top-0 -left-4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"}),(0,er.jsx)("div",{className:"absolute top-0 -right-4 w-96 h-96 bg-yellow-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"}),(0,er.jsx)("div",{className:"absolute -bottom-8 left-20 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"})]}),(0,er.jsxs)("div",{className:"relative z-10 max-w-4xl mx-auto p-6",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-8",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 mb-4",children:(0,er.jsx)(bD,{className:"w-10 h-10 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-5xl mb-4",children:"Terms of Use"}),(0,er.jsx)("p",{className:"text-white/70",children:"Last Updated: October 17, 2025"})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-blue-500/20 to-cyan-500/20 border-blue-400/30 p-6 mb-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-4",children:" Agreement Overview"}),(0,er.jsx)("p",{className:"text-white/80 leading-relaxed",children:"Thanks for hanging out on MoveSplash. These are the house rules: they explain what we offer, what we expect in return, and what happens when things go sideways. If something here doesn't sit right with you, skip the app instead of rolling the dice."})]}),(0,er.jsxs)("div",{className:"space-y-6",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center",children:(0,er.jsx)(bL,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"1. Acceptance of Terms"})]}),(0,er.jsxs)("div",{className:"text-white/70 space-y-3",children:[(0,er.jsx)("p",{children:"Opening the app, creating an account, or even checking out public content means you accept these Terms plus our Privacy Policy. That's true whether you're lurking, livestreaming, or running a community."}),(0,er.jsx)("p",{children:"We tweak these terms when laws change or we launch new stuff. When that happens we'll call it out in-product or by email. Keep using MoveSplash after the update and you're agreeing to the new version."})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"2. Eligibility"}),(0,er.jsxs)("div",{className:"text-white/70 space-y-2",children:[(0,er.jsx)("p",{children:"MoveSplash is meant for people who can legally be responsible for what they post."}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[(0,er.jsx)("li",{children:"You must be 13 or older in the United States (check your local rules elsewhere)."}),(0,er.jsx)("li",{children:"You can't join if you're barred from online services where you live."}),(0,er.jsx)("li",{children:"Previous bans stick. If we removed you once, don't sneak back in."}),(0,er.jsx)("li",{children:"Sign-up info should be real and currentno burner names or fake birthdays."})]}),(0,er.jsx)("p",{className:"mt-3",children:"If you're under 18, loop in a parent or guardian so everyone understands the deal."})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:(0,er.jsx)(gN,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"3. Account Responsibilities"})]}),(0,er.jsxs)("div",{className:"text-white/70 space-y-3",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:"Account Security"}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[(0,er.jsx)("li",{children:"Pick a password you don't reuse anywhere else and keep it private."}),(0,er.jsx)("li",{children:"Let us know right away if you suspect someone logged in as you."}),(0,er.jsx)("li",{children:"You're on the hook for anything that happens on your profile until you report the issue."}),(0,er.jsx)("li",{children:"Sharing accounts isn't allowedeven with roommates or teammates."})]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:"Account Information"}),(0,er.jsxs)("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[(0,er.jsx)("li",{children:"Keep your profile details accurate so friends know it's you."}),(0,er.jsx)("li",{children:"No impersonation, parody, or duplicate accounts without our written okay."}),(0,er.jsx)("li",{children:"If your contact info changes, update it so we can reach you about important stuff."}),(0,er.jsx)("li",{children:"Businesses and creators who need more than one account must talk to us first."})]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center",children:(0,er.jsx)(gA,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"4. Acceptable Use Policy"})]}),(0,er.jsxs)("div",{className:"text-white/70 space-y-3",children:[(0,er.jsx)("p",{className:"text-white",children:"You agree NOT to use MoveSplash to:"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-3",children:[(0,er.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-3 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-red-400 mb-1",children:" Harassment & Bullying"}),(0,er.jsx)("p",{className:"text-sm",children:"No pile-ons, doxxing, threats, or coordinated takedowns. Disagree without being cruel."})]}),(0,er.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-3 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-red-400 mb-1",children:" Hate Speech"}),(0,er.jsx)("p",{className:"text-sm",children:"Any slur, coded language, or encouragement of violence aimed at a protected group is an instant ban."})]}),(0,er.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-3 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-red-400 mb-1",children:" Illegal Content"}),(0,er.jsx)("p",{className:"text-sm",children:"Don't upload or organize anything illegalincluding knock-off merch, drugs, or dangerous challenges."})]}),(0,er.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-3 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-red-400 mb-1",children:" Spam & Scams"}),(0,er.jsx)("p",{className:"text-sm",children:"No mass DMs, pyramid pitches, phishing, or fake giveaways. Keep conversations real."})]}),(0,er.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-3 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-red-400 mb-1",children:" Adult Content"}),(0,er.jsx)("p",{className:"text-sm",children:"Graphic sexual content, exploitation, and gore are never welcome here."})]}),(0,er.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-3 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-red-400 mb-1",children:" Intellectual Property"}),(0,er.jsx)("p",{className:"text-sm",children:"Share work you own or have permission to repost. Credit alone doesn't make it legal."})]}),(0,er.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-3 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-red-400 mb-1",children:" System Abuse"}),(0,er.jsx)("p",{className:"text-sm",children:"No reverse engineering, load testing, or exploits meant to break our infrastructure."})]}),(0,er.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 p-3 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-red-400 mb-1",children:" Data Mining"}),(0,er.jsx)("p",{className:"text-sm",children:"Scraping profiles, harvesting handles, or exporting other people's data is off-limits."})]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"5. Content & Intellectual Property"}),(0,er.jsxs)("div",{className:"text-white/70 space-y-3",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:"Your Content"}),(0,er.jsx)("p",{children:"Everything you create is still yours. Sharing it on MoveSplash gives us a limited, revocable license to host it, display it to the people you choose, and make backup copies so the app works. Delete the post and the license ends once it clears our caches."})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:"Our Content"}),(0,er.jsx)("p",{children:"The brand, codebase, product copy, and design system belong to MoveSplash. Please don't rip our UI, reuse our logo, or ship a look-alike experience without written permission."})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:"Reporting Violations"}),(0,er.jsxs)("p",{children:["Spot something that steals your work? Email"," ",(0,er.jsx)("span",{className:"text-white",children:"copyright@movesplash.com"})," ","with the link, proof you own it, and how to reach you. We respond as fast as possible."]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"6. Privacy & Data"}),(0,er.jsxs)("p",{className:"text-white/70",children:["We only collect the info we need to keep MoveSplash running (think account basics, usage stats, and stuff you intentionally share). The full breakdown lives in our"," ",(0,er.jsx)("span",{className:"text-white underline cursor-pointer",children:"Privacy Policy"}),". Using the app means you're cool with those practices."]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-red-500 to-pink-500 flex items-center justify-center",children:(0,er.jsx)(p9,{className:"w-5 h-5 text-white"})}),(0,er.jsx)("h2",{className:"text-white text-2xl",children:"7. Termination"})]}),(0,er.jsxs)("div",{className:"text-white/70 space-y-3",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:"By You"}),(0,er.jsx)("p",{children:"Done with MoveSplash? Head to Settings and delete your account. We start wiping things within 30 days unless the law says we have to hold onto them a little longer (for example, fraud investigations)."})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:"By Us"}),(0,er.jsx)("p",{children:"We can pause or remove accounts that break these rules, hurt other people, or threaten the service. We'll usually send a warning, but for serious stuff we can cut access immediately."})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"8. Disclaimers & Limitations"}),(0,er.jsxs)("div",{className:"text-white/70 space-y-3",children:[(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:'Service is "as-is":'})," We work hard to keep MoveSplash fast and reliable, but bugs and outages happen. We can't promise uninterrupted service, perfect security, or zero data loss."]}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"Limited liability:"})," If something breaks, we're not liable for lost profits, data, or other indirect damage the law lets us disclaim."]}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"User content:"})," You control what you share and who sees it. We don't endorse user posts and we're not responsible for what someone else says or does."]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"9. Indemnification"}),(0,er.jsx)("p",{className:"text-white/70",children:"If your actions or content cause us legal trouble, you'll cover the reasonable costs including lawyersso the rest of the community doesn't have to."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"10. Dispute Resolution"}),(0,er.jsxs)("div",{className:"text-white/70 space-y-3",children:[(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"Governing law:"})," California law applies, even if you use MoveSplash somewhere else."]}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"Arbitration first:"})," Shoot us a note at"," ","support@movesplash.com and we'll try to fix issues quickly. If that doesn't work, we'll resolve things through binding arbitration (unless you qualify for small-claims court)."]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"11. Changes to Terms"}),(0,er.jsx)("p",{className:"text-white/70",children:"When we change these terms, we'll give you a heads up (email + in-app banner) about 30 days before the update takes effect. Don't like the new version? Remove your account before the date listed and you won't be bound by it going forward."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"12. Miscellaneous"}),(0,er.jsxs)("div",{className:"text-white/70 space-y-2",children:[(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"Entire agreement:"})," These terms and the Privacy Policy replace any previous conversations you had with us about using MoveSplash."]}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"If one part fails:"})," The rest still counts even if a single sentence is struck down in court."]}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"No silent waivers:"})," If we don't enforce a rule right away, it doesn't mean we gave up the right to enforce it later."]}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"Assignment:"})," You can't transfer your account or these terms to someone else. We can assign our rights if we merge, get acquired, or restructure."]})]})]}),(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 border-purple-400/30 p-8",children:(0,er.jsxs)("div",{className:"text-center space-y-4",children:[(0,er.jsx)("h3",{className:"text-white text-2xl",children:"Need a real person?"}),(0,er.jsxs)("p",{className:"text-white/70",children:["Email ",(0,er.jsx)("span",{className:"text-white",children:"legal@movesplash.com"})," or drop a line through the in-app help form. Real humans read both."]}),(0,er.jsxs)("p",{className:"text-white/70 text-sm",children:["MoveSplash, Inc.",(0,er.jsx)("br",{}),"123 Social Street",(0,er.jsx)("br",{}),"San Francisco, CA 94103",(0,er.jsx)("br",{}),"United States"]})]})})]})]})]})}let bU=tc("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),bB=tc("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);function bz({onBack:e}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-pink-900 to-blue-900 relative overflow-hidden",children:[(0,er.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,er.jsx)("div",{className:"absolute w-96 h-96 bg-pink-500/30 rounded-full blur-3xl -top-48 -left-48 animate-pulse"}),(0,er.jsx)("div",{className:"absolute w-96 h-96 bg-purple-500/30 rounded-full blur-3xl top-1/3 -right-48 animate-pulse",style:{animationDelay:"1s"}}),(0,er.jsx)("div",{className:"absolute w-96 h-96 bg-blue-500/30 rounded-full blur-3xl -bottom-48 left-1/3 animate-pulse",style:{animationDelay:"2s"}})]}),(0,er.jsxs)("div",{className:"relative z-10 max-w-4xl mx-auto p-6 py-12",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-8",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-16",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-pink-500 to-purple-500 mb-6",children:(0,er.jsx)(tp,{className:"w-12 h-12 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-6xl mb-4",children:"About MoveSplash"}),(0,er.jsx)("p",{className:"text-white/70 text-xl max-w-2xl mx-auto",children:"The most vibrant social platform designed for Gen Z. Built with love, powered by innovation."})]}),(0,er.jsx)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-8",children:(0,er.jsxs)("div",{className:"flex items-start gap-4",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-pink-500 to-purple-500 flex items-center justify-center flex-shrink-0",children:(0,er.jsx)(tm,{className:"w-6 h-6 text-white"})}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"Our Mission"}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed",children:"We started MoveSplash because our own group chats were split across four different apps. Instead of bolting on more features, we rebuilt the basicsfast messaging, crisp video, expressive designand kept the experience opinionated but simple."})]})]})}),(0,er.jsxs)("div",{className:"mb-12",children:[(0,er.jsx)("h2",{className:"text-white text-3xl mb-6 text-center",children:"Our Values"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center mb-4",children:(0,er.jsx)(tb,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Innovation First"}),(0,er.jsx)("p",{className:"text-white/70",children:"We only ship features when they make conversations feel more natural4K video, buttery screen share, and tools that do not get in the way."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4",children:(0,er.jsx)(th,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Community Focused"}),(0,er.jsx)("p",{className:"text-white/70",children:"Every roadmap discussion starts with will this help a friend group stay close? If not, it does not make the cut."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center mb-4",children:(0,er.jsx)(gN,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Privacy & Security"}),(0,er.jsx)("p",{className:"text-white/70",children:"Encryption, disappearing stories, and clear controls keep your info yours. No data brokers, no surprise dark patterns."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center mb-4",children:(0,er.jsx)(bU,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Inclusive Design"}),(0,er.jsx)("p",{className:"text-white/70",children:"High-contrast themes, captions, and keyboard-friendly flows make the app usable whether you are on a phone, tablet, or laptop."})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-8",children:[(0,er.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0",children:(0,er.jsx)(bB,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("div",{children:(0,er.jsx)("h2",{className:"text-white text-2xl mb-3",children:"What Makes Us Different"})})]}),(0,er.jsxs)("div",{className:"space-y-4 text-white/70",children:[(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-pink-500 rounded-full mt-2 flex-shrink-0"}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"Honest quality:"})," 4K video and 8K screen share are standard, not hidden behind a pricing grid."]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"One tap away:"})," Feeds, stories, calls, and DMs sit under the same roof so your group never splinters."]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"Design with taste:"})," The interface nods to glass and neon without sacrificing readability or speed."]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"Demo saves the day:"})," If Zoom already owns your camera, we fake one so presentations keep rolling."]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full mt-2 flex-shrink-0"}),(0,er.jsxs)("p",{children:[(0,er.jsx)("span",{className:"text-white",children:"No paywall:"})," Use every feature without upgrading or watching ads. We're focused on building trust, not squeezing wallets."]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-8",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-4",children:"Our Story"}),(0,er.jsxs)("div",{className:"space-y-4 text-white/70 leading-relaxed",children:[(0,er.jsx)("p",{children:"MoveSplash started as a side project to fix our own friend group problems. We were hopping between Snapchat for stories, Discord for planning, and Zoom for calls. It felt ridiculous."}),(0,er.jsx)("p",{children:"Instead of cloning another feed, we stitched the pieces togetherhi-res video, stories that do not overstay their welcome, and a feed that does not punish you for disappearing for a weekend."}),(0,er.jsx)("p",{children:"Today we are still a small team, but we ship fast, talk to users every week, and keep the product honest. If it does not help you connect with real people, it does not ship."})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-pink-500/30 to-purple-500/30 border-pink-400/30 p-12 text-center",children:[(0,er.jsx)("h2",{className:"text-white text-4xl mb-4",children:"Join us if you're tired of noisy feeds."}),(0,er.jsx)("p",{className:"text-white/80 text-lg mb-6",children:"Sign up free, bring your people, and let us worry about the infrastructure."}),(0,er.jsx)(tn,{onClick:e,className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white border-0 text-lg px-8 py-6",children:"Get Started Now"})]})]})]})}function bq({onBack:e}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-orange-900 via-yellow-900 to-amber-900 relative overflow-hidden",children:[(0,er.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,er.jsx)("div",{className:"absolute w-96 h-96 bg-orange-500/30 rounded-full blur-3xl -top-48 -left-48 animate-pulse"}),(0,er.jsx)("div",{className:"absolute w-96 h-96 bg-yellow-500/30 rounded-full blur-3xl top-1/3 -right-48 animate-pulse",style:{animationDelay:"1s"}}),(0,er.jsx)("div",{className:"absolute w-96 h-96 bg-amber-500/30 rounded-full blur-3xl -bottom-48 left-1/3 animate-pulse",style:{animationDelay:"2s"}})]}),(0,er.jsxs)("div",{className:"relative z-10 max-w-4xl mx-auto p-6 py-12",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-8",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-12",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-orange-500 to-yellow-500 mb-6",children:(0,er.jsx)(bM,{className:"w-12 h-12 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-6xl mb-4",children:"Cookie Policy"}),(0,er.jsx)("p",{className:"text-white/70 text-lg",children:"Last Updated: January 17, 2025"})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-4",children:"What Are Cookies?"}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed mb-4",children:"Cookies are tiny text snippets your browser saves so a site remembers you the next time."}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed",children:"MoveSplash uses cookies to keep you signed in, load things faster, and figure out which features deserve more love."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-6",children:"Types of Cookies We Use"}),(0,er.jsxs)("div",{className:"space-y-6",children:[(0,er.jsxs)("div",{children:[(0,er.jsxs)("h3",{className:"text-white text-xl mb-2 flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-2xl",children:""})," Essential Cookies (Required)"]}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed mb-3",children:"These are the behind-the-scenes helpers that keep MoveSplash usable. Without them you couldn't log in, load your feed, or protect your account."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm ml-8",children:[(0,er.jsx)("li",{children:" Authentication tokens so you stay signed in."}),(0,er.jsx)("li",{children:" Session cookies that remember which tab is yours."}),(0,er.jsx)("li",{children:" Security cookies that catch suspicious logins."}),(0,er.jsx)("li",{children:" Load-balancer notes to keep the app speedy."})]}),(0,er.jsx)("p",{className:"text-white/50 text-sm mt-2",children:" If you disable these, the app simply won't run."})]}),(0,er.jsxs)("div",{children:[(0,er.jsxs)("h3",{className:"text-white text-xl mb-2 flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-2xl",children:""})," Functional Cookies"]}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed mb-3",children:"These remember the little things so you don't have to redo them every visit."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm ml-8",children:[(0,er.jsx)("li",{children:" Language and region settings."}),(0,er.jsx)("li",{children:" Light/dark mode and accessibility tweaks."}),(0,er.jsx)("li",{children:" Video quality defaults for calls and streams."}),(0,er.jsx)("li",{children:" Notification and mute choices."}),(0,er.jsx)("li",{children:" Demo mode toggles when you block hardware access."}),(0,er.jsx)("li",{children:" Volume, playback, and camera preferences."})]})]}),(0,er.jsxs)("div",{children:[(0,er.jsxs)("h3",{className:"text-white text-xl mb-2 flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-2xl",children:""})," Analytics Cookies"]}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed mb-3",children:"These help us understand what's working and what's confusing so we can make better decisions."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm ml-8",children:[(0,er.jsx)("li",{children:" Which screens people bounce from immediately."}),(0,er.jsx)("li",{children:" Feature usage stats so we know what to improve."}),(0,er.jsx)("li",{children:" Performance metrics and crash reports."}),(0,er.jsx)("li",{children:" Approximate time spent inside different areas."}),(0,er.jsx)("li",{children:" Anonymous device/browser combos to reproduce bugs."})]}),(0,er.jsx)("p",{className:"text-white/60 text-sm mt-2",children:"We aggregate this data and never sell individual information."})]}),(0,er.jsxs)("div",{children:[(0,er.jsxs)("h3",{className:"text-white text-xl mb-2 flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-2xl",children:""})," Performance Cookies"]}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed mb-3",children:"These keep things smooth even when your Wi-Fi isn't."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm ml-8",children:[(0,er.jsx)("li",{children:" Cached assets so feeds don't reload on every scroll."}),(0,er.jsx)("li",{children:" CDN routing choices to serve content from nearby servers."}),(0,er.jsx)("li",{children:" Adaptive video streaming that matches your connection."}),(0,er.jsx)("li",{children:" Network monitoring to catch regional outages quickly."})]})]}),(0,er.jsxs)("div",{children:[(0,er.jsxs)("h3",{className:"text-white text-xl mb-2 flex items-center gap-2",children:[(0,er.jsx)("span",{className:"text-2xl",children:""})," Social Media & Integration Cookies"]}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed mb-3",children:"These power things like social logins and embedded content."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm ml-8",children:[(0,er.jsx)("li",{children:" Share buttons and live embeds."}),(0,er.jsx)("li",{children:" OAuth logins through Apple, Google, or others."}),(0,er.jsx)("li",{children:" Playing nicely with calendars, docs, or other shared content."}),(0,er.jsx)("li",{children:" Remembering permissions you've granted to integrations."})]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-4",children:"Third-Party Cookies"}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed mb-4",children:"Some of the tools we lean on drop their own cookies. We only work with vendors we trust and we keep the list short:"}),(0,er.jsxs)("ul",{className:"space-y-3 text-white/60",children:[(0,er.jsxs)("li",{className:"flex items-start gap-3",children:[(0,er.jsx)("span",{className:"text-white",children:""}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"Analytics partners:"})," Help us spot bugs, crashes, and clunky flows."]})]}),(0,er.jsxs)("li",{className:"flex items-start gap-3",children:[(0,er.jsx)("span",{className:"text-white",children:""}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"Authentication providers:"})," Power single-sign-on through services like Google or Apple."]})]}),(0,er.jsxs)("li",{className:"flex items-start gap-3",children:[(0,er.jsx)("span",{className:"text-white",children:""}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"CDNs:"})," Serve photos and videos quickly from servers near you."]})]}),(0,er.jsxs)("li",{className:"flex items-start gap-3",children:[(0,er.jsx)("span",{className:"text-white",children:""}),(0,er.jsxs)("div",{children:[(0,er.jsx)("span",{className:"text-white",children:"Video infrastructure:"})," Keep 4K calls and screen shares stable."]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-4",children:"Managing Your Cookie Preferences"}),(0,er.jsxs)("div",{className:"space-y-4 text-white/70 leading-relaxed",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white text-lg mb-2",children:"Browser Settings"}),(0,er.jsx)("p",{className:"mb-2",children:"Head to your browser's privacy panel to tweak cookies. Typical controls include:"}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 ml-6",children:[(0,er.jsx)("li",{children:" Viewing or deleting saved cookies."}),(0,er.jsx)("li",{children:" Blocking every cookie (the app will struggle if you do)."}),(0,er.jsx)("li",{children:" Blocking only third-party cookies while keeping essentials."}),(0,er.jsx)("li",{children:" Auto-clearing cookies each time you close the browser."})]})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white text-lg mb-2",children:"In-App Settings"}),(0,er.jsx)("p",{children:"Inside MoveSplash go to Settings  Privacy  Cookie Preferences to:"}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 ml-6 mt-2",children:[(0,er.jsx)("li",{children:" Clear cached data without deleting the app."}),(0,er.jsx)("li",{children:" Adjust notification and tracking permissions."}),(0,er.jsx)("li",{children:" Review active sessions and log out devices."})]})]}),(0,er.jsx)("div",{className:"bg-yellow-500/20 border border-yellow-400/30 p-4 rounded-lg",children:(0,er.jsxs)("p",{className:"text-yellow-200",children:[" ",(0,er.jsx)("strong",{children:"Heads up:"})," Disabling essential cookies breaks logins and live features. If something feels off after changing settings, re-enable required cookies and refresh."]})})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-4",children:"How Long Do Cookies Last?"}),(0,er.jsxs)("div",{className:"space-y-3 text-white/70",children:[(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-1",children:"Session Cookies"}),(0,er.jsx)("p",{className:"text-sm",children:"Short-lived and gone when you close the tab. These keep you logged in while you bounce between screens."})]}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-1",children:"Persistent Cookies"}),(0,er.jsx)("p",{className:"text-sm",children:"Stick around for 30 days to a year so we remember things like your theme or camera settings."})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-6",children:[(0,er.jsx)("h2",{className:"text-white text-2xl mb-4",children:"Updates to This Policy"}),(0,er.jsx)("p",{className:"text-white/70 leading-relaxed",children:"If we tweak how we use cookies, we'll update this page and refresh the Last Updated date. Big changes also trigger an in-app heads-up."})]}),(0,er.jsx)("div",{className:"text-center mt-12",children:(0,er.jsx)(tn,{onClick:e,className:"bg-gradient-to-r from-orange-500 to-yellow-500 hover:from-orange-600 hover:to-yellow-600 text-white border-0 px-8 py-6",children:"Back to MoveSplash"})})]})]})}let bF=tc("flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),bH=tc("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),bW=tc("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);function bG({feature:e,onBack:t,onGetStarted:r}){switch(e){case"group-chats":return(0,er.jsx)(bV,{onBack:t,onGetStarted:r});case"video-calls":return(0,er.jsx)(bK,{onBack:t,onGetStarted:r});case"screen-share":return(0,er.jsx)(bJ,{onBack:t,onGetStarted:r});case"stories":return(0,er.jsx)(bY,{onBack:t,onGetStarted:r});case"friends":return(0,er.jsx)(bX,{onBack:t,onGetStarted:r});case"gen-z":return(0,er.jsx)(bQ,{onBack:t,onGetStarted:r});default:return null}}function bV({onBack:e,onGetStarted:t}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-pink-900 relative overflow-hidden",children:[(0,er.jsx)(bZ,{}),(0,er.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto p-6",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-12",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 mb-6",children:(0,er.jsx)(pG,{className:"w-12 h-12 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-6xl mb-4",children:"Group Chats"}),(0,er.jsx)("p",{className:"text-white/70 text-xl max-w-2xl mx-auto",children:"Bring your whole squad together with group chats that support up to 20 people. Share moments, coordinate plans, and stay connected - all in one place."})]}),(0,er.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center mb-4",children:(0,er.jsx)(th,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Up to 20 People"}),(0,er.jsx)("p",{className:"text-white/70",children:"Create massive group chats for your friend groups, teams, or family. Everyone stays in the loop."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center mb-4",children:(0,er.jsx)(a_,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Rich Media Sharing"}),(0,er.jsx)("p",{className:"text-white/70",children:"Share photos, videos, voice messages, files, and links. Everything your group needs to communicate."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center mb-4",children:(0,er.jsx)(u3,{className:"w-6 h-6 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Star Messages"}),(0,er.jsx)("p",{className:"text-white/70",children:"Mark important messages with a star so your group can find them easily later."})]})]}),(0,er.jsx)("div",{className:"space-y-6 mb-12",children:(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)("h2",{className:"text-white text-3xl mb-6",children:"Powerful Group Features"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)(b0,{icon:(0,er.jsx)(td,{className:"w-5 h-5"}),title:"Text Messages",description:"Send unlimited text messages with emoji support and formatting"}),(0,er.jsx)(b0,{icon:(0,er.jsx)(tg,{className:"w-5 h-5"}),title:"Photo & Video Sharing",description:"Share photos and videos instantly with the whole group"}),(0,er.jsx)(b0,{icon:(0,er.jsx)(hn,{className:"w-5 h-5"}),title:"Voice Messages",description:"Record and send voice messages when typing isn't enough"}),(0,er.jsx)(b0,{icon:(0,er.jsx)(bD,{className:"w-5 h-5"}),title:"File Sharing",description:"Share documents, PDFs, and files up to 100MB"})]}),(0,er.jsxs)("div",{className:"space-y-4",children:[(0,er.jsx)(b0,{icon:(0,er.jsx)(tm,{className:"w-5 h-5"}),title:"Message Reactions",description:"React to messages with emojis -    and more"}),(0,er.jsx)(b0,{icon:(0,er.jsx)(u3,{className:"w-5 h-5"}),title:"Starred Messages",description:"Save important messages by starring them for quick access"}),(0,er.jsx)(b0,{icon:(0,er.jsx)(th,{className:"w-5 h-5"}),title:"Group Admin Controls",description:"Admins can add/remove members and manage group settings"}),(0,er.jsx)(b0,{icon:(0,er.jsx)(b4,{className:"w-5 h-5"}),title:"Custom Notifications",description:"Set notification preferences per group - mute or customize alerts"})]})]})]})}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-12",children:[(0,er.jsx)("h2",{className:"text-white text-3xl mb-6",children:"Perfect For Every Squad"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,er.jsx)(b1,{icon:"",title:"Friend Groups",description:"Keep the crew connected"}),(0,er.jsx)(b1,{icon:"",title:"Study Groups",description:"Coordinate homework & projects"}),(0,er.jsx)(b1,{icon:"",title:"Family Chats",description:"Stay close with loved ones"}),(0,er.jsx)(b1,{icon:"",title:"Work Teams",description:"Collaborate on projects"}),(0,er.jsx)(b1,{icon:"",title:"Gaming Squads",description:"Plan game sessions"}),(0,er.jsx)(b1,{icon:"",title:"Event Planning",description:"Organize parties & meetups"}),(0,er.jsx)(b1,{icon:"",title:"Sports Teams",description:"Coordinate practices & games"}),(0,er.jsx)(b1,{icon:"",title:"Creative Projects",description:"Share ideas & feedback"})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-purple-500/30 to-pink-500/30 border-purple-400/30 p-12 text-center",children:[(0,er.jsx)("h2",{className:"text-white text-4xl mb-4",children:"Ready to Connect Your Squad?"}),(0,er.jsx)("p",{className:"text-white/80 text-lg mb-6",children:"Create your first group chat in seconds and bring everyone together."}),(0,er.jsx)(tn,{onClick:()=>t?.(),className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 text-lg px-8 py-6",children:"Start Group Chat"})]})]})]})}function bK({onBack:e,onGetStarted:t}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-pink-900 relative overflow-hidden",children:[(0,er.jsx)(bZ,{}),(0,er.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto p-6",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-12",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 mb-6",children:(0,er.jsx)(tu,{className:"w-12 h-12 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-6xl mb-4",children:"Video Calls"}),(0,er.jsx)("p",{className:"text-white/70 text-xl max-w-2xl mx-auto",children:"Stunning 4K UHD video calls with up to 20 participants. See your friends' faces in incredible detail, share your screen, and feel like you're in the same room - no matter where you are."})]}),(0,er.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 mb-12",children:[(0,er.jsx)(b2,{number:"20",label:"Participants",color:"from-blue-500 to-cyan-500"}),(0,er.jsx)(b2,{number:"4K",label:"UHD Quality",color:"from-purple-500 to-pink-500"}),(0,er.jsx)(b2,{number:"",label:"Call Duration",color:"from-green-500 to-emerald-500"}),(0,er.jsx)(b2,{number:"0",label:"Call Limits",color:"from-yellow-500 to-orange-500"})]}),(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-12",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center mb-4",children:(0,er.jsx)(tu,{className:"w-7 h-7 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-2xl mb-3",children:"4K UHD Video & Audio"}),(0,er.jsx)("p",{className:"text-white/70 mb-4",children:"Stunning 4K UHD (3840x2160) video quality with intelligent adaptive streaming. Automatically detects your webcam capabilities and internet speed for the best possible quality - from 4K UHD down to HD as needed."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm",children:[(0,er.jsx)("li",{children:" Up to 4K UHD (3840x2160) @ 30fps"}),(0,er.jsx)("li",{children:" Auto-fallback to Full HD (1920x1080) or HD (1280x720)"}),(0,er.jsx)("li",{children:" Echo cancellation & noise reduction"}),(0,er.jsx)("li",{children:" Automatic quality optimization"}),(0,er.jsx)("li",{children:" Low-latency audio streaming"})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4",children:(0,er.jsx)(th,{className:"w-7 h-7 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-2xl mb-3",children:"Group Video Calls"}),(0,er.jsx)("p",{className:"text-white/70 mb-4",children:"Host video calls with up to 20 people simultaneously. Perfect for friend groups, family gatherings, study sessions, or remote team meetings."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm",children:[(0,er.jsx)("li",{children:" Up to 20 simultaneous participants"}),(0,er.jsx)("li",{children:" Grid or speaker view layouts"}),(0,er.jsx)("li",{children:" See who's talking with active speaker indicator"}),(0,er.jsx)("li",{children:" Join from mobile or desktop"})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center mb-4",children:(0,er.jsx)(pH,{className:"w-7 h-7 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-2xl mb-3",children:"Screen Sharing"}),(0,er.jsx)("p",{className:"text-white/70 mb-4",children:"Share your entire screen, specific window, or browser tab. Perfect for presentations, watching videos together, or helping friends troubleshoot."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm",children:[(0,er.jsx)("li",{children:" Share full screen or specific windows"}),(0,er.jsx)("li",{children:" Audio sharing included"}),(0,er.jsx)("li",{children:" HD quality screen streaming"}),(0,er.jsx)("li",{children:" Easy one-click sharing"})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center mb-4",children:(0,er.jsx)(tb,{className:"w-7 h-7 text-white"})}),(0,er.jsx)("h3",{className:"text-white text-2xl mb-3",children:"Demo Mode"}),(0,er.jsx)("p",{className:"text-white/70 mb-4",children:"Presenting on another call? Enable Demo Mode to simulate your camera without accessing it, preventing conflicts with other video apps."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60 text-sm",children:[(0,er.jsx)("li",{children:" Safe for presentations"}),(0,er.jsx)("li",{children:" No camera conflicts"}),(0,er.jsx)("li",{children:" Animated demo feed"}),(0,er.jsx)("li",{children:" Toggle anytime during calls"})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-12",children:[(0,er.jsx)("h2",{className:"text-white text-3xl mb-6",children:"How MoveSplash Compares"}),(0,er.jsx)("div",{className:"overflow-x-auto",children:(0,er.jsxs)("table",{className:"w-full text-left",children:[(0,er.jsx)("thead",{children:(0,er.jsxs)("tr",{className:"border-b border-white/20",children:[(0,er.jsx)("th",{className:"text-white py-3 px-4",children:"Platform"}),(0,er.jsx)("th",{className:"text-white py-3 px-4",children:"Video Quality"}),(0,er.jsx)("th",{className:"text-white py-3 px-4",children:"Screen Share"}),(0,er.jsx)("th",{className:"text-white py-3 px-4",children:"Participants"}),(0,er.jsx)("th",{className:"text-white py-3 px-4",children:"Price"})]})}),(0,er.jsxs)("tbody",{className:"text-white/70",children:[(0,er.jsxs)("tr",{className:"border-b border-white/10 bg-gradient-to-r from-purple-500/20 to-pink-500/20",children:[(0,er.jsx)("td",{className:"py-3 px-4 text-white",children:" MoveSplash"}),(0,er.jsx)("td",{className:"py-3 px-4 text-green-400",children:"4K UHD"}),(0,er.jsx)("td",{className:"py-3 px-4 text-green-400",children:"8K UHD"}),(0,er.jsx)("td",{className:"py-3 px-4 text-green-400",children:"20"}),(0,er.jsx)("td",{className:"py-3 px-4 text-green-400",children:"FREE"})]}),(0,er.jsxs)("tr",{className:"border-b border-white/10",children:[(0,er.jsx)("td",{className:"py-3 px-4",children:"Zoom"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"1080p"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"1080p"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"100 (paid)"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"$14.99/mo"})]}),(0,er.jsxs)("tr",{className:"border-b border-white/10",children:[(0,er.jsx)("td",{className:"py-3 px-4",children:"Google Meet"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"1080p"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"1080p"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"100 (paid)"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"$6-18/mo"})]}),(0,er.jsxs)("tr",{className:"border-b border-white/10",children:[(0,er.jsx)("td",{className:"py-3 px-4",children:"Discord"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"1080p"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"4K (Nitro)"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"25"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"$9.99/mo"})]}),(0,er.jsxs)("tr",{className:"border-b border-white/10",children:[(0,er.jsx)("td",{className:"py-3 px-4",children:"Messenger"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"720p"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"720p"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"8"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"Free"})]}),(0,er.jsxs)("tr",{children:[(0,er.jsx)("td",{className:"py-3 px-4",children:"Snapchat"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"720p"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"N/A"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"15"}),(0,er.jsx)("td",{className:"py-3 px-4",children:"Free"})]})]})]})}),(0,er.jsx)("p",{className:"text-white/60 text-sm mt-4 text-center",children:"MoveSplash offers the highest video and screen sharing quality of any social platform - completely free! "})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-12",children:[(0,er.jsx)("h2",{className:"text-white text-3xl mb-6",children:"Intuitive Call Controls"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,er.jsxs)("div",{className:"text-center",children:[(0,er.jsx)("div",{className:"w-16 h-16 rounded-full bg-white/10 flex items-center justify-center mx-auto mb-3",children:(0,er.jsx)(hn,{className:"w-8 h-8 text-white"})}),(0,er.jsx)("h3",{className:"text-white mb-2",children:"Mute/Unmute"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Quick toggle for your microphone"})]}),(0,er.jsxs)("div",{className:"text-center",children:[(0,er.jsx)("div",{className:"w-16 h-16 rounded-full bg-white/10 flex items-center justify-center mx-auto mb-3",children:(0,er.jsx)(tu,{className:"w-8 h-8 text-white"})}),(0,er.jsx)("h3",{className:"text-white mb-2",children:"Camera On/Off"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Toggle your video feed"})]}),(0,er.jsxs)("div",{className:"text-center",children:[(0,er.jsx)("div",{className:"w-16 h-16 rounded-full bg-white/10 flex items-center justify-center mx-auto mb-3",children:(0,er.jsx)(pH,{className:"w-8 h-8 text-white"})}),(0,er.jsx)("h3",{className:"text-white mb-2",children:"8K Screen Share"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Share in up to 8K UHD quality"})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-blue-500/30 to-purple-500/30 border-blue-400/30 p-12 text-center",children:[(0,er.jsx)("h2",{className:"text-white text-4xl mb-4",children:"Start Your First Video Call"}),(0,er.jsx)("p",{className:"text-white/80 text-lg mb-6",children:"Connect face-to-face with friends, family, or colleagues in stunning 4K UHD quality."}),(0,er.jsx)(tn,{onClick:()=>t?.(),className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white border-0 text-lg px-8 py-6",children:"Make a Call"})]})]})]})}function bJ({onBack:e,onGetStarted:t}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-green-900 via-teal-900 to-blue-900 relative overflow-hidden",children:[(0,er.jsx)(bZ,{}),(0,er.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto p-6",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-12",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 mb-6",children:(0,er.jsx)(pH,{className:"w-12 h-12 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-6xl mb-4",children:"8K Screen Sharing"}),(0,er.jsx)("p",{className:"text-white/70 text-xl max-w-2xl mx-auto",children:"Share your screen in stunning 8K UHD quality (7680x4320) during video calls. Perfect for ultra-high-res presentations, design work, tutorials, or remote collaboration with uncompromising clarity."})]}),(0,er.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 mb-12",children:[(0,er.jsx)(b2,{number:"8K",label:"UHD Quality",color:"from-green-500 to-emerald-500"}),(0,er.jsx)(b2,{number:"7680",label:"Pixels Wide",color:"from-blue-500 to-cyan-500"}),(0,er.jsx)(b2,{number:"30fps",label:"Frame Rate",color:"from-purple-500 to-pink-500"}),(0,er.jsx)(b2,{number:"",label:"Share Time",color:"from-yellow-500 to-orange-500"})]}),(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-12",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)("h3",{className:"text-white text-2xl mb-4",children:" 8K UHD Full Screen Sharing"}),(0,er.jsx)("p",{className:"text-white/70 mb-4",children:"Share your entire screen at up to 8K UHD resolution (7680x4320). Perfect for ultra-high-resolution displays, professional presentations, design reviews, and content creation workflows where every pixel matters."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60",children:[(0,er.jsx)("li",{children:" Up to 8K UHD (7680x4320) quality"}),(0,er.jsx)("li",{children:" Auto-detects display resolution"}),(0,er.jsx)("li",{children:" Falls back to 5K/4K/QHD/Full HD/HD as needed"}),(0,er.jsx)("li",{children:" Smooth 30fps frame rate"}),(0,er.jsx)("li",{children:" Audio sharing included"}),(0,er.jsx)("li",{children:" Works on mobile & desktop"})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)("h3",{className:"text-white text-2xl mb-4",children:" Selective Window Sharing"}),(0,er.jsx)("p",{className:"text-white/70 mb-4",children:"Share just a specific window or application in full quality. Keep your notifications, messages, and other windows completely private while sharing."}),(0,er.jsxs)("ul",{className:"space-y-2 text-white/60",children:[(0,er.jsx)("li",{children:" Privacy-focused sharing"}),(0,er.jsx)("li",{children:" Choose specific apps or browser tabs"}),(0,er.jsx)("li",{children:" Hide sensitive information"}),(0,er.jsx)("li",{children:" Easy app switching during share"}),(0,er.jsx)("li",{children:" Full quality for selected window"}),(0,er.jsx)("li",{children:" Share audio from specific tabs"})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-12",children:[(0,er.jsx)("h2",{className:"text-white text-3xl mb-6",children:"Intelligent Quality Adaptation"}),(0,er.jsx)("p",{className:"text-white/70 mb-6",children:"MoveSplash automatically detects your display resolution and internet connection to deliver the best possible screen sharing quality:"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,er.jsxs)("div",{className:"bg-gradient-to-br from-purple-500/20 to-pink-500/20 border border-purple-400/30 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" 8K UHD"}),(0,er.jsx)("p",{className:"text-white/60 text-sm mb-2",children:"7680 x 4320 pixels"}),(0,er.jsx)("p",{className:"text-white/60 text-xs",children:"For ultra-high-res displays and professional work"})]}),(0,er.jsxs)("div",{className:"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 border border-blue-400/30 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" 5K UHD"}),(0,er.jsx)("p",{className:"text-white/60 text-sm mb-2",children:"5120 x 2880 pixels"}),(0,er.jsx)("p",{className:"text-white/60 text-xs",children:"For iMac 5K and similar displays"})]}),(0,er.jsxs)("div",{className:"bg-gradient-to-br from-green-500/20 to-emerald-500/20 border border-green-400/30 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" 4K UHD"}),(0,er.jsx)("p",{className:"text-white/60 text-sm mb-2",children:"3840 x 2160 pixels"}),(0,er.jsx)("p",{className:"text-white/60 text-xs",children:"Standard 4K displays and monitors"})]}),(0,er.jsxs)("div",{className:"bg-white/10 border border-white/20 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" QHD"}),(0,er.jsx)("p",{className:"text-white/60 text-sm mb-2",children:"2560 x 1440 pixels"}),(0,er.jsx)("p",{className:"text-white/60 text-xs",children:"2K/1440p displays"})]}),(0,er.jsxs)("div",{className:"bg-white/10 border border-white/20 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" Full HD"}),(0,er.jsx)("p",{className:"text-white/60 text-sm mb-2",children:"1920 x 1080 pixels"}),(0,er.jsx)("p",{className:"text-white/60 text-xs",children:"Standard 1080p displays"})]}),(0,er.jsxs)("div",{className:"bg-white/10 border border-white/20 p-4 rounded-lg",children:[(0,er.jsx)("h3",{className:"text-white mb-2",children:" HD"}),(0,er.jsx)("p",{className:"text-white/60 text-sm mb-2",children:"1280 x 720 pixels"}),(0,er.jsx)("p",{className:"text-white/60 text-xs",children:"Mobile devices and lower-res screens"})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-12",children:[(0,er.jsx)("h2",{className:"text-white text-3xl mb-6",children:"Perfect For"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,er.jsx)(b1,{icon:"",title:"Design Reviews",description:"Show high-res mockups & prototypes"}),(0,er.jsx)(b1,{icon:"",title:"Video Editing",description:"Share 8K footage & timelines"}),(0,er.jsx)(b1,{icon:"",title:"Data Visualization",description:"Share detailed dashboards"}),(0,er.jsx)(b1,{icon:"",title:"CAD/3D Work",description:"Present architectural designs"}),(0,er.jsx)(b1,{icon:"",title:"Photography",description:"Review high-res photos"}),(0,er.jsx)(b1,{icon:"",title:"Code Reviews",description:"Share IDE with clarity"}),(0,er.jsx)(b1,{icon:"",title:"Teaching",description:"Clear presentations & tutorials"}),(0,er.jsx)(b1,{icon:"",title:"Gaming",description:"Stream gameplay in detail"})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-green-500/30 to-teal-500/30 border-green-400/30 p-12 text-center",children:[(0,er.jsx)("h2",{className:"text-white text-4xl mb-4",children:"Experience 8K Screen Sharing"}),(0,er.jsx)("p",{className:"text-white/80 text-lg mb-6",children:"The most advanced screen sharing technology available on any social platform."}),(0,er.jsx)(tn,{onClick:()=>t?.(),className:"bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white border-0 text-lg px-8 py-6",children:"Start Sharing in 8K"})]})]})]})}function bY({onBack:e,onGetStarted:t}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-900 via-purple-900 to-orange-900 relative overflow-hidden",children:[(0,er.jsx)(bZ,{}),(0,er.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto p-6",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-12",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-pink-500 to-orange-500 mb-6",children:(0,er.jsx)(tp,{className:"w-12 h-12 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-6xl mb-4",children:"Stories & Snaps"}),(0,er.jsx)("p",{className:"text-white/70 text-xl max-w-2xl mx-auto",children:"Share your moments with disappearing Stories that vanish after 24 hours. Snapchat-style ephemeral content that's perfect for sharing your day without the permanence."})]}),(0,er.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)(iG,{className:"w-12 h-12 text-yellow-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"24-Hour Stories"}),(0,er.jsx)("p",{className:"text-white/70",children:"Stories disappear after 24 hours. Share freely without worrying about permanent posts."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)(bT,{className:"w-12 h-12 text-blue-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"See Who Viewed"}),(0,er.jsx)("p",{className:"text-white/70",children:"Track who's viewing your stories and when they watched them."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6",children:[(0,er.jsx)(tm,{className:"w-12 h-12 text-pink-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"React & Reply"}),(0,er.jsx)("p",{className:"text-white/70",children:"Friends can react with emojis or send quick replies to your stories."})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-pink-500/30 to-orange-500/30 border-pink-400/30 p-12 text-center",children:[(0,er.jsx)("h2",{className:"text-white text-4xl mb-4",children:"Start Sharing Your Story"}),(0,er.jsx)(tn,{onClick:()=>t?.(),className:"bg-gradient-to-r from-pink-500 to-orange-500 hover:from-pink-600 hover:to-orange-600 text-white border-0 text-lg px-8 py-6",children:"Post Your First Story"})]})]})]})}function bX({onBack:e,onGetStarted:t}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 relative overflow-hidden",children:[(0,er.jsx)(bZ,{}),(0,er.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto p-6",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-12",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 mb-6",children:(0,er.jsx)(th,{className:"w-12 h-12 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-6xl mb-4",children:"Friends Network"}),(0,er.jsx)("p",{className:"text-white/70 text-xl max-w-2xl mx-auto",children:"Build your social circle. Connect with friends, discover new people, and manage your network with powerful friend management tools."})]}),(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-12",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)(iF,{className:"w-12 h-12 text-green-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-2xl mb-3",children:"Easy Friend Requests"}),(0,er.jsx)("p",{className:"text-white/70",children:"Search for friends by name or username. Send friend requests and build your network easily."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)(bU,{className:"w-12 h-12 text-blue-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-2xl mb-3",children:"Friend Suggestions"}),(0,er.jsx)("p",{className:"text-white/70",children:"Discover mutual friends and get personalized friend recommendations."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)(gk,{className:"w-12 h-12 text-purple-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-2xl mb-3",children:"Privacy Controls"}),(0,er.jsx)("p",{className:"text-white/70",children:"Control who can send you requests, see your posts, and view your profile."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8",children:[(0,er.jsx)(bH,{className:"w-12 h-12 text-pink-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-2xl mb-3",children:"Friend Lists"}),(0,er.jsx)("p",{className:"text-white/70",children:"Organize friends into custom lists: Close Friends, Family, Work, etc."})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-indigo-500/30 to-purple-500/30 border-indigo-400/30 p-12 text-center",children:[(0,er.jsx)("h2",{className:"text-white text-4xl mb-4",children:"Grow Your Network"}),(0,er.jsx)(tn,{onClick:()=>t?.(),className:"bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 text-white border-0 text-lg px-8 py-6",children:"Find Friends"})]})]})]})}function bQ({onBack:e,onGetStarted:t}){return(0,er.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-900 via-pink-900 to-purple-900 relative overflow-hidden",children:[(0,er.jsx)(bZ,{}),(0,er.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto p-6",children:[(0,er.jsxs)(tn,{variant:"ghost",onClick:e,className:"text-white/70 hover:text-white hover:bg-white/10 mb-4",children:[(0,er.jsx)(bA,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,er.jsxs)("div",{className:"text-center mb-12",children:[(0,er.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-yellow-500 via-pink-500 to-purple-500 mb-6",children:(0,er.jsx)(bF,{className:"w-12 h-12 text-white"})}),(0,er.jsx)("h1",{className:"text-white text-6xl mb-4",children:"Gen Z Vibes "}),(0,er.jsx)("p",{className:"text-white/70 text-xl max-w-2xl mx-auto",children:"Built by Gen Z, for Gen Z. We speak your language with a design that's aesthetic AF, features that matter, and vibes that just hit different."})]}),(0,er.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-pink-500/20 to-purple-500/20 border-pink-400/30 p-6",children:[(0,er.jsx)(tb,{className:"w-12 h-12 text-pink-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Glassmorphism Design"}),(0,er.jsx)("p",{className:"text-white/70",children:"That smooth, frosted glass aesthetic everyone's obsessed with. Liquid gradients, blur effects, and vibes."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-yellow-500/20 to-orange-500/20 border-yellow-400/30 p-6",children:[(0,er.jsx)(tm,{className:"w-12 h-12 text-yellow-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Emoji Everything"}),(0,er.jsx)("p",{className:"text-white/70",children:"Full emoji support everywhere. React, express, and communicate in the language of the internet."})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-purple-500/20 to-blue-500/20 border-purple-400/30 p-6",children:[(0,er.jsx)(gD,{className:"w-12 h-12 text-purple-400 mb-4"}),(0,er.jsx)("h3",{className:"text-white text-xl mb-2",children:"Always Evolving"}),(0,er.jsx)("p",{className:"text-white/70",children:"We're constantly adding new features based on what YOU want. Your feedback shapes the app."})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-8 mb-12",children:[(0,er.jsx)("h2",{className:"text-white text-3xl mb-6",children:"Why Gen Z Loves MoveSplash"}),(0,er.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)(bF,{className:"w-6 h-6 text-orange-400 flex-shrink-0 mt-1"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-1",children:"No Toxic Algorithms"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"See what your friends share, not what a faceless ranking system decides you care about."})]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)(gk,{className:"w-6 h-6 text-green-400 flex-shrink-0 mt-1"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-1",children:"Privacy First"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Your data is yours. We don't sell it, period."})]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)(tp,{className:"w-6 h-6 text-yellow-400 flex-shrink-0 mt-1"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-1",children:"Lightning Fast"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"No lag, no loading, just instant vibes"})]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)(tm,{className:"w-6 h-6 text-pink-400 flex-shrink-0 mt-1"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-1",children:"Mental Health Friendly"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"No follower counts, no public likes, less stress"})]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)(bW,{className:"w-6 h-6 text-purple-400 flex-shrink-0 mt-1"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-1",children:"Aesthetic AF"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Every screen is screenshot-worthy"})]})]}),(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)(tf,{className:"w-6 h-6 text-blue-400 flex-shrink-0 mt-1"}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h3",{className:"text-white mb-1",children:"Made for Sharing"}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:"Stories, snaps, memes - share it all your way"})]})]})]})]}),(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-gradient-to-br from-yellow-500/30 via-pink-500/30 to-purple-500/30 border-yellow-400/30 p-12 text-center",children:[(0,er.jsx)("h2",{className:"text-white text-4xl mb-4",children:"Join the MoveSplash Generation"}),(0,er.jsx)("p",{className:"text-white/80 text-lg mb-6",children:"Where your vibe matters more than your follower count "}),(0,er.jsx)(tn,{onClick:()=>t?.(),className:"bg-gradient-to-r from-yellow-500 via-pink-500 to-purple-500 hover:opacity-90 text-white border-0 text-lg px-8 py-6",children:"Get Started - It's Free"})]})]})]})}function bZ(){return(0,er.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,er.jsx)("div",{className:"absolute top-0 -left-4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"}),(0,er.jsx)("div",{className:"absolute top-0 -right-4 w-96 h-96 bg-yellow-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"}),(0,er.jsx)("div",{className:"absolute -bottom-8 left-20 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"})]})}function b0({icon:e,title:t,description:r}){return(0,er.jsxs)("div",{className:"flex items-start gap-3",children:[(0,er.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0 text-white",children:e}),(0,er.jsxs)("div",{children:[(0,er.jsx)("h4",{className:"text-white mb-1",children:t}),(0,er.jsx)("p",{className:"text-white/60 text-sm",children:r})]})]})}function b1({icon:e,title:t,description:r}){return(0,er.jsxs)("div",{className:"bg-white/5 p-4 rounded-lg text-center",children:[(0,er.jsx)("div",{className:"text-3xl mb-2",children:e}),(0,er.jsx)("h4",{className:"text-white text-sm mb-1",children:t}),(0,er.jsx)("p",{className:"text-white/50 text-xs",children:r})]})}function b2({number:e,label:t,color:r}){return(0,er.jsxs)(ak,{className:"backdrop-blur-xl bg-white/10 border-white/20 p-6 text-center",children:[(0,er.jsx)("div",{className:`text-5xl text-transparent bg-clip-text bg-gradient-to-r ${r} mb-2`,children:e}),(0,er.jsx)("div",{className:"text-white/70",children:t})]})}function b4({className:e}){return(0,er.jsx)("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,er.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}let b5=({...e})=>{let{theme:t="system"}=(0,en.useTheme)();return(0,er.jsx)(i9,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})},b3="/login",b6="feed",b8={feed:"feed",messages:"messages",video:"videochat",friends:"friendsList",stories:"stories",settings:"settings",profile:"profile",help:"help",privacy:"privacy",terms:"terms"},b7=Object.entries(b8).reduce((e,[t,r])=>(e[r.toLowerCase()]=t,e),{}),b9={"group-chats":"messaging","video-calls":"videochat","screen-share":"screenshare",stories:"stories",friends:"friends","gen-z":"genz"},xe=Object.entries(b9).reduce((e,[t,r])=>(e[r.toLowerCase()]=t,e),{}),xt={help:"help",privacy:"privacy",terms:"terms",about:"about",cookies:"cookies",signup:"signup"},xr={landing:"/",signup:"/signup",help:"/help",privacy:"/privacy",terms:"/terms",about:"/about",cookies:"/cookies"};function xs(e){let t=e.split("/").filter(Boolean);if(0===t.length)return{state:"landing",feature:null,view:b6};let[r,s]=t.map(e=>e.toLowerCase());if("login"===r){if(!s)return{state:"login",feature:null,view:b6};let e=b7[s];return e?{state:"app",feature:null,view:e}:{state:"login",feature:null,view:b6}}let n=xt[r];if(n)return{state:n,feature:null,view:b6};let i=xe[r];return i?{state:"feature",feature:i,view:b6}:{state:"landing",feature:null,view:b6}}function xn(){let{login:e,signup:t,logout:r,currentUser:s,loadProfileUser:n}=ai(),i=(0,ei.useRouter)(),a=(0,ei.usePathname)()||"/",o=xs(a),[l,c]=(0,es.useState)(o.state),[d,u]=(0,es.useState)(o.view),[h,p]=(0,es.useState)(null),[f,m]=(0,es.useState)(o.feature),[g,b]=(0,es.useState)(null),[x,y]=(0,es.useState)(null),[w,v]=(0,es.useState)(null),[j,k]=(0,es.useState)(!1),{resolvedTheme:N}=(0,en.useTheme)(),S="light"===N,_=tr("min-h-screen relative overflow-hidden transition-colors duration-500",S?"bg-gradient-to-br from-rose-100 via-purple-100 to-sky-100 text-slate-900":"bg-gradient-to-br from-purple-900 via-pink-800 to-orange-700 text-white");(0,es.useEffect)(()=>{let e=xs(a);if("app"===e.state){c("app"),u(e.view),m(null);return}if("feature"===e.state){c("feature"),m(e.feature);return}c(e.state),m(null)},[a]),(0,es.useEffect)(()=>{let e=function(e,t,r){if("login"===e)return b3;if("app"===e){let e=b8[r]??b8[b6];return`${b3}/${e}`}return"feature"===e&&t?`/${b9[t]}`:xr[e]??"/"}(l,f,d);a!==e&&i.replace(e,{scroll:!1})},[l,f,d,a,i]),(0,es.useEffect)(()=>{s?v(e=>e||s.id):v(null)},[s]),(0,es.useEffect)(()=>{let e=!1;return(async()=>{if(null===w){k(!1),await n(null);return}k(!0);let t=await n(w);!e&&(k(!1),t||i5.error("Unable to load that profile right now."))})(),()=>{e=!0}},[w,n]);let C=async(t,r)=>{await e(t,r)?(i5.success("Welcome back! "),v(null),c("app"),u("feed")):i5.error("Invalid email or password")},E=async(e,r,s,n)=>{await t(e,r,s,n)?(i5.success(`Welcome to MoveSplash, ${e}! `),v(null),c("app"),u("feed")):i5.error("Email already in use")},R=()=>{r(),i5.success("See you later! "),v(null),y(null),k(!1),c("landing")},A=e=>{b(e),u("messages")},O=()=>{m(null),c("login")};return"help"===l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(bO,{onBack:()=>c("landing")}),(0,er.jsx)(b5,{position:"top-center"})]}):"privacy"===l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(bP,{onBack:()=>c("landing")}),(0,er.jsx)(b5,{position:"top-center"})]}):"terms"===l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(b$,{onBack:()=>c("landing")}),(0,er.jsx)(b5,{position:"top-center"})]}):"about"===l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(bz,{onBack:()=>c("landing")}),(0,er.jsx)(b5,{position:"top-center"})]}):"cookies"===l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(bq,{onBack:()=>c("landing")}),(0,er.jsx)(b5,{position:"top-center"})]}):"feature"===l&&f?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(bG,{feature:f,onBack:()=>{m(null),c("landing")},onGetStarted:()=>c("signup")}),(0,er.jsx)(b5,{position:"top-center"})]}):"landing"===l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(tw,{onGetStarted:()=>c("signup"),onLogin:O,onViewFeature:e=>{m(e),c("feature")},onViewHelp:()=>c("help"),onViewPrivacy:()=>c("privacy"),onViewTerms:()=>c("terms"),onViewAbout:()=>c("about"),onViewCookies:()=>c("cookies")}),(0,er.jsx)(b5,{position:"top-center"})]}):"login"===l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(sF,{onLogin:C,onBack:()=>c("landing"),onSignup:()=>c("signup")}),(0,er.jsx)(b5,{position:"top-center"})]}):"signup"===l?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(sH,{onSignup:E,onBack:()=>c("landing"),onLogin:O}),(0,er.jsx)(b5,{position:"top-center"})]}):(0,er.jsxs)("div",{className:_,children:[(0,er.jsx)("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:(S?["absolute -top-40 -left-40 w-96 h-96 bg-gradient-to-r from-pink-200 to-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob","absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-r from-amber-200 to-orange-200 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob animation-delay-2000","absolute -bottom-40 left-20 w-96 h-96 bg-gradient-to-r from-sky-200 to-cyan-200 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob animation-delay-4000"]:["absolute -top-40 -left-40 w-96 h-96 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob","absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-2000","absolute -bottom-40 left-20 w-96 h-96 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-4000"]).map((e,t)=>(0,er.jsx)("div",{className:e},t))}),(0,er.jsx)(aj,{currentView:d,onNavigate:e=>{"profile"===e&&v(s?s.id:null),u(e),p(null)},onLogout:R,onOpenSettings:()=>{u("settings"),p(null)}}),(0,er.jsxs)("main",{className:"relative z-10 p-6",children:["feed"===d&&(0,er.jsxs)("div",{className:"space-y-6",children:[(0,er.jsx)(mk,{}),(0,er.jsx)(lU,{onShareToMessages:A})]}),"messages"===d&&!h&&(0,er.jsx)(hm,{onStartCall:e=>{p(e),u("video")},shareDraft:g?.message??null,onShareDraftConsumed:()=>b(null),focusUserId:x,onFocusUserConsumed:()=>y(null)}),("video"===d||h)&&(0,er.jsx)(p3,{callType:h||"video",onEndCall:()=>{p(null),u("messages")}}),"friends"===d&&(0,er.jsx)(ft,{onOpenProfile:e=>{v(e),u("profile")},onOpenMessage:e=>{y(e),u("messages")}}),"stories"===d&&(0,er.jsx)(mk,{}),"settings"===d&&(0,er.jsx)(gT,{onClose:()=>{u("feed")},onLogout:R,onOpenHelpCenter:()=>{p(null),u("help")},onOpenPrivacyPolicy:()=>{p(null),u("privacy")},onOpenTermsOfService:()=>{p(null),u("terms")}}),"help"===d&&(0,er.jsx)(bO,{onBack:()=>u("settings")}),"privacy"===d&&(0,er.jsx)(bP,{onBack:()=>u("settings")}),"terms"===d&&(0,er.jsx)(b$,{onBack:()=>u("settings")}),"profile"===d&&(0,er.jsx)(g$,{onShareToMessages:A,profileUserId:w,isLoading:j,onBackToFriends:()=>{s&&v(s.id),u("friends")}})]}),(0,er.jsx)(b5,{position:"top-center"}),(0,er.jsx)("style",{children:`
        @keyframes blob {
          0% { transform: translate(0px, 0px) scale(1); }
          33% { transform: translate(30px, -50px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
          100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob {
          animation: blob 7s infinite;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
      `})]})}function xi(){return(0,er.jsx)(af,{children:(0,er.jsx)(xn,{})})}e.s(["default",()=>xi],52683)}]);